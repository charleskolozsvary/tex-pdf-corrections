\documentclass{amsart}

\usepackage{amsmath,amssymb,amsthm, mathrsfs, mathtools, bm, amsfonts}
\usepackage{mathabx}
\usepackage{amscd,mathtools}

%% \usepackage[utf8]{inputenc}
%% \usepackage[english]{babel}

\usepackage{cite}
\usepackage{color}

\usepackage[pagebackref,colorlinks,citecolor=blue,linkcolor=red]{hyperref}

\renewcommand*{\backrefalt}[4]{\ifcase #1 (Not cited).\or (Cited p.~#2).\else (Cited pp.~#2).\fi} % Cited on...

%% \usepackage[pagebackref,colorlinks,citecolor=blue,linkcolor=red]{hyperref}
\usepackage{float}
\usepackage{tikz}
\usepackage{lmodern}
\usetikzlibrary{decorations.pathmorphing}

\usepackage{multicol}
\tikzset{snake it/.style={decorate, decoration=snake}}
\usetikzlibrary{automata}
\usetikzlibrary{cd}

%% \usepackage[margin=3cm]{geometry}


%% \usepackage{comment}
\usepackage{mathtools}


\usepackage{csquotes}

%% \usepackage{amsthm}

%\usepackage[notref,notcite]{showkeys} %Adds usual marginal notes


% \newtheorem{theorem}{Theorem}[section]
%\theoremstyle{definition}
%\newtheorem{definition}[theorem]{Definition}
%\newtheorem{lemma}[theorem]{Lemma}
%\newtheorem{claim}[theorem]{Claim}
%\newtheorem{example}[theorem]{Example}
%
%\newtheorem{corollary}[theorem]{Corollary}
% \newtheorem*{maintheorem}{Main Theorem}
%  \newtheorem*{keytheorem}{Key Theorem}
% \newtheorem{remark}[theorem]{Remark}
% \newtheorem{eremark}[theorem]{Essential Remark}
%  \newtheorem{question}{Question}
%\newtheorem{proposition}[theorem]{Proposition}
%  \newtheorem{conjecture}{Conjecture}

\usepackage{tikz}
\usetikzlibrary{calc}
\usetikzlibrary{arrows}
\usetikzlibrary{decorations.pathreplacing}
\usetikzlibrary{intersections}

\usepackage{hyperref}
\usepackage{tikz}
\usepackage{caption, subcaption}
\usepackage{tikz-cd}
\usetikzlibrary{calc,decorations.pathreplacing}
%% \usepackage{tikz}
%% \usetikzlibrary{calc}
\usetikzlibrary{arrows}
%% \usetikzlibrary{decorations.pathreplacing}
\usetikzlibrary{intersections}



 \newtheorem{theorem}{Theorem}[section]
  \newtheorem{proposition}[theorem]{Proposition}
    \newtheorem{convention}[theorem]{Convention}
      \newtheorem{construction}[theorem]{Construction}
         \newtheorem{assumption}[theorem]{Assumption}


  \newtheorem{corollary}[theorem]{Corollary}
  \newtheorem{lemma}[theorem]{Lemma}
  \newtheorem{conjecture}[theorem]{Conjecture}
  \newtheorem{problem}[theorem]{Problem}
  \newtheorem{question}[theorem]{Question}
  \newtheorem{axiom}[theorem]{Axiom}


  \newtheorem{introthm}{Theorem}
  \newtheorem{introcor}[introthm]{Corollary}
  \renewcommand{\theintrothm}{\Alph{introthm}}
  \renewcommand{\theintrocor}{\Alph{introcor}}

  \theoremstyle{definition}
  \newtheorem{definition}[theorem]{Definition}
  \newtheorem{claim}[theorem]{Claim}
  \newtheorem{subclaim}[theorem]{Subclaim}
  \newtheorem*{claim*}{Claim}
  \newtheorem{exercise}[theorem]{Exercise}
  \newtheorem{example}[theorem]{Example}
    \newtheorem{notation}[theorem]{Notation}

  \newtheorem{fact}[theorem]{Fact}
  \newtheorem*{question*}{Question}
  \newtheorem*{answer*}{Answer}
  \newtheorem*{application*}{Application}

  \theoremstyle{remark}
  \newtheorem{remark}[theorem]{Remark}
  \newtheorem*{remark*}{Remark}
    \newtheorem{fiddly}[theorem]{Fiddly Bit}

  
  
  

  

\usepackage{amssymb}


\newcommand{\Cone}{\text{Cone}}
\newcommand{\id}{\text{id}}
\newcommand{\Pone}{\text{Pcone}}
\DeclarePairedDelimiterX{\Norm}[1]{\lVert}{\rVert}{#1}
 \newcommand{\from}{\colon\thinspace} 
\theoremstyle{definition}

%%new font
 \newcommand{\sA}{{\sf A}}   
  \newcommand{\sB}{{\sf B}}   
  \newcommand{\sC}{{\sf C}}   
  \newcommand{\sD}{{\sf D}}     
  \newcommand{\sE}{{\sf E}}   
  \newcommand{\sF}{{\sf F}}   
  \newcommand{\sG}{{\sf G}}   
  \newcommand{\sH}{{\sf H}}     
  \newcommand{\sI}{{\sf I}}   
  \newcommand{\sJ}{{\sf J}}   
  \newcommand{\sK}{{\sf K}}   
  \newcommand{\sL}{{\sf L}}     
  \newcommand{\sM}{{\sf M}}   
  \newcommand{\sN}{{\sf N}}   
  \newcommand{\sO}{{\sf O}}   
  \newcommand{\sP}{{\sf P}}       
  \newcommand{\sQ}{{\sf Q}}   
  \newcommand{\sR}{{\sf R}}   
  \newcommand{\sS}{{\sf S}}     
  \newcommand{\sT}{{\sf T}}   
  \newcommand{\sU}{{\sf U}}   
  \newcommand{\sV}{{\sf V}}   
  \newcommand{\sW}{{\sf W}}     
  \newcommand{\sX}{{\sf X}}   
  \newcommand{\sY}{{\sf Y}}   
  \newcommand{\sZ}{{\sf Z}}     
  
  \newcommand{\Aut}{\mathrm{Aut}}
  
  
  
  \renewcommand{\aa}{{\sf a}}   
  \newcommand{\bb}{{\sf b}}   
  \newcommand{\cc}{{\sf c}}   
  \newcommand{\dd}{{\sf d}}     
  \newcommand{\ee}{{\sf e}}   
    \newcommand{\E}{{\mathbb{e}}}   
  \newcommand{\fff}{{\sf f}}   
  %\renewcommand{\gg}{{\sf g}}   
  \newcommand{\hh}{{\sf h}}     
  \newcommand{\ii}{{\sf Ii}}   
  \newcommand{\jj}{{\sf j}}   
  \newcommand{\kk}{{\sf k}}   
   
  \newcommand{\mm}{{\sf m}}   
  \newcommand{\nn}{{\sf n}}   
  \newcommand{\oo}{{\sf o}}   
  \newcommand{\pp}{{\sf p}}       
  \newcommand{\qq}{{\sf q}}   
  \newcommand{\rr}{{\sf r}}  
    \newcommand{\RR}{{\mathbb{R}}}    
  \renewcommand{\ss}{{\sf s}}     
  \renewcommand{\tt}{{\sf t}}   
  \newcommand{\uu}{{\sf u}}   
  \newcommand{\vv}{{\sf v}}   
  \newcommand{\ww}{{\sf w}}     
  \newcommand{\xx}{{\sf x}}   
  \newcommand{\yy}{{\sf y}}   
  \newcommand{\zz}{{\sf z}}   
  
    \newcommand{\bfa}{{\textbf{a}}} 
  \newcommand{\bfb}{{\textbf{b}}} 
    \newcommand{\bfc}{{\textbf{c}}} 
    \newcommand{\bfp}{{\textbf{p}}}
   
  \newcommand{\gothic}{\mathfrak}
  \newcommand{\go}{{\gothic o}}
%%
 \newcommand{\calA}{\mathcal{A}}
  \newcommand{\calB}{\mathcal{B}}
  \newcommand{\calC}{\mathcal{C}}
  \newcommand{\calD}{\mathcal{D}}
  \newcommand{\calE}{\mathcal{E}}
  \newcommand{\calF}{\mathcal{F}}
  \newcommand{\calG}{\mathcal{G}}
  \newcommand{\calH}{\mathcal{H}}
  \newcommand{\calI}{\mathcal{I}}
  \newcommand{\calJ}{\mathcal{J}}
  \newcommand{\calK}{\mathcal{K}}
  \newcommand{\calL}{\mathcal{L}}
  \newcommand{\calM}{\mathcal{M}}
  \newcommand{\calN}{\mathcal{N}}
  \newcommand{\calO}{\mathcal{O}}
  \newcommand{\calP}{\mathcal{P}}
  \newcommand{\calQ}{\mathcal{Q}}
  \newcommand{\calR}{\mathcal{R}}
  \newcommand{\calS}{\mathcal{S}}
  \newcommand{\calT}{\mathcal{T}}
  \newcommand{\calU}{\mathcal{U}}
    \newcommand{\calV}{\mathcal{V}}
  \newcommand{\calW}{\mathcal{W}}
  \newcommand{\calX}{\mathcal{X}}
    \newcommand{\calY}{\mathcal{Y}}
  \newcommand{\calZ}{\mathcal{Z}}
      \newcommand{\oV}{\overline{\mathcal{V}}}
            \newcommand{\oW}{\overline{\mathcal{W}}}
  \newcommand{\ZZ}{\mathbb Z}
  \newcommand{\Dual}{\calD}
  \newcommand{\BS}{\mathcal{BS}}
  
    \newcommand{\move}{\mathrm{Move}}

  
  \newcommand{\CAT}{\mathrm{CAT}(0)} 
    \newcommand{\Ext}{\mathrm{Ext}} 
  
    \newcommand{\MCG}{\mathcal{MCG}}
      \newcommand{\Teich}{\mathrm{Teich}}
  
  
  \newcommand{\Sp}{\mathrm{Sp}}
    \newcommand{\hT}{\widehat{T}}
    \newcommand{\hx}{\hat{x}}
     \newcommand{\ha}{\hat{a}}
     \newcommand{\bT}{\mathbb{T}}
     
         \newcommand{\hmed}{\hat{\mathfrak{m}}}
     
      \newcommand{\hb}{\hat{b}}
          \newcommand{\hc}{\hat{c}}
       \newcommand{\hz}{\hat{z}}
    \newcommand{\hy}{\hat{y}}
    \newcommand{\hd}{\hat{\delta}}
    \newcommand{\hl}{\hat{l}}
        \newcommand{\hv}{\hat{v}}
    \newcommand{\hw}{\hat{w}}
    \newcommand{\hlam}{\hat{\lambda}}
    \newcommand{\om}{\omega}
    \newcommand{\hO}{\widehat{\Omega}}
    \newcommand{\ho}{\hat{\omega}}
    \newcommand{\hpsi}{\hat{\psi}}
    \newcommand{\hPsi}{\widehat{\Psi}}
        \newcommand{\hPhi}{\widehat{\Phi}}
    \newcommand{\hf}{\hat{f}}
    \newcommand{\hY}{\widehat{\mathcal Y}}
    \newcommand{\BM}{\calB_{\min}}
    \newcommand{\Orth}{\mathrm{orth}}
    \renewcommand{\hh}{\mathbf{h}}
    \newcommand{\PP}{\mathbf{P}}
    \newcommand{\hpi}{\widehat{\pi}}
    \newcommand{\Dust}{\mathrm{Dust}}
    \newcommand{\bp}{\mathfrak{p}}
    
    \newcommand{\bF}{\mathbb{F}}
    \newcommand{\bE}{\mathbb{E}}
    
    
       \newcommand{\oZ}{\overline{\mathcal Z}}
    \newcommand{\oQ}{\overline{\mathcal Q}}
    \newcommand{\oY}{\overline{\mathcal Y}}
    
    \newcommand{\ES}{E_{\mathfrak S}}
    
    
    
    
    \newcommand{\Rel}{\mathrm{Rel}}
  
  \newcommand{\dist}{\mathbf{d}}
  
  
\newcommand{\bma}{\bm{\alpha}} 
\newcommand{\bmb}{\bm{\beta}} 
\newcommand{\ou}{\pm}

\newcommand{\diam}{\mathrm{diam}}
\newcommand{\hull}{\mathrm{hull}}
\newcommand{\med}{\mathfrak{m}}
\newcommand{\gate}{\mathfrak{g}}
\newcommand{\Neb}{\mathcal{N}}
\newcommand{\ret}{\mathrm{ret}}
\newcommand{\Real}{\mathrm{Real}}
\newcommand{\supp}{\mathrm{supp}}
\newcommand{\vis}{\mathrm{vis}}
\newcommand{\Shell}{\mathrm{Shell}}



\newcommand{\nest}{\sqsubset}


\newtheorem{thmi}{Theorem}
\newtheorem{cori}[thmi]{Corollary}
\newtheorem{probi}[thmi]{Problem}
\newtheorem{questioni}{Question}
\newtheorem{propi}[thmi]{Proposition}
\newtheorem{conji}[thmi]{Conjecture}

\renewcommand*{\thethmi}{\Alph{thmi}}
\renewcommand*{\thecori}{\Alph{thmi}}




















%%%%
%%%symbol
  \newcommand{\ST}{\mathbin{\Big|}} 
\newcommand{\pka}{\partial_{\kappa}} 
 %\newcommand{\param}{{\mathchoice{\mkern1mu\mbox{\raise2.2pt\hbox{$\centerdot$}}
%%%% TITLE
%%%%

\title[Bicombing MCG and Teich via stable cubical intervals]{Bicombing the mapping class group and Teichm\"uller space via stable cubical intervals}



 
 
 \author{Matthew Gentry Durham}
 \address{Department of Mathematics and Statistics, CUNY Hunter College, New York, NY }
 \email{matthew.durham@hunter.edu}
 

\newwrite\markfile
\immediate\openout\markfile=boxpositions_teichmuller.txt

\newcommand{\markbox}[2]{%
  \setbox0=\hbox{#2}%
  \immediate\write\markfile{#1:whd{}:\the\value{page}:\the\wd0:\the\ht0:\the\dp0}%
  \pdfsavepos
  \write\markfile{#1:start:\the\value{page}:\the\pdflastxpos:\the\pdflastypos}%
  #2% 
  \pdfsavepos
  \write\markfile{#1:end{}:\the\value{page}:\the\pdflastxpos:\the\pdflastypos}%
}

\begin{document}
\begin{abstract}
  In this mostly expository article, we provide a new account of our proof with Minsky and Sisto that mapping class groups and Teichm\"uller spaces admit bicombings.  More generally, we explain how the hierarchical hull of a pair of points in any colorable hierarchically hyperbolic space is quasi-isometric to a finite CAT(0) cube complex of bounded dimension, with the added property that perturbing the pair of points results in a uniformly bounded change to the cubical structure.  Our approach is simplified and new in many aspects.
  
\end{abstract}


\maketitle


\section{Introduction} \label{sec:intro}

The \markbox{0}{recent} \markbox{1}{infusion} \markbox{2}{of} \markbox{3}{techniques} \markbox{4}{from} \markbox{5}{cube} \markbox{6}{complexes} \markbox{7}{into} \markbox{8}{the} \markbox{9}{study} \markbox{10}{of} \markbox{11}{mapping} \markbox{12}{class} \markbox{13}{groups} \markbox{14}{of} finite-type \markbox{15}{surfaces} \markbox{16}{has} \markbox{17}{had} \markbox{18}{dramatic} consequences, \markbox{19}{including} \markbox{20}{toward} \markbox{21}{our} \markbox{22}{ability} \markbox{23}{to} \markbox{24}{control} top-dimensional quasi-isometrically \markbox{25}{embedded} \markbox{26}{flats} \cite{HHS_quasi}, \markbox{27}{build} \markbox{28}{bicombings} \cite{DMS_bary, HHP}, \markbox{29}{and} \markbox{30}{understand} \markbox{31}{their} \markbox{32}{geometry} \markbox{33}{at} \markbox{34}{infinity} \cite{DZ22, Ham_boundary, Dur_infcube}, \markbox{35}{among} \markbox{36}{others} \cite{ABD, Petyt_quasicube, DZ22, zalloum2025effective}.

The \markbox{37}{central} \markbox{38}{result} \markbox{39}{facilitating} \markbox{40}{most} \markbox{41}{of} \markbox{42}{the} \markbox{43}{above} \markbox{44}{work} \markbox{45}{was} \markbox{46}{the} \emph{cubical model theorem} \markbox{47}{of} Behrstock--Hagen--Sisto \cite{HHS_quasi}.  \markbox{48}{It} says, roughly, \markbox{49}{that} \markbox{50}{the} \markbox{51}{coarse} \markbox{52}{convex} \markbox{53}{hull} \markbox{54}{of} \markbox{55}{a} \markbox{56}{finite} \markbox{57}{set} \markbox{58}{of} \markbox{59}{points} \markbox{60}{in} \markbox{61}{the} \markbox{62}{mapping} \markbox{63}{class} \markbox{64}{group} \markbox{65}{is} quasi-isometrically \markbox{66}{approximated} \markbox{67}{by} \markbox{68}{a} CAT(0) \markbox{69}{cube} complex, \markbox{70}{which} \markbox{71}{is} \markbox{72}{a} \markbox{73}{higher} \markbox{74}{dimensional} \markbox{75}{analogue} \markbox{76}{of} Gromov's \markbox{77}{tree} \markbox{78}{approximation} \markbox{79}{theorem} \markbox{80}{for} \markbox{81}{hyperbolic} spaces.  \markbox{82}{The} \markbox{83}{cubical} \markbox{84}{model} \markbox{85}{theorem} \markbox{86}{was} \markbox{87}{later} \markbox{88}{generalized} \markbox{89}{by} \markbox{90}{Bowditch} \cite{Bowditch_hulls} (to \markbox{91}{certain} \markbox{92}{coarse} \markbox{93}{median} spaces) \markbox{94}{and} \markbox{95}{the} \markbox{96}{author} \cite{Dur_infcube} (to \markbox{97}{allow} \markbox{98}{for} \markbox{99}{points} \markbox{100}{at} infinity).  \markbox{101}{All} \markbox{102}{versions} \markbox{103}{hold} \markbox{104}{in} \markbox{105}{the} \markbox{106}{broader} \markbox{107}{context} \markbox{108}{of} \markbox{109}{hierarchically} \markbox{110}{hyperbolic} \markbox{111}{spaces} \cite{HHS_I}, \markbox{112}{a} \markbox{113}{framework} \markbox{114}{for} \markbox{115}{studying} \markbox{116}{a} \markbox{117}{wide} \markbox{118}{variety} \markbox{119}{of} \markbox{120}{spaces} \markbox{121}{with} \markbox{122}{blended} \markbox{123}{negative} \markbox{124}{and} \markbox{125}{positive} curvature, e.g. Teichm\"uller \markbox{126}{spaces} \cite{Brock, Rafi:hypteich, Dur:augmented}, \markbox{127}{that} \markbox{128}{built} \markbox{129}{off} \markbox{130}{the} \markbox{131}{seminal} \markbox{132}{work} \markbox{133}{of} Masur--Minsky \cite{MM99,MM00} \markbox{134}{on} \markbox{135}{the} \markbox{136}{mapping} \markbox{137}{class} group; \markbox{138}{see} \markbox{139}{Section} \ref{sec:HHS}. 

The \markbox{140}{cubical} \markbox{141}{approximation} \markbox{142}{theorem} \markbox{143}{allows} \markbox{144}{one} \markbox{145}{to} \markbox{146}{build} \markbox{147}{any} \markbox{148}{number} \markbox{149}{of} cubically-defined (and \markbox{150}{hierarchically} well-behaved) \markbox{151}{paths} \markbox{152}{between} \markbox{153}{a} \markbox{154}{pair} \markbox{155}{of} \markbox{156}{points} \markbox{157}{by} \markbox{158}{importing} \markbox{159}{them} \markbox{160}{from} \markbox{161}{the} \markbox{162}{cubical} \markbox{163}{model} \markbox{164}{of} \markbox{165}{their} hull.  \markbox{166}{This} \markbox{167}{observation} \markbox{168}{was} \markbox{169}{at} \markbox{170}{the} \markbox{171}{core} \markbox{172}{of} \markbox{173}{two} \markbox{174}{recent} \markbox{175}{proofs} \markbox{176}{that} \markbox{177}{the} \markbox{178}{mapping} \markbox{179}{class} \markbox{180}{group} \markbox{181}{is} \emph{bicombable}\footnote{Roughly, a bicombing on a metric space is a transitive family of quasi-geodesic paths that are stable under small perturbations of the endpoints; see Definition \ref{defn:bicombing}.}.  \markbox{182}{The} \markbox{183}{two} proofs, \markbox{184}{due} \markbox{185}{to} Haettel--Hoda--Petyt \cite{HHP} \markbox{186}{and} Minsky, Sisto, \markbox{187}{and} \markbox{188}{the} \markbox{189}{author} \cite{DMS_bary}, \markbox{190}{are} \markbox{191}{very} \markbox{192}{different} \markbox{193}{but} \markbox{194}{both} \markbox{195}{depend} \markbox{196}{crucially} \markbox{197}{on} \markbox{198}{this} \markbox{199}{cubical} \markbox{200}{model} machinery.  \markbox{201}{See} \markbox{202}{also} \markbox{203}{a} \markbox{204}{recent} \markbox{205}{elegant} \markbox{206}{proof} \markbox{207}{of} \markbox{208}{bicombability} \markbox{209}{using} \markbox{210}{wallspace} \markbox{211}{techniques} \markbox{212}{due} \markbox{213}{to} Petyt--Zalloum \cite{PZ_walls}.

The \markbox{214}{purpose} \markbox{215}{of} \markbox{216}{this} \markbox{217}{paper} \markbox{218}{is} \markbox{219}{to} \markbox{220}{explain} \markbox{221}{a} \markbox{222}{new} \markbox{223}{proof} \markbox{224}{of} \markbox{225}{the} two-point \markbox{226}{version} \markbox{227}{of} \markbox{228}{the} \markbox{229}{main} \markbox{230}{technical} \markbox{231}{result} \markbox{232}{of} \cite{DMS_bary} \markbox{233}{via} \markbox{234}{the} \markbox{235}{machinery} \markbox{236}{in} \cite{Dur_infcube}, \markbox{237}{which} \markbox{238}{we} \markbox{239}{state} \markbox{240}{here} \markbox{241}{informally} (see \markbox{242}{Theorem} \ref{thm:stable cubes}):

\begin{thmi}\label{thmi:main}
The \markbox{243}{hierarchical} \markbox{244}{hull} \markbox{245}{of} \markbox{246}{a} \markbox{247}{pair} \markbox{248}{of} \markbox{249}{points} \markbox{250}{in} \markbox{251}{a} \markbox{252}{colorable} \markbox{253}{HHS} \markbox{254}{can} \markbox{255}{be} \markbox{256}{stably} \markbox{257}{approximated} \markbox{258}{by} \markbox{259}{a} CAT(0) \markbox{260}{cube} complex.
\end{thmi}

With \markbox{261}{this} \markbox{262}{tool} \markbox{263}{in} hand, \markbox{264}{bicombability} \markbox{265}{is} \markbox{266}{a} straight-forward \markbox{267}{application} \markbox{268}{of} \markbox{269}{cubical} \markbox{270}{techniques} \markbox{271}{essentially} \markbox{272}{via} \markbox{273}{the} \markbox{274}{arguments} \markbox{275}{in}  \cite[Sections 5 \markbox{276}{and} 6]{DMS_bary}:

\begin{cori}\label{cori:semihyp}
Let \markbox{m277}{$S$} \markbox{278}{be} \markbox{279}{a} \markbox{280}{finite} \markbox{281}{type} surface.  \markbox{282}{Then} \markbox{283}{its} \markbox{284}{mapping} \markbox{285}{class} \markbox{286}{group} \markbox{287}{and} Teichm\"uller \markbox{288}{space} \markbox{289}{with} \markbox{290}{the} Teichm\"uller \markbox{291}{metric} \markbox{292}{admit} \markbox{293}{bicombings} \markbox{294}{by} \markbox{295}{hierarchy} paths.
\end{cori}


\begin{remark}
One \markbox{296}{can} \markbox{297}{upgrade} \markbox{298}{both} \markbox{299}{of} \markbox{300}{these} \markbox{301}{statements} \markbox{302}{to} \markbox{303}{ensure} \markbox{304}{coarse} \markbox{305}{equivariance} \markbox{306}{in} \markbox{307}{the} \markbox{308}{presence} \markbox{309}{of} \markbox{310}{an} \markbox{311}{appropriate} \markbox{312}{group} action.  \markbox{313}{In} particular, \markbox{314}{in} \cite{DMS_bary} \markbox{315}{we} \markbox{316}{showed} \markbox{317}{that} \markbox{318}{the} \markbox{319}{bicombings} \markbox{320}{in} \markbox{321}{Corollary} \ref{cori:semihyp} \markbox{322}{are} \markbox{323}{coarsely} \markbox{324}{equivariant} \markbox{325}{with} \markbox{326}{respect} \markbox{327}{to} \markbox{328}{the} \markbox{329}{mapping} \markbox{330}{class} \markbox{331}{group} action, \markbox{332}{and} \markbox{333}{that} \markbox{334}{the} \markbox{335}{mapping} \markbox{336}{class} \markbox{337}{group} \markbox{338}{is} \emph{semi-hyperbolic} \markbox{339}{in} \markbox{340}{the} \markbox{341}{sense} \markbox{342}{of} \cite{AB95}.  \markbox{343}{This} \markbox{344}{equivariance} \markbox{345}{upgrade} \markbox{346}{is} \markbox{347}{relatively} straight-forward \markbox{348}{once} \markbox{349}{one} \markbox{350}{has} \markbox{351}{the} bicombing, \markbox{352}{but} \markbox{353}{we} \markbox{354}{have} \markbox{355}{omitted} \markbox{356}{it} \markbox{357}{since} \markbox{358}{it} \markbox{359}{adds} \markbox{360}{yet} \markbox{361}{another} \markbox{362}{layer} \markbox{363}{complexity} \markbox{364}{to} \markbox{365}{the} \markbox{366}{statements} \markbox{367}{and} \markbox{368}{proofs} \markbox{369}{in} \markbox{370}{an} \markbox{371}{already} \markbox{372}{technical} construction.  \markbox{373}{We} \markbox{374}{point} \markbox{375}{the} \markbox{376}{reader} \markbox{377}{to} \cite[Remark 2]{DMS_bary} \markbox{378}{for} \markbox{379}{a} \markbox{380}{discussion} \markbox{381}{of} \markbox{382}{how} \markbox{383}{equivariance} \markbox{384}{works} \markbox{385}{for} \markbox{386}{this} construction. 
\end{remark}

% More generally, these results hold in the context of \emph{hierarchically hyperbolic spaces} (HHSes), a framework for studying a wide variety of spaces with blended negative and positive curvature that built off the seminal work of Masur--Minsky \cite{MM99,MM00} on the mapping class group; see Section \ref{sec:HHS}.  In the HHS setting, the guiding philosophy is to study objects by projecting to a family of hyperbolic spaces and then use techniques from hyperbolic geometry.  The cubical model theorem is utilized similarly---one exports problems from the mapping class group to a family cube complexes and employs cubical techniques.


We \markbox{387}{have} \markbox{388}{several} \markbox{389}{motivations} \markbox{390}{for} \markbox{391}{writing} \markbox{392}{this} paper.  First, \markbox{393}{we} \markbox{394}{wanted} \markbox{395}{to} \markbox{396}{give} \markbox{397}{a} \markbox{398}{simplified} \markbox{399}{account} \markbox{400}{of} \markbox{401}{the} \markbox{402}{cubical} \markbox{403}{model} \markbox{404}{results} \markbox{405}{in} \cite{DMS_bary, DMS_FJ} \markbox{406}{in} \markbox{407}{less} generality.  \markbox{408}{Roughly} speaking, \markbox{409}{the} \markbox{410}{cubical} \markbox{411}{model} \markbox{412}{for} \markbox{413}{a} \markbox{414}{finite} \markbox{415}{subset} \markbox{m416}{$F$} \markbox{417}{of} \markbox{418}{an} \markbox{419}{HHS} \markbox{420}{from} \cite{HHS_quasi} \markbox{421}{is} \markbox{422}{produced} \markbox{423}{from} \markbox{424}{a} \markbox{425}{wallspace} \markbox{426}{on} \markbox{427}{a} \markbox{428}{family} \markbox{429}{of} \markbox{430}{trees} \markbox{431}{obtained} \markbox{432}{by} \markbox{433}{projecting} \markbox{m434}{$F$} \markbox{435}{to} \markbox{436}{each} \markbox{437}{of} \markbox{438}{the} \markbox{439}{hyperbolic} \markbox{440}{spaces} \markbox{441}{in} \markbox{442}{the} hierarchy.  \markbox{443}{The} \markbox{444}{proof} \markbox{445}{of} \markbox{446}{bicombability} \markbox{447}{in} \cite{DMS_bary} \markbox{448}{proceeds} \markbox{449}{by} \markbox{450}{using} \markbox{451}{hyperbolic} \markbox{452}{geometry} techniques---culminating \markbox{453}{in} \markbox{454}{the} \markbox{455}{Stable} \markbox{456}{Tree} \markbox{457}{Theorem} \cite[Theorem 3.2]{DMS_bary}---to \markbox{458}{produce} \markbox{459}{a} \markbox{460}{family} \markbox{461}{of} \markbox{462}{trees} \markbox{463}{which} \markbox{464}{is} \markbox{465}{coarsely} \markbox{466}{stable} \markbox{467}{under} \markbox{468}{bounded} \markbox{469}{perturbations} \markbox{470}{of} \markbox{m471}{$F$}.  \markbox{472}{In} \markbox{473}{this} paper, \markbox{474}{we} \markbox{475}{simplify} \markbox{476}{a} \markbox{477}{number} \markbox{478}{of} \markbox{479}{aspects} \markbox{480}{of} \markbox{481}{this} \markbox{482}{initial} \markbox{483}{portion} \markbox{484}{of} \markbox{485}{the} \markbox{486}{argument} \markbox{487}{by} \markbox{488}{limiting} \markbox{489}{ourselves} \markbox{490}{to} \markbox{491}{modeling} \markbox{492}{only} \markbox{493}{a} \markbox{494}{pair} \markbox{495}{of} \markbox{496}{points} \markbox{497}{instead} \markbox{498}{of} \markbox{499}{arbitrary} \markbox{500}{collections} \markbox{501}{of} \markbox{502}{points} \markbox{503}{and} rays.

The \markbox{504}{second} \markbox{505}{motivation} \markbox{506}{is} \markbox{507}{to} \markbox{508}{explain} \markbox{509}{how} \markbox{510}{to} \markbox{511}{combine} \markbox{512}{the} \markbox{513}{stability} \markbox{514}{techniques} \markbox{515}{from} \cite{DMS_bary} \markbox{516}{with} \markbox{517}{the} \markbox{518}{new} \markbox{519}{cubical} \markbox{520}{model} \markbox{521}{construction} \markbox{522}{from} \cite{Dur_infcube}\footnote{This construction has many extra benefits as compared to the construction from \cite{HHS_quasi}.  We point interested readers to the in-depth discussion in the introduction of \cite{Dur_infcube}.}.  \markbox{523}{This} \markbox{524}{involves} \markbox{525}{a} new, \markbox{526}{more} \markbox{527}{elementary} \markbox{528}{proof} \markbox{529}{of} \markbox{530}{the} \markbox{531}{key} \markbox{532}{Stable} \markbox{533}{Trees} \markbox{534}{Theorem} \markbox{535}{for} intervals; \markbox{536}{see} \markbox{537}{Section} \ref{sec:stable intervals} below.  Notably, \markbox{538}{with} \markbox{539}{Minsky} \markbox{540}{and} Sisto, \markbox{541}{we} \markbox{542}{recently} \cite{DMS_FJ} \markbox{543}{implemented} \markbox{544}{a} \markbox{545}{significant} \markbox{546}{expansion} \markbox{547}{of} \markbox{548}{the} \markbox{549}{techniques} \markbox{550}{from} \cite{DMS_bary} \markbox{551}{utilizing} \markbox{552}{the} \markbox{553}{framework} \markbox{554}{of} \cite{Dur_infcube}\footnote{The first version of this expository article appeared before \cite{DMS_FJ}, but we have subsequently adapted it to account for that paper.}.  \markbox{555}{This} \markbox{556}{allowed} \markbox{557}{us} \markbox{558}{to} \markbox{559}{build} \markbox{560}{an} \markbox{561}{asymptotically} CAT(0) \markbox{562}{metric} \cite{Kar_asymp} \markbox{563}{on} \markbox{564}{any} \markbox{565}{colorable} HHS, \markbox{566}{construct} \markbox{567}{a} \markbox{m568}{$\calZ$}-boundary (in \markbox{569}{the} \markbox{570}{sense} \markbox{571}{of} \cite{bestvina1996local, Dra:BM_formula}) \markbox{572}{for} \markbox{573}{any} \markbox{574}{colorable} \markbox{575}{HHG} (see \markbox{576}{also} \cite{hamenstadt2025z} \markbox{577}{for} \markbox{578}{mapping} \markbox{579}{class} groups), \markbox{580}{and} \markbox{581}{establish} \markbox{582}{the} Farrell--Jones \markbox{583}{Conjecture} \cite{farrell1993isomorphism} \markbox{584}{for} \markbox{585}{many} HHGs, \markbox{586}{including} extra-large \markbox{587}{type} \markbox{588}{Artin} groups.  \markbox{589}{This} \markbox{590}{paper} \markbox{591}{can} \markbox{592}{be} \markbox{593}{seen} \markbox{594}{as} \markbox{595}{explaining} \markbox{596}{the} \markbox{597}{simplest} \markbox{598}{possible} \markbox{599}{case} \markbox{600}{of} \markbox{601}{the} \markbox{602}{main} \markbox{603}{technical} \markbox{604}{construction} \markbox{605}{in} \cite{DMS_FJ}.

Unsurprisingly, \markbox{606}{combining} \markbox{607}{the} \markbox{608}{work} \markbox{609}{in} \cite{DMS_bary} \markbox{610}{and} \cite{Dur_infcube} \markbox{611}{involves} \markbox{612}{an} \markbox{613}{exposition} \markbox{614}{of} both, \markbox{615}{though} \markbox{616}{we} \markbox{617}{have} \markbox{618}{mostly} \markbox{619}{focused} \markbox{620}{on} \markbox{621}{where} \markbox{622}{they} meet.  \markbox{623}{We} \markbox{624}{summarize} \markbox{625}{the} \markbox{626}{main} \markbox{627}{features} \markbox{628}{of} \markbox{629}{this} (mostly) \markbox{630}{expository} \markbox{631}{paper} \markbox{632}{as} follows:

\begin{itemize}
\item We \markbox{633}{give} \markbox{634}{an} \markbox{635}{exposition} \markbox{636}{of} \markbox{637}{the} \markbox{638}{basic} \markbox{639}{cubical} \markbox{640}{model} \markbox{641}{construction} \markbox{642}{from} \cite{Dur_infcube}, \markbox{643}{which} \markbox{644}{is} \markbox{645}{significantly} \markbox{646}{simplified} \markbox{647}{from} \markbox{648}{the} \markbox{649}{much} \markbox{650}{more} \markbox{651}{general} \markbox{652}{setting} \markbox{653}{considered} therein, (i.e., \markbox{654}{which} \markbox{655}{allows} \markbox{656}{for} \markbox{657}{modeling} \markbox{658}{points} \markbox{659}{at} infinity).

\item We \markbox{660}{explain} \markbox{661}{how} \markbox{662}{to} \markbox{663}{combine} \markbox{664}{the} \markbox{665}{stability} \markbox{666}{techniques} \markbox{667}{from} \cite{DMS_bary} \markbox{668}{with} \markbox{669}{the} \markbox{670}{cubical} \markbox{671}{model} \markbox{672}{construction} \markbox{673}{of} \cite{Dur_infcube}.  \markbox{674}{In} particular, \markbox{675}{this} \markbox{676}{involves} \markbox{677}{defining} \markbox{678}{a} \markbox{679}{refined} \markbox{680}{notion} \markbox{681}{of} \markbox{682}{a} \emph{stable decomposition} (Definition \ref{defn:stable decomp}), \markbox{683}{and} \markbox{684}{giving} \markbox{685}{a} \markbox{686}{new} \markbox{687}{proof} \markbox{688}{of} \markbox{689}{the} \markbox{690}{Stable} \markbox{691}{Trees} \markbox{692}{Theorem} \ref{thm:stable intervals} \markbox{693}{for} intervals.  \markbox{694}{We} \markbox{695}{note} \markbox{696}{that} \markbox{697}{these} \markbox{698}{stable} \markbox{699}{decompositions} \markbox{700}{also} \markbox{701}{appear} \markbox{702}{in} \cite{DMS_FJ}.

\item Using \markbox{703}{the} above, \markbox{704}{we} \markbox{705}{prove} \markbox{706}{bicombability} \markbox{707}{of} \markbox{708}{mapping} \markbox{709}{class} \markbox{710}{groups} (and HHSes) \markbox{711}{via} \markbox{712}{the} \markbox{713}{stable} \markbox{714}{cubulation} \markbox{715}{techniques} \markbox{716}{from} \cite{DMS_bary}, \markbox{717}{while} \markbox{718}{restricting} \markbox{719}{ourselves} \markbox{720}{to} \markbox{721}{the} \markbox{722}{simplified} \markbox{723}{setting} \markbox{724}{of} \markbox{725}{cubical} \markbox{726}{models} \markbox{727}{for} \markbox{728}{pairs} \markbox{729}{of} points.  Notably, \markbox{730}{the} \markbox{731}{bicombing} \markbox{732}{construction} \markbox{733}{from} \cite{HHP} \markbox{734}{also} \markbox{735}{depends} \markbox{736}{on} \markbox{737}{the} \markbox{738}{cubical} \markbox{739}{models} (from \cite{HHS_quasi}), \markbox{740}{so} \markbox{741}{one} \markbox{742}{can} \markbox{743}{also} \markbox{744}{see} \markbox{745}{this} \markbox{746}{paper} \markbox{747}{as} \markbox{748}{supplying} \markbox{749}{an} \markbox{750}{exposition} \markbox{751}{for} \markbox{752}{some} \markbox{753}{of} \markbox{754}{the} \markbox{755}{underlying} \markbox{756}{technology} \markbox{757}{of} \markbox{758}{their} construction.

\item By \markbox{759}{focusing} \markbox{760}{on} \markbox{761}{the} \markbox{762}{bicombing} \markbox{763}{result} (Corollary \ref{cori:semihyp}), \markbox{764}{we} \markbox{765}{are} \markbox{766}{able} \markbox{767}{significantly} \markbox{768}{simplifly} \markbox{769}{the} \markbox{770}{endgame} \markbox{771}{of} \markbox{772}{the} \markbox{773}{path} construction.  \markbox{774}{In} particular, \markbox{775}{we} \markbox{776}{utilize} Niblo--Reeves \markbox{777}{paths} \cite{NibloReeves} \markbox{778}{in} \markbox{779}{the} \markbox{780}{cubical} \markbox{781}{model} \markbox{782}{instead} \markbox{783}{of} \markbox{784}{the} \markbox{785}{more} \markbox{786}{elaborate} \markbox{787}{version} \markbox{788}{of} Niblo--Reeves \markbox{789}{contractions} \markbox{790}{from} \markbox{791}{our} \markbox{792}{work} \markbox{793}{with} \markbox{794}{Minsky} \markbox{795}{and} \markbox{796}{Sisto} \cite[Section 5]{DMS_bary}.
\end{itemize}

\subsection{Background reading}

Our \markbox{797}{main} \markbox{798}{focus} \markbox{799}{in} \markbox{800}{this} \markbox{801}{article} \markbox{802}{is} \markbox{803}{explaining} \markbox{804}{how} \markbox{805}{to} \markbox{806}{adapt} \markbox{807}{the} \markbox{808}{stable} \markbox{809}{cubulation} \markbox{810}{techniques} \markbox{811}{from} \cite{DMS_bary} \markbox{812}{to} \markbox{813}{the}  \markbox{814}{cubical} \markbox{815}{model} \markbox{816}{setup} \markbox{817}{from} \cite{Dur_infcube}, \markbox{818}{which} \markbox{819}{we} \markbox{820}{note} \markbox{821}{is} \markbox{822}{done} \markbox{823}{in} \markbox{824}{much} \markbox{825}{more} \markbox{826}{general} \markbox{827}{setting} \markbox{828}{in} \cite{DMS_FJ}.  \markbox{829}{As} such, \markbox{830}{the} \markbox{831}{reader} \markbox{832}{will} \markbox{833}{benefit} \markbox{834}{from} \markbox{835}{a} \markbox{836}{variety} \markbox{837}{of} \markbox{838}{contextual} \markbox{839}{information} \markbox{840}{and} \markbox{841}{motivation} \markbox{842}{in} \markbox{843}{and} \markbox{844}{around} \markbox{845}{cube} \markbox{846}{complexes} \markbox{847}{and} HHSes.  \markbox{848}{We} \markbox{849}{provide} \markbox{850}{some} \markbox{851}{suggested} \markbox{852}{reading} \markbox{853}{in} \markbox{854}{the} \markbox{855}{list} below:
\begin{itemize}
	\item  See Sisto's \markbox{856}{notes} \cite{Sisto_HHS} \markbox{857}{and} \markbox{858}{the} \markbox{859}{background} \markbox{860}{in} Casals-Ruiz--Hagen--Kazachkov \cite{CRHK} \markbox{861}{for} \markbox{862}{an} \markbox{863}{introduction} \markbox{864}{to} HHSes.  \markbox{865}{While} \markbox{866}{we} \markbox{867}{do} \markbox{868}{give} \markbox{869}{a} \markbox{870}{proof} \markbox{871}{of} \markbox{872}{the} \markbox{873}{harder} \markbox{874}{bound} \markbox{875}{of} \markbox{876}{the} \markbox{877}{Distance} \markbox{878}{Formula} \markbox{879}{in} \markbox{880}{Corollary} \ref{cor:DF lower bound}, \markbox{881}{we} \markbox{882}{expect} \markbox{883}{the} \markbox{884}{reader} \markbox{885}{to} \markbox{886}{be} \markbox{887}{familiar} \markbox{888}{with} \markbox{889}{the} \markbox{890}{general} framework.
	\item  See Farb--Margalit \cite{FM_primer} \markbox{891}{for} \markbox{892}{an} \markbox{893}{introduction} \markbox{894}{to} \markbox{895}{mapping} \markbox{896}{class} groups, \markbox{897}{and} \cite[Section 11]{HHS_II} \markbox{898}{and} \markbox{899}{there} \markbox{900}{references} \markbox{901}{therein} (particular, Masur--Minsky's \markbox{902}{work} \cite{MM99, MM00}) \markbox{903}{for} \markbox{904}{its} \markbox{905}{hierarchically} \markbox{906}{hyperbolic} structure.  Similarly, \markbox{907}{see} \markbox{908}{Rafi} \cite{Rafi:combo, Rafi:hypteich} \markbox{909}{and} \markbox{910}{the} \markbox{911}{author} \cite{Dur:augmented} \markbox{912}{for} \markbox{913}{the} \markbox{914}{hierarchical} \markbox{915}{structure} \markbox{916}{on} Teichm\"uller \markbox{917}{space} \markbox{918}{with} \markbox{919}{the} Teichm\"uller metric.
	\item For \markbox{920}{an} \markbox{921}{introduction} \markbox{922}{to} \markbox{923}{bicombings} \markbox{924}{and} semihyperbolicity, \markbox{925}{see} Alonso--Bridson \cite{AB95}.
	\item For \markbox{926}{background} \markbox{927}{on} \markbox{928}{cube} complexes, \markbox{929}{see} Sageev's \markbox{930}{notes} \cite{Sageev:pcmi} \markbox{931}{and} Schwer's \markbox{932}{book} \cite{schwer2324cat}.
	\item  For \markbox{933}{a} \markbox{934}{discussion} \markbox{935}{of} \markbox{936}{cubical} \markbox{937}{techniques} \markbox{938}{in} \markbox{939}{HHSes} \markbox{940}{and} \markbox{941}{related} objects, \markbox{942}{see} Zalloum's \markbox{943}{expository} article\cite{Zalloum_expo}.  
\end{itemize}

\subsection{Structure of the paper}

The \markbox{944}{paper} \markbox{945}{begins} \markbox{946}{with} \markbox{947}{a} high-level \markbox{948}{discussion} \markbox{949}{of} \markbox{950}{the} \markbox{951}{endgame} \markbox{952}{for} \markbox{953}{the} \markbox{954}{bicombing} \markbox{955}{construction} \markbox{956}{using} \markbox{957}{cubical} \markbox{958}{approximation} techniques.  \markbox{959}{In} particular, \markbox{960}{in} \markbox{961}{Section} \ref{sec:endgame}, \markbox{962}{we} \markbox{963}{will} \markbox{964}{extract} \markbox{965}{the} \markbox{966}{key} \markbox{967}{facts} \markbox{968}{that} \markbox{969}{we} \markbox{970}{prove} \markbox{971}{about} \markbox{972}{colorable} \markbox{973}{hierarchically} \markbox{974}{hyperbolic} spaces, \markbox{975}{namely} \markbox{976}{the} \markbox{977}{Stable} \markbox{978}{Cubes} \markbox{979}{Theorem} \ref{thm:stable cubes} \markbox{980}{and} \markbox{981}{Stable} \markbox{982}{Moves} \markbox{983}{Theorem} \ref{thm:stable moves}, \markbox{984}{to} \markbox{985}{build} \markbox{986}{a} \markbox{987}{bicombing} \markbox{988}{on} \markbox{989}{any} \markbox{990}{metric} \markbox{991}{space} \markbox{992}{possessing} \markbox{993}{the} \markbox{994}{properties} \markbox{995}{described} \markbox{996}{in} \markbox{997}{the} former.  \markbox{998}{This} \markbox{999}{includes} \markbox{1000}{the} \markbox{1001}{much} \markbox{1002}{simplified} \markbox{1003}{construction} \markbox{1004}{of} \markbox{1005}{the} \markbox{1006}{bicombing} \markbox{1007}{paths} \markbox{1008}{themselves} \markbox{1009}{via} Niblo--Reeves \markbox{1010}{paths} \markbox{1011}{in} \markbox{1012}{Subsection} \ref{sec:NR stability}.

With \markbox{1013}{this} \markbox{1014}{setup} \markbox{1015}{as} motivation, \markbox{1016}{we} \markbox{1017}{then} \markbox{1018}{proceed} \markbox{1019}{to} \markbox{1020}{describe} \markbox{1021}{the} \markbox{1022}{cubical} \markbox{1023}{model} \markbox{1024}{construction} \markbox{1025}{for} HHSes.  \markbox{1026}{Sections} \ref{sec:interval systems} \markbox{1027}{through} \ref{sec:cubulation} \markbox{1028}{explain} \markbox{1029}{the} \markbox{1030}{interval} \markbox{1031}{version} \markbox{1032}{of} \markbox{1033}{the} \markbox{1034}{cubical} \markbox{1035}{model} \markbox{1036}{theorem} \markbox{1037}{from} \cite{Dur_infcube}.  \markbox{1038}{The} \markbox{1039}{heart} \markbox{1040}{of} \markbox{1041}{the} \markbox{1042}{paper} \markbox{1043}{is} \markbox{1044}{in} \markbox{1045}{Sections} \ref{sec:controlling domains} \markbox{1046}{and} \ref{sec:stable intervals}, \markbox{1047}{where} \markbox{1048}{we} \markbox{1049}{explain} \markbox{1050}{how} \markbox{1051}{to} \markbox{1052}{build} \markbox{1053}{the} \markbox{1054}{stabilized} \markbox{1055}{family} \markbox{1056}{of} \markbox{1057}{intervals} \markbox{1058}{which} \markbox{1059}{serve} \markbox{1060}{as} input, \markbox{1061}{as} \markbox{1062}{well} \markbox{1063}{as} \markbox{1064}{in} \markbox{1065}{Section} \ref{sec:stable cubes}, \markbox{1066}{where} \markbox{1067}{we} \markbox{1068}{see} \markbox{1069}{how} \markbox{1070}{to} \markbox{1071}{plug} \markbox{1072}{this} \markbox{1073}{stabilized} \markbox{1074}{input} \markbox{1075}{into} \markbox{1076}{the} \markbox{1077}{cubulation} machine.
 
\subsection{Acknowledgements}

This \markbox{1078}{work} \markbox{1079}{was} \markbox{1080}{supported} \markbox{1081}{in} \markbox{1082}{part} \markbox{1083}{by} \markbox{1084}{NSF} \markbox{1085}{grant} DMS-1906487 \markbox{1086}{and} \markbox{1087}{NSF} \markbox{1088}{CAREER} DMS-2441982.  \markbox{1089}{The} \markbox{1090}{main} \markbox{1091}{thanks} \markbox{1092}{go} \markbox{1093}{to} \markbox{1094}{Yair} \markbox{1095}{Minsky} \markbox{1096}{and} \markbox{1097}{Alessandro} Sisto, \markbox{1098}{as} \markbox{1099}{our} \markbox{1100}{papers} \cite{DMS_bary, DMS_FJ} \markbox{1101}{are} \markbox{1102}{at} \markbox{1103}{the} \markbox{1104}{center} \markbox{1105}{of} \markbox{1106}{this} article.  \markbox{1107}{Thanks} \markbox{1108}{to} \markbox{1109}{Thomas} \markbox{1110}{Koberda} \markbox{1111}{for} \markbox{1112}{his} \markbox{1113}{efforts} \markbox{1114}{in} \markbox{1115}{coorganizing} \markbox{1116}{the} \markbox{1117}{first} \markbox{1118}{Riverside} \markbox{1119}{Workshop} \markbox{1120}{on} \markbox{1121}{Geometric} \markbox{1122}{Group} Theory\footnote{\url{https://sites.google.com/view/riggthew-2023/home}} \markbox{1123}{in} 2023 (and \markbox{1124}{its} \markbox{1125}{subsequent} versions), \markbox{1126}{which} \markbox{1127}{was} \markbox{1128}{supported} \markbox{1129}{by} \markbox{1130}{NSF} \markbox{1131}{grant} DMS-2234299.  \markbox{1132}{Thanks} \markbox{1133}{also} \markbox{1134}{to} \markbox{1135}{Harry} \markbox{1136}{Petyt} \markbox{1137}{for} \markbox{1138}{giving} \markbox{1139}{many} \markbox{1140}{detailed} \markbox{1141}{comments} \markbox{1142}{which} \markbox{1143}{greatly} \markbox{1144}{improved} \markbox{1145}{the} paper.  \markbox{1146}{This} \markbox{1147}{paper} \markbox{1148}{was} \markbox{1149}{written} \markbox{1150}{for} \markbox{1151}{the} \markbox{1152}{conference} \markbox{1153}{proceedings} \markbox{1154}{and} \markbox{1155}{I} \markbox{1156}{appreciated} Thomas' \markbox{1157}{patience} \markbox{1158}{and} \markbox{1159}{encouragement} \markbox{1160}{while} \markbox{1161}{completing} it.  \markbox{1162}{Thanks} \markbox{1163}{also} \markbox{1164}{to} \markbox{1165}{the} \markbox{1166}{other} speakers---Anne Lonjou, \markbox{1167}{Marissa} \markbox{1168}{Kawehi} Loving, \markbox{1169}{and} Jean-Pierre Mutanguha---for \markbox{1170}{their} \markbox{1171}{outstanding} minicourses.  Finally, \markbox{1172}{thanks} \markbox{1173}{to} \markbox{1174}{the} \markbox{1175}{attendees} \markbox{1176}{of} RivGGT23 \markbox{1177}{where} \markbox{1178}{my} \markbox{1179}{minicourse} \markbox{1180}{covered} \markbox{1181}{some} \markbox{1182}{of} \markbox{1183}{the} \markbox{1184}{material} \markbox{1185}{in} \markbox{1186}{this} paper, \markbox{1187}{and} \markbox{1188}{the} \markbox{1189}{UCR} \markbox{1190}{graduate} \markbox{1191}{students} \markbox{1192}{who} \markbox{1193}{attended} \markbox{1194}{my} \markbox{1195}{topics} \markbox{1196}{course} \markbox{1197}{on} \markbox{1198}{the} \markbox{1199}{construction} \markbox{1200}{in} \cite{Dur_infcube}.




\section{Beginning at the end} \label{sec:endgame}

The \markbox{1201}{purpose} \markbox{1202}{of} \markbox{1203}{this} \markbox{1204}{section} \markbox{1205}{is} \markbox{1206}{to} \markbox{1207}{prove} \markbox{1208}{the} \markbox{1209}{main} \markbox{1210}{consequence} \markbox{1211}{of} \markbox{1212}{the} \markbox{1213}{technical} \markbox{1214}{results} \markbox{1215}{we} \markbox{1216}{will} \markbox{1217}{spend} \markbox{1218}{the} \markbox{1219}{rest} \markbox{1220}{of} \markbox{1221}{the} \markbox{1222}{paper} establishing.  \markbox{1223}{That} is, \markbox{1224}{we} \markbox{1225}{will} \markbox{1226}{begin} \markbox{1227}{by} \markbox{1228}{explaining} \markbox{1229}{how} \markbox{1230}{the} \markbox{1231}{Stable} \markbox{1232}{Cubical} \markbox{1233}{Intervals} \markbox{1234}{Theorem} \ref{thmi:main}  (Theorem \ref{thm:stable cubes}) \markbox{1235}{is} \markbox{1236}{enough} \markbox{1237}{to} \markbox{1238}{prove} \markbox{1239}{bicombability} \markbox{1240}{of} \markbox{1241}{the} \markbox{1242}{mapping} \markbox{1243}{class} \markbox{1244}{groups} \markbox{1245}{and} \markbox{1246}{colorably} \markbox{1247}{hierarchically} \markbox{1248}{hyperbolic} spaces, \markbox{1249}{more} generally.

We \markbox{1250}{begin} \markbox{1251}{with} \markbox{1252}{a} \markbox{1253}{brief} \markbox{1254}{primer} \markbox{1255}{on} CAT(0) \markbox{1256}{cube} \markbox{1257}{complexes} \markbox{1258}{and} \markbox{1259}{a} \markbox{1260}{discussion} \markbox{1261}{of} Niblo--Reeves \markbox{1262}{paths} \markbox{1263}{and} \markbox{1264}{their} \markbox{1265}{stability} \markbox{1266}{under} \markbox{1267}{hyperplane} deletions.  \markbox{1268}{In} \markbox{1269}{Subsection} \ref{subsec:stable cubes, early}, \markbox{1270}{we} \markbox{1271}{give} \markbox{1272}{a} \markbox{1273}{precise} \markbox{1274}{version} \markbox{1275}{of} \markbox{1276}{our} \markbox{1277}{stable} \markbox{1278}{cubulations} \markbox{1279}{result} \markbox{1280}{along} \markbox{1281}{with} \markbox{1282}{its} \markbox{1283}{associated} path-building construction.  \markbox{1284}{In} \markbox{1285}{Subsection} \ref{subsec:semihyp}, \markbox{1286}{we} \markbox{1287}{then} \markbox{1288}{define} \markbox{1289}{and} \markbox{1290}{discuss} bicombings.  \markbox{1291}{In} \markbox{1292}{Subsection} \ref{subsec:building bicombing}, \markbox{1293}{we} \markbox{1294}{explain} \markbox{1295}{how} \markbox{1296}{to} \markbox{1297}{put} \markbox{1298}{these} \markbox{1299}{parts} \markbox{1300}{together} \markbox{1301}{to} \markbox{1302}{give} \markbox{1303}{a} \markbox{1304}{bicombing} \markbox{1305}{for} \markbox{1306}{any} \markbox{1307}{metric} \markbox{1308}{space} \markbox{1309}{satisfying} \markbox{1310}{some} \markbox{1311}{version} \markbox{1312}{of} \markbox{1313}{our} \markbox{1314}{stable} \markbox{1315}{cubulations} setup.

\subsection{Wall spaces, cube complexes, and hyperplane deletions}\label{subsec:CCC background}


%@@@@Adapt to median setup

This \markbox{1316}{subsection} \markbox{1317}{includes} \markbox{1318}{a} \markbox{1319}{quick} \markbox{1320}{set} \markbox{1321}{of} \markbox{1322}{definitions} \markbox{1323}{and} \markbox{1324}{references} \markbox{1325}{for} \markbox{1326}{readers} \markbox{1327}{unfamiliar} \markbox{1328}{with} CAT(0) \markbox{1329}{cube} complexes.

Our \markbox{1330}{approach} \markbox{1331}{here} \markbox{1332}{follows} \markbox{1333}{most} \markbox{1334}{closely} Roller's \markbox{1335}{approach} \cite{Roller} \markbox{1336}{to} Sageev's \markbox{1337}{cubulation} \markbox{1338}{machine} \cite{Sageev:cubulation}, \markbox{1339}{which} \markbox{1340}{uses} \markbox{1341}{the} \markbox{1342}{notion} \markbox{1343}{of} wall-space \markbox{1344}{as} \markbox{1345}{introduced} \markbox{1346}{by} Haglund-Paulin \cite{HP_wallspace}.  \markbox{1347}{See} Sageev's \markbox{1348}{notes} \cite{Sageev:pcmi}, \markbox{1349}{as} \markbox{1350}{well} \markbox{1351}{as} Hruska-Wise \cite{HW_CCC}, \markbox{1352}{for} \markbox{1353}{excellent} \markbox{1354}{expositions} \markbox{1355}{on} \markbox{1356}{this} subject.  \markbox{1357}{We} \markbox{1358}{note} \markbox{1359}{that} \markbox{1360}{we} \markbox{1361}{will} \markbox{1362}{later} \markbox{1363}{take} \markbox{1364}{an} \markbox{1365}{approach} \markbox{1366}{using} \markbox{1367}{medians} \markbox{1368}{in} \markbox{1369}{Section} \ref{sec:cubulation}.  

A \emph{cube complex} \markbox{1370}{is} \markbox{1371}{a} \markbox{1372}{CW} \markbox{1373}{complex} \markbox{1374}{obtained} \markbox{1375}{by} \markbox{1376}{gluing} \markbox{1377}{a} \markbox{1378}{collection} \markbox{1379}{of} \markbox{1380}{unit} \markbox{1381}{Euclidean} \markbox{1382}{cubes} \markbox{1383}{of} \markbox{1384}{various} \markbox{1385}{dimensions} \markbox{1386}{along} \markbox{1387}{their} \markbox{1388}{faces} \markbox{1389}{by} \markbox{1390}{a} \markbox{1391}{collection} \markbox{1392}{of} (Euclidean) isometries.  \markbox{1393}{A} \markbox{1394}{cube} \markbox{1395}{complex} \markbox{m1396}{$\Sigma$} \markbox{1397}{is} \emph{non-positively curved} \markbox{1398}{when} \markbox{1399}{it} \markbox{1400}{satisfies} Gromov's \markbox{1401}{link} condition, \markbox{1402}{and} \markbox{1403}{every} non-positively \markbox{1404}{curved} \markbox{1405}{simply} \markbox{1406}{connected} \markbox{1407}{cube} \markbox{1408}{complex} \markbox{1409}{admits} \markbox{1410}{a} \markbox{1411}{unique} CAT(0) metric.

A \emph{hyperplane} \markbox{1412}{in} \markbox{1413}{a} CAT(0) \markbox{1414}{cube} \markbox{1415}{complex} \markbox{m1416}{$\Sigma$} \markbox{1417}{is} \markbox{1418}{a} \markbox{1419}{connected} \markbox{1420}{subspace} \markbox{1421}{whose} \markbox{1422}{intersection} \markbox{1423}{with} \markbox{1424}{each} \markbox{1425}{cube} \markbox{m1426}{$\sigma = [0,1]^{n}$} \markbox{1427}{is} \markbox{1428}{either} \markbox{m1429}{$\emptyset$} \markbox{1430}{or} \markbox{1431}{the} \markbox{1432}{subspace} \markbox{1433}{obtained} \markbox{1434}{by} \markbox{1435}{restricting} \markbox{1436}{exactly} \markbox{1437}{one} \markbox{1438}{coordinate} \markbox{1439}{to} \markbox{m1440}{$\frac{1}{2}$}.  \markbox{1441}{In} particular, \markbox{1442}{every} \markbox{1443}{hyperplane} \markbox{1444}{partitions} \markbox{m1445}{$\Sigma$}.  \markbox{1446}{This} \markbox{1447}{motivates} \markbox{1448}{the} \markbox{1449}{definition} \markbox{1450}{of} \markbox{1451}{a} half-spaces \markbox{1452}{and} pocsets, \markbox{1453}{following} \markbox{1454}{Roller} \cite{Roller}.

\begin{definition}[Pocset]\label{defn:pocset}
Let \markbox{m1455}{$(\Sigma,<)$} \markbox{1456}{be} \markbox{1457}{a} partially-ordered set.  \markbox{1458}{A} \emph{pocset} \markbox{1459}{structure} \markbox{1460}{on} \markbox{m1461}{$\Sigma$} \markbox{1462}{has} \markbox{1463}{the} \markbox{1464}{additional} \markbox{1465}{structure} \markbox{1466}{of} \markbox{1467}{an} order-reversing \markbox{1468}{involution} \markbox{m1469}{$A \mapsto A^*$} satisfying
\begin{enumerate}
\item \markbox{m1470}{$A \neq A^*$} \markbox{1471}{and} \markbox{m1472}{$A, A^*$} \markbox{1473}{are} \markbox{m1474}{$<$}-incomparable;
\item \markbox{m1475}{$A < B \implies B^* < A^*$}.
\end{enumerate}
\begin{itemize}
\item Given \markbox{m1476}{$A<B$}, \markbox{1477}{the} \emph{interval} \markbox{1478}{between} \markbox{m1479}{$A$} \markbox{1480}{and} \markbox{m1481}{$B$} \markbox{1482}{is} \markbox{m1483}{$[A,B] = \{C|A<C<B\}$}.
\item The \markbox{1484}{pocset} \markbox{m1485}{$(\Sigma,<)$} \markbox{1486}{is} \emph{locally finite} \markbox{1487}{if} \markbox{1488}{every} \markbox{1489}{interval} \markbox{1490}{is} finite.
\item Given \markbox{m1491}{$A,B \in \Sigma$}, \markbox{1492}{we} \markbox{1493}{say} \markbox{m1494}{$A$} \markbox{1495}{is} \emph{transverse} \markbox{1496}{to} \markbox{m1497}{$B$} \markbox{1498}{if} \markbox{1499}{none} \markbox{1500}{of} \markbox{m1501}{$A<B, A<B^*, A^*<B, A^*<B^*$} holds.  \markbox{1502}{The} \markbox{1503}{pocset} \markbox{m1504}{$(\Sigma,<)$} \markbox{1505}{has} \emph{finite width} \markbox{1506}{if} \markbox{1507}{the} \markbox{1508}{maximal} \markbox{1509}{size} \markbox{1510}{of} \markbox{1511}{a} \markbox{1512}{pairwise} \markbox{1513}{transverse} \markbox{1514}{subset} \markbox{1515}{is} finite.

\end{itemize}
\end{definition}

In \markbox{1516}{a} CAT(0) \markbox{1517}{cube} complex, \markbox{1518}{every} \markbox{1519}{vertex} \markbox{1520}{is} \markbox{1521}{contained} \markbox{1522}{in} \markbox{1523}{exactly} \markbox{1524}{one} half-space \markbox{1525}{associated} \markbox{1526}{to} \markbox{1527}{each} hyperplane.  \markbox{1528}{The} \markbox{1529}{following} \markbox{1530}{notion} \markbox{1531}{abstracts} \markbox{1532}{the} \markbox{1533}{combinatorial} \markbox{1534}{structure} \markbox{1535}{of} \markbox{1536}{such} \markbox{1537}{a} \markbox{1538}{family} \markbox{1539}{of} half-spaces:

\begin{definition}[Ultrafilters \markbox{1540}{and} \markbox{1541}{the} DCC]\label{defn:ultrafilter}
Given \markbox{1542}{a} \markbox{1543}{locally} \markbox{1544}{finite} \markbox{1545}{pocset} \markbox{m1546}{$(\Sigma, <)$}, \markbox{1547}{an} \emph{ultrafilter} \markbox{m1548}{$\alpha$} \markbox{1549}{on} \markbox{m1550}{$\Sigma$} \markbox{1551}{is} \markbox{1552}{a} \markbox{1553}{subset} \markbox{1554}{of} \markbox{m1555}{$\Sigma$} satisfying
\begin{enumerate}
\item (Choice) \markbox{1556}{Exactly} \markbox{1557}{one} \markbox{1558}{element} \markbox{1559}{of} \markbox{1560}{each} \markbox{1561}{pair} \markbox{m1562}{$\{A,A^*\}$} \markbox{1563}{is} \markbox{1564}{an} \markbox{1565}{element} \markbox{1566}{of} \markbox{m1567}{$\alpha$};
\item (Consistency) \markbox{m1568}{$A \in \alpha$} \markbox{1569}{and} \markbox{m1570}{$A< B \implies B \in \alpha$}.
\end{enumerate}
\begin{itemize}
\item An \markbox{1571}{ultrafilter} \markbox{m1572}{$\alpha$} \markbox{1573}{satisfies} \markbox{1574}{the} \emph{descending chain condition} (DCC) \markbox{1575}{if} \markbox{1576}{every} \markbox{1577}{descending} \markbox{1578}{chain} \markbox{1579}{of} \markbox{1580}{elements} terminates.
\end{itemize}
\end{definition}

We \markbox{1581}{can} \markbox{1582}{now} \markbox{1583}{define} \markbox{1584}{the} \markbox{1585}{dual} \markbox{1586}{cube} \markbox{1587}{complex} \markbox{1588}{to} \markbox{1589}{a} \markbox{1590}{locally} finite, discrete, finite-width pocset:

\begin{definition}[Dual \markbox{1591}{cube} complex]\label{defn:dual CCC}
Given \markbox{1592}{a} \markbox{1593}{locally} finite, discrete, finite-width \markbox{1594}{pocset} \markbox{m1595}{$(\Sigma,<)$}, \markbox{1596}{we} \markbox{1597}{define} \markbox{1598}{a} \markbox{1599}{CW} \markbox{1600}{complex} \markbox{m1601}{$X(\Sigma)$} \markbox{1602}{as} follows:
\begin{enumerate}
\item The \markbox{m1603}{$0$}-cells \markbox{m1604}{$X^{(0)}$} \markbox{1605}{of} \markbox{m1606}{$X$} \markbox{1607}{are} \markbox{1608}{the} \markbox{1609}{DCC} \markbox{1610}{ultrafilters} \markbox{1611}{on} \markbox{m1612}{$(\Sigma, <)$}.
\item Two \markbox{m1613}{$0$}-cells \markbox{m1614}{$\alpha, \beta$} \markbox{1615}{are} \markbox{1616}{connected} \markbox{1617}{by} \markbox{1618}{an} \markbox{1619}{edge} \markbox{1620}{in} \markbox{m1621}{$X^{(1)}$} \markbox{1622}{if} \markbox{1623}{and} \markbox{1624}{only} \markbox{1625}{if} \markbox{m1626}{$|\alpha \triangle \beta| = 2$}, i.e. \markbox{m1627}{$\alpha = (\beta - \{A\}) \cup \{A^*\}$} \markbox{1628}{for} \markbox{1629}{some} \markbox{m1630}{$A \in \Sigma$}.
\item Define \markbox{m1631}{$X^{(n)}$} \markbox{1632}{inductively} \markbox{1633}{by} \markbox{1634}{adding} \markbox{1635}{an} \markbox{m1636}{$n$}-cube \markbox{1637}{whenever} \markbox{1638}{the} \markbox{1639}{boundary} \markbox{1640}{of} \markbox{1641}{one} \markbox{1642}{appears} \markbox{1643}{in} \markbox{1644}{the} \markbox{m1645}{$X^{(n-1)}$}-skeleton.
\end{enumerate}
\end{definition}


The \markbox{1646}{following} \markbox{1647}{is} \markbox{1648}{a} \markbox{1649}{theorem} \markbox{1650}{of} \markbox{1651}{Roller} \cite{Roller}, \markbox{1652}{building} \markbox{1653}{on} \markbox{1654}{Sageev} \cite{Sageev:cubulation}:

\begin{theorem}[Sageev's machine]\label{thm:Sageev}
Given \markbox{1655}{a} \markbox{1656}{locally} finite, finite-width \markbox{1657}{pocset} \markbox{m1658}{$(\Sigma,<)$}, \markbox{1659}{the} \markbox{1660}{CW} \markbox{1661}{complex} \markbox{m1662}{$X(\Sigma)$} \markbox{1663}{is} \markbox{1664}{a} \markbox{1665}{finite} \markbox{1666}{dimensional} CAT(0) \markbox{1667}{cube} complex, \markbox{1668}{where} \markbox{1669}{the} \markbox{1670}{dimension} \markbox{1671}{is} \markbox{1672}{equal} \markbox{1673}{to} \markbox{1674}{the} \markbox{1675}{width} \markbox{1676}{of} \markbox{m1677}{$(\Sigma, <)$}.
\begin{itemize}
\item We \markbox{1678}{call} \markbox{m1679}{$X(\Sigma)$} \markbox{1680}{the} \emph{dual cube complex} \markbox{1681}{to} \markbox{m1682}{$(\Sigma, <)$}.
\end{itemize}
\end{theorem}

We \markbox{1683}{note} \markbox{1684}{that} \markbox{1685}{the} \markbox{1686}{dual} \markbox{1687}{cube} \markbox{1688}{complex} \markbox{1689}{to} \markbox{1690}{the} \markbox{1691}{pocset} \markbox{1692}{coming} \markbox{1693}{from} \markbox{1694}{the} \markbox{1695}{hyperplanes} \markbox{1696}{of} \markbox{1697}{a} CAT(0) \markbox{1698}{cube} \markbox{1699}{complex} \markbox{1700}{is} (isomorphic to) \markbox{1701}{that} \markbox{1702}{cube} complex.

The \markbox{1703}{following} \markbox{1704}{lemma} \markbox{1705}{is} \markbox{1706}{useful} \markbox{1707}{for} \markbox{1708}{obtaining} \markbox{1709}{isomorphisms} \markbox{1710}{between} \markbox{1711}{cube} \markbox{1712}{complexes} \markbox{1713}{whose} wall-spaces \markbox{1714}{we} \markbox{1715}{can} \markbox{1716}{directly} compare.  \markbox{1717}{Its} \markbox{1718}{proof} \markbox{1719}{is} \markbox{1720}{an} \markbox{1721}{exercise} \markbox{1722}{in} \markbox{1723}{the} \markbox{1724}{basics} \markbox{1725}{of} CAT(0) \markbox{1726}{cube} \markbox{1727}{complexes} \markbox{1728}{which} \markbox{1729}{we} \markbox{1730}{leave} \markbox{1731}{to} \markbox{1732}{the} reader.

\begin{lemma}\label{lem:halfspaces_bijection}
 \markbox{1733}{Let} \markbox{m1734}{$\calW$}, \markbox{m1735}{$\calW'$} \markbox{1736}{be} wallspaces, \markbox{1737}{and} \markbox{1738}{let} \markbox{m1739}{$\iota:\calH_{\calW} \to \calH_{\calW'}$} \markbox{1740}{be} \markbox{1741}{a} \markbox{1742}{bijection} \markbox{1743}{of} \markbox{1744}{their} half-spaces, \markbox{1745}{which} preserves
 \markbox{1746}{complements} \markbox{1747}{and} disjointness.  \markbox{1748}{Then} \markbox{m1749}{$\iota$} \markbox{1750}{induces} \markbox{1751}{a} \markbox{1752}{cubical} isomorphism
\markbox{m1753}{$h:\calD(\calW)\to \calD(\calW')$}
between \markbox{1754}{the} \markbox{1755}{corresponding} \markbox{1756}{dual} CAT(0) \markbox{1757}{cube} complexes.
\end{lemma}

Finally, \markbox{1758}{in} \markbox{1759}{our} \markbox{1760}{stable} \markbox{1761}{cubulations} theorem, \markbox{1762}{we} \markbox{1763}{will} \markbox{1764}{want} \markbox{1765}{to} \markbox{1766}{realize} \markbox{1767}{maps} \markbox{1768}{between} \markbox{1769}{certain} \markbox{1770}{cube} \markbox{1771}{complexes} \markbox{1772}{as} \markbox{1773}{a} \markbox{1774}{sort} \markbox{1775}{of} \markbox{1776}{collapsing} \markbox{1777}{of} \markbox{1778}{a} \markbox{1779}{controlled} \markbox{1780}{piece} \markbox{1781}{of} \markbox{1782}{their} \markbox{1783}{combinatorial} data.  \markbox{1784}{The} \markbox{1785}{right} \markbox{1786}{notion} \markbox{1787}{here} \markbox{1788}{is} \markbox{1789}{of} \markbox{1790}{a} \emph{hyperplane deletion}.  \markbox{1791}{The} \markbox{1792}{motivating} \markbox{1793}{example} \markbox{1794}{is} \markbox{1795}{where} \markbox{1796}{one} \markbox{1797}{has} \markbox{1798}{a} wall-space \markbox{m1799}{$\calW(\calH)$} \markbox{1800}{on} \markbox{1801}{some} \markbox{1802}{set} \markbox{1803}{of} \markbox{1804}{walls} \markbox{m1805}{$\calH$}, \markbox{1806}{and} \markbox{1807}{one} \markbox{1808}{removes} \markbox{1809}{some} \markbox{1810}{collection} \markbox{1811}{of} \markbox{1812}{the} \markbox{1813}{walls} \markbox{m1814}{$\calH - \calG$}, \markbox{1815}{to} \markbox{1816}{obtain} \markbox{1817}{a} \emph{restriction map} \markbox{m1818}{$\calD(\calW(\calH)) \to \calD(\calW(\calH- \calG))$} \markbox{1819}{between} \markbox{1820}{their} \markbox{1821}{dual} \markbox{1822}{cube} \markbox{1823}{complexes} \markbox{1824}{in} \markbox{1825}{the} \markbox{1826}{sense} \markbox{1827}{of} \cite{CapraceSageev}.  \markbox{1828}{This} \markbox{1829}{map} \markbox{1830}{collapses} \markbox{1831}{the} \markbox{1832}{carriers} \markbox{1833}{of} \markbox{1834}{the} \markbox{1835}{hyperplanes} \markbox{1836}{in} \markbox{m1837}{$\calG$} (recall \markbox{1838}{that} \markbox{1839}{a} \markbox{1840}{carrier} \markbox{1841}{of} \markbox{1842}{a} \markbox{1843}{hyperplane} \markbox{m1844}{$\hh$} \markbox{1845}{is} \markbox{1846}{naturally} \markbox{1847}{isomorphic} \markbox{1848}{to} \markbox{m1849}{$\hh \times [0,1]$}).










\subsection{Stable cubes and stable moves}\label{subsec:stable cubes, early}

We \markbox{1850}{will} \markbox{1851}{prove} \markbox{1852}{Corollary} \ref{cori:semihyp} \markbox{1853}{in} \markbox{1854}{an} \markbox{1855}{ostensibly} \markbox{1856}{more} \markbox{1857}{general} \markbox{1858}{framework} \markbox{1859}{than} \markbox{1860}{that} \markbox{1861}{of} (colorable) HHSes\footnote{We actually suspect that coarse median spaces satisfying some version of the property in Definition \ref{defn:stable cubes} will be HHSes, though it is unclear to us what exactly the right property is, e.g. perhaps a factor system in the sense of \cite{HHS_I}.}.  \markbox{1862}{That} is, \markbox{1863}{we} \markbox{1864}{only} \markbox{1865}{need} \markbox{1866}{a} \markbox{1867}{metric} \markbox{1868}{space} \markbox{1869}{which} \markbox{1870}{satisfies} \markbox{1871}{the} \markbox{1872}{following} definitions.  \markbox{1873}{The} \markbox{1874}{first} \markbox{1875}{is} \markbox{1876}{effectively} \markbox{1877}{a} \markbox{1878}{weak} two-point \markbox{1879}{version} \markbox{1880}{of} \markbox{1881}{the} \markbox{1882}{cubical} \markbox{1883}{model} \markbox{1884}{property} \markbox{1885}{for} \markbox{1886}{HHSes} \markbox{1887}{from} \cite{HHS_quasi}, \markbox{1888}{proven} \markbox{1889}{in} \markbox{1890}{Theorem} \ref{thm:Q CCC} \markbox{1891}{in} \markbox{1892}{this} paper.

\begin{definition}[Weak \markbox{1893}{local} quasi-cubicality]\label{defn:lqc pair}

Let \markbox{m1894}{$X$} \markbox{1895}{be} \markbox{1896}{a} \markbox{1897}{metric} space.  \markbox{1898}{A} \markbox{m1899}{$B_0$}-\emph{cubical model} \markbox{1900}{for} \markbox{1901}{a} \markbox{1902}{pair} \markbox{m1903}{$a,b \in X$} \markbox{1904}{is} \markbox{1905}{a} CAT(0) \markbox{1906}{cube} \markbox{1907}{complex} \markbox{m1908}{$\calQ$} \markbox{1909}{of} \markbox{1910}{dimension} \markbox{1911}{at} \markbox{1912}{most} \markbox{m1913}{$B_0$} \markbox{1914}{satisfying} \markbox{1915}{the} following:
\begin{enumerate}
\item There \markbox{1916}{is} \markbox{1917}{a} \markbox{m1918}{$(B_0,B_0)$}-quasi-isometric \markbox{1919}{embedding} \markbox{m1920}{$\hO:\calQ \to X$} (the \emph{cubical model map}),
\item There \markbox{1921}{are} \markbox{1922}{two} \emph{distinguished vertices} \markbox{m1923}{$\ha,\hb \in \calQ$} \markbox{1924}{so} \markbox{1925}{that} \markbox{1926}{any} \markbox{m1927}{$\ell^{\infty}$}-geodesic \markbox{m1928}{$\gamma \subset \calQ$} \markbox{1929}{between} \markbox{m1930}{$\ha,\hb$} \markbox{1931}{is} \markbox{1932}{sent} \markbox{1933}{to} \markbox{1934}{a} \markbox{m1935}{$(B_0,B_0)$}-quasi-geodesic \markbox{m1936}{$\hO(\gamma) \subset X$} \markbox{1937}{between} \markbox{m1938}{$a,b$}.
\end{enumerate}
\begin{itemize}
\item We \markbox{1939}{say} \markbox{m1940}{$X$} \markbox{1941}{is} \markbox{m1942}{$B_0$}-\emph{weakly locally quasi-cubical} (wLQC) \markbox{1943}{if} \markbox{1944}{there} \markbox{1945}{exists} \markbox{m1946}{$B_0>0$} \markbox{1947}{so} \markbox{1948}{that} \markbox{1949}{any} \markbox{1950}{pair} \markbox{m1951}{$a,b\in X$} \markbox{1952}{admits} \markbox{1953}{a} \markbox{m1954}{$B_0$}-cubical model.
\end{itemize}
\end{definition}

 \markbox{1955}{While} CAT(0) \markbox{1956}{cube} \markbox{1957}{complexes} \markbox{1958}{have} \markbox{1959}{many} \markbox{1960}{standard} \markbox{1961}{metrics} (all \markbox{1962}{of} \markbox{1963}{which} \markbox{1964}{are} quasi-isometric), \markbox{1965}{the} \markbox{1966}{convenient} \markbox{1967}{one} \markbox{1968}{for} \markbox{1969}{us} \markbox{1970}{is} \markbox{1971}{the} \markbox{m1972}{$\ell^{\infty}$}-metric, which, \markbox{1973}{for} \markbox{1974}{vertices} \markbox{1975}{in} \markbox{1976}{a} \markbox{1977}{single} \markbox{1978}{unit} cube, \markbox{1979}{is} \markbox{1980}{just} \markbox{1981}{the} \markbox{m1982}{$\sup$}-metric. 

The \markbox{1983}{next} \markbox{1984}{definition} \markbox{1985}{is} \markbox{1986}{extracted} \markbox{1987}{from} \markbox{1988}{Theorem} \ref{thm:stable cubes} below.  \markbox{1989}{This} \markbox{1990}{property} \markbox{1991}{holds} \markbox{1992}{for} \markbox{1993}{colorable} \markbox{1994}{hierarchically} \markbox{1995}{hyperbolic} spaces, e.g., \markbox{1996}{the} \markbox{1997}{mapping} \markbox{1998}{class} \markbox{1999}{group} \markbox{2000}{and} Teichm\"uller space; \markbox{2001}{see} \cite[Theorem 4.1]{DMS_bary} \markbox{2002}{for} \markbox{2003}{the} original, \markbox{2004}{more} \markbox{2005}{general} version, \markbox{2006}{and} \cite[Theorem 9.1]{DMS_FJ} \markbox{2007}{for} \markbox{2008}{the} state-of-the-art.  \markbox{2009}{Part} \markbox{2010}{of} \markbox{2011}{our} \markbox{2012}{purpose} \markbox{2013}{here} \markbox{2014}{for} \markbox{2015}{extracting} \markbox{2016}{it} \markbox{2017}{from} \markbox{2018}{the} \markbox{2019}{HHS} \markbox{2020}{setting} \markbox{2021}{is} \markbox{2022}{to} \markbox{2023}{highlight} \markbox{2024}{the} \markbox{2025}{structure} \markbox{2026}{of} \markbox{2027}{the} endgame.


\begin{definition}[Stable \markbox{2028}{weak} \markbox{2029}{local} quasicubicality]\label{defn:stable cubes}
We \markbox{2030}{say} \markbox{2031}{that} \markbox{2032}{a} \markbox{2033}{metric} \markbox{2034}{space} \markbox{m2035}{$X$} \markbox{2036}{is} \emph{$B_0$-stably wLQC} \markbox{2037}{if} \markbox{2038}{there} \markbox{2039}{is} \markbox{2040}{a} \markbox{m2041}{$B_0$} \markbox{2042}{so} \markbox{2043}{that} \markbox{2044}{the} \markbox{2045}{following} holds:  

\begin{itemize}
\item For \markbox{2046}{any} \markbox{m2047}{$a,b, a',b' \in X$} \markbox{2048}{with} \markbox{m2049}{$d_X(a,a') \leq 1$} \markbox{2050}{and} \markbox{m2051}{$d_X(b,b')\leq 1$}, \markbox{2052}{there} \markbox{2053}{exist} \markbox{m2054}{$B_0$}-cubical \markbox{2055}{models} \markbox{m2056}{$\calQ, \calQ_0$} \markbox{2057}{and} \markbox{m2058}{$\calQ',\calQ'_0$} \markbox{2059}{for} \markbox{m2060}{$a,b$} \markbox{2061}{and} \markbox{m2062}{$a',b'$} \markbox{2063}{so} \markbox{2064}{that} \markbox{2065}{the} \markbox{2066}{following} \markbox{2067}{diagram} \markbox{2068}{commutes} \markbox{2069}{up} \markbox{2070}{to} \markbox{2071}{additive} \markbox{2072}{error} \markbox{m2073}{$B_0$}:
\begin{equation}\label{Phi diagram, early}
  \begin{tikzcd}
   \calQ \arrow[ddrr,"\hO", bend left=40] \arrow[dr,"\Delta_0 \hspace{.075in}" left] &  \\
    &\calQ_{0} \arrow[dr,"\hO_0 \hspace{.2in}" below]\arrow[dd, "I_0"] \\
    & & X\\
    & \calQ'_{0} \arrow[ur,"\hO'_0"] \\
    \calQ'\arrow[uurr,"\hspace{.2in} \vspace{.1in} \hO'" below, bend right=40] \arrow[ur,"\Delta'_0"] & \\
  \end{tikzcd}
  \end{equation}
 \item In \markbox{2074}{the} above,
  \begin{enumerate}
  \item  \markbox{m2075}{$\hO, \hO_0, \hO', \hO'_0$} \markbox{2076}{are} \markbox{2077}{cubical} \markbox{2078}{model} \markbox{2079}{maps} \markbox{2080}{and} \markbox{2081}{hence} \markbox{m2082}{$(B_0,B_0)$}-quasi-isometric embeddings,
  \item the \markbox{2083}{map} \markbox{m2084}{$I_0$} \markbox{2085}{is} \markbox{2086}{a} \markbox{2087}{cubical} isomorphism,
  \item the \markbox{2088}{maps} \markbox{m2089}{$\Delta_0, \Delta'_0$} \markbox{2090}{are} \markbox{2091}{induced} \markbox{2092}{by} \markbox{2093}{deleting} \markbox{2094}{at} \markbox{2095}{most} \markbox{m2096}{$B_0$}-many hyperplanes, and
  \item \markbox{m2097}{$\Delta_0, \Delta'_0$} \markbox{2098}{take} \markbox{2099}{the} \markbox{2100}{distinguished} \markbox{2101}{vertices} \markbox{2102}{associated} \markbox{2103}{to} \markbox{m2104}{$a,b$} \markbox{2105}{and} \markbox{m2106}{$a',b'$} \markbox{2107}{in} \markbox{m2108}{$\calQ,\calQ'$} \markbox{2109}{to} \markbox{2110}{those} \markbox{2111}{in} \markbox{m2112}{$\calQ_0,\calQ'_0$}, respectively.
  \end{enumerate}
  \end{itemize}
\end{definition}

Requirement (4) \markbox{2113}{says} \markbox{2114}{that} \markbox{2115}{the} \markbox{2116}{way} \markbox{2117}{that} \markbox{2118}{the} \markbox{2119}{cube} \markbox{2120}{complexes} \markbox{m2121}{$\calQ,\calQ_0$} \markbox{2122}{model} \markbox{m2123}{$a,b$} align, \markbox{2124}{and} \markbox{2125}{similarly} \markbox{2126}{for} \markbox{m2127}{$\calQ', \calQ'_0$} \markbox{2128}{and} \markbox{m2129}{$a',b'$}.  \markbox{2130}{Note} \markbox{2131}{that} \markbox{2132}{if} \markbox{m2133}{$X$} \markbox{2134}{satisfies} \markbox{2135}{Definition} \ref{defn:stable cubes} \markbox{2136}{then} \markbox{2137}{it} \markbox{2138}{satisfies} \markbox{2139}{Definition} \ref{defn:lqc pair}.  

\begin{remark}
Theorems \ref{thm:Q CCC} \markbox{2140}{and} \ref{thm:stable cubes} \markbox{2141}{actually} \markbox{2142}{provide} \markbox{2143}{a} \markbox{2144}{lot} \markbox{2145}{more} \markbox{2146}{information} \markbox{2147}{about} \markbox{2148}{these} \markbox{2149}{cubical} models.  \markbox{2150}{In} particular, \markbox{2151}{if} \markbox{m2152}{$\calX$} \markbox{2153}{is} \markbox{2154}{an} \markbox{2155}{HHS} \markbox{2156}{and} \markbox{m2157}{$a,b \in \calX$}, \markbox{2158}{then} \markbox{2159}{the} \markbox{2160}{cube} \markbox{2161}{complexes} \markbox{m2162}{$\calQ$} \markbox{2163}{and} \markbox{m2164}{$\calQ_0$} \markbox{2165}{above} \markbox{2166}{model} \markbox{2167}{the} \emph{hierarchical hull} \markbox{2168}{of} \markbox{m2169}{$a,b$} (Definition \ref{defn:hier hull}), \markbox{2170}{which} \markbox{2171}{is} \markbox{2172}{a} \markbox{2173}{coarsely} \markbox{2174}{convex} \markbox{2175}{subspace} \markbox{2176}{which} \markbox{2177}{encodes} \markbox{2178}{the} \markbox{2179}{hierarchical} \markbox{2180}{geometry} \markbox{2181}{between} \markbox{m2182}{$a,b$}.  Moreover, \markbox{2183}{the} \markbox{2184}{combinatorial} \markbox{2185}{geometry} \markbox{2186}{of} \markbox{2187}{the} \markbox{2188}{cube} \markbox{2189}{complex} \markbox{2190}{encodes} \markbox{2191}{essentially} \markbox{2192}{all} \markbox{2193}{of} \markbox{2194}{this} \markbox{2195}{hierarchical} data.  \markbox{2196}{See} \markbox{2197}{the} \markbox{2198}{introduction} \markbox{2199}{of} \cite{Dur_infcube} \markbox{2200}{for} \markbox{2201}{a} \markbox{2202}{detailed} discussion.
\end{remark}

\subsection{Stable moves}\label{sec:NR stability}

In \markbox{2203}{this} subsection, \markbox{2204}{we} \markbox{2205}{establish} \markbox{2206}{the} \markbox{2207}{key} path-building \markbox{2208}{portion} \markbox{2209}{of} \markbox{2210}{our} \markbox{2211}{bicombing} construction, \markbox{2212}{namely} \markbox{2213}{the} \markbox{2214}{Stable} \markbox{2215}{Moves} \markbox{2216}{Theorem} \ref{thm:stable moves}.  \markbox{2217}{This} \markbox{2218}{involves} \markbox{2219}{proving} \markbox{2220}{that} \markbox{2221}{a} well-studied \markbox{2222}{family} \markbox{2223}{of} \markbox{2224}{paths} \markbox{2225}{in} \markbox{2226}{a} \markbox{2227}{cube} \markbox{2228}{complex} \markbox{2229}{due} \markbox{2230}{to} Niblo--Reeves \cite{NibloReeves} \markbox{2231}{behaves} \markbox{2232}{well} \markbox{2233}{under} \markbox{2234}{hyperplane} deletion.  \markbox{2235}{These} \markbox{2236}{paths} \markbox{2237}{were} \markbox{2238}{at} \markbox{2239}{the} \markbox{2240}{center} \markbox{2241}{of} \markbox{2242}{their} \markbox{2243}{construction} \markbox{2244}{of} \markbox{2245}{a} \markbox{2246}{biautomatic} \markbox{2247}{structure} \markbox{2248}{on} \markbox{2249}{an} CAT(0) \markbox{2250}{cubical} group, \markbox{2251}{and} \markbox{2252}{so} \markbox{2253}{it} \markbox{2254}{is} \markbox{2255}{quite} \markbox{2256}{agreeable} \markbox{2257}{that} \markbox{2258}{they} \markbox{2259}{play} \markbox{2260}{a} \markbox{2261}{central} \markbox{2262}{role} \markbox{2263}{in} \markbox{2264}{our} \markbox{2265}{construction} \markbox{2266}{of} \markbox{2267}{a} \markbox{2268}{bicombing} \markbox{2269}{for} \markbox{2270}{our} \markbox{2271}{sort} \markbox{2272}{of} quasi-cubical spaces.  \markbox{2273}{While} \markbox{2274}{we} \markbox{2275}{have} \markbox{2276}{maintained} \markbox{2277}{some} \markbox{2278}{of} \markbox{2279}{the} \markbox{2280}{structure} \markbox{2281}{and} \markbox{2282}{terminology} \markbox{2283}{from} \markbox{2284}{our} \markbox{2285}{work} \markbox{2286}{with} \markbox{2287}{Minsky} \markbox{2288}{and} \markbox{2289}{Sisto} \markbox{2290}{in} \cite[Section 5]{DMS_bary}, \markbox{2291}{our} \markbox{2292}{limited} \markbox{2293}{setting} \markbox{2294}{allows} \markbox{2295}{for} \markbox{2296}{a} \markbox{2297}{much} \markbox{2298}{simpler} \markbox{2299}{path} construction.

Let \markbox{m2300}{$X$} \markbox{2301}{be} \markbox{2302}{a} \markbox{2303}{finite} CAT(0) \markbox{2304}{cube} \markbox{2305}{complex} \markbox{2306}{with} \markbox{m2307}{$X = \hull_X(a,b)$} \markbox{2308}{the} \markbox{2309}{cubical} hull\footnote{The  assumption that $X = \hull_X(a,b)$ is not necessary, but is convenient for our purposes.} \markbox{2310}{of} \markbox{m2311}{$a,b \in X^0$}.  \markbox{2312}{Set} \markbox{m2313}{$\calH = \calH(a,b)$} \markbox{2314}{to} \markbox{2315}{be} \markbox{2316}{the} \markbox{2317}{set} \markbox{2318}{of} \markbox{2319}{hyperplanes} \markbox{2320}{in} \markbox{m2321}{$X$} \markbox{2322}{separating} \markbox{m2323}{$a,b$}, \markbox{2324}{so} \markbox{2325}{that} \markbox{m2326}{$X = \calX(\calH)$} \markbox{2327}{is} \markbox{2328}{the} \markbox{2329}{dual} \markbox{2330}{cube} \markbox{2331}{complex} \markbox{2332}{to} \markbox{m2333}{$\calH$}.  \markbox{2334}{Recall} \markbox{2335}{that} \markbox{2336}{we} \markbox{2337}{can} \markbox{2338}{think} \markbox{2339}{of} \markbox{2340}{vertices} \markbox{2341}{of} \markbox{m2342}{$X$} \markbox{2343}{as} \markbox{2344}{coherent} \markbox{2345}{orientations} \markbox{2346}{on} \markbox{2347}{hyperplanes} \markbox{2348}{in} \markbox{m2349}{$\calH$}.

\begin{definition}
Let \markbox{m2350}{$p \in X^0$}.  \markbox{2351}{A} \markbox{2352}{hyperplane} \markbox{m2353}{$\hh \in \calH$} \markbox{2354}{is} \emph{transitional}, \markbox{2355}{denoted} \markbox{m2356}{$\hh \in T(p,\calH)$}, if
\begin{enumerate}
\item \markbox{m2357}{$\hh$} \markbox{2358}{separates} \markbox{m2359}{$p$} \markbox{2360}{from} \markbox{m2361}{$b$}, and
\item \markbox{m2362}{$p$} \markbox{2363}{is} \emph{adjacent} \markbox{2364}{to} \markbox{m2365}{$\hh$}, i.e. \markbox{m2366}{$\hh$} \markbox{2367}{crosses} \markbox{2368}{some} \markbox{2369}{cube} \markbox{2370}{of} \markbox{2371}{which} \markbox{m2372}{$p$} \markbox{2373}{is} \markbox{2374}{a} vertex.
\end{enumerate}
\end{definition}

We \markbox{2375}{note} \markbox{2376}{that} \markbox{2377}{there} \markbox{2378}{is} \markbox{2379}{a} \markbox{2380}{natural} \markbox{2381}{partial} \markbox{2382}{order} \markbox{m2383}{$\prec$} \markbox{2384}{on} \markbox{m2385}{$\calH$}, \markbox{2386}{where} \markbox{m2387}{$\hh \prec \hh'$} \markbox{2388}{when} \markbox{m2389}{$\hh$} \markbox{2390}{separates} \markbox{m2391}{$\hh'$} \markbox{2392}{from} \markbox{m2393}{$a$}, \markbox{2394}{or} \markbox{2395}{equivalently} \markbox{m2396}{$\hh'$} \markbox{2397}{separates} \markbox{m2398}{$\hh$} \markbox{2399}{from} \markbox{m2400}{$b$}.  \markbox{2401}{In} \markbox{2402}{our} \markbox{2403}{special} \markbox{2404}{setting} \markbox{2405}{with} \markbox{m2406}{$X = \hull_X(a,b)$}, \markbox{2407}{every} \markbox{2408}{vertex} \markbox{m2409}{$p \in X^0$} \markbox{2410}{occurs} \markbox{2411}{on} \markbox{2412}{some} \markbox{m2413}{$\ell^1$}-geodesic \markbox{2414}{from} \markbox{m2415}{$a$} \markbox{2416}{to} \markbox{m2417}{$b$}.  \markbox{2418}{The} \markbox{2419}{property} \markbox{2420}{of} \markbox{2421}{transitionality} \markbox{2422}{for} \markbox{m2423}{$\hh \in T(p,\calH)$} \markbox{2424}{is} \markbox{2425}{encoding} \markbox{2426}{that} \markbox{m2427}{$\hh$} \markbox{2428}{is} \markbox{2429}{minimal} \markbox{2430}{in} \markbox{2431}{the} \markbox{2432}{partial} \markbox{2433}{order} \markbox{2434}{on} \markbox{m2435}{$\calH(p,b) \subset \calH$}.

The \markbox{2436}{following} \markbox{2437}{lemma} \markbox{2438}{says} \markbox{2439}{that} \markbox{2440}{minimal} \markbox{2441}{elements} \markbox{2442}{in} \markbox{2443}{the} \markbox{2444}{partial} \markbox{2445}{order} \markbox{2446}{must} cross:

\begin{lemma}\label{lem:trans cross}
If \markbox{m2447}{$\hh_1,\hh_2 \in T(p,\calH)$}, \markbox{2448}{then} \markbox{m2449}{$\hh_1$} \markbox{2450}{crosses} \markbox{m2451}{$\hh_2$}.
\end{lemma}

\begin{proof}
If \markbox{m2452}{$\hh_1$} \markbox{2453}{and} \markbox{m2454}{$\hh_2$} \markbox{2455}{do} \markbox{2456}{not} cross, then, \markbox{2457}{without} \markbox{2458}{loss} \markbox{2459}{of} generality, \markbox{2460}{there} \markbox{2461}{is} \markbox{2462}{a} half-space \markbox{2463}{of} \markbox{m2464}{$\hh_2$} \markbox{2465}{containing} \markbox{m2466}{$a, \hh_1$}.  \markbox{2467}{On} \markbox{2468}{the} \markbox{2469}{other} hand, \markbox{m2470}{$p$} \markbox{2471}{is} \markbox{2472}{adjacent} \markbox{2473}{to} \markbox{m2474}{$\hh_2$}.  \markbox{2475}{This} \markbox{2476}{implies} \markbox{2477}{that} \markbox{m2478}{$p,a$} \markbox{2479}{are} \markbox{2480}{in} \markbox{2481}{different} half-spaces \markbox{2482}{of} \markbox{m2483}{$\hh_1$}, \markbox{2484}{which} \markbox{2485}{is} \markbox{2486}{a} contradiction.
\end{proof}

With \markbox{2487}{this} lemma, \markbox{2488}{we} \markbox{2489}{can} \markbox{2490}{define} \markbox{2491}{our} \emph{Niblo--Reeves} \markbox{2492}{paths} \markbox{m2493}{$p_0=a, p_1, \dots, p_n = b$} \markbox{2494}{as} \markbox{2495}{follows} \cite{NibloReeves}:

\begin{itemize}
\item Let \markbox{m2496}{$p_0 = a$}.
\item By \markbox{2497}{Lemma} \ref{lem:trans cross}, \markbox{m2498}{$p_0$} \markbox{2499}{is} \markbox{2500}{the} \markbox{2501}{corner} \markbox{2502}{of} \markbox{2503}{a} \markbox{2504}{unique} \markbox{2505}{cube} \markbox{m2506}{$C_0$} \markbox{2507}{for} \markbox{2508}{which} \markbox{2509}{the} \markbox{2510}{set} \markbox{2511}{of} \markbox{2512}{hyperplanes} \markbox{2513}{that} \markbox{2514}{cross} \markbox{m2515}{$C_0$} \markbox{2516}{is} \markbox{2517}{precisely} \markbox{m2518}{$T(p,\calH)$}.  \markbox{2519}{Set} \markbox{m2520}{$p_1$} \markbox{2521}{to} \markbox{2522}{be} \markbox{2523}{the} \markbox{2524}{diagonally} \markbox{2525}{opposite} \markbox{2526}{corner} \markbox{2527}{of} \markbox{m2528}{$C_0$}.  Equivalently, \markbox{m2529}{$p_1$} \markbox{2530}{is} \markbox{2531}{obtained} \markbox{2532}{from} \markbox{m2533}{$p_0$} \markbox{2534}{by} \markbox{2535}{flipping} \markbox{2536}{orientations} \markbox{2537}{on} \markbox{2538}{the} \markbox{2539}{hyperplanes} \markbox{2540}{in} \markbox{m2541}{$T(p,\calH)$}.
\item Define \markbox{m2542}{$p_i$} \markbox{2543}{for} \markbox{m2544}{$i \geq 1$} \markbox{2545}{recursively} \markbox{2546}{with} \markbox{m2547}{$p_i$} \markbox{2548}{in} \markbox{2549}{place} \markbox{2550}{of} \markbox{m2551}{$p_0$}.
\end{itemize}



Thus, \markbox{2552}{at} \markbox{2553}{each} \markbox{2554}{step} \markbox{m2555}{$p_i \mapsto p_{i+1}$}, \markbox{2556}{the} \markbox{2557}{path} \markbox{2558}{crosses} \markbox{2559}{the} \markbox{2560}{set} \markbox{2561}{of} \markbox{m2562}{$\prec$}-minimal \markbox{2563}{hyperplanes} \markbox{2564}{in} \markbox{m2565}{$\calH(p_i,b)$}.  \markbox{2566}{The} \markbox{2567}{following} \markbox{2568}{proposition} \markbox{2569}{states} \markbox{2570}{the} \markbox{2571}{basic} \markbox{2572}{properties} \markbox{2573}{of} \markbox{2574}{the} Niblo--Reeves paths:

\begin{proposition}\label{prop:NR basics}
Continuing \markbox{2575}{with} \markbox{2576}{the} \markbox{2577}{above} notation, \markbox{2578}{the} \markbox{2579}{following} hold:
\begin{enumerate}
\item There \markbox{2580}{exists} \markbox{2581}{some} \markbox{m2582}{$n$} \markbox{2583}{so} \markbox{2584}{that} \markbox{m2585}{$p_n=b$}.
\item For \markbox{2586}{all} \markbox{m2587}{$0 \leq i \leq n$}, \markbox{2588}{we} \markbox{2589}{have} \markbox{m2590}{$d^{\infty}_X(p_{i}, p_{i+1}) =1$}.
\item Any \markbox{2591}{path} \markbox{2592}{obtained} \markbox{2593}{by} \markbox{2594}{concatenating} \markbox{m2595}{$\ell^1$}-geodesics \markbox{2596}{between} \markbox{m2597}{$p_i, p_{i+1}$} \markbox{2598}{for} \markbox{m2599}{$0 \leq i < n$} \markbox{2600}{is} \markbox{2601}{an} \markbox{m2602}{$\ell^1$}-geodesic.
\end{enumerate}
\end{proposition}

\begin{proof}
For (1), \markbox{2603}{observe} \markbox{2604}{that} \markbox{2605}{the} \markbox{2606}{sequence} \markbox{m2607}{$p_i$} \markbox{2608}{only} \markbox{2609}{crosses} \markbox{2610}{hyperplanes} \markbox{2611}{separating} \markbox{m2612}{$a$} \markbox{2613}{from} \markbox{m2614}{$b$}.  \markbox{2615}{Each} \markbox{2616}{step} \markbox{m2617}{$p_i \mapsto p_{i+1}$} \markbox{2618}{of} \markbox{2619}{the} \markbox{2620}{sequence} \markbox{2621}{crosses} \markbox{2622}{the} \markbox{2623}{collection} \markbox{2624}{of} \markbox{m2625}{$\prec$}-minimal \markbox{2626}{hyperplanes} \markbox{2627}{in} \markbox{m2628}{$\calH(p_i, b)\subset \calH$}.  \markbox{2629}{Now} (1) \markbox{2630}{is} \markbox{2631}{equivalent} \markbox{2632}{to} \markbox{2633}{the} \markbox{2634}{claim} \markbox{2635}{that} \markbox{m2636}{$\calH = \bigcup_i \calH(p_i,b)$}, \markbox{2637}{which} \markbox{2638}{is} \markbox{2639}{to} \markbox{2640}{say} \markbox{2641}{that} \markbox{2642}{this} \markbox{2643}{process} \markbox{2644}{exhausts} \markbox{2645}{the} \markbox{2646}{set} \markbox{2647}{of} \markbox{2648}{hyperplanes} \markbox{2649}{separating} \markbox{m2650}{$a$} \markbox{2651}{and} \markbox{m2652}{$b$}, \markbox{2653}{which} \markbox{2654}{is} \markbox{2655}{clear} \markbox{2656}{because} \markbox{m2657}{$\calH$} \markbox{2658}{is} finite.

Item (2) \markbox{2659}{is} \markbox{2660}{by} construction, \markbox{2661}{since} \markbox{m2662}{$p_i$} \markbox{2663}{and} \markbox{m2664}{$p_{i+1}$} \markbox{2665}{are} \markbox{2666}{opposite} \markbox{2667}{corners} \markbox{2668}{of} \markbox{2669}{a} cube.

Finally, \markbox{2670}{item} (3) \markbox{2671}{follows} \markbox{2672}{from} \markbox{2673}{the} \markbox{2674}{fact} \markbox{2675}{that} \markbox{m2676}{$\calH(p_i, b) \subset \calH(p_{i+1},b)$} \markbox{2677}{with} \markbox{m2678}{$\calH(p_{i+1},b) - \calH(p_i, b) = \calH(p_i,p_{i+1})$}.  \markbox{2679}{Hence} \markbox{2680}{if} \markbox{m2681}{$\hh \in T(p_i,b)$}, \markbox{2682}{then} \markbox{m2683}{$\hh$} \markbox{2684}{does} \markbox{2685}{not} \markbox{2686}{separate} \markbox{m2687}{$p_i$} \markbox{2688}{from} \markbox{m2689}{$p_j$} \markbox{2690}{for} \markbox{m2691}{$j<i$}.  \markbox{2692}{This} \markbox{2693}{says} \markbox{2694}{that} \markbox{2695}{the} \markbox{2696}{sequence} \markbox{m2697}{$\{p_i\}$} \markbox{2698}{does} \markbox{2699}{not} \markbox{2700}{cross} \markbox{2701}{any} \markbox{2702}{hyperplane} twice, \markbox{2703}{and} \markbox{2704}{it} \markbox{2705}{follows} \markbox{2706}{that} \markbox{2707}{the} \markbox{2708}{concatenation} \markbox{2709}{of} \markbox{2710}{the} \markbox{m2711}{$\ell^1$}-geodesic \markbox{2712}{segments} \markbox{2713}{will} \markbox{2714}{not} either, \markbox{2715}{making} \markbox{2716}{it} \markbox{2717}{an} \markbox{m2718}{$\ell^1$}-geodesic.
\end{proof}

The \markbox{2719}{following} \markbox{2720}{is} \markbox{2721}{a} \markbox{2722}{useful} \markbox{2723}{observation} \markbox{2724}{about} \markbox{2725}{this} construction:

\begin{proposition}\label{prop:NR iso}
Let \markbox{m2726}{$\Phi:\calQ \to \calQ'$} \markbox{2727}{be} \markbox{2728}{an} \markbox{2729}{isomorphism} \markbox{2730}{of} \markbox{2731}{cube} complexes.  \markbox{2732}{If} \markbox{m2733}{$\gamma$} \markbox{2734}{is} \markbox{2735}{the} Niblo--Reeves \markbox{2736}{path} \markbox{2737}{between} \markbox{m2738}{$a,b \in \calQ^0$}, \markbox{2739}{then} \markbox{m2740}{$\Phi(\gamma)$} \markbox{2741}{is} \markbox{2742}{the} Niblo--Reeves \markbox{2743}{path} \markbox{2744}{between} \markbox{m2745}{$\Phi(a), \Phi(b) \in \left(\calQ'\right)^{0}$}.
\end{proposition}

We \markbox{2746}{can} \markbox{2747}{now} \markbox{2748}{state} \markbox{2749}{the} \markbox{2750}{main} \markbox{2751}{result} \markbox{2752}{of} \markbox{2753}{this} subsection.

\begin{theorem}[Stable moves]\label{thm:stable moves}
Suppose \markbox{2754}{that} \markbox{m2755}{$\hh \in \calH$} \markbox{2756}{is} hyperplane, \markbox{2757}{and} \markbox{2758}{let} \markbox{m2759}{$\Delta_{\hh}:\calD(\calH) \to \calD(\calH - \{\hh\})$} \markbox{2760}{denote} \markbox{2761}{the} \markbox{2762}{hyperplane} \markbox{2763}{collapse} map.  \markbox{2764}{Set} \markbox{m2765}{$\Delta_{\hh}(a) = a'$} \markbox{2766}{and} \markbox{m2767}{$\Delta_{\hh}(b) =b'$}.  \markbox{2768}{Let} \markbox{m2769}{$p_0,\dots,p_n$} \markbox{2770}{denote} \markbox{2771}{the} Niblo--Reeves \markbox{2772}{path} \markbox{2773}{in} \markbox{m2774}{$X = \calD(\calH)$}  \markbox{2775}{between} \markbox{m2776}{$a,b$} \markbox{2777}{and} \markbox{m2778}{$p'_0, \dots, p'_m$} \markbox{2779}{the} \markbox{2780}{path} \markbox{2781}{between} \markbox{m2782}{$a',b'$} \markbox{2783}{in} \markbox{m2784}{$\calD(\calH- \{\hh\})$}.  \markbox{2785}{Then} \markbox{2786}{the} \markbox{2787}{following} hold:
\begin{enumerate}
\item We \markbox{2788}{have} \markbox{m2789}{$n \leq m+1$}.
\item For \markbox{2790}{all} \markbox{m2791}{$1 \leq i \leq n$}, \markbox{2792}{we} \markbox{2793}{have} \markbox{m2794}{$d^{\infty}_{\calD(\calH - \{\hh\})}(\Delta_{\hh}(p_i), p'_i) \leq 1$}.
\end{enumerate}
\end{theorem}

In \markbox{2795}{other} words, Niblo--Reeves \markbox{2796}{paths} \markbox{2797}{are} \markbox{2798}{stable} \markbox{2799}{under} \markbox{2800}{hyperplane} \markbox{2801}{deletion} maps.

The \markbox{2802}{following} \markbox{2803}{notation} \markbox{2804}{will} \markbox{2805}{be} \markbox{2806}{useful} \markbox{2807}{for} us:

\begin{definition}
Let \markbox{m2808}{$\hh' \in \calH$}.  \markbox{2809}{We} \markbox{2810}{set} \markbox{m2811}{$t_{\hh'}(a, \calH)$}, \markbox{2812}{called} \markbox{2813}{the} \emph{transition index} \markbox{2814}{of} \markbox{m2815}{$\hh'$}, \markbox{2816}{to} \markbox{2817}{be} \markbox{2818}{the} \markbox{2819}{index} \markbox{m2820}{$i$} \markbox{2821}{at} \markbox{2822}{which} \markbox{m2823}{$\hh' \in \calH(p_i, p_{i+1})$}.  Similarly, \markbox{2824}{if} \markbox{m2825}{$\hh' \in \calH - \{\hh\}$}, \markbox{2826}{we} \markbox{2827}{define} \markbox{m2828}{$t_{\hh'}(a', \calH - \{\hh\})$} \markbox{2829}{to} \markbox{2830}{be} \markbox{2831}{the} \markbox{2832}{index} \markbox{m2833}{$i$} \markbox{2834}{so} \markbox{2835}{that} \markbox{m2836}{$\hh' \in \calH(p'_i, p'_{i+1})$}.
\end{definition} 

\begin{lemma}\label{lem:move control}
If \markbox{m2837}{$\hh' \in \calH - \{\hh\}$}, \markbox{2838}{then} \markbox{m2839}{$t_{\hh'}(a,\calH) = t_{\hh'}(a', \calH - \{\hh\}) + \delta$} \markbox{2840}{for} \markbox{m2841}{$\delta \in \{0,1\}$}.
\end{lemma}

\begin{proof}
This \markbox{2842}{is} \markbox{2843}{essentially} \cite[Lemma 5.12]{DMS_bary}, \markbox{2844}{though} \markbox{2845}{the} \markbox{2846}{proof} \markbox{2847}{is} \markbox{2848}{basically} \markbox{2849}{immediate} \markbox{2850}{in} \markbox{2851}{our} setting.  \markbox{2852}{Note} \markbox{2853}{that} \markbox{2854}{the} \markbox{2855}{transition} \markbox{2856}{index} \markbox{m2857}{$t_{\hh} = d_{\infty}(a, \hh) + \frac{1}{2}$}.  \markbox{2858}{Since} \markbox{2859}{the} \markbox{m2860}{$\ell^{\infty}$} \markbox{2861}{distance} \markbox{2862}{between} \markbox{m2863}{$a'$} \markbox{2864}{and} \markbox{m2865}{$\hh'$} \markbox{2866}{measures} \markbox{2867}{the} \markbox{2868}{maximal} \markbox{2869}{length} \markbox{2870}{of} \markbox{2871}{a} \markbox{2872}{chain} \markbox{2873}{of} \markbox{2874}{hyperplanes} \markbox{2875}{separating} \markbox{2876}{them} (plus \markbox{m2877}{$\frac{1}{2}$}), \markbox{2878}{that} \markbox{2879}{distance} \markbox{2880}{can} \markbox{2881}{be} \markbox{2882}{at} \markbox{2883}{most} \markbox{m2884}{$1$} \markbox{2885}{more} \markbox{2886}{than} \markbox{m2887}{$d_{\infty}(a,\hh)$}.  \markbox{2888}{This} \markbox{2889}{completes} \markbox{2890}{the} proof.
\end{proof}

\begin{proof}[Proof \markbox{2891}{of} \markbox{2892}{the} \markbox{2893}{Stable} \markbox{2894}{Moves} \markbox{2895}{Theorem} \ref{thm:stable moves}]
Suppose \markbox{m2896}{$\hh_1, \hh_2$} \markbox{2897}{separate} \markbox{m2898}{$\Delta_{\hh}(p_i)$} \markbox{2899}{and} \markbox{m2900}{$p'_i$} \markbox{2901}{in} \markbox{m2902}{$X' = \calD(\calH - \{\hh\})$} \markbox{2903}{but} \markbox{2904}{do} \markbox{2905}{not} cross, \markbox{2906}{since} \markbox{2907}{we} \markbox{2908}{are} \markbox{2909}{done} \markbox{2910}{if} \markbox{2911}{all} \markbox{2912}{such} \markbox{2913}{hyperplanes} cross.

Without \markbox{2914}{loss} \markbox{2915}{of} generality, \markbox{2916}{we} \markbox{2917}{may} \markbox{2918}{assume} \markbox{2919}{that} \markbox{m2920}{$\hh_1$} \markbox{2921}{separates} \markbox{m2922}{$\Delta_{\hh}(p_i)$} \markbox{2923}{from} \markbox{m2924}{$\hh_2$}.  \markbox{2925}{Let} \markbox{m2926}{$j = t_{\hh_1}(a',\calH - \{\hh\})$}.  \markbox{2927}{Then} \markbox{m2928}{$j < t_{\hh_2}(a',\calH - \{\hh\}) < i$}, \markbox{2929}{with} \markbox{2930}{the} \markbox{2931}{latter} \markbox{2932}{inequality} \markbox{2933}{following} \markbox{2934}{because} \markbox{m2935}{$p'_{i+1}$} \markbox{2936}{has} \markbox{2937}{already} \markbox{2938}{crossed} \markbox{m2939}{$\hh_2$} (and \markbox{m2940}{$\hh_1$}).  \markbox{2941}{Thus} \markbox{m2942}{$j + 1 < i$}.

But \markbox{2943}{then} \markbox{m2944}{$t_{\hh_1}(a, \calH) \leq t_{\hh_1}(a', \calH - \{\hh\}) + 1 = j+1 < i$}, \markbox{2945}{which} \markbox{2946}{says} \markbox{2947}{that} \markbox{m2948}{$\hh_1$} \markbox{2949}{separates} \markbox{m2950}{$p_i$} \markbox{2951}{from} \markbox{m2952}{$a$}, \markbox{2953}{which} \markbox{2954}{is} \markbox{2955}{a} contradiction.
\end{proof}


\subsection{Bicombings}\label{subsec:semihyp}

Our \markbox{2956}{ultimate} \markbox{2957}{goal} \markbox{2958}{is} \markbox{2959}{to} \markbox{2960}{prove} \markbox{2961}{that} \markbox{2962}{mapping} \markbox{2963}{class} \markbox{2964}{groups} \markbox{2965}{and} Teichm\"uller \markbox{2966}{spaces} \markbox{2967}{admits} \markbox{2968}{bicombings} (Theorem \ref{thmi:main}).  Roughly, \markbox{2969}{a} \markbox{2970}{bicombing} \markbox{2971}{on} \markbox{2972}{a} \markbox{2973}{space} \markbox{m2974}{$X$} \markbox{2975}{is} \markbox{2976}{a} \markbox{2977}{family} \markbox{2978}{of} \markbox{2979}{uniform} quasi-geodesic \markbox{2980}{paths} \markbox{2981}{that} \markbox{2982}{is} \markbox{2983}{transitive} (i.e., \markbox{2984}{connects} \markbox{2985}{any} \markbox{2986}{pair} \markbox{2987}{of} \markbox{2988}{points} \markbox{2989}{of} \markbox{m2990}{$X$}), \markbox{2991}{and} \markbox{2992}{for} \markbox{2993}{which} \markbox{2994}{paths} \markbox{2995}{in} \markbox{2996}{the} \markbox{2997}{family} \markbox{2998}{between} \markbox{2999}{pairs} \markbox{3000}{of} \markbox{3001}{endpoints} \markbox{3002}{that} \markbox{3003}{are} \markbox{3004}{close} \markbox{3005}{to} \markbox{3006}{each} \markbox{3007}{other} \markbox{3008}{uniformly} fellow-travel \markbox{3009}{in} \markbox{3010}{a} \markbox{3011}{parameterized} fashion.   \markbox{3012}{The} \markbox{3013}{notion} \markbox{3014}{of} \markbox{3015}{bicombing} \markbox{3016}{was} \markbox{3017}{first} \markbox{3018}{introduced} \markbox{3019}{by} \markbox{3020}{Thurston} \markbox{3021}{in} \markbox{3022}{the} \markbox{3023}{context} \markbox{3024}{of} \markbox{3025}{algorithmic} \markbox{3026}{problems} \markbox{3027}{in} groups.  \markbox{3028}{It} \markbox{3029}{is} \markbox{3030}{a} \markbox{3031}{straightforward} \markbox{3032}{but} \markbox{3033}{informative} \markbox{3034}{exercise} \markbox{3035}{to} \markbox{3036}{prove} \markbox{3037}{that} \markbox{3038}{geodesics} \markbox{3039}{in} \markbox{3040}{hyperbolic} \markbox{3041}{and} CAT(0) \markbox{3042}{spaces} \markbox{3043}{satisfy} \markbox{3044}{this} property, \markbox{3045}{and} \markbox{3046}{this} \markbox{3047}{is} \markbox{3048}{precisely} \markbox{3049}{what} \markbox{3050}{the} \markbox{3051}{definition} \markbox{3052}{is} \markbox{3053}{intended} \markbox{3054}{to} generalize.

\smallskip
The \markbox{3055}{following} \markbox{3056}{definition} \markbox{3057}{is} \markbox{3058}{essentially} \markbox{3059}{from} \cite{AB95}, \markbox{3060}{as} \markbox{3061}{restated} \markbox{3062}{in} \cite[Definition 6.4]{DMS_bary}:  

\begin{definition}[Bicombings]\label{defn:bicombing}
A \emph{discrete, bounded, quasi-geodesic bicombing} \markbox{3063}{of} \markbox{3064}{a} \markbox{3065}{metric} \markbox{3066}{space} \markbox{m3067}{$X$} \markbox{3068}{consists} \markbox{3069}{of} \markbox{3070}{a} \markbox{3071}{family} \markbox{3072}{of} \markbox{3073}{discrete} \markbox{3074}{paths} \markbox{m3075}{$\{\Gamma_{x,y}\}_{x,y \in X}$} \markbox{3076}{and} \markbox{3077}{a} \markbox{3078}{constant} \markbox{m3079}{$\zeta>0$} \markbox{3080}{satisfying} \markbox{3081}{the} following:
\begin{enumerate}
\item \emph{Quasi-geodesic}: \markbox{3082}{For} \markbox{3083}{any} \markbox{m3084}{$x,y \in X$} \markbox{3085}{with} \markbox{m3086}{$d = d_{X}(x,y)$}, \markbox{3087}{there} \markbox{3088}{exists} \markbox{m3089}{$n_{x,y} \leq d\zeta + \zeta$} \markbox{3090}{so} \markbox{3091}{that} \markbox{3092}{the} \markbox{3093}{path} \markbox{m3094}{$\Gamma_{x,y}:\{0, \dots, n_{x,y}\} \rightarrow X$} \markbox{3095}{is} \markbox{3096}{a} \markbox{m3097}{$(\zeta,\zeta)$}-quasi-isometric \markbox{3098}{embedding} \markbox{3099}{with} \markbox{m3100}{$\Gamma_{x,y}(0)=x$} \markbox{3101}{and} \markbox{m3102}{$\Gamma_{x,y}(n_{x,y}) = y$}; and
\item \emph{Fellow-traveling}: \markbox{3103}{If} \markbox{m3104}{$x',y' \in X$} \markbox{3105}{and} \markbox{m3106}{$d_X(x,x'), d_X(y,y') \leq 1$}, \markbox{3107}{then} \markbox{3108}{for} \markbox{3109}{all} \markbox{m3110}{$t \in \{0, \dots, \max\{n_{x,y}, n_{x',y'}\}\}$}, \markbox{3111}{we} have
$$d_X(\Gamma_{x,y}(t), \Gamma_{x',y'}(t)) \leq \zeta.$$
\end{enumerate}


For \markbox{3112}{our} purposes, \markbox{3113}{the} fellow-traveling \markbox{3114}{condition} \markbox{3115}{in} \markbox{3116}{item} (2) \markbox{3117}{is} \markbox{3118}{the} \markbox{3119}{key} challenge.  \markbox{3120}{At} \markbox{3121}{this} point, \markbox{3122}{there} \markbox{3123}{are} \markbox{3124}{many} \markbox{3125}{constructions} \markbox{3126}{of} \markbox{3127}{uniform} \markbox{3128}{quasigeodesics} \markbox{3129}{in} \markbox{3130}{mapping} \markbox{3131}{class} groups.


\end{definition}

\subsection{Building the bicombing}\label{subsec:building bicombing}

We \markbox{3132}{are} \markbox{3133}{now} \markbox{3134}{ready} \markbox{3135}{to} \markbox{3136}{define} \markbox{3137}{the} bicombing.  \markbox{3138}{Let} \markbox{m3139}{$X$} \markbox{3140}{be} \markbox{m3141}{$B_0$}-stably \markbox{3142}{wLQC} (Definition \ref{defn:stable cubes}).  \markbox{3143}{For} \markbox{3144}{any} \markbox{m3145}{$a,b \in X$}, \markbox{3146}{let} \markbox{m3147}{$\calQ$} \markbox{3148}{be} \markbox{3149}{a} CAT(0) \markbox{3150}{cube} \markbox{3151}{complex} \markbox{3152}{provided} \markbox{3153}{by} \markbox{3154}{Definition} \ref{defn:stable cubes} \markbox{3155}{and} \markbox{m3156}{$\ha,\hb\in \calQ$} \markbox{3157}{the} \markbox{3158}{distinguished} \markbox{3159}{vertices} \markbox{3160}{associated} \markbox{3161}{to} \markbox{m3162}{$a,b$}.

We \markbox{3163}{can} \markbox{3164}{define} \markbox{3165}{a} \markbox{3166}{family} \markbox{3167}{of} \markbox{3168}{paths} \markbox{m3169}{$\{\Gamma_{a,b}\}_{a,b \in X}$} \markbox{3170}{by} \markbox{3171}{taking} \markbox{m3172}{$\Gamma_{a,b}$} \markbox{3173}{to} \markbox{3174}{be} \markbox{3175}{the} \markbox{3176}{image} \markbox{3177}{under} \markbox{3178}{the} quasi-isometry \markbox{m3179}{$\hO:\calQ \to X$} \markbox{3180}{of} \markbox{3181}{the} Niblo--Reeves \markbox{3182}{path} \markbox{3183}{between} \markbox{m3184}{$\ha,\hb$}.  \markbox{3185}{By} \markbox{3186}{Definition} \ref{defn:lqc pair}, \markbox{3187}{this} \markbox{3188}{is} \markbox{3189}{a} \markbox{3190}{uniform} \markbox{m3191}{$(B_0,B_0)$}-quasi-geodesic \markbox{3192}{between} \markbox{m3193}{$a,b$}.

\begin{theorem}\label{thm:bicombing}
The \markbox{3194}{family} \markbox{3195}{of} \markbox{3196}{paths} \markbox{m3197}{$\{\Gamma_{a,b}\}_{a,b \in X}$} \markbox{3198}{forms} \markbox{3199}{a} \markbox{3200}{discrete} \markbox{3201}{bounded} quasi-geodesic \markbox{3202}{bicombing} \markbox{3203}{on} \markbox{m3204}{$X$}.
\end{theorem}

\begin{figure}
    \centering
    \includegraphics[width=.8\textwidth]{figures/bicombing_example.pdf}
    \caption{Stable Moves: A simple example of how Niblo--Reeves paths behave under hyperplane collapses.  In each cube complex, the red vertices correspond to $a,b$.  The orange hyperplanes are collapsed when passing to $\calQ_0 = \calQ'_0$.  The Niblo--Reeves path in $\calQ_0$ between $a,b$ travels in a straight line between the red vertices.  The Niblo--Reeves paths in $\calQ$ (blue) and $\calQ'$ (purple) descend to paths which are close to it the Niblo--Reeves path in $\calQ_0$, and hence close to each other.  This example is a modified version of \cite[Figure 25]{DMS_bary}.}
    \label{fig:bicoming_example}
\end{figure}


\begin{proof}
We \markbox{3205}{need} \markbox{3206}{to} \markbox{3207}{confirm} \markbox{3208}{the} \markbox{3209}{properties} \markbox{3210}{in} \markbox{3211}{Definition} \ref{defn:bicombing}.  \markbox{3212}{The} \markbox{3213}{paths} \markbox{3214}{are} \markbox{3215}{clearly} \markbox{3216}{discrete} \markbox{3217}{and} \markbox{3218}{are} \markbox{m3219}{$(B_0,B_0)$}-quasi-geodesics \markbox{3220}{by} assumption.  \markbox{3221}{So} \markbox{3222}{we} \markbox{3223}{need} \markbox{3224}{to} \markbox{3225}{show} \markbox{3226}{that} \markbox{3227}{they} \markbox{3228}{satisfy} \markbox{3229}{the} fellow-traveling \markbox{3230}{property} \markbox{3231}{in} \markbox{3232}{item} (2) \markbox{3233}{of} \markbox{3234}{that} definition.  \markbox{3235}{This} \markbox{3236}{is} \markbox{3237}{a} \markbox{3238}{direct} \markbox{3239}{application} \markbox{3240}{of} \markbox{3241}{the} \markbox{3242}{properties} \markbox{3243}{in} \markbox{3244}{Definition} \ref{defn:stable cubes} \markbox{3245}{and} \markbox{3246}{Theorem} \ref{thm:stable moves}.

Let \markbox{m3247}{$\ha,\hb \in \calQ$} \markbox{3248}{and} \markbox{m3249}{$\ha_0,\hb_0 \in \calQ_0$} \markbox{3250}{be} \markbox{3251}{the} \markbox{3252}{distinguished} \markbox{3253}{vertices} \markbox{3254}{associated} \markbox{3255}{to} \markbox{m3256}{$a,b$}, \markbox{3257}{and} \markbox{3258}{the} \markbox{3259}{same} \markbox{3260}{for} \markbox{m3261}{$\ha',\hb' \in \calQ'$} \markbox{3262}{and} \markbox{m3263}{$\ha'_0,\hb'_0 \in \calQ'_0$} \markbox{3264}{with} \markbox{m3265}{$a',b'$}, respectively.  \markbox{3266}{Note} \markbox{3267}{that} \markbox{m3268}{$\Delta_0(\ha) = \ha_0$}, etc, \markbox{3269}{by} \markbox{3270}{item} (4) \markbox{3271}{of} \markbox{3272}{Definition} \ref{defn:stable cubes}.  \markbox{3273}{Let} \markbox{m3274}{$\Lambda, \Lambda_0, \Lambda',\Lambda'_0$} \markbox{3275}{be} \markbox{3276}{the} Niblo--Reeves \markbox{3277}{paths} \markbox{3278}{in} \markbox{m3279}{$\calQ,\calQ_0,\calQ',\calQ'_0$} \markbox{3280}{connecting} \markbox{3281}{the} \markbox{3282}{respective} \markbox{3283}{pairs} \markbox{m3284}{$(\ha,\hb), (\ha_0,\hb_0), (\ha',\hb'), (\ha'_0,\hb'_0)$} \markbox{3285}{in} \markbox{3286}{their} \markbox{3287}{respective} \markbox{3288}{cube} \markbox{3289}{complexes} \markbox{m3290}{$\calQ,\calQ_0,\calQ',\calQ'_0$}.  \markbox{3291}{So} \markbox{3292}{in} \markbox{3293}{our} notation, \markbox{m3294}{$\Gamma_{a,b} = \hO(\Lambda)$} \markbox{3295}{and} \markbox{m3296}{$\Gamma_{a',b'} = \hO'(\Lambda')$}.  \markbox{3297}{We} \markbox{3298}{have} \markbox{3299}{the} \markbox{3300}{following} estimate
\begin{eqnarray}
d_X(\Gamma_{a,b}(i), \Gamma_{a',b'}(i)) &=& d_X(\hO(\Lambda(i)), \hO'(\Lambda'(i)))\\
&\leq& d_X(\hO_0 \circ \Delta_0(\Lambda(i)), \hO'_0 \circ \Delta'_0 (\Lambda'(i))) + 2B_0\\
&\leq& d_X(\hO_0(\Lambda_0(i)), \hO'_0(\Lambda'_0(i))) + 4B_0\\
&\leq& d_X(\hO'_0 \circ I_0(\Lambda_0(i)), \hO'_0(\Lambda'_0(i))) + 5B_0\\
&=& d_X(\hO'_0(\Lambda'_0(i)), \hO'_0(\Lambda'_0(i)))\\
&=& 5B_0.
\end{eqnarray}
In \markbox{3301}{the} above, (3) \markbox{3302}{follows} \markbox{3303}{from} \markbox{3304}{commutativity} \markbox{3305}{of} \markbox{3306}{the} \markbox{3307}{top} \markbox{3308}{and} \markbox{3309}{bottom} \markbox{3310}{triangles} \markbox{3311}{in} \markbox{3312}{diagram} \ref{Phi diagram, early}, (4) \markbox{3313}{follows} \markbox{3314}{from} \markbox{3315}{Theorem} \ref{thm:stable moves}, (5) \markbox{3316}{follows} \markbox{3317}{from} \markbox{3318}{commutativity} \markbox{3319}{the} \markbox{3320}{middle} \markbox{3321}{triangle} \markbox{3322}{of} \markbox{3323}{diagram} \ref{Phi diagram, early}, \markbox{3324}{and} (6) \markbox{3325}{follows} \markbox{3326}{from} \markbox{3327}{the} \markbox{3328}{fact} \markbox{3329}{that} \markbox{3330}{the} \markbox{3331}{cubical} \markbox{3332}{isomorphism} \markbox{m3333}{$I_0:\calQ_0 \to \calQ'_0$} \markbox{3334}{identifies} \markbox{3335}{the} \markbox{3336}{paths} \markbox{m3337}{$\Lambda_0$} \markbox{3338}{and} \markbox{m3339}{$\Lambda'_0$}, i.e. \markbox{m3340}{$\Lambda_0(i) = \Lambda'_0(i)$} \markbox{3341}{for} \markbox{3342}{each} \markbox{m3343}{$i$} (Proposition \ref{prop:NR iso}).  \markbox{3344}{This} \markbox{3345}{completes} \markbox{3346}{the} proof.


\end{proof}

With \markbox{3347}{this} \markbox{3348}{in} hand, \markbox{3349}{we} \markbox{3350}{can} \markbox{3351}{prove} \markbox{3352}{our} \markbox{3353}{bicombing} result:

\begin{proof}[Proof \markbox{3354}{of} \markbox{3355}{Corollary} \ref{cori:semihyp}]
Mapping \markbox{3356}{class} \markbox{3357}{groups} \markbox{3358}{and} Teichm\"uller \markbox{3359}{spaces} \markbox{3360}{of} \markbox{3361}{finite} \markbox{3362}{type} \markbox{3363}{surfaces} \markbox{3364}{are} \markbox{3365}{colorable} \markbox{3366}{HHSes} (see \markbox{3367}{Section} \ref{sec:HHS} \markbox{3368}{for} references), \markbox{3369}{so} \markbox{3370}{they} \markbox{3371}{are} \markbox{3372}{stably} \markbox{3373}{weakly} \markbox{3374}{locally} quasi-cubical \markbox{3375}{by} \markbox{3376}{Theorem} \ref{thm:stable cubes}.  \markbox{3377}{Hence} \markbox{3378}{Theorem} \ref{thm:bicombing} \markbox{3379}{provides} \markbox{3380}{a} \markbox{3381}{bicombing} \markbox{3382}{by} \markbox{3383}{pushing} \markbox{3384}{forward} \markbox{3385}{the} Niblo--Reeves \markbox{3386}{path} \markbox{3387}{in} \markbox{3388}{an} \markbox{3389}{appropriate} \markbox{3390}{cubical} \markbox{3391}{model} \markbox{3392}{to} \markbox{3393}{the} \markbox{3394}{respective} space.  \markbox{3395}{Any} \markbox{3396}{such} \markbox{m3397}{$\ell^{\infty}$}-geodesic \markbox{3398}{can} \markbox{3399}{be} \markbox{3400}{completed} \markbox{3401}{to} \markbox{3402}{an} \markbox{m3403}{$\ell^1$}-geodesic \markbox{3404}{by} \markbox{3405}{connecting} \markbox{3406}{vertices} \markbox{3407}{via} \markbox{m3408}{$\ell^1$}-geodesic \markbox{3409}{segments} \markbox{3410}{as} \markbox{3411}{in} \markbox{3412}{Proposition} \ref{prop:NR basics}.  \markbox{3413}{But} \markbox{3414}{now} \markbox{3415}{Proposition} \ref{prop:cubical hp} \markbox{3416}{says} \markbox{3417}{that} \markbox{3418}{the} \markbox{3419}{images} \markbox{3420}{of} \markbox{3421}{these} \markbox{3422}{paths} \markbox{3423}{are} \markbox{3424}{hierarchy} \markbox{3425}{paths} (Definition \ref{defn:hp}).  \markbox{3426}{This} \markbox{3427}{completes} \markbox{3428}{the} proof.
\end{proof}

\begin{remark}\label{rem:no medians}
A \markbox{3429}{reader} \markbox{3430}{familiar} \markbox{3431}{with} \markbox{3432}{both} \cite{HHS_quasi} \markbox{3433}{and} \cite{DMS_bary} \markbox{3434}{will} \markbox{3435}{note} \markbox{3436}{that} \markbox{3437}{one} \markbox{3438}{usually} \markbox{3439}{uses} \markbox{3440}{the} \markbox{3441}{fact} \markbox{3442}{that} \markbox{3443}{the} \markbox{3444}{cubical} \markbox{3445}{model} \markbox{3446}{maps} \markbox{3447}{are} \emph{quasi-median} \markbox{3448}{maps} \markbox{3449}{to} \markbox{3450}{get} \markbox{3451}{this} \markbox{3452}{last} \markbox{3453}{hierarchy} \markbox{3454}{path} property.  However, \markbox{3455}{we} \markbox{3456}{have} \markbox{3457}{avoided} \markbox{3458}{discussions} \markbox{3459}{of} \markbox{3460}{median} \markbox{3461}{structures} \markbox{3462}{in} \markbox{3463}{this} \markbox{3464}{paper} \markbox{3465}{because} \markbox{3466}{they} \markbox{3467}{are} \markbox{3468}{unnecessary} \markbox{3469}{for} \markbox{3470}{our} purposes.  \markbox{3471}{See} \cite[Section 15]{Dur_infcube} \markbox{3472}{for} \markbox{3473}{how} \markbox{3474}{our} \markbox{3475}{cubical} \markbox{3476}{model} \markbox{3477}{construction} \markbox{3478}{works} \markbox{3479}{with} medians.
\end{remark}


\section{A brief primer on HHSes}\label{sec:HHS}

Hierarchically \markbox{3480}{hyperbolic} \markbox{3481}{spaces} \markbox{3482}{were} \markbox{3483}{introduced} \markbox{3484}{by} Behrstock--Hagen--Sisto \markbox{3485}{in} \cite{HHS_I, HHS_II}, \markbox{3486}{building} \markbox{3487}{off} \markbox{3488}{of} \markbox{3489}{work} \markbox{3490}{of} Masur--Minsky \cite{MM99,MM00} \markbox{3491}{on} \markbox{3492}{the} \markbox{3493}{mapping} \markbox{3494}{class} group, \markbox{3495}{among} \markbox{3496}{others} \cite{Brock, Rafi:combo, Rafi:hypteich, Dur:augmented, EMR:rank}.

For \markbox{3497}{our} purposes, \markbox{3498}{we} \markbox{3499}{will} \markbox{3500}{introduce} \markbox{3501}{the} \markbox{3502}{basic} \markbox{3503}{foundational} \markbox{3504}{concepts} \markbox{3505}{that} \markbox{3506}{we} need.  \markbox{3507}{It} \markbox{3508}{turns} \markbox{3509}{out} \markbox{3510}{that} \markbox{3511}{the} \markbox{3512}{cubical} \markbox{3513}{model} \markbox{3514}{construction} \markbox{3515}{is} \markbox{3516}{a} foundational-level construction, \markbox{3517}{as} \markbox{3518}{one} \markbox{3519}{can} \markbox{3520}{use} \markbox{3521}{it} \markbox{3522}{to} \markbox{3523}{prove} \markbox{3524}{key} \markbox{3525}{facts} \markbox{3526}{like} \markbox{3527}{the} \markbox{3528}{Distance} \markbox{3529}{Formula} \ref{thm:DF}; \markbox{3530}{see} \markbox{3531}{Bowditch} \cite{Bowditch_hulls} \markbox{3532}{and} \cite{Dur_infcube}.

The \markbox{3533}{following} \markbox{3534}{is} \markbox{3535}{a} \markbox{3536}{complete} \markbox{3537}{list} (at \markbox{3538}{the} \markbox{3539}{time} \markbox{3540}{of} writing) \markbox{3541}{of} \markbox{3542}{the} \markbox{3543}{spaces} \markbox{3544}{known} \markbox{3545}{to} \markbox{3546}{be} \markbox{3547}{hierarchically} hyperbolic.  \markbox{3548}{With} \markbox{3549}{the} \markbox{3550}{exception} \markbox{3551}{of} \markbox{3552}{some} \markbox{3553}{cubical} examples, \markbox{3554}{all} \markbox{3555}{of} \markbox{3556}{them} \markbox{3557}{are} \markbox{3558}{colorable} (Definition \ref{defn:colorable}), \markbox{3559}{and} \markbox{3560}{so} \markbox{3561}{our} \markbox{3562}{main} \markbox{3563}{results} \markbox{3564}{Theorem} \ref{thmi:main} \markbox{3565}{and} \markbox{3566}{Corollary} \ref{cori:semihyp} apply:

\begin{itemize}
\item Hyperbolic spaces.
\item Mapping \markbox{3567}{class} \markbox{3568}{groups} \cite{MM99, MM00, Aougab_hyp, HHS_I} \markbox{3569}{and} Teichm\"uller spaces, \markbox{3570}{with} \markbox{3571}{both} \markbox{3572}{the} Teichm\"uller \cite{Rafi:combo, Dur:augmented} \markbox{3573}{and} Weil-Petersson \markbox{3574}{metrics} \cite{Brock}.
\item Many \cite{HS:cubical}, \markbox{3575}{but} \markbox{3576}{not} \markbox{3577}{all} \cite{shepherd2025cubulation}, CAT(0) \markbox{3578}{cubical} groups,  \markbox{3579}{including} \markbox{3580}{all} right-angled \markbox{3581}{Artin} \markbox{3582}{and} \markbox{3583}{Coxeter} \markbox{3584}{groups} \cite{HHS_I}.
\item Fundamental \markbox{3585}{groups} \markbox{3586}{of} \markbox{3587}{closed} 3-manifolds \markbox{3588}{without} \markbox{3589}{Nil} \markbox{3590}{or} \markbox{3591}{Sol} \markbox{3592}{summands} \cite{HHS_II, hagen2022equivariant}.
\item Quotients \markbox{3593}{of} \markbox{3594}{mapping} \markbox{3595}{class} \markbox{3596}{groups} \markbox{3597}{by} \markbox{3598}{large} \markbox{3599}{powers} \markbox{3600}{of} \markbox{3601}{Dehn} \markbox{3602}{twists} \cite{behrstock2024combinatorial} \markbox{3603}{and} pseudo-Anosovs \cite{HHS:asdim}.
\item Surface \markbox{3604}{group} \markbox{3605}{extensions} \markbox{3606}{of} \markbox{3607}{Veech} \markbox{3608}{groups} \cite{DDLS1, DDLS2, bongiovanni2024extensions} \markbox{3609}{and} \markbox{3610}{multicurve} \markbox{3611}{stabilizers} \cite{russell2021extensions} \markbox{3612}{of} \markbox{3613}{mapping} \markbox{3614}{class} groups.
\item  The genus-2 \markbox{3615}{handlebody} \markbox{3616}{group} \cite{chesser2022stable}.
\item Artin \markbox{3617}{groups} \markbox{3618}{of} extra-large \markbox{3619}{type} \cite{MMS:Artin}.
\item Many free-by-cyclic \markbox{3620}{groups} \cite{bongiovanni2025characterizing}.
\item Admissible \markbox{3621}{curve} \markbox{3622}{graphs} \cite{calderon2024hierarchical}.
\item The \markbox{3623}{class} \markbox{3624}{of} \markbox{3625}{HHSes} \markbox{3626}{is} \markbox{3627}{closed} \markbox{3628}{under} \markbox{3629}{products} \markbox{3630}{and} \markbox{3631}{appropriate} \markbox{3632}{combinations} \cite{HHS_II}, \markbox{3633}{including} \markbox{3634}{graph} \markbox{3635}{products} \cite{BR:graph_prods} \markbox{3636}{and} \markbox{3637}{graph} \markbox{3638}{braid} \markbox{3639}{groups}  \cite{berlyne2021hierarchical}.
\end{itemize}

We \markbox{3640}{note} \markbox{3641}{that} \markbox{3642}{there} \markbox{3643}{are} non-colorable \markbox{3644}{cubical} \markbox{3645}{HHSes} \cite{Hagen:non-col} \markbox{3646}{and} non-HHS \markbox{3647}{cubical} \markbox{3648}{groups} \cite{shepherd2025cubulation}.  CAT(0) \markbox{3649}{cube} \markbox{3650}{complexes} \markbox{3651}{are} \markbox{3652}{obviously} \markbox{3653}{locally} \markbox{3654}{modeled} \markbox{3655}{by} \markbox{3656}{cube} \markbox{3657}{complexes} and, moreover, \markbox{3658}{are} \markbox{3659}{bicombable} \cite{NibloReeves}, \markbox{3660}{so} \markbox{3661}{they} \markbox{3662}{are} \markbox{3663}{not} \markbox{3664}{of} \markbox{3665}{interest} \markbox{3666}{in} \markbox{3667}{this} \markbox{3668}{paper} \markbox{3669}{in} \markbox{3670}{any} event.

\subsection{Basic setup of an HHS}\label{subsec:basic HHS}

Roughly, \markbox{3671}{a} \emph{hierarchically hyperbolic} \markbox{3672}{structure} \markbox{3673}{is} \markbox{3674}{a} \markbox{3675}{pair} \markbox{m3676}{$(\calX, \mathfrak S)$} \markbox{3677}{where} \markbox{m3678}{$\calX$} \markbox{3679}{is} \markbox{3680}{a} \markbox{3681}{uniformly} \markbox{3682}{quasigeodesic} \markbox{3683}{metric} \markbox{3684}{space} \markbox{3685}{and} \markbox{m3686}{$\mathfrak S$} \markbox{3687}{is} \markbox{3688}{an} \markbox{3689}{index} \markbox{3690}{set} \markbox{3691}{for} \markbox{3692}{a} \markbox{3693}{family} \markbox{3694}{of} \markbox{3695}{uniformly} \markbox{3696}{hyperbolic} \markbox{3697}{spaces} \markbox{m3698}{$\{\calC(U)\}_{U \in \mathfrak S}$}.  \markbox{3699}{The} \markbox{3700}{ambient} \markbox{3701}{space} \markbox{m3702}{$\calX$} \markbox{3703}{admits} \markbox{3704}{a} \markbox{3705}{family} \markbox{3706}{of} \markbox{3707}{uniformly} \markbox{3708}{coarsely} \markbox{3709}{Lipschitz} \markbox{3710}{projections} \markbox{m3711}{$\pi_U:\calX \to \calC(U)$}, \markbox{3712}{and} \markbox{3713}{those} projections, \markbox{3714}{along} \markbox{3715}{with} \markbox{3716}{certain} \markbox{3717}{relations} \markbox{3718}{on} \markbox{3719}{the} \markbox{3720}{family} \markbox{m3721}{$\mathfrak S$}, \markbox{3722}{largely} \markbox{3723}{control} \markbox{3724}{the} \markbox{3725}{coarse} \markbox{3726}{geometry} \markbox{3727}{of} \markbox{m3728}{$\calX$}.

The \markbox{3729}{following} \markbox{3730}{extracts} \markbox{3731}{some} \markbox{3732}{of} \markbox{3733}{the} \markbox{3734}{properties} \markbox{3735}{we} \markbox{3736}{need} \markbox{3737}{from} \markbox{3738}{the} \markbox{3739}{axiomatic} \markbox{3740}{setup} \cite{HHS_II}, \markbox{3741}{see} \cite{Sisto_HHS} \markbox{3742}{for} \markbox{3743}{a} discussion.


\begin{enumerate}

\item For \markbox{3744}{each} \markbox{m3745}{$U \in \mathfrak S$} \markbox{3746}{there} \markbox{3747}{exist} \markbox{3748}{an} \markbox{m3749}{$\ES$}-hyperbolic \markbox{3750}{space} \markbox{m3751}{$\calC(U
)$} \markbox{3752}{and} \markbox{3753}{a} \markbox{m3754}{$\ES$}-coarsely \markbox{3755}{surjective} \markbox{m3756}{$(\ES,\ES)$}-coarsely \markbox{3757}{Lipschitz} \markbox{3758}{map} \markbox{m3759}{$\pi_U: \calX \rightarrow \calC(U),$} \markbox{3760}{with} \markbox{m3761}{$\ES$} \markbox{3762}{independent} \markbox{3763}{of} \markbox{m3764}{$U$}.

    \item The \markbox{3765}{set} \markbox{m3766}{$\mathfrak S$} \markbox{3767}{has} \markbox{3768}{the} \markbox{3769}{following} relations:
    \begin{itemize}
        \item It \markbox{3770}{is} \markbox{3771}{equipped} \markbox{3772}{with} \markbox{3773}{a} \markbox{3774}{partial} \markbox{3775}{order} \markbox{m3776}{$\nest$} \markbox{3777}{called} \emph{nesting}. \markbox{3778}{If} \markbox{m3779}{$\mathfrak S \neq \emptyset,$} \markbox{3780}{the} \markbox{3781}{set} \markbox{m3782}{$\mathfrak S$} \markbox{3783}{contains} \markbox{3784}{a} \markbox{3785}{unique} \markbox{m3786}{$\nest$}-maximal \markbox{3787}{element} \markbox{m3788}{$S.$}
        
        \item It \markbox{3789}{has} \markbox{3790}{a} symmetric, anti-reflexive \markbox{3791}{relation} \markbox{m3792}{$\perp$} \markbox{3793}{called} \emph{orthogonality}. \markbox{3794}{If} \markbox{m3795}{$U \nest V$}, \markbox{3796}{then} \markbox{m3797}{$U,V$} \markbox{3798}{are} \markbox{3799}{not} \markbox{3800}{related} \markbox{3801}{via} \markbox{m3802}{$\perp$}. Furthermore, \markbox{3803}{domains} \markbox{3804}{have} \emph{orthogonal containers}: \markbox{3805}{if} \markbox{m3806}{$U \in \mathfrak S$} \markbox{3807}{and} \markbox{3808}{there} \markbox{3809}{is} \markbox{3810}{a} \markbox{3811}{domain} \markbox{3812}{orthogonal} \markbox{3813}{to} \markbox{m3814}{$U$} \markbox{3815}{then} \markbox{3816}{there} \markbox{3817}{is} \markbox{3818}{a} \markbox{3819}{domain} \markbox{m3820}{$W$} \markbox{3821}{such} \markbox{3822}{that} \markbox{m3823}{$V \nest W$} \markbox{3824}{whenever} \markbox{m3825}{$V \perp U.$}
        
        \item For \markbox{3826}{any} \markbox{3827}{distinct} \markbox{m3828}{$ U, V \in \mathfrak S$} \markbox{3829}{unrelated} \markbox{3830}{via} \markbox{m3831}{$\perp, \nest$}, \markbox{3832}{then} \markbox{3833}{we} \markbox{3834}{say} \markbox{m3835}{$U,V$} \markbox{3836}{are} \emph{transverse} \markbox{3837}{and} \markbox{3838}{write} \markbox{m3839}{$U  \pitchfork V.$} 
     
        \end{itemize}
          
        \item There \markbox{3840}{exists} \markbox{3841}{an} \markbox{3842}{integer} \markbox{3843}{called} \markbox{3844}{the} \emph{complexity} \markbox{3845}{of} \markbox{m3846}{$\calX$} \markbox{3847}{and} \markbox{3848}{denoted} \markbox{m3849}{$\xi(\mathfrak S)$} \markbox{3850}{such} \markbox{3851}{that} \markbox{3852}{whenever} \markbox{m3853}{$U_1,U_2,\cdots U_n$} \markbox{3854}{is} \markbox{3855}{a} \markbox{3856}{collection} \markbox{3857}{of} \markbox{3858}{pairwise} non-transverse domains, \markbox{3859}{then} \markbox{m3860}{$n \leq \xi(\mathfrak S).$}
        
        \item If \markbox{m3861}{$U  \sqsubset V$} \markbox{3862}{or} \markbox{m3863}{$U  \pitchfork V,$} \markbox{3864}{then} \markbox{3865}{there} \markbox{3866}{exists} \markbox{3867}{a} \markbox{3868}{set} \markbox{m3869}{$\rho^U_V$} \markbox{3870}{of} \markbox{3871}{diameter} \markbox{3872}{at} \markbox{3873}{most} \markbox{m3874}{$\ES$} \markbox{3875}{in} \markbox{m3876}{$\calC(V)$}.
        
        \item If \markbox{m3877}{$U  \sqsubset V$}, \markbox{3878}{there} \markbox{3879}{is} \markbox{3880}{a} \markbox{3881}{map} \markbox{m3882}{$\rho^V_U:\calC(V) \rightarrow \calC(U)$}, \markbox{3883}{called} \markbox{3884}{the} \emph{relative projection} \markbox{3885}{of} \markbox{m3886}{$U$} \markbox{3887}{to} \markbox{m3888}{$V$} \markbox{3889}{which} \markbox{3890}{satisfies} \markbox{3891}{the} following: \markbox{3892}{For} \markbox{m3893}{$x \in \calX$} \markbox{3894}{with} \markbox{m3895}{$d_{ V}(\pi_V(x),\rho^U_V)>\ES,$} \markbox{3896}{we} \markbox{3897}{have} \markbox{m3898}{$\pi_U(x) \underset{\ES}{\asymp} \rho^V_U(\pi_V(x)).$}

        
        


\end{enumerate}

For \markbox{3899}{two} \markbox{3900}{points} \markbox{m3901}{$x,y \in \calX,$} \markbox{3902}{it} \markbox{3903}{is} \markbox{3904}{standard} \markbox{3905}{to} \markbox{3906}{use} \markbox{m3907}{$d_U(x,y)$} \markbox{3908}{to} \markbox{3909}{denote} \markbox{m3910}{$d_{\calC(U)}(\pi_U(x), \pi_U(y)),$} \markbox{3911}{and} \markbox{3912}{similarly} \markbox{3913}{for} \markbox{3914}{subsets} \markbox{3915}{of} \markbox{m3916}{$\calX.$} \markbox{3917}{For} \markbox{3918}{a} \markbox{3919}{subset} \markbox{m3920}{$A \subseteq \calX,$} \markbox{3921}{we} \markbox{3922}{will} \markbox{3923}{also} \markbox{3924}{use} \markbox{m3925}{$\diam_U(A)$} \markbox{3926}{to} \markbox{3927}{denote} \markbox{3928}{the} \markbox{3929}{diameter} \markbox{3930}{of} \markbox{3931}{the} \markbox{3932}{set} \markbox{m3933}{$\pi_U(A) \subset \calC(U)$}.

\subsection{Basic HHS facts}

We \markbox{3934}{now} \markbox{3935}{collect} \markbox{3936}{some} \markbox{3937}{useful} \markbox{3938}{facts} \markbox{3939}{about} \markbox{3940}{HHSes} \markbox{3941}{from} \markbox{3942}{various} places. \medskip

The \markbox{3943}{following} \markbox{3944}{definition} \markbox{3945}{from} \cite{Beh:thesis, BKMM:qirigid, HHS_II}, \markbox{3946}{will} \markbox{3947}{be} \markbox{3948}{important} \markbox{3949}{for} us.  \markbox{3950}{The} \markbox{3951}{idea} \markbox{3952}{here} \markbox{3953}{is} \markbox{3954}{that} \markbox{3955}{we} \markbox{3956}{want} \markbox{3957}{to} \markbox{3958}{combine} \markbox{3959}{all} \markbox{3960}{of} \markbox{3961}{the} \markbox{3962}{projections} \markbox{m3963}{$\pi_U:\calX \to \calC(U)$} \markbox{3964}{for} \markbox{3965}{each} \markbox{m3966}{$U \in \mathfrak S$} \markbox{3967}{into} \markbox{3968}{a} \markbox{3969}{global} \markbox{3970}{projection} \markbox{m3971}{$\Pi:\calX \to \prod_U \calC(U)$}.  \markbox{3972}{The} \markbox{3973}{following} \markbox{3974}{definition} \markbox{3975}{uses} \markbox{3976}{the} \markbox{3977}{relations} \markbox{3978}{on} \markbox{m3979}{$\mathfrak S$} \markbox{3980}{to} \markbox{3981}{constrain} \markbox{3982}{tuples} \markbox{3983}{in} \markbox{m3984}{$\prod_U \calC(U)$}.

\begin{definition}[Consistent tuple]\label{defn:consistency}
Let \markbox{m3985}{$\kappa\geq 0$} \markbox{3986}{and} \markbox{3987}{let} \markbox{m3988}{$(b_U)\in\prod_{U\in\mathfrak S}2^{\calC(U)}$} \markbox{3989}{be} \markbox{3990}{a} \markbox{3991}{tuple} \markbox{3992}{such} \markbox{3993}{that} \markbox{3994}{for} \markbox{3995}{each} \markbox{m3996}{$U\in\mathfrak S$}, 
the \markbox{m3997}{$U$}--coordinate  \markbox{m3998}{$b_U$} \markbox{3999}{has} \markbox{4000}{diameter} \markbox{m4001}{$\leq\kappa$}.  \markbox{4002}{Then} \markbox{m4003}{$(b_U)$} \markbox{4004}{is} \textbf{\em $\kappa$--consistent} \markbox{4005}{if} \markbox{4006}{for} \markbox{4007}{all} 
\markbox{m4008}{$V,W\in \mathfrak S$}, \markbox{4009}{we} \markbox{4010}{have} $$\min\{\dist_V(b_V,\rho^W_V),\dist_W(b_W,\rho^V_W)\}\leq\kappa$$ \markbox{4011}{whenever} \markbox{m4012}{$V\pitchfork W$} \markbox{4013}{and} 
$$\min\{\dist_W(x,\rho^V_W),\diam_V(b_V\cup\rho^W_V)\}\leq\kappa$$ \markbox{4014}{whenever} \markbox{m4015}{$V\nest W$}.
\begin{itemize}
\item We \markbox{4016}{refer} \markbox{4017}{to} \markbox{4018}{the} \markbox{4019}{above} \markbox{4020}{inequalities} \markbox{4021}{as} \markbox{4022}{the} \emph{consistency inequalities}.
\end{itemize}
\end{definition}




\medskip


The \markbox{4023}{following} \markbox{4024}{is} \markbox{4025}{a} \markbox{4026}{key} \markbox{4027}{fact} \markbox{4028}{for} us.  \markbox{4029}{It} \markbox{4030}{says} \markbox{4031}{that} \markbox{4032}{the} \markbox{4033}{image} \markbox{4034}{of} \markbox{m4035}{$\Pi:\calX \to \prod_U \calC(U)$} \markbox{4036}{consists} \markbox{4037}{of} \markbox{4038}{uniformly} \markbox{4039}{consistent} tuples:

\begin{lemma}\label{lem:base consistency}
There \markbox{4040}{exists} \markbox{m4041}{$\theta = \theta(\mathfrak S)>0$} \markbox{4042}{so} \markbox{4043}{that} \markbox{4044}{if} \markbox{m4045}{$x \in \calX$}, \markbox{4046}{then} \markbox{4047}{the} \markbox{4048}{tuple} \markbox{m4049}{$(\pi_U(x)) \in \prod_{U \in \mathfrak S} \calC(U)$} \markbox{4050}{is} \markbox{m4051}{$\theta$}-consistent.
\end{lemma}


On \markbox{4052}{the} \markbox{4053}{other} hand, \markbox{4054}{we} \markbox{4055}{would} \markbox{4056}{like} \markbox{4057}{to} \markbox{4058}{know} \markbox{4059}{whether} \markbox{4060}{all} \markbox{4061}{consistent} \markbox{4062}{tuples} \markbox{4063}{in} \markbox{m4064}{$\prod_U \calC(U)$} \markbox{4065}{essentially} \markbox{4066}{come} \markbox{4067}{from} \markbox{m4068}{$\calX$}.  \markbox{4069}{That} \markbox{4070}{is} \markbox{4071}{the} \markbox{4072}{content} \markbox{4073}{of} \markbox{4074}{the} \markbox{4075}{following} \markbox{4076}{Realization} Theorem.  \markbox{4077}{In} particular, \markbox{4078}{says} \markbox{4079}{that} \markbox{4080}{any} \markbox{4081}{tuple} \markbox{4082}{satisfying} \markbox{4083}{Definition} \ref{defn:consistency} \markbox{4084}{can} \markbox{4085}{be} \markbox{4086}{coarsely} \markbox{4087}{realized} \markbox{4088}{via} \markbox{4089}{a} \markbox{4090}{point} \markbox{4091}{in} \markbox{m4092}{$\calX$}.  \markbox{4093}{It} \markbox{4094}{is} \cite[Theorem 4.3]{BKMM:qirigid} \markbox{4095}{for} \markbox{4096}{mapping} \markbox{4097}{class} groups, \cite[Theorem 3.2]{EMR:rank} \markbox{4098}{for} Teichm\"uller \markbox{4099}{space} \markbox{4100}{with} \markbox{4101}{the} Teichm\"uller metric, \markbox{4102}{and} \cite[Theorem 3.1]{HHS_II} \markbox{4103}{for} \markbox{4104}{the} \markbox{4105}{general} \markbox{4106}{HHS} case:

\begin{theorem}[Realization]\label{thm:realization}
For \markbox{4107}{each} \markbox{m4108}{$\kappa \geq 1$} \markbox{4109}{there} \markbox{4110}{exists} \markbox{m4111}{$\theta_e, \theta_u \geq 0$} \markbox{4112}{such} \markbox{4113}{that} \markbox{4114}{the} \markbox{4115}{following} holds.  \markbox{4116}{Let} \markbox{m4117}{$\mathbf{b} = (b_U)_{U \in \mathfrak S} \in \prod_{U \in \mathfrak S} 2^{\calC(U)}$} \markbox{4118}{be} \markbox{m4119}{$\kappa$}-consistent.

Then \markbox{4120}{there} \markbox{4121}{exists} \markbox{m4122}{$x \in X$} \markbox{4123}{so} \markbox{4124}{that} \markbox{m4125}{$d_U(b_U, \pi_W(x)) \leq \theta_e$} \markbox{4126}{for} \markbox{4127}{all} \markbox{m4128}{$U \in \mathfrak S$}.  Moreover, \markbox{m4129}{$x$} \markbox{4130}{is} \emph{coarsely unique} \markbox{4131}{in} \markbox{4132}{the} \markbox{4133}{sense} \markbox{4134}{that} 
$$\diam_{\calX} \{x \in \calX| d_W(b_W, \pi_W(x)) \leq \theta_e \textrm{ for all } U \in \mathfrak S\} < \theta_u.$$
\end{theorem}

\begin{remark}
Notably, \markbox{4135}{the} \markbox{4136}{proof} \markbox{4137}{of} \markbox{4138}{Theorem} \ref{thm:realization} \markbox{4139}{in} \cite{HHS_II} \markbox{4140}{does} \markbox{4141}{not} \markbox{4142}{involve} \markbox{4143}{the} \markbox{4144}{hyperbolicity} \markbox{4145}{of} \markbox{4146}{the} \markbox{4147}{associated} \markbox{4148}{spaces} \markbox{m4149}{$\{\calC(U)\}_{U \in \mathfrak S}$}, \markbox{4150}{and} \markbox{4151}{actually} \markbox{4152}{follows} \markbox{4153}{from} \markbox{4154}{a} \markbox{4155}{weak} \markbox{4156}{form} \markbox{4157}{which} \markbox{4158}{is} \markbox{4159}{axiomatized} \markbox{4160}{into} \markbox{4161}{the} \markbox{4162}{HHS} setup.  \markbox{4163}{In} \markbox{4164}{this} sense, \markbox{4165}{realization} \markbox{4166}{is} \markbox{4167}{a} \markbox{4168}{purely} \markbox{4169}{hierarchical} \markbox{4170}{fact} \markbox{4171}{which} \markbox{4172}{plays} \markbox{4173}{a} \markbox{4174}{similar} \markbox{4175}{role} \markbox{4176}{to} \markbox{4177}{the} \markbox{4178}{existence} \markbox{4179}{of} \markbox{4180}{a} \markbox{4181}{coarse} \markbox{4182}{median} \markbox{4183}{in} Bowditch's \markbox{4184}{analysis} \cite{Bowditch_hulls}.


\end{remark}

Perhaps \markbox{4185}{the} \markbox{4186}{main} \markbox{4187}{technique} \markbox{4188}{in} \markbox{4189}{HHSes} \markbox{4190}{is} \markbox{4191}{taking} \markbox{4192}{an} \markbox{4193}{object} \markbox{4194}{in} \markbox{4195}{the} \markbox{4196}{ambient} \markbox{4197}{space} \markbox{m4198}{$\calX$} \markbox{4199}{and} \markbox{4200}{projecting} \markbox{4201}{it} \markbox{4202}{to} \markbox{4203}{all} \markbox{4204}{of} \markbox{4205}{the} \markbox{4206}{hyperbolic} spaces, \markbox{4207}{doing} \markbox{4208}{hyperbolic} geometry, \markbox{4209}{and} \markbox{4210}{then} \markbox{4211}{reassembling} \markbox{4212}{the} \markbox{4213}{pieces} \markbox{4214}{via} \markbox{4215}{hierarchical} \markbox{4216}{tools} \markbox{4217}{like} \markbox{4218}{the} \markbox{4219}{Realization} \markbox{4220}{Theorem} \ref{thm:realization}.  \markbox{4221}{Toward} \markbox{4222}{that} end, \markbox{4223}{and} \markbox{4224}{recognizing} \markbox{4225}{that} \markbox{4226}{HHSes} \markbox{4227}{are} \markbox{4228}{fundamentally} \markbox{4229}{coarse} spaces, \markbox{4230}{we} \markbox{4231}{will} \markbox{4232}{usually} \markbox{4233}{want} \markbox{4234}{to} \markbox{4235}{restrict} \markbox{4236}{ourselves} \markbox{4237}{to} \markbox{4238}{the} \emph{relevant} \markbox{4239}{collection} \markbox{4240}{of} \markbox{4241}{hyperbolic} \markbox{4242}{spaces} \markbox{4243}{to} \markbox{4244}{which} \markbox{4245}{an} \markbox{4246}{object} \markbox{4247}{has} \markbox{4248}{a} \markbox{4249}{sufficiently} \markbox{4250}{large} projection.

\begin{definition}[Relevant domains] \label{defn:relevant}
Given \markbox{4251}{a} \markbox{4252}{subset} \markbox{m4253}{$A \subset \calX$} \markbox{4254}{and} \markbox{m4255}{$K > 0$}, \markbox{4256}{we} \markbox{4257}{say} \markbox{4258}{that} \markbox{m4259}{$U \in \mathfrak S$} \markbox{4260}{is} \markbox{m4261}{$K$}-\emph{relevant} \markbox{4262}{for} \markbox{m4263}{$A$} \markbox{4264}{if} \markbox{m4265}{$\diam_U(A) \geq K$}.  \markbox{4266}{We} \markbox{4267}{denote} \markbox{4268}{the} \markbox{4269}{set} \markbox{4270}{of} \markbox{m4271}{$K$}-relevant \markbox{4272}{domains} \markbox{4273}{for} \markbox{m4274}{$A$} \markbox{4275}{by} \markbox{m4276}{$\Rel_K(A)$}.
\end{definition}


The \markbox{4277}{following} Passing-Up \markbox{4278}{lemma} \markbox{4279}{is} \markbox{4280}{a} \markbox{4281}{foundational} \markbox{4282}{fact} \markbox{4283}{about} HHSes; \markbox{4284}{in} fact, \markbox{4285}{it} \markbox{4286}{can} \markbox{4287}{be} \markbox{4288}{taken} \markbox{4289}{to} \markbox{4290}{be} \markbox{4291}{an} \markbox{4292}{axiom} \cite[Proposition 4.15]{Dur_infcube}.  \markbox{4293}{Roughly} speaking, \markbox{4294}{the} passing-up \markbox{4295}{lemma} \markbox{4296}{says} \markbox{4297}{that} \markbox{4298}{if} \markbox{m4299}{$x,y \in \calX$} \markbox{4300}{have} \markbox{4301}{a} \markbox{4302}{large} \markbox{4303}{number} \markbox{4304}{of} \markbox{4305}{lower} \markbox{4306}{complexity} \markbox{4307}{relevant} domains, \markbox{4308}{then} \markbox{4309}{there} \markbox{4310}{must} \markbox{4311}{be} \markbox{4312}{some} \markbox{4313}{higher} \markbox{4314}{complexity} \markbox{4315}{relevant} \markbox{4316}{domain} \markbox{4317}{containing} \markbox{4318}{at} \markbox{4319}{least} \markbox{4320}{one} \markbox{4321}{of} them, \markbox{4322}{thereby} \markbox{4323}{allowing} \markbox{4324}{us} \markbox{4325}{to} ``pass up'' \markbox{4326}{the} \markbox{m4327}{$\nest$}-lattice.

\begin{lemma}[Passing-up]\label{lem:passing-up}
Let \markbox{m4328}{$\calX$} \markbox{4329}{be} \markbox{4330}{an} \markbox{4331}{HHS} \markbox{4332}{with} \markbox{4333}{constant} \markbox{m4334}{$\ES$}.  \markbox{4335}{For} \markbox{4336}{every} \markbox{m4337}{$D>0$} \markbox{4338}{there} \markbox{4339}{is} \markbox{4340}{an} \markbox{4341}{integer} \markbox{m4342}{$PU=PU(D)>0$} \markbox{4343}{such} \markbox{4344}{that} \markbox{4345}{if} \markbox{m4346}{$V \in \mathfrak S$} \markbox{4347}{and} \markbox{m4348}{$x,y \in \calX$} \markbox{4349}{satisfy} \markbox{m4350}{$d_{U_i}(x,y)>\ES$} \markbox{4351}{for} \markbox{4352}{a} \markbox{4353}{collection} \markbox{4354}{of} \markbox{4355}{domains} \markbox{m4356}{$\{U_i\}_{i=1}^{PU}$} \markbox{4357}{with} \markbox{4358}{each} \markbox{m4359}{$U_i \in \mathfrak S_V$}, \markbox{4360}{then} \markbox{4361}{there} \markbox{4362}{exists} \markbox{m4363}{$W \in \mathfrak S_V$} \markbox{4364}{and} \markbox{m4365}{$i$} \markbox{4366}{with} \markbox{m4367}{$U_i \sqsubsetneq W$} \markbox{4368}{such} \markbox{4369}{that} \markbox{m4370}{$d_W(x,y)>D.$}
\end{lemma}

As \markbox{4371}{an} \markbox{4372}{example} \markbox{4373}{of} \markbox{4374}{how} \markbox{4375}{this} \markbox{4376}{lemma} \markbox{4377}{is} foundational, \markbox{4378}{we} \markbox{4379}{observe} \markbox{4380}{the} \markbox{4381}{following} corollary.  \markbox{4382}{The} \markbox{4383}{original} \markbox{4384}{proof} \markbox{4385}{is} \markbox{4386}{embedded} \markbox{4387}{in} \markbox{4388}{the} \markbox{4389}{proof} \markbox{4390}{of} \markbox{4391}{Theorem} \ref{thm:realization} \markbox{4392}{in} \cite[Theorem 3.1]{HHS_II}, \markbox{4393}{but} \markbox{4394}{not} \markbox{4395}{explicitly} stated.  \markbox{4396}{We} \markbox{4397}{give} \markbox{4398}{a} \markbox{4399}{proof} \markbox{4400}{for} completeness:

\begin{corollary}\label{cor:rel sets are finite}
For \markbox{4401}{any} \markbox{m4402}{$x,y \in \calX$}, \markbox{4403}{the} \markbox{4404}{set} \markbox{m4405}{$\Rel_{\ES}(x,y)$} \markbox{4406}{is} finite.
\end{corollary}

\begin{proof}
Let \markbox{m4407}{$C$} \markbox{4408}{be} \markbox{4409}{the} \markbox{4410}{coarse} \markbox{4411}{Lipschitz} \markbox{4412}{constant} \markbox{4413}{for} \markbox{4414}{all} \markbox{4415}{of} \markbox{4416}{the} \markbox{4417}{projections} \markbox{m4418}{$\pi_U$} \markbox{4419}{for} \markbox{m4420}{$U \in \mathfrak S$}, \markbox{4421}{and} \markbox{4422}{set} \markbox{m4423}{$D > C d_{\calX}(x,y) + C$}.  \markbox{4424}{If} \markbox{m4425}{$\# \Rel_{\ES}(x,y) > P(D)$}, \markbox{4426}{then} \markbox{4427}{the} Passing-Up \markbox{4428}{Lemma} \ref{lem:passing-up} \markbox{4429}{provides} \markbox{4430}{a} \markbox{4431}{domain} \markbox{m4432}{$W \in \mathfrak S$} \markbox{4433}{with} \markbox{m4434}{$d_W(x,y)>D$}, \markbox{4435}{which} \markbox{4436}{is} impossible.
\end{proof}

Another \markbox{4437}{fundamental} \markbox{4438}{fact} \markbox{4439}{about} \markbox{4440}{HHSes} \markbox{4441}{is} \markbox{4442}{the} \markbox{4443}{following} \markbox{4444}{distance} formula, \markbox{4445}{which} \markbox{4446}{originated} \markbox{4447}{in} \markbox{4448}{work} \markbox{4449}{of} Masur-Minsky \cite{MM00}, \markbox{4450}{and} \markbox{4451}{found} \markbox{4452}{various} \markbox{4453}{iterations} \markbox{4454}{elsewhere} \cite{Brock, Rafi:combo, Dur:augmented, kim2014geometry} \markbox{4455}{before} \markbox{4456}{being} \markbox{4457}{generalized} \markbox{4458}{to} \markbox{4459}{all} \markbox{4460}{HHSes} \markbox{4461}{in} \cite{HHS_II}.  \markbox{4462}{See} \cite[Theorem 4.5]{HHS_II} \markbox{4463}{for} \markbox{4464}{a} \markbox{4465}{proof} \markbox{4466}{from} \markbox{4467}{the} now-standard \markbox{4468}{HHS} setup, \markbox{4469}{and} \markbox{4470}{also} \cite[Theorem 1.2]{Bowditch_hulls} \markbox{4471}{and} \cite[Corollary C]{Dur_infcube} \markbox{4472}{from} \markbox{4473}{proofs} \markbox{4474}{using} \markbox{4475}{cubical} \markbox{4476}{model} techniques, \markbox{4477}{which} \markbox{4478}{we} \markbox{4479}{also} \markbox{4480}{recover} \markbox{4481}{here} \markbox{4482}{below} \markbox{4483}{in} \markbox{4484}{Corollary} \ref{cor:DF lower bound}.

\begin{theorem}[Distance formula]\label{thm:DF}
There \markbox{4485}{exists} \markbox{m4486}{$K_0 = K_0(\mathfrak S)>0$} \markbox{4487}{so} \markbox{4488}{that} \markbox{4489}{if} \markbox{m4490}{$K>K_0$} \markbox{4491}{and} \markbox{m4492}{$x,y \in \calX$}, then
$$d_{\calX}(x,y) \asymp \sum_{U \in \mathfrak S} [d_U(x,y)]_K$$
where \markbox{4493}{the} \markbox{4494}{coarse} \markbox{4495}{equality} \markbox{m4496}{$\asymp$} \markbox{4497}{depends} \markbox{4498}{only} \markbox{4499}{on} \markbox{m4500}{$\mathfrak S$} \markbox{4501}{and} \markbox{m4502}{$K$}.
\end{theorem}

Philosophically (for \markbox{4503}{our} purposes), \markbox{4504}{the} \markbox{4505}{distance} \markbox{4506}{formula} \markbox{4507}{says} \markbox{4508}{that} \markbox{4509}{if} \markbox{4510}{we} \markbox{4511}{want} \markbox{4512}{to} \markbox{4513}{understand} \markbox{4514}{how} \markbox{4515}{to} \markbox{4516}{move} \markbox{4517}{between} \markbox{4518}{two} \markbox{4519}{points} \markbox{4520}{in} \markbox{4521}{an} HHS, \markbox{4522}{it} \markbox{4523}{should} \markbox{4524}{be} \markbox{4525}{enough} \markbox{4526}{to} \markbox{4527}{focus} \markbox{4528}{on} \markbox{4529}{the} \markbox{4530}{set} \markbox{4531}{of} \markbox{4532}{relevant} \markbox{4533}{domains} \markbox{4534}{between} them. 

The \markbox{4535}{next} \markbox{4536}{definition} \markbox{4537}{is} \markbox{4538}{of} \markbox{4539}{a} \markbox{4540}{special} \markbox{4541}{kind} \markbox{4542}{of} \markbox{4543}{path} \markbox{4544}{in} \markbox{4545}{an} HHS.  \markbox{4546}{The} \markbox{4547}{proof} \markbox{4548}{of} \markbox{4549}{their} \markbox{4550}{existence} \markbox{4551}{is} \markbox{4552}{always} \markbox{4553}{tied} \markbox{4554}{up} \markbox{4555}{in} \markbox{4556}{the} \markbox{4557}{proof} \markbox{4558}{of} \markbox{4559}{the} \markbox{4560}{more} \markbox{4561}{difficult} \markbox{4562}{bound} \markbox{4563}{of} \markbox{4564}{the} \markbox{4565}{distance} formula, \markbox{4566}{as} \markbox{4567}{is} \markbox{4568}{the} \markbox{4569}{case} \markbox{4570}{in} \markbox{4571}{this} \markbox{4572}{paper} \markbox{4573}{in} \markbox{4574}{Subsection} \ref{subsec:HP and DF}.  Otherwise, \markbox{4575}{we} \markbox{4576}{will} \markbox{4577}{not} \markbox{4578}{need} \markbox{4579}{this} notion.

\begin{definition}\label{defn:hp}
A \markbox{4580}{path} \markbox{m4581}{$\gamma:I \to \calX$} \markbox{4582}{in} \markbox{4583}{an} \markbox{4584}{HHS} \markbox{m4585}{$(\calX, \mathfrak S)$} \markbox{4586}{is} \markbox{4587}{a} \markbox{m4588}{$L$}-\emph{hierarchy path} \markbox{4589}{if} \markbox{4590}{its} \markbox{4591}{projection} \markbox{m4592}{$\pi_U(\gamma) \subset \calC(U)$} \markbox{4593}{is} \markbox{4594}{an} \markbox{4595}{unparameterized} \markbox{m4596}{$(L,L)$}-quasi-geodesic \markbox{4597}{for} \markbox{4598}{each} \markbox{m4599}{$U \in \mathfrak S$}.
\end{definition}

We \markbox{4600}{end} \markbox{4601}{this} \markbox{4602}{subsection} \markbox{4603}{with} \markbox{4604}{a} \markbox{4605}{basic} observation, \markbox{4606}{which} \markbox{4607}{generalizes} \markbox{4608}{the} \markbox{4609}{observation} \markbox{4610}{that} \markbox{4611}{if} \markbox{4612}{two} \markbox{4613}{subsurfaces} \markbox{m4614}{$U,V$} \markbox{4615}{are} \markbox{4616}{not} transverse, \markbox{4617}{then} \markbox{4618}{their} \markbox{4619}{boundary} \markbox{4620}{curves} \markbox{4621}{must} \markbox{4622}{be} \markbox{4623}{disjoint} \markbox{4624}{up} \markbox{4625}{to} isotopy.

\begin{lemma}\label{lem:rho control}
Suppose \markbox{4626}{that} \markbox{m4627}{$U,V,W \in \Rel_{K_0}(a,b)$} \markbox{4628}{for} \markbox{m4629}{$a,b \in \calX$}.
\begin{enumerate}
\item If \markbox{m4630}{$U, V \nest W$} \markbox{4631}{and} \markbox{m4632}{$U,V$} \markbox{4633}{are} \markbox{4634}{not} transverse, \markbox{4635}{then} \markbox{m4636}{$d_W(\rho^U_W, \rho^V_W) < \ES$}.
\item If \markbox{m4637}{$U \pitchfork V$} \markbox{4638}{and} \markbox{m4639}{$W \nest V$} \markbox{4640}{with} \markbox{m4641}{$W,U$} \markbox{4642}{not} orthogonal, \markbox{4643}{then} \markbox{m4644}{$d_U(\rho^V_W, \rho^W_U)<\ES$}.
\end{enumerate}
\end{lemma}

Finally, \markbox{4645}{we} \markbox{4646}{end} \markbox{4647}{with} \markbox{4648}{a} \markbox{4649}{key} \markbox{4650}{HHS} axiom, \markbox{4651}{originally} \markbox{4652}{proven} \markbox{4653}{for} \markbox{4654}{mapping} \markbox{4655}{class} \markbox{4656}{groups} \markbox{4657}{in} \cite[Theorem 3.1]{MM_II}:

\begin{axiom}[Bounded \markbox{4658}{geodesic} image]\label{ax:BGIA}  \markbox{4659}{If} \markbox{m4660}{$U  \sqsubset V$} \markbox{4661}{and} \markbox{m4662}{$\gamma \in \calC(V)$} \markbox{4663}{is} \markbox{4664}{a} \markbox{4665}{geodesic} \markbox{4666}{with} \markbox{m4667}{$d_{V}(\rho^U_V,\gamma)>\ES$}, \markbox{4668}{then} diam\markbox{m4669}{$(\rho^V_U(\gamma))\leq \ES.$} Furthermore, \markbox{4670}{for} \markbox{4671}{any} \markbox{m4672}{$x,y \in \calX$} \markbox{4673}{and} \markbox{4674}{any} \markbox{4675}{geodesic} \markbox{m4676}{$\gamma$} \markbox{4677}{connecting} \markbox{m4678}{$\pi_V(x),\pi_V(y)$}, \markbox{4679}{if} \markbox{m4680}{$d_{V}(\rho^U_V,\gamma)>\ES$}, \markbox{4681}{then} \markbox{m4682}{$d(\pi_U(x), \pi_U(y)) \leq \ES.$}
\end{axiom} 

\subsection{Hierarchical hulls and related basic facts}

In \markbox{4683}{our} \markbox{4684}{HHS} setup, \markbox{4685}{the} \markbox{4686}{basic} \markbox{4687}{object} \markbox{4688}{we} \markbox{4689}{will} \markbox{4690}{want} \markbox{4691}{to} \markbox{4692}{consider} \markbox{4693}{is} \markbox{4694}{the} \markbox{4695}{following} \markbox{4696}{hierarchical} \markbox{4697}{notion} \markbox{4698}{of} \markbox{4699}{a} \markbox{4700}{coarse} \markbox{4701}{convex} hull.  \markbox{4702}{These} \emph{hierarchical hulls} \markbox{4703}{are} \markbox{4704}{built} \markbox{4705}{out} \markbox{4706}{of} \markbox{4707}{consistent} \markbox{4708}{tuples} \markbox{4709}{of} \markbox{4710}{points} \markbox{4711}{whose} \markbox{4712}{coordinates} \markbox{4713}{are} \markbox{4714}{contained} \markbox{4715}{in} \markbox{4716}{the} \markbox{4717}{hyperbolic} \markbox{4718}{hulls} \markbox{4719}{in} \markbox{4720}{each} domain.  \markbox{4721}{More} specifically, \markbox{4722}{given} \markbox{4723}{a} \markbox{4724}{pair} \markbox{4725}{of} \markbox{4726}{points} \markbox{m4727}{$x,y \in \calX$}, \markbox{4728}{for} each, \markbox{m4729}{$U \in \mathfrak S$}, \markbox{4730}{we} \markbox{4731}{set} \markbox{m4732}{$H_U = \hull_U(\pi_U(\{x,y\}))$}, \markbox{4733}{where} \markbox{m4734}{$\hull_U$} \markbox{4735}{denotes} \markbox{4736}{the} \markbox{4737}{hyperbolic} \markbox{4738}{hull} \markbox{4739}{in} \markbox{m4740}{$\calC(U)$}.

\begin{definition}[Hierarchical hull]\label{defn:hier hull}
Given \markbox{4741}{a} \markbox{4742}{constant} \markbox{m4743}{$\theta>0$}, \markbox{4744}{we} \markbox{4745}{define} \markbox{4746}{the} \emph{$\theta$-hull} \markbox{4747}{of} \markbox{m4748}{$x,y$} \markbox{4749}{to} \markbox{4750}{be} \markbox{4751}{all} \markbox{m4752}{$z \in \calX$} \markbox{4753}{so} \markbox{4754}{that} \markbox{m4755}{$d_U(z, H_U)<\theta$} \markbox{4756}{for} \markbox{4757}{all} \markbox{m4758}{$U \in \mathfrak S$}.
\begin{itemize}
\item We \markbox{4759}{denote} \markbox{4760}{the} \markbox{m4761}{$\theta$}-hull \markbox{4762}{of} \markbox{m4763}{$x,y$} \markbox{4764}{by} \markbox{m4765}{$H_{\theta} = \hull_{\theta}(x,y)$}.
\end{itemize}
\end{definition}

One \markbox{4766}{of} \markbox{4767}{the} \markbox{4768}{key} \markbox{4769}{facts} \markbox{4770}{about} \markbox{4771}{hierarchical} \markbox{4772}{hulls} \markbox{4773}{is} \markbox{4774}{that} \markbox{4775}{they} \markbox{4776}{are} \emph{hierarchically quasiconvex} \cite[Lemma 6.2]{HHS_II}, \markbox{4777}{see} \cite{russell2023convexity} \markbox{4778}{for} \markbox{4779}{more} \markbox{4780}{on} \markbox{4781}{convexity} \markbox{4782}{in} HHSes.  \markbox{4783}{We} \markbox{4784}{do} \markbox{4785}{not} \markbox{4786}{need} \markbox{4787}{this} \markbox{4788}{definition} \markbox{4789}{for} \markbox{4790}{our} purposes, \markbox{4791}{but} \markbox{4792}{we} \markbox{4793}{do} \markbox{4794}{need} \markbox{4795}{the} \markbox{4796}{following} consequence:

\begin{lemma}\label{lem:gate retract}
For \markbox{4797}{any} \markbox{m4798}{$\theta>0$}, \markbox{4799}{there} \markbox{4800}{exists} \markbox{4801}{is} \markbox{4802}{a} \markbox{m4803}{$(J,J)$}-coarse \markbox{4804}{Lipschitz} \markbox{4805}{retract} \markbox{m4806}{$\gate_{H_{\theta}}:\calX \to H_{\theta}$}, \markbox{4807}{where} \markbox{m4808}{$J = J(\theta, \mathfrak S)>0$} .
\end{lemma}

In \markbox{4809}{the} \markbox{4810}{above} lemma, \markbox{4811}{the} \markbox{4812}{map} \markbox{m4813}{$\gate_{H_{\theta}}: \calX \to H_{\theta}$} \markbox{4814}{is} \markbox{4815}{a} \markbox{4816}{hierarchical} \markbox{4817}{analogue} \markbox{4818}{of} \markbox{4819}{a} \markbox{4820}{cubical} \markbox{4821}{gate} map.  \markbox{4822}{When} \markbox{m4823}{$z \in \calX$}, \markbox{4824}{the} \markbox{4825}{point} \markbox{m4826}{$\gate_{H_{\theta}}(z) \in H_{\theta}$} \markbox{4827}{is} \markbox{4828}{defined} \markbox{4829}{by} coordinate-wise closest-point \markbox{4830}{projection} \markbox{4831}{of} \markbox{m4832}{$\pi_U(z)$} \markbox{4833}{to} \markbox{m4834}{$H_U$} \markbox{4835}{and} \markbox{4836}{then} \markbox{4837}{applying} \markbox{4838}{the} \markbox{4839}{Realization} \markbox{4840}{Theorem} \ref{thm:realization}; \markbox{4841}{see} \cite[Proposition 6.3]{HHS_II} \markbox{4842}{and} \markbox{4843}{the} \markbox{4844}{surrounding} \markbox{4845}{text} \markbox{4846}{for} details.







\subsection{Consequences of the Passing-up Lemma \ref{lem:passing-up}}

The \markbox{4847}{following} \markbox{4848}{statements} \markbox{4849}{are} \markbox{4850}{useful} \markbox{4851}{for} \markbox{4852}{the} \markbox{4853}{sort} \markbox{4854}{of} \markbox{4855}{distance} \markbox{4856}{formula} \markbox{4857}{related} \markbox{4858}{hierarchical} \markbox{4859}{accounting} \markbox{4860}{that} \markbox{4861}{we} \markbox{4862}{need} \markbox{4863}{to} \markbox{4864}{do} \markbox{4865}{the} \markbox{4866}{proof} \markbox{4867}{of} \markbox{4868}{the} \markbox{4869}{cubical} \markbox{4870}{model} theorem.  \markbox{4871}{The} \markbox{4872}{first} \markbox{4873}{says} \markbox{4874}{that} \markbox{4875}{any} \markbox{4876}{given} \markbox{4877}{relevant} \markbox{4878}{domain} \markbox{4879}{for} \markbox{4880}{a} \markbox{4881}{pair} \markbox{m4882}{$x,y \in \calX$} \markbox{4883}{can} \markbox{4884}{only} \markbox{4885}{nest} \markbox{4886}{into} boundedly-many \markbox{4887}{other} \markbox{4888}{relevant} \markbox{4889}{domains} \markbox{4890}{for} \markbox{m4891}{$x,y$}.  \markbox{4892}{It} \markbox{4893}{first} \markbox{4894}{appeared} \markbox{4895}{in} \cite[Lemma 2.15]{DMS_bary}; \markbox{4896}{see} \cite[Lemma 11.13]{CRHK} \markbox{4897}{for} \markbox{4898}{a} \markbox{4899}{different} \markbox{4900}{proof} \markbox{4901}{and} \cite[Lemma 4.8]{Dur_infcube} \markbox{4902}{for} \markbox{4903}{a} \markbox{4904}{version} \markbox{4905}{that} \markbox{4906}{allows} \markbox{m4907}{$x,y$} \markbox{4908}{to} \markbox{4909}{be} \markbox{4910}{at} infinity.

\begin{lemma}[Covering]\label{lem:covering}
For \markbox{4911}{any} \markbox{4912}{HHS} \markbox{m4913}{$(\calX, \mathfrak S)$}, \markbox{4914}{there} \markbox{4915}{exists} \markbox{m4916}{$N = N(\mathfrak S)>0$} \markbox{4917}{so} \markbox{4918}{that} \markbox{4919}{the} \markbox{4920}{following} holds.  \markbox{4921}{For} \markbox{4922}{any} \markbox{m4923}{$x,y \in \calX$} \markbox{4924}{and} \markbox{4925}{all} \markbox{m4926}{$U \in \Rel_{50\ES}(x,y)$}, \markbox{4927}{there} \markbox{4928}{are} \markbox{4929}{at} \markbox{4930}{most} \markbox{m4931}{$N$} \markbox{4932}{domains} \markbox{m4933}{$V \in \Rel_{50\ES}(x,y)$} \markbox{4934}{so} \markbox{4935}{that} \markbox{m4936}{$U \nest V$}.
\end{lemma}

Another \markbox{4937}{consequence} \markbox{4938}{of} \markbox{4939}{Lemma} \ref{lem:passing-up} \markbox{4940}{is} \markbox{4941}{the} \markbox{4942}{following} \markbox{4943}{distance} \markbox{4944}{formula} \markbox{4945}{type} statement, \markbox{4946}{which} \markbox{4947}{is} \markbox{4948}{a} \markbox{4949}{less} \markbox{4950}{general} \markbox{4951}{version} \markbox{4952}{of} \cite[Proposition 4.14]{Dur_infcube}.  Roughly, \markbox{4953}{it} \markbox{4954}{says} \markbox{4955}{that} \markbox{4956}{the} \markbox{4957}{number} \markbox{4958}{of} medium-sized \markbox{4959}{relevant} \markbox{4960}{domains} \markbox{4961}{for} \markbox{4962}{a} \markbox{4963}{pair} \markbox{m4964}{$x,y$} \markbox{4965}{can} \markbox{4966}{be} \markbox{4967}{accounted} \markbox{4968}{for} (i.e., \markbox{4969}{in} \markbox{4970}{terms} \markbox{4971}{of} \markbox{4972}{the} \markbox{4973}{domain} projections) \markbox{4974}{by} large-sized \markbox{4975}{domains} \markbox{4976}{higher} \markbox{4977}{up} \markbox{4978}{the} \markbox{4979}{hierarchy} \markbox{4980}{in} \markbox{4981}{a} \markbox{4982}{precise} fashion.  

\begin{proposition}[Bounding \markbox{4983}{large} containers] \label{prop:bounding containers}
Let \markbox{m4984}{$K_1 >50\ES$}, \markbox{m4985}{$K_2 \geq K_1+47\ES$}, \markbox{4986}{and} \markbox{m4987}{$x,y \in \calX$} \markbox{4988}{with} \markbox{m4989}{$\calU_1 = \Rel_{K_1}(x,y), \calU_2 = \Rel_{K_2}(x,y),$} \markbox{4990}{and} \markbox{m4991}{$\calV = \calU_1 - \calU_2$}.  \markbox{4992}{Then} \markbox{4993}{the} \markbox{4994}{following} hold:
\begin{enumerate}
    \item For \markbox{4995}{all} \markbox{4996}{but} \markbox{m4997}{$PU(K_2)-1$} \markbox{4998}{domains} \markbox{m4999}{$V \in \calV$}, \markbox{5000}{there} \markbox{5001}{exists} \markbox{m5002}{$W \in \calU_2$} \markbox{5003}{with} \markbox{m5004}{$V \nest W$}.
    \item For \markbox{5005}{any} \markbox{m5006}{$W \in \calU_2$}, \markbox{5007}{if} \markbox{m5008}{$\calW = \{V \in \calV| V \nest W\}$} \markbox{5009}{then} \markbox{5010}{we} \markbox{5011}{have} \markbox{m5012}{$\#\calW \prec d_W(x,y)$} \markbox{5013}{with} \markbox{5014}{constants} \markbox{5015}{depending} \markbox{5016}{only} \markbox{5017}{on} \markbox{m5018}{$\mathfrak S$} \markbox{5019}{and} \markbox{m5020}{$K_2$}.
\end{enumerate}
\end{proposition}

The \markbox{5021}{above} \markbox{5022}{proposition} \markbox{5023}{is} \markbox{5024}{useful} \markbox{5025}{for} \markbox{5026}{proving} \markbox{5027}{the} \markbox{5028}{following} \markbox{5029}{slight} \markbox{5030}{generalization} \markbox{5031}{of} \markbox{5032}{the} \markbox{5033}{Distance} \markbox{5034}{Formula} \ref{thm:DF}.  It's \markbox{5035}{useful} \markbox{5036}{for} circumstances, \markbox{5037}{such} \markbox{5038}{as} \markbox{5039}{in} \markbox{5040}{Section} \ref{subsec:Q qie}, \markbox{5041}{where} \markbox{5042}{we} \markbox{5043}{want} \markbox{5044}{to} \markbox{5045}{make} \markbox{5046}{distance} formula-type \markbox{5047}{arguments} \markbox{5048}{where} \markbox{5049}{the} \markbox{5050}{summands} \markbox{5051}{are} \markbox{5052}{only} \markbox{5053}{coarsely} \markbox{5054}{equal} \markbox{5055}{to} \markbox{5056}{the} \markbox{5057}{standard} \markbox{5058}{distance} \markbox{5059}{formula} terms.  \markbox{5060}{Probably} \markbox{5061}{the} \markbox{5062}{key} \markbox{5063}{example} \markbox{5064}{of} \markbox{5065}{this} \markbox{5066}{is} \markbox{5067}{when} \markbox{5068}{we} \markbox{5069}{want} \markbox{5070}{to} \markbox{5071}{replace} \markbox{m5072}{$d_U(x,y)$} \markbox{5073}{with} \markbox{m5074}{$d_{T_U}(x,y)$}, \markbox{5075}{where} \markbox{5076}{each} \markbox{m5077}{$T_U$} \markbox{5078}{is} \markbox{5079}{a} \markbox{5080}{uniform} quasi-geodesic \markbox{5081}{in} \markbox{m5082}{$\calC(U)$} \markbox{5083}{between} \markbox{m5084}{$\pi_U(x)$} \markbox{5085}{and} \markbox{m5086}{$\pi_U(y)$}.  \markbox{5087}{This} \markbox{5088}{originally} \markbox{5089}{appeared} \markbox{5090}{in} \cite[Lemma 9.6]{Min_ELC} \markbox{5091}{for} \markbox{5092}{mapping} \markbox{5093}{class} groups, \markbox{5094}{and} \markbox{5095}{see} \cite[Theorem 2.9]{BHMS:kill_twists} (which \markbox{5096}{depends} \markbox{5097}{on} \markbox{5098}{the} \markbox{5099}{distance} formula) \markbox{5100}{and} \cite[Corollary 4.17]{Dur_infcube} (which \markbox{5101}{does} not) \markbox{5102}{for} \markbox{5103}{proofs} \markbox{5104}{in} \markbox{5105}{the} \markbox{5106}{HHS} setting.

\begin{corollary}\label{cor:DF replace}
Let \markbox{m5107}{$x,y \in \calX$}.  \markbox{5108}{Suppose} \markbox{5109}{that} \markbox{m5110}{$\sigma:\mathbb R_+ \to \mathbb R_+$} \markbox{5111}{is} \markbox{5112}{a} \markbox{5113}{function} \markbox{5114}{satisfying} 
$$\sigma(d_U(x,y)) \asymp d_U(x,y)$$
for \markbox{5115}{each} \markbox{m5116}{$U \in \mathfrak S$}, \markbox{5117}{where} \markbox{5118}{the} \markbox{5119}{constants} \markbox{5120}{in} \markbox{m5121}{$\asymp$} \markbox{5122}{are} \markbox{5123}{independent} \markbox{5124}{of} \markbox{m5125}{$U$}.  \markbox{5126}{Then} \markbox{5127}{for} \markbox{5128}{any} \markbox{m5129}{$K_1>50\ES$}, \markbox{5130}{we} have
$$\sum_{U \in \calU} [d_U(x,y)]_{K_1} \asymp \sum_{U \in \calU} [\sigma(d_U(x,y))]_{K_1}$$
where \markbox{5131}{the} \markbox{5132}{constants} \markbox{5133}{in} \markbox{m5134}{$\asymp$} \markbox{5135}{depend} \markbox{5136}{only} \markbox{5137}{on} \markbox{m5138}{$\mathfrak S$}, \markbox{m5139}{$K_1$}, \markbox{5140}{and} \markbox{m5141}{$\sigma$}.
\end{corollary}











\section{From hierarchical hulls to collapsed interval systems} \label{sec:interval systems}

In \markbox{5142}{the} \markbox{5143}{next} \markbox{5144}{three} sections, \markbox{5145}{we} \markbox{5146}{will} \markbox{5147}{give} \markbox{5148}{an} \markbox{5149}{overview} \markbox{5150}{of} \markbox{5151}{the} \markbox{5152}{cubical} \markbox{5153}{model} \markbox{5154}{construction} \markbox{5155}{for} \markbox{5156}{the} \markbox{5157}{hierarchical} \markbox{5158}{hull} \markbox{5159}{of} \markbox{5160}{a} \markbox{5161}{pair} \markbox{5162}{of} \markbox{5163}{points} \markbox{5164}{in} \markbox{5165}{an} \markbox{5166}{HHS} \markbox{5167}{from} \cite{Dur_infcube}.  \markbox{5168}{The} \markbox{5169}{original} \markbox{5170}{construction} \markbox{5171}{is} \markbox{5172}{due} \markbox{5173}{to} Behrstock-Hagen-Sisto \cite{HHS_quasi}, \markbox{5174}{and} \markbox{5175}{see} \markbox{5176}{also} \markbox{5177}{Bowditch} \cite{Bowditch_hulls} \markbox{5178}{for} \markbox{5179}{a} \markbox{5180}{version} \markbox{5181}{in} \markbox{5182}{the} \markbox{5183}{more} \markbox{5184}{general} \markbox{5185}{setting} \markbox{5186}{of} \markbox{5187}{coarse} \markbox{5188}{median} \markbox{5189}{spaces} \markbox{5190}{satisfying} HHS-like axioms.

The \markbox{5191}{main} \markbox{5192}{goal} \markbox{5193}{of} \markbox{5194}{this} \markbox{5195}{section} \markbox{5196}{is} \markbox{5197}{to} \markbox{5198}{explain} \markbox{5199}{how} \markbox{5200}{to} \markbox{5201}{take} \markbox{5202}{a} \markbox{5203}{pair} \markbox{5204}{of} \markbox{5205}{points} \markbox{m5206}{$a,b \in \calX$} \markbox{5207}{in} \markbox{5208}{an} \markbox{5209}{HHS} \markbox{m5210}{$(\calX, \mathfrak S)$} \markbox{5211}{and} \markbox{5212}{produce} \markbox{5213}{a} \markbox{5214}{family} \markbox{5215}{of} \markbox{5216}{intervals} \markbox{5217}{which} \markbox{5218}{encode} \markbox{5219}{the} \markbox{5220}{relevant} \markbox{5221}{hierarchical} \markbox{5222}{data} \markbox{5223}{in} \markbox{5224}{a} \markbox{5225}{fairly} \markbox{5226}{efficient} manner.  Roughly, \markbox{5227}{the} \markbox{5228}{result} \markbox{5229}{of} \markbox{5230}{this} \markbox{5231}{process} \markbox{5232}{is} \markbox{5233}{a} \markbox{5234}{collection} \markbox{5235}{of} \markbox{5236}{intervals} \markbox{m5237}{$\{\hT_U\}_{U \in \calU}$} \markbox{5238}{equipped} \markbox{5239}{with} \markbox{5240}{a} \markbox{5241}{family} \markbox{5242}{of} \markbox{5243}{relative} \markbox{5244}{projections} \markbox{5245}{satisfying} \markbox{5246}{certain} HHS-like properties, \markbox{5247}{where} \markbox{5248}{the} \markbox{5249}{index} \markbox{5250}{set} \markbox{m5251}{$\calU = \Rel_K(a,b)$} \markbox{5252}{is} \markbox{5253}{the} \markbox{5254}{set} \markbox{5255}{of} \markbox{m5256}{$K$}-relevant \markbox{5257}{domains} \markbox{5258}{for} \markbox{m5259}{$a,b$} (Definition \ref{defn:relevant}).  \markbox{5260}{For} \markbox{5261}{any} \markbox{5262}{such} \markbox{5263}{collection} \markbox{5264}{of} intervals, \markbox{5265}{one} \markbox{5266}{can} \markbox{5267}{define} \markbox{5268}{a} \markbox{5269}{notion} \markbox{5270}{of} \markbox{m5271}{$0$}-consistency (an \markbox{5272}{exact} \markbox{5273}{form} \markbox{5274}{of} \markbox{5275}{Definition} \ref{defn:consistency}), \markbox{5276}{which} \markbox{5277}{defines} \markbox{5278}{a} \markbox{5279}{special} \markbox{m5280}{$0$}-consistent \markbox{5281}{subset} \markbox{m5282}{$\calQ$} \markbox{5283}{of} \markbox{5284}{the} \markbox{5285}{product} \markbox{m5286}{$\prod_{U \in \calU} \hT_U$}.  \markbox{5287}{In} \markbox{5288}{Section} \ref{sec:hPsi qi} \markbox{5289}{below} \markbox{5290}{we} \markbox{5291}{will} \markbox{5292}{explain} \markbox{5293}{why} \markbox{5294}{this} \markbox{5295}{set} \markbox{m5296}{$\calQ$} \markbox{5297}{is} quasi-isometric \markbox{5298}{to} \markbox{5299}{the} \markbox{5300}{hierarchical} \markbox{5301}{hull} \markbox{5302}{of} \markbox{m5303}{$a,b$} \markbox{5304}{in} \markbox{m5305}{$\calX$}.  \markbox{5306}{Finally} \markbox{5307}{in} \markbox{5308}{Section} \ref{sec:cubulation}, \markbox{5309}{we} \markbox{5310}{will} \markbox{5311}{axiomatize} \markbox{5312}{the} \markbox{5313}{properties} \markbox{5314}{any} \markbox{5315}{such} \markbox{5316}{family} \markbox{5317}{of} \markbox{5318}{intervals} satisfies, \markbox{5319}{explain} \markbox{5320}{how} \markbox{5321}{it} \markbox{5322}{admits} \markbox{5323}{a} \markbox{5324}{natural} \markbox{5325}{wallspace} structure, \markbox{5326}{and} \markbox{5327}{show} \markbox{5328}{that} \markbox{5329}{the} \markbox{5330}{associated} \markbox{m5331}{$0$}-consistent \markbox{5332}{set} \markbox{m5333}{$\calQ$} \markbox{5334}{is} \markbox{5335}{isometric} \markbox{5336}{to} \markbox{5337}{the} \markbox{5338}{cubical} \markbox{5339}{dual} \markbox{5340}{of} \markbox{5341}{this} wallspace. 


\subsection{Basic setup of the section}

For \markbox{5342}{the} \markbox{5343}{rest} \markbox{5344}{of} \markbox{5345}{this} section, \markbox{5346}{we} \markbox{5347}{fix} \markbox{5348}{a} \markbox{5349}{constant} \markbox{m5350}{$K\geq K_0$}, \markbox{5351}{where} \markbox{m5352}{$K_0 = K_0(\mathfrak S)>0$} \markbox{5353}{is} \markbox{5354}{the} \markbox{5355}{constant} \markbox{5356}{from} \markbox{5357}{the} \markbox{5358}{Distance} \markbox{5359}{Formula} \ref{thm:DF}.  \markbox{5360}{In} \markbox{5361}{this} section, \markbox{5362}{we} \markbox{5363}{will} \markbox{5364}{be} \markbox{5365}{able} \markbox{5366}{to} \markbox{5367}{allow} \markbox{m5368}{$K$} \markbox{5369}{to} \markbox{5370}{be} \markbox{5371}{as} \markbox{5372}{large} \markbox{5373}{as} necessary.

Fix \markbox{5374}{also} \markbox{m5375}{$a, b\in \calX$}.  \markbox{5376}{Let} \markbox{m5377}{$\calU = \Rel_K(a,b) = \{U \in \mathfrak S| d_U(a,b)>K\}$} \markbox{5378}{denote} \markbox{5379}{their} \markbox{m5380}{$K$}-relevant set.  \markbox{5381}{To} \markbox{5382}{each} \markbox{m5383}{$U \in \calU$}, \markbox{5384}{let} \markbox{m5385}{$\phi_U:T_U\to \calC(U)$} \markbox{5386}{denote} \markbox{5387}{a} \markbox{m5388}{$(C,C)$}-quasi-isometric \markbox{5389}{embedding} \markbox{5390}{of} \markbox{5391}{an} \markbox{5392}{interval} \markbox{5393}{between} \markbox{m5394}{$a_U$} \markbox{5395}{and} \markbox{m5396}{$b_U$}, \markbox{5397}{so} \markbox{5398}{that} \markbox{m5399}{$\phi_U(a_U) = \pi_U(a)$} \markbox{5400}{and} \markbox{m5401}{$\phi_U(b_U) = \pi_U(b)$}.  \markbox{5402}{Here} \markbox{5403}{we} \markbox{5404}{can} \markbox{5405}{assume} \markbox{5406}{that} \markbox{m5407}{$C=C(\mathfrak S)>0$} \markbox{5408}{depends} \markbox{5409}{only} \markbox{5410}{on} \markbox{5411}{the} \markbox{5412}{ambient} HHS.  \markbox{5413}{Note} \markbox{5414}{that} \markbox{5415}{we} \markbox{5416}{are} \markbox{5417}{only} \markbox{5418}{taking} \markbox{5419}{a} quasi-isometric embedding, \markbox{5420}{instead} \markbox{5421}{of} \markbox{5422}{a} geodesic, \markbox{5423}{because} \markbox{5424}{that} \markbox{5425}{is} \markbox{5426}{the} \markbox{5427}{level} \markbox{5428}{of} \markbox{5429}{generality} \markbox{5430}{that} \markbox{5431}{we} \markbox{5432}{will} \markbox{5433}{require} later.

We \markbox{5434}{also} \markbox{5435}{set} \markbox{5436}{some} \markbox{5437}{terminology} \markbox{5438}{for} \markbox{m5439}{$a_U,b_U$}, \markbox{5440}{since} \markbox{5441}{they} \markbox{5442}{will} \markbox{5443}{play} \markbox{5444}{a} \markbox{5445}{distinguished} \markbox{5446}{role} below. 

\begin{definition}[Marked \markbox{5447}{points} \markbox{5448}{on} intervals] \label{defn:marked}
For \markbox{5449}{each} \markbox{m5450}{$U\in \calU$} \markbox{5451}{the} \markbox{5452}{points} \markbox{m5453}{$a_U, b_U \in T_U$} \markbox{5454}{are} \markbox{5455}{called} \emph{marked points}.
\end{definition}

We \markbox{5456}{note} \markbox{5457}{that} \markbox{5458}{in} \markbox{5459}{the} \markbox{5460}{basic} \markbox{5461}{construction} \markbox{5462}{explained} \markbox{5463}{in} \markbox{5464}{this} section, \markbox{5465}{marked} \markbox{5466}{points} \markbox{5467}{will} \markbox{5468}{always} \markbox{5469}{been} \markbox{5470}{the} \markbox{5471}{endpoints} \markbox{5472}{of} \markbox{5473}{the} \markbox{5474}{intervals} \markbox{m5475}{$T_U$}.  \markbox{5476}{This} \markbox{5477}{will} \markbox{5478}{also} \markbox{5479}{be} \markbox{5480}{true} \markbox{5481}{of} \markbox{5482}{our} \markbox{5483}{collapsed} \markbox{5484}{stable} \markbox{5485}{trees} \markbox{5486}{defined} \markbox{5487}{in} \markbox{5488}{Subsection} \ref{subsec:collapsed stable intervals}, \markbox{5489}{though} \markbox{5490}{not} \markbox{5491}{necessarily} \markbox{5492}{of} \markbox{5493}{the} \markbox{5494}{stable} \markbox{5495}{intervals} themselves.

The \markbox{5496}{discussion} \markbox{5497}{in} \markbox{5498}{this} \markbox{5499}{section} \markbox{5500}{closely} \markbox{5501}{follows} \cite[Sections 6 \markbox{5502}{and} 7]{Dur_infcube}. \markbox{5503}{Given} \markbox{5504}{the} \markbox{5505}{technical} \markbox{5506}{nature} \markbox{5507}{of} \markbox{5508}{this} part, \markbox{5509}{we} \markbox{5510}{will} \markbox{5511}{mostly} \markbox{5512}{state} \markbox{5513}{definitions} \markbox{5514}{and} \markbox{5515}{important} properties, \markbox{5516}{providing} \markbox{5517}{sketches} \markbox{5518}{where} \markbox{5519}{convenient} \markbox{5520}{but} \markbox{5521}{leaving} \markbox{5522}{the} \markbox{5523}{details} \markbox{5524}{for} \markbox{5525}{the} \markbox{5526}{reader} \markbox{5527}{to} verify.

\subsection{Reduced interval systems} \label{subsec:reduced interval systems}

Our \markbox{5528}{first} \markbox{5529}{goal} \markbox{5530}{is} \markbox{5531}{to} \markbox{5532}{push} \markbox{5533}{the} \markbox{5534}{hierarchical} \markbox{5535}{data} \markbox{5536}{associated} \markbox{5537}{to} \markbox{m5538}{$a,b$} \markbox{5539}{onto} \markbox{5540}{the} \markbox{5541}{family} \markbox{5542}{of} \markbox{5543}{intervals} \markbox{m5544}{$\{T_U\}_{U \in \calU}$}.  \markbox{5545}{This} \markbox{5546}{involves} \markbox{5547}{producing} \markbox{5548}{a} \markbox{5549}{notion} \markbox{5550}{of} \markbox{5551}{relative} \markbox{5552}{projection} \markbox{5553}{between} \markbox{5554}{the} \markbox{5555}{intervals} \markbox{5556}{and} \markbox{5557}{verifying} \markbox{5558}{some} HHS-like \markbox{5559}{properties} \markbox{5560}{for} them.

These \emph{interval projections} \markbox{5561}{are} \markbox{5562}{defined} \markbox{5563}{simply} \markbox{5564}{by} closest-point \markbox{5565}{projecting} \markbox{5566}{the} \markbox{5567}{relative} \markbox{5568}{projections} \markbox{5569}{of} \markbox{m5570}{$(\calX,\mathfrak S)$} \markbox{5571}{to} \markbox{5572}{the} \markbox{5573}{images} \markbox{5574}{of} \markbox{m5575}{$\phi_U(T_U) \subset \calC(U)$} \markbox{5576}{then} \markbox{5577}{pulling} \markbox{5578}{back} \markbox{5579}{to} \markbox{m5580}{$T_U$} \markbox{5581}{via} \markbox{m5582}{$\phi^{-1}_U$}.  \markbox{5583}{We} \markbox{5584}{write} \markbox{m5585}{$\delta^V_U$}, \markbox{5586}{rather} \markbox{5587}{than} \markbox{m5588}{$\rho^V_U$}, \markbox{5589}{for} \markbox{5590}{the} \markbox{5591}{relative} \markbox{5592}{interval} \markbox{5593}{projections} \markbox{5594}{among} \markbox{5595}{the} \markbox{m5596}{$T_U$}.  \markbox{5597}{These} \markbox{5598}{interval} \markbox{5599}{projections} \markbox{5600}{are} \markbox{5601}{interval} \markbox{5602}{versions} \markbox{5603}{of} \markbox{5604}{the} ``tree projections'' \markbox{5605}{described} \markbox{5606}{in} \cite[Section 6]{Dur_infcube}.

The \markbox{5607}{following} lemma, \markbox{5608}{which} \markbox{5609}{summarizes} \markbox{5610}{the} \markbox{5611}{basic} \markbox{5612}{properties} \markbox{5613}{that} \markbox{5614}{we} need, \markbox{5615}{says} \markbox{5616}{that} \markbox{5617}{the} \markbox{m5618}{$\delta^V_U$} \markbox{5619}{behave} \markbox{5620}{in} \markbox{5621}{essentially} \markbox{5622}{the} \markbox{5623}{same} \markbox{5624}{way} \markbox{5625}{as} \markbox{5626}{the} \markbox{m5627}{$\rho^V_U$}.  \markbox{5628}{Its} \markbox{5629}{proof} \markbox{5630}{is} \markbox{5631}{an} \markbox{5632}{exercise} \markbox{5633}{in} \markbox{5634}{the} \markbox{5635}{definitions} \markbox{5636}{and} \markbox{5637}{the} \markbox{5638}{basic} \markbox{5639}{properties} \markbox{5640}{of} \markbox{5641}{an} HHS; \markbox{5642}{see} \cite[Lemma 6.13]{Dur_infcube}.

\begin{lemma}\label{lem:interval control}
For \markbox{5643}{any} \markbox{m5644}{$C>0$} \markbox{5645}{there} \markbox{5646}{exists} \markbox{m5647}{$R_C = R_C(C,\mathfrak S)>0$} \markbox{5648}{so} \markbox{5649}{that} \markbox{5650}{the} \markbox{5651}{following} holds:

\begin{enumerate}
    \item If \markbox{m5652}{$U \pitchfork V \in \calU$}, \markbox{5653}{then} \markbox{5654}{both} \markbox{m5655}{$\delta^V_U \subset T_U$} \markbox{5656}{and} \markbox{m5657}{$\delta^U_V \subset T_V$} \markbox{5658}{are} \markbox{5659}{sets} \markbox{5660}{of} \markbox{5661}{diameter} \markbox{5662}{at} \markbox{5663}{most} \markbox{m5664}{$R_C$} \markbox{5665}{which} \markbox{5666}{are} \markbox{m5667}{$R_C$}-close \markbox{5668}{to} \markbox{5669}{a} \markbox{5670}{marked} \markbox{5671}{point} \markbox{5672}{of} \markbox{m5673}{$T_U,T_V$}, respectively.  Moreover, \markbox{m5674}{$d_U(\phi_U(\delta^V_U), \rho^V_U)<R_C$}, \markbox{5675}{and} \markbox{5676}{similarly} \markbox{5677}{for} \markbox{m5678}{$\delta^U_V$}.
    \item If \markbox{m5679}{$U \nest V \in \calU$}, \markbox{5680}{then} \markbox{m5681}{$\delta^U_V \subset T_V$} \markbox{5682}{has} \markbox{5683}{diameter} \markbox{5684}{bounded} \markbox{5685}{by} \markbox{m5686}{$R_C$}.  Moreover, \markbox{m5687}{$d_V(\phi_V(\delta^U_V), \rho^U_V)<R_C$}.
     \item If \markbox{m5688}{$U, V \nest W \in \calU$} \markbox{5689}{with} \markbox{m5690}{$U,V$} \markbox{5691}{not} transverse, \markbox{5692}{then} \markbox{m5693}{$\diam_{T_W}(\delta^U_W \cup \delta^V_W) < R_C$}.
    \item If \markbox{m5694}{$U \pitchfork V$} \markbox{5695}{and} \markbox{m5696}{$W \nest V$} \markbox{5697}{and} \markbox{m5698}{$W,U$} \markbox{5699}{not} orthogonal, \markbox{5700}{then} \markbox{m5701}{$\diam_{T_U}(\delta^V_U \cup \delta^W_U)<R_C$}.
    \item(Bounded \markbox{5702}{geodesic} image) \markbox{5703}{If} \markbox{m5704}{$U \nest V \in \calU$}, \markbox{5705}{then} \markbox{5706}{any} \markbox{5707}{component} \markbox{m5708}{$C \subset T_V - \calN_{R_C}(\delta^U_V)$} \markbox{5709}{satisfies} \markbox{m5710}{$\diam_{T_U}(\delta^V_U(C))<R_C$}.
  
\end{enumerate}

\end{lemma}

It \markbox{5711}{will} \markbox{5712}{be} \markbox{5713}{useful} \markbox{5714}{for} \markbox{5715}{us} \markbox{5716}{to} \markbox{5717}{abstract} \markbox{5718}{the} \markbox{5719}{properties} \markbox{5720}{obtained} \markbox{5721}{for} \markbox{5722}{the} \markbox{5723}{intervals} \markbox{m5724}{$T_U$} \markbox{5725}{in} \markbox{5726}{the} \markbox{5727}{last} subsection.  \markbox{5728}{We} \markbox{5729}{are} \markbox{5730}{doing} \markbox{5731}{this} \markbox{5732}{so} \markbox{5733}{that} \markbox{5734}{we} \markbox{5735}{can} \markbox{5736}{later} \markbox{5737}{plug} \markbox{5738}{in} \markbox{5739}{the} \markbox{5740}{intervals} \markbox{5741}{produced} \markbox{5742}{by} \markbox{5743}{the} \markbox{5744}{Stable} \markbox{5745}{Interval} \markbox{5746}{Theorem} \ref{thm:stable intervals} \markbox{5747}{below} \markbox{5748}{directly} \markbox{5749}{into} \markbox{5750}{this} setup.

\begin{definition}[Interval system]\label{defn:interval axioms}
Given \markbox{m5751}{$R>0$}, \markbox{5752}{an} \markbox{m5753}{$R$}-\emph{interval system} \markbox{5754}{for} \markbox{m5755}{$a,b \in \calX$} \markbox{5756}{and} \markbox{m5757}{$\calU = \Rel_K(a,b)$} \markbox{5758}{is} \markbox{5759}{the} \markbox{5760}{following} \markbox{5761}{set} \markbox{5762}{of} data:
\begin{enumerate}
\item For \markbox{5763}{each} \markbox{m5764}{$U \in \calU$}, \markbox{5765}{we} \markbox{5766}{have} \markbox{5767}{an} \markbox{5768}{interval} \markbox{m5769}{$T_U$} \markbox{5770}{and} \markbox{5771}{a} \markbox{m5772}{$(R,R)$}-quasi-isometric \markbox{5773}{embedding} \markbox{m5774}{$\phi_U:T_U \to \calC(U)$} \markbox{5775}{so} \markbox{5776}{that} \markbox{m5777}{$d^{Haus}_U(\phi_U(T_U), \hull_U(a,b))<R$}.
\item For \markbox{5778}{each} \markbox{m5779}{$U \in\calU$}, \markbox{5780}{there} \markbox{5781}{exists} \markbox{5782}{a} \markbox{5783}{marked} \markbox{5784}{point} \markbox{m5785}{$a_U \in T_U$} \markbox{5786}{with} \markbox{m5787}{$d_{\calC(U)}(\phi_U(a_U),\pi_U(a))<R$}, \markbox{5788}{and} \markbox{5789}{similarly} \markbox{5790}{for} \markbox{m5791}{$b$}.
\item There \markbox{5792}{are} \markbox{m5793}{$\delta^V_U$} \markbox{5794}{sets} \markbox{5795}{which} \markbox{5796}{satisfy} \markbox{5797}{the} \markbox{5798}{conclusions} \markbox{5799}{of} \markbox{5800}{Lemma} \ref{lem:interval control}.


\end{enumerate}
\end{definition}


\begin{remark}
When \markbox{5801}{stabilizing} \markbox{5802}{the} \markbox{5803}{construction} \markbox{5804}{of} \markbox{5805}{the} \markbox{5806}{cubical} \markbox{5807}{models} \markbox{5808}{in} \markbox{5809}{Section} \ref{sec:stable cubes}, \markbox{5810}{we} \markbox{5811}{will} \markbox{5812}{want} \markbox{5813}{to} \markbox{5814}{use} \markbox{5815}{the} \markbox{5816}{stable} \markbox{5817}{intervals} \markbox{5818}{provided} \markbox{5819}{by} \markbox{5820}{Theorem} \ref{thm:stable intervals} below.  \markbox{5821}{For} these, \markbox{5822}{we} \markbox{5823}{will} \markbox{5824}{induce} \markbox{5825}{an} \markbox{5826}{interval} \markbox{5827}{system} \markbox{5828}{structure} \markbox{5829}{by} \markbox{5830}{a} \markbox{5831}{slightly} \markbox{5832}{more} \markbox{5833}{careful} \markbox{5834}{construction} \markbox{5835}{than} \markbox{5836}{just} \markbox{5837}{working} \markbox{5838}{directly} \markbox{5839}{with} \markbox{5840}{Gromov} trees, e.g. \markbox{5841}{item} (2) \markbox{5842}{in} \markbox{5843}{Definition} \ref{defn:interval axioms} \markbox{5844}{is} \markbox{5845}{immediate} \markbox{5846}{in} \markbox{5847}{that} setting.  \markbox{5848}{But} \markbox{5849}{the} \markbox{5850}{upshot} \markbox{5851}{is} \markbox{5852}{the} same: \markbox{5853}{the} \markbox{5854}{rest} \markbox{5855}{of} \markbox{5856}{the} \markbox{5857}{material} \markbox{5858}{in} \markbox{5859}{this} \markbox{5860}{section} \markbox{5861}{also} \markbox{5862}{holds} \markbox{5863}{for} \markbox{5864}{that} setup.
\end{remark}

\subsection{Interval consistency}

The \markbox{5865}{goal} \markbox{5866}{of} \markbox{5867}{this} \markbox{5868}{subsection} \markbox{5869}{is} \markbox{5870}{to} \markbox{5871}{define} \markbox{5872}{a} \markbox{5873}{map} \markbox{m5874}{$\Psi:\hull_{\calX}(a,b)\to \prod_{U \in \calU} T_U$} \markbox{5875}{and} \markbox{5876}{show} \markbox{5877}{that} \markbox{5878}{its} \markbox{5879}{image} \markbox{5880}{satisfies} \markbox{5881}{the} \markbox{5882}{appropriate} \markbox{5883}{analogue} \markbox{5884}{of} \markbox{5885}{Definition} \ref{defn:consistency} \markbox{5886}{in} \markbox{5887}{this} setting.  \markbox{5888}{Toward} \markbox{5889}{that} end, \markbox{5890}{for} \markbox{5891}{any} \markbox{m5892}{$\alpha>0$}, \markbox{5893}{we} \markbox{5894}{set} \markbox{m5895}{$\calZ_{\alpha} \subset \prod_{U \in \calU} T_U$} \markbox{5896}{to} \markbox{5897}{be} \markbox{5898}{the} \markbox{5899}{set} \markbox{5900}{of} \markbox{m5901}{$\alpha$}-consistent tuples.

We \markbox{5902}{can} \markbox{5903}{now} \markbox{5904}{define} \markbox{5905}{our} \markbox{5906}{map} \markbox{m5907}{$\Psi:H \to \prod_{U \in \calU} T_U$} \markbox{5908}{for} \markbox{m5909}{$H = \hull_{\calX}(a,b)$}.  \markbox{5910}{Let} \markbox{m5911}{$x \in H$} \markbox{5912}{and} \markbox{5913}{for} \markbox{5914}{each} \markbox{m5915}{$U \in \calU$}, \markbox{5916}{let} \markbox{m5917}{$x_U$} \markbox{5918}{denote} \markbox{5919}{a} \markbox{5920}{choice} \markbox{5921}{of} \markbox{5922}{a} \markbox{5923}{point} \markbox{5924}{in} \markbox{m5925}{$\psi_U(x) = \phi_{U}^{-1}(p_U(\pi_U(x))) \subset T_U$}, \markbox{5926}{where} \markbox{m5927}{$p_U:\calC(U)\to \phi_U(T_U)$} \markbox{5928}{is} \markbox{5929}{closest} \markbox{5930}{point} projection.  \markbox{5931}{For} \markbox{5932}{each} \markbox{m5933}{$x \in H$}, \markbox{5934}{this} \markbox{5935}{defines} \markbox{5936}{a} \markbox{5937}{tuple} \markbox{m5938}{$(\psi_U(x)) = (x_U) \in \prod_{U \in \calU}T_U$}.  \markbox{5939}{That} is, \markbox{5940}{the} coordinate-wise \markbox{5941}{maps} \markbox{m5942}{$\psi_U:H \to T_U$} \markbox{5943}{combine} \markbox{5944}{to} \markbox{5945}{a} \markbox{5946}{global} \markbox{5947}{map} \markbox{m5948}{$\Psi:H \to \prod_U T_U$}.

\begin{lemma}\label{lem:interval consistency}
For \markbox{5949}{any} \markbox{m5950}{$R>0$}, \markbox{5951}{there} \markbox{5952}{exists} \markbox{m5953}{$\alpha_0 = \alpha_0(\mathfrak S,R)>0$} \markbox{5954}{so} \markbox{5955}{that} \markbox{5956}{if} \markbox{m5957}{$\{T_U\}_{U \in \calU}$} \markbox{5958}{is} \markbox{5959}{an} \markbox{m5960}{$R$}-interval \markbox{5961}{system} \markbox{5962}{for} \markbox{m5963}{$a,b \in \calX$} \markbox{5964}{and} \markbox{m5965}{$x \in \hull_{\calX}(a,b)$}, \markbox{5966}{then} \markbox{m5967}{$\Psi(x) = (x_U)$} \markbox{5968}{is} \markbox{m5969}{$\alpha_0$}-consistent.
\end{lemma}

\begin{proof}

Let \markbox{m5970}{$x \in \hull_{\calX}(a,b)$}.  \markbox{5971}{The} \markbox{5972}{corresponding} \markbox{5973}{tuple} \markbox{m5974}{$(\pi_U(x_U))$} \markbox{5975}{is} \markbox{m5976}{$O(\theta, \mathfrak S)$}-consistent \markbox{5977}{by} \markbox{5978}{Lemma} \ref{lem:base consistency}.  Moreover, \markbox{5979}{by} \markbox{5980}{definition} \markbox{5981}{of} \markbox{m5982}{$H = \hull_{\calX}(a,b)$} (Definition \ref{defn:hier hull}), \markbox{5983}{we} \markbox{5984}{have} \markbox{m5985}{$d_U(\pi_U(x_U), H_U) < \theta$}, \markbox{5986}{where} \markbox{m5987}{$H_U = \hull_{\calC(U)}(a,b)$} \markbox{5988}{and} \markbox{m5989}{$\theta = \theta(\mathfrak S)>0$}.  \markbox{5990}{Hence} \markbox{m5991}{$d_U(\pi_U(x_U), \phi_U(T_U))<\theta'$} \markbox{5992}{for} \markbox{5993}{some} \markbox{m5994}{$\theta' = \theta'(\mathfrak S, \theta)>0$}.  \markbox{5995}{At} \markbox{5996}{this} point, \markbox{5997}{a} straight-forward \markbox{5998}{argument} \markbox{5999}{using} \markbox{6000}{the} \markbox{6001}{properties} \markbox{6002}{in} \markbox{6003}{Lemma} \ref{lem:interval control} \markbox{6004}{gives} \markbox{6005}{the} \markbox{6006}{required} \markbox{6007}{consistency} \markbox{6008}{constant} \markbox{m6009}{$\alpha_0 = \alpha_0(\mathfrak S, R)$}.  \markbox{6010}{We} \markbox{6011}{leave} \markbox{6012}{the} \markbox{6013}{details} \markbox{6014}{to} \markbox{6015}{the} reader.
\end{proof}



\subsection{Interval thickenings}\label{subsec:thickenings}

Our \markbox{6016}{next} \markbox{6017}{goal} \markbox{6018}{is} \markbox{6019}{to} \markbox{6020}{define} \markbox{6021}{a} \markbox{6022}{way} \markbox{6023}{of} \markbox{6024}{collapsing} \markbox{6025}{the} \markbox{6026}{relative} \markbox{6027}{projection} \markbox{6028}{data} \markbox{6029}{associated} \markbox{6030}{to} \markbox{6031}{intervals} \markbox{m6032}{$T_U$}, i.e. \markbox{6033}{the} \markbox{m6034}{$\delta^V_U$}, \markbox{6035}{in} \markbox{6036}{an} \markbox{6037}{interval} \markbox{6038}{system} \markbox{6039}{to} \markbox{6040}{remove} \markbox{6041}{coarseness} \markbox{6042}{from} \markbox{6043}{the} setup.  \markbox{6044}{The} \markbox{6045}{idea} \markbox{6046}{is} \markbox{6047}{that} \markbox{6048}{Definition} \ref{defn:interval axioms} \markbox{6049}{roughly} \markbox{6050}{encodes} \markbox{6051}{the} \markbox{6052}{projection} \markbox{6053}{data} \markbox{6054}{up} \markbox{6055}{to} \markbox{6056}{a} \markbox{6057}{controlled} error.  \markbox{6058}{In} \markbox{6059}{slightly} \markbox{6060}{more} detail, \markbox{6061}{observe} \markbox{6062}{that} \markbox{6063}{each} \markbox{6064}{interval} \markbox{m6065}{$T_U$} \markbox{6066}{contains} \markbox{6067}{the} \markbox{6068}{relative} \markbox{6069}{projections} \markbox{m6070}{$\delta^V_U$} \markbox{6071}{for} \markbox{m6072}{$V \nest U$}.  \markbox{6073}{We} \markbox{6074}{would} \markbox{6075}{like} \markbox{6076}{to} \markbox{6077}{collect} close-by \markbox{6078}{relative} \markbox{6079}{projections} \markbox{6080}{into} \markbox{6081}{single} \markbox{6082}{intervals} \markbox{6083}{called} \emph{cluster components}, \markbox{6084}{so} \markbox{6085}{that} \markbox{6086}{we} \markbox{6087}{can} \markbox{6088}{later} \markbox{6089}{collapse} them.  \markbox{6090}{One} \markbox{6091}{complication} \markbox{6092}{is} \markbox{6093}{that} \markbox{6094}{the} \markbox{m6095}{$\delta^V_U$} \markbox{6096}{need} \markbox{6097}{not} \markbox{6098}{be} \markbox{6099}{subintervals} \markbox{6100}{of} \markbox{m6101}{$T_U$}, \markbox{6102}{so} \markbox{6103}{we} \markbox{6104}{need} \markbox{6105}{a} \markbox{6106}{couple} \markbox{6107}{of} constants---one \markbox{6108}{to} \markbox{6109}{determine} \markbox{6110}{what} \markbox{6111}{it} \markbox{6112}{means} \markbox{6113}{for} \markbox{6114}{relative} \markbox{6115}{projections} \markbox{6116}{to} \markbox{6117}{be} ``close'', \markbox{6118}{and} \markbox{6119}{the} \markbox{6120}{other} \markbox{6121}{to} \markbox{6122}{guarantee} \markbox{6123}{that} \markbox{6124}{cluster} \markbox{6125}{components} \markbox{6126}{which} \markbox{6127}{are} \markbox{6128}{not} \markbox{6129}{close} \markbox{6130}{satisfy} \markbox{6131}{a} \markbox{6132}{minimum} \markbox{6133}{distance} bound.



We \markbox{6134}{will} \markbox{6135}{use} \markbox{6136}{the} \markbox{6137}{following} \markbox{6138}{slightly} \markbox{6139}{more} \markbox{6140}{abstract} setup, \markbox{6141}{as} \markbox{6142}{it} \markbox{6143}{will} \markbox{6144}{be} \markbox{6145}{useful} \markbox{6146}{later} \markbox{6147}{during} \markbox{6148}{our} \markbox{6149}{stabilization} process:

 \begin{definition}[Thickenings]\label{defn:thickening}
Let \markbox{m6150}{$T$} \markbox{6151}{be} \markbox{6152}{an} \markbox{6153}{interval} \markbox{6154}{with} \markbox{6155}{a} \markbox{6156}{decomposition} \markbox{m6157}{$T = A \cup B$} \markbox{6158}{into} \markbox{6159}{collections} \markbox{6160}{of} segments.  \markbox{6161}{Given} \markbox{m6162}{$r_1,r_2>0$}, \markbox{6163}{the} \markbox{m6164}{$(r_1,r_2)$}-\emph{thickening} \markbox{6165}{of} \markbox{m6166}{$T$} \emph{along $B$} \markbox{6167}{defines} \markbox{6168}{a} \markbox{6169}{decomposition} \markbox{m6170}{$T = \bT_e \cup \bT_c$} \markbox{6171}{into} \emph{edge} \markbox{m6172}{$\bT_e$} \markbox{6173}{and} \emph{cluster} \markbox{m6174}{$\bT_c$} \markbox{6175}{components} \markbox{6176}{as} follows:
\begin{enumerate}
\item First, \markbox{6177}{take} \markbox{6178}{the} \markbox{m6179}{$r_1$}-neighborhoods \markbox{6180}{in} \markbox{m6181}{$T$} \markbox{6182}{of} \markbox{6183}{the} \markbox{6184}{components} \markbox{6185}{of} \markbox{m6186}{$B$}.  \markbox{6187}{Call} \markbox{6188}{the} \markbox{6189}{collection} \markbox{6190}{of} \markbox{6191}{these} \markbox{6192}{neighborhood} \markbox{m6193}{$\calB$}, \markbox{6194}{and} \markbox{6195}{their} \markbox{6196}{complement} \markbox{m6197}{$T - \calB = \calA$}.
\item Second, \markbox{6198}{connect} \markbox{6199}{any} \markbox{6200}{two} \markbox{6201}{subintervals} \markbox{6202}{in} \markbox{m6203}{$\calB$} \markbox{6204}{which} \markbox{6205}{come} \markbox{6206}{within} \markbox{m6207}{$r_2$} \markbox{6208}{of} \markbox{6209}{each} \markbox{6210}{other} \markbox{6211}{in} \markbox{m6212}{$T$} \markbox{6213}{by} \markbox{6214}{the} \markbox{6215}{geodesic} \markbox{6216}{between} them.  \markbox{6217}{Call} \markbox{6218}{the} \markbox{6219}{resulting} \markbox{6220}{collection} \markbox{6221}{of} \markbox{6222}{subintervals} \markbox{m6223}{$\bT_c$} \markbox{6224}{and} \markbox{6225}{set} \markbox{m6226}{$\bT_e = T- \bT_c$}.
\end{enumerate}
\end{definition}



In \markbox{6227}{our} \markbox{6228}{current} context, \markbox{6229}{we} \markbox{6230}{can} \markbox{6231}{take} \markbox{m6232}{$B$} \markbox{6233}{to} \markbox{6234}{be} \markbox{6235}{the} \markbox{6236}{collection} \markbox{6237}{of} \markbox{m6238}{$\delta^V_U \subset T_U$} \markbox{6239}{segments} \markbox{6240}{for} \markbox{m6241}{$V \nest U$} \markbox{6242}{along} \markbox{6243}{with} \markbox{6244}{the} \markbox{6245}{marked} \markbox{6246}{points} \markbox{m6247}{$a_U,b_U$} \markbox{6248}{on} \markbox{m6249}{$T_U$} (Definition \ref{defn:marked}).  \markbox{6250}{Thus} \markbox{6251}{a} \markbox{6252}{thickening} \markbox{6253}{of} \markbox{m6254}{$T_U$} \markbox{6255}{along} \markbox{6256}{this} \markbox{6257}{collection} \markbox{m6258}{$B$} \markbox{6259}{expands} \markbox{6260}{the} \markbox{m6261}{$\delta^V_U$} \markbox{6262}{segments} \markbox{6263}{and} \markbox{m6264}{$a_U,b_U$} \markbox{6265}{and} \markbox{6266}{combines} \markbox{6267}{nearby} expansions.  \markbox{6268}{For} \markbox{6269}{each} \markbox{m6270}{$U \in \calU$}, \markbox{6271}{we} \markbox{6272}{denote} \markbox{6273}{the} \markbox{6274}{resulting} \markbox{6275}{decomposition} \markbox{6276}{of} \markbox{6277}{the} \markbox{6278}{thickened} \markbox{6279}{interval} \markbox{6280}{by} \markbox{m6281}{$T_U = \bT^e_{U} \cup \bT^c_{U}$}.  \markbox{6282}{When} \markbox{6283}{we} \markbox{6284}{perform} \markbox{6285}{an} \markbox{m6286}{$(r_1,r_2)$}-thickening \markbox{6287}{to} \markbox{6288}{each} \markbox{6289}{interval} \markbox{6290}{in} \markbox{6291}{an} \markbox{6292}{interval} system, \markbox{6293}{we} \markbox{6294}{refer} \markbox{6295}{to} \markbox{6296}{the} \markbox{6297}{resulting} \markbox{6298}{collection} \markbox{6299}{of} \markbox{6300}{thickened} \markbox{6301}{intervals} \markbox{6302}{as} \markbox{6303}{a} \markbox{m6304}{$(r_1,r_2)$}-\emph{thickening} \markbox{6305}{of} \markbox{6306}{the} \markbox{6307}{interval} system.

\begin{remark}
In \markbox{6308}{our} context, \markbox{6309}{we} \markbox{6310}{will} \markbox{6311}{be} \markbox{6312}{able} \markbox{6313}{to} \markbox{6314}{control} \markbox{6315}{the} \markbox{6316}{constants} \markbox{m6317}{$r_1,r_2>0$} \markbox{6318}{in} \markbox{6319}{terms} \markbox{6320}{of} \markbox{6321}{the} \markbox{6322}{ambient} HHS, and, importantly, \markbox{6323}{we} \markbox{6324}{will} \markbox{6325}{be} \markbox{6326}{able} \markbox{6327}{to} \markbox{6328}{choose} \markbox{6329}{our} \markbox{6330}{largeness} \markbox{6331}{constant} \markbox{m6332}{$K$} \markbox{6333}{to} \markbox{6334}{be} \markbox{6335}{independent} \markbox{6336}{of} them.
\end{remark}





\subsection{Collapsed intervals and $0$-consistency} \label{subsec:collapsing}

Let \markbox{m6337}{$\{T_U\}_{U \in \calU}$} \markbox{6338}{be} \markbox{6339}{an} \markbox{m6340}{$R$}-interval \markbox{6341}{system} \markbox{6342}{for} \markbox{m6343}{$a,b \in \calX$}.  \markbox{6344}{Fix} \markbox{m6345}{$r_i = r_i(R, \mathfrak S)>0$} \markbox{6346}{for} \markbox{m6347}{$i=1,2$} \markbox{6348}{to} \markbox{6349}{be} \markbox{6350}{determined} soon.  \markbox{6351}{For} \markbox{6352}{each} \markbox{m6353}{$U \in \calU$}, \markbox{6354}{let} \markbox{m6355}{$T_U = \bT^e_U \cup \bT^c_U$} \markbox{6356}{denote} \markbox{6357}{its} \markbox{m6358}{$(r_1,r_2)$}-thickening, \markbox{6359}{as} \markbox{6360}{in} \markbox{6361}{Definition} \ref{defn:thickening}.

Let \markbox{m6362}{$q_U:T_U \to \hT_U$} \markbox{6363}{denote} \markbox{6364}{the} \markbox{6365}{map} \markbox{6366}{which} \markbox{6367}{collapses} \markbox{6368}{each} \markbox{6369}{component} \markbox{6370}{of} \markbox{m6371}{$\bT^c_U$} \markbox{6372}{to} \markbox{6373}{a} point, \markbox{6374}{each} \markbox{6375}{of} \markbox{6376}{which} \markbox{6377}{we} \markbox{6378}{call} \markbox{6379}{a} \emph{collapsed point}.  \markbox{6380}{The} \markbox{6381}{resulting} \markbox{6382}{object} \markbox{m6383}{$\hT_U$} \markbox{6384}{is} \markbox{6385}{an} interval.  \markbox{6386}{Note} \markbox{6387}{that} \markbox{6388}{by} \markbox{6389}{construction} \markbox{m6390}{$a_U, b_U \in \bT^c_U$} \markbox{6391}{for} \markbox{6392}{each} \markbox{m6393}{$U \in \calU$}.  \markbox{6394}{Hence} \markbox{6395}{each} \markbox{6396}{of} \markbox{m6397}{$a_U,b_U$} \markbox{6398}{determines} \markbox{6399}{a} \emph{marked point} \markbox{m6400}{$\ha_U,\hb_U \in \hT_U$}, \markbox{6401}{and} \markbox{6402}{these} \markbox{6403}{marked} \markbox{6404}{points} \markbox{m6405}{$\ha_U,\hb_U$} \markbox{6406}{will} \markbox{6407}{be} \markbox{6408}{the} \markbox{6409}{endpoints} \markbox{6410}{of} \markbox{6411}{the} (collapsed) \markbox{6412}{interval} \markbox{m6413}{$\hT_U$}.  Moreover, \markbox{6414}{the} \markbox{6415}{decomposition} \markbox{m6416}{$T_U = \bT^e_U \cup \bT^c_U$} \markbox{6417}{descends} \markbox{6418}{to} \markbox{6419}{a} \markbox{6420}{decomposition} \markbox{m6421}{$\hT_U = \hT^e_U \cup \hT^c_U$}, \markbox{6422}{where} \markbox{6423}{the} \markbox{6424}{components} \markbox{6425}{of} \markbox{m6426}{$\hT^c_U$} \markbox{6427}{are} \markbox{6428}{the} \markbox{6429}{collapsed} \markbox{6430}{points} \markbox{6431}{corresponding} \markbox{6432}{to} \markbox{6433}{the} \markbox{6434}{components} \markbox{6435}{of} \markbox{m6436}{$\bT^c_U$}, \markbox{6437}{and} \markbox{6438}{the} \markbox{6439}{components} \markbox{6440}{of} \markbox{m6441}{$\hT^e_U$} \markbox{6442}{are} \markbox{6443}{isometric} \markbox{6444}{images} \markbox{6445}{of} \markbox{6446}{the} \markbox{6447}{components} \markbox{6448}{of} \markbox{m6449}{$\bT^e_U$}.

Combining \markbox{6450}{these} \markbox{m6451}{$q_U$} \markbox{6452}{maps} \markbox{6453}{with} \markbox{6454}{our} coordinate-wise \markbox{6455}{projections} \markbox{m6456}{$\psi_U:H \to T_U$}, \markbox{6457}{we} \markbox{6458}{get} coordinate-wise \markbox{6459}{maps} \markbox{m6460}{$\hpsi_U:H \to \hT_U$} \markbox{6461}{to} \markbox{6462}{the} \markbox{6463}{collapsed} intervals, \markbox{6464}{and} \markbox{6465}{hence} \markbox{6466}{combining} \markbox{6467}{these} \markbox{6468}{gives} \markbox{6469}{a} \markbox{6470}{global} \markbox{6471}{map} \markbox{m6472}{$\hPsi:H \to \prod_U \hT_U$}.

We \markbox{6473}{can} \markbox{6474}{define} \emph{collapsed relative projections} \markbox{m6475}{$\hd^V_U$} \markbox{6476}{in} \markbox{6477}{the} \markbox{6478}{obvious} way, \markbox{6479}{by} \markbox{6480}{composing} \markbox{6481}{with} \markbox{6482}{the} \markbox{6483}{quotient} \markbox{6484}{maps} \markbox{m6485}{$q_U$}.  Similarly, \markbox{6486}{consistency} \markbox{6487}{in} \markbox{6488}{this} \markbox{6489}{setting} \markbox{6490}{is} \markbox{6491}{the} \markbox{6492}{appropriate} \markbox{6493}{analogue} \markbox{6494}{of} \markbox{6495}{Definition} \ref{defn:consistency}, \markbox{6496}{except} \markbox{6497}{now} \markbox{6498}{all} \markbox{6499}{coarseness} \markbox{6500}{has} \markbox{6501}{been} removed:

\begin{definition} \label{defn:Q defined}
A \markbox{6502}{tuple} \markbox{m6503}{$(\hx_U) \in \prod_{U \in \calU} \hT_U$} \markbox{6504}{is} \markbox{m6505}{$0$}-\emph{consistent} \markbox{6506}{if} \markbox{6507}{the} \markbox{6508}{following} hold:
\begin{enumerate}
\item For \markbox{6509}{any} \markbox{m6510}{$U \pitchfork V \in \calU$}, \markbox{6511}{either} \markbox{m6512}{$\hx_U = \hd^V_U$} \markbox{6513}{or} \markbox{m6514}{$\hx_V = \hd^U_V$}.
\item For \markbox{6515}{any} \markbox{m6516}{$U \nest V \in \calU$}, \markbox{6517}{either} \markbox{m6518}{$\hx_V = \hd^U_V$} \markbox{6519}{or} \markbox{m6520}{$\hx_U \in \hd^V_U(\hx_V) \subset \hT_U$}.
\end{enumerate}
\begin{itemize}
\item We \markbox{6521}{let} \markbox{m6522}{$\calQ$} \markbox{6523}{denote} \markbox{6524}{set} \markbox{6525}{of} \markbox{m6526}{$0$}-consistent \markbox{6527}{tuples} \markbox{6528}{in} \markbox{m6529}{$\prod_{U \in \calU} \hT_U$}.
\end{itemize}
\end{definition}



We \markbox{6530}{can} \markbox{6531}{prove} \markbox{6532}{that} \markbox{m6533}{$\hPsi$} \markbox{6534}{has} \markbox{6535}{image} \markbox{6536}{in} \markbox{m6537}{$\calQ$}:

\begin{proposition}\label{prop:hPsi defined}
For \markbox{6538}{any} \markbox{m6539}{$R>0$},  \markbox{6540}{there} \markbox{6541}{exists} \markbox{m6542}{$R_1 = R_1(R,\mathfrak S)>0$} \markbox{6543}{so} \markbox{6544}{that} \markbox{6545}{for} \markbox{6546}{any} \markbox{m6547}{$r_1 > R_1$} \markbox{6548}{and} \markbox{m6549}{$r_2>0$}, \markbox{6550}{if} \markbox{m6551}{$\{\hT_U\}_{U \in \calU}$} \markbox{6552}{are} \markbox{6553}{the} \markbox{6554}{collapsed} \markbox{6555}{intervals} \markbox{6556}{associated} \markbox{6557}{to} \markbox{6558}{an} \markbox{m6559}{$(r_1,r_2)$}-thickening \markbox{6560}{of} \markbox{6561}{an} \markbox{m6562}{$R$}-interval \markbox{6563}{system} \markbox{6564}{for} \markbox{m6565}{$a,b \in \calX$} \markbox{6566}{and} \markbox{m6567}{$x \in \hull_{\calX}(a,b)$}, \markbox{6568}{then} \markbox{m6569}{$\hPsi(x) = (\hx_U) \in \calQ$}.
\end{proposition}

\begin{proof}
We \markbox{6570}{need} \markbox{6571}{to} \markbox{6572}{prove} \markbox{m6573}{$0$}-consistency \markbox{6574}{of} \markbox{m6575}{$\hPsi(x)$} \markbox{6576}{as} \markbox{6577}{in} \markbox{6578}{Definition} \ref{defn:Q defined}.

First \markbox{6579}{suppose} \markbox{6580}{that} \markbox{m6581}{$U \pitchfork V \in \calU$}.  \markbox{6582}{Since} \markbox{m6583}{$\Psi(x) = (x_V)$} \markbox{6584}{is} \markbox{m6585}{$\alpha_0$}-consistent \markbox{6586}{by} \markbox{6587}{Lemma} \ref{lem:interval consistency} \markbox{6588}{where} \markbox{m6589}{$\alpha_0=\alpha_0(R,\theta,\mathfrak S)>0$}, \markbox{6590}{we} have, \markbox{6591}{without} \markbox{6592}{loss} \markbox{6593}{of} generality, \markbox{6594}{that} \markbox{m6595}{$d_{T_U}(x_U, \delta^V_U)< \alpha_0$}.  \markbox{6596}{Hence} \markbox{m6597}{$q_U(x_U) = \hd^V_U$} \markbox{6598}{as} \markbox{6599}{long} \markbox{6600}{as} \markbox{m6601}{$r_1 > \alpha_0$}.  

Next \markbox{6602}{suppose} \markbox{6603}{that} \markbox{m6604}{$U \nest V \in \calU$}.  \markbox{6605}{If} \markbox{m6606}{$d_{T_V}(x_V, \delta^U_V)< \alpha_0 < r_1$}, \markbox{6607}{then} \markbox{m6608}{$q_V(x_V) = \hd^U_V$}, \markbox{6609}{and} \markbox{6610}{we} \markbox{6611}{are} done.  Otherwise, \markbox{6612}{we} \markbox{6613}{have} \markbox{m6614}{$\diam_{T_U}(x_U \cup \delta^V_U(x_V))<\alpha_0$} \markbox{6615}{while} \markbox{6616}{also} \markbox{m6617}{$d_{T_V}(x_V, \delta^U_V)>\alpha_0$}.  \markbox{6618}{By} \markbox{6619}{taking} \markbox{m6620}{$\alpha_0 > R$}, \markbox{6621}{we} \markbox{6622}{have} \markbox{6623}{that} \markbox{m6624}{$\diam_{T_U}(\delta^V_U(x_V)\cup f_U)< R$} \markbox{6625}{for} \markbox{6626}{some} \markbox{m6627}{$f \in \{a,b\}$} \markbox{6628}{by} \markbox{6629}{the} \markbox{6630}{BGI} \markbox{6631}{property} \markbox{6632}{in} \markbox{6633}{item} (4) \markbox{6634}{of} \markbox{6635}{Definition} \ref{defn:interval axioms}.  \markbox{6636}{In} particular, \markbox{6637}{setting} \markbox{m6638}{$r_1>\alpha_0 + R$}, \markbox{6639}{then} \markbox{6640}{both} \markbox{m6641}{$x_U$} \markbox{6642}{and} \markbox{m6643}{$\delta^V_U(x_V)$} \markbox{6644}{are} \markbox{6645}{within} \markbox{m6646}{$\alpha_0 + R< r_1$} \markbox{6647}{of} \markbox{m6648}{$f_U$}, \markbox{6649}{and} \markbox{6650}{hence} \markbox{m6651}{$q_U(x_U) = q_V(\delta^V_U(x_V))$}.  Finally, \markbox{6652}{observe} \markbox{6653}{that} \markbox{m6654}{$q^{-1}_V(q_V(x_V))$} \markbox{6655}{is} \markbox{6656}{contained} \markbox{6657}{in} \markbox{6658}{the} \markbox{6659}{component} \markbox{6660}{of} \markbox{m6661}{$T_V - \mathcal{N}_{R}(\delta^U_V)$} \markbox{6662}{containing} \markbox{m6663}{$x_V$}, \markbox{6664}{and} \markbox{6665}{hence} \markbox{m6666}{$q_V(\delta^V_U(x_V)) = \hd^V_U(q_V(x_V))$}.  \markbox{6667}{This} \markbox{6668}{completes} \markbox{6669}{the} proof.
\end{proof}

\subsection{Controlling the collapsed intervals}

In \markbox{6670}{this} subsection, \markbox{6671}{we} \markbox{6672}{record} \markbox{6673}{the} \markbox{6674}{following} \markbox{6675}{technical} lemma, \markbox{6676}{which} \markbox{6677}{is} \markbox{6678}{in} \markbox{6679}{part} \markbox{6680}{a} \markbox{6681}{collapsed} \markbox{6682}{version} \markbox{6683}{of} \markbox{6684}{Lemma} \ref{lem:interval control}, \markbox{6685}{but} \markbox{6686}{also} \markbox{6687}{contains} \markbox{6688}{the} \markbox{6689}{conclusion} \markbox{6690}{of} \markbox{6691}{Proposition} \ref{prop:hPsi defined}.  \markbox{6692}{The} \markbox{6693}{statement} \markbox{6694}{and} \markbox{6695}{its} \markbox{6696}{proof} \markbox{6697}{are} \markbox{6698}{basically} \cite[Lemma 7.13]{Dur_infcube}.

\begin{lemma}[Collapsed \markbox{6699}{interval} control]\label{lem:collapsed interval control}
Let \markbox{m6700}{$R>0$} \markbox{6701}{and} \markbox{m6702}{$r_1 > R_1$} \markbox{6703}{for} \markbox{m6704}{$R_1 = R_1(R,\theta, \mathfrak S)>0$} \markbox{6705}{as} \markbox{6706}{in} \markbox{6707}{Proposition} \ref{prop:hPsi defined}.  \markbox{6708}{There} \markbox{6709}{exists} \markbox{m6710}{$R_2 = R_2(R,\mathfrak S)>0$} \markbox{6711}{so} \markbox{6712}{that} \markbox{6713}{for} \markbox{6714}{any} \markbox{m6715}{$r_2>R_2$}, \markbox{6716}{the} \markbox{6717}{following} \markbox{6718}{hold} \markbox{6719}{for} \markbox{6720}{any} \markbox{m6721}{$(r_1,r_2)$}-thickening \markbox{6722}{of} \markbox{6723}{an} \markbox{m6724}{$R$}-interval \markbox{6725}{system} \markbox{6726}{for} \markbox{m6727}{$a,b \in \calX$}: 
\begin{enumerate}
    \item For \markbox{6728}{any} \markbox{m6729}{$x \in H = \hull_{\calX}(a,b)$}, \markbox{6730}{the} \markbox{6731}{tuple} \markbox{m6732}{$\hPsi(x) \in \calQ$} \markbox{6733}{is} \markbox{m6734}{$0$}-consistent.
    
    \item If \markbox{m6735}{$U \pitchfork V \in \calU$}, \markbox{6736}{then} \markbox{6737}{both} \markbox{m6738}{$\hd^V_U \in \hT_U$} \markbox{6739}{and} \markbox{m6740}{$\hd^U_V \in \hT_V$} \markbox{6741}{are} \markbox{6742}{in} \markbox{m6743}{$\{\ha_U, \hb_U\}$}.
    
    \item If \markbox{m6744}{$U \nest V \in \calU$}, \markbox{6745}{then} \markbox{m6746}{$\hd^U_V$} \markbox{6747}{coincides} \markbox{6748}{with} \markbox{6749}{a} \markbox{6750}{collapsed} point.
    
    \item For \markbox{6751}{any} \markbox{m6752}{$U \in \calU$} \markbox{6753}{and} \markbox{6754}{any} \markbox{m6755}{$x,y \in H$}, \markbox{6756}{we} \markbox{6757}{have} \markbox{m6758}{$d_U(x,y) \asymp d_{T_U}(x_u,y_U)\geq d_{\hT_U}(\hx_U,\hy_U)$}, \markbox{6759}{with} \markbox{6760}{the} \markbox{6761}{constants} \markbox{6762}{in} \markbox{m6763}{$\asymp$} \markbox{6764}{depending} \markbox{6765}{only} \markbox{6766}{on} \markbox{m6767}{$\mathfrak S$} \markbox{6768}{and} \markbox{m6769}{$R$}.
  
    
    \item If \markbox{m6770}{$x,y \in H$} \markbox{6771}{and} \markbox{m6772}{$U \in \calU$} \markbox{6773}{and} \markbox{m6774}{$\hpsi_U(x), \hpsi_U(y)$} \markbox{6775}{are} \markbox{6776}{distinct} \markbox{6777}{collapsed} points, \markbox{6778}{then} \markbox{m6779}{$d_U(x,y) > 50\ES$}.
    
    \item If \markbox{m6780}{$U \in \calU$} \markbox{6781}{is} \markbox{m6782}{$\nest_{\calU}$}-minimal, \markbox{6783}{then} \markbox{m6784}{$d_{\hT_U}(\ha_U,\hb_U) \succ K - 2r_1$}, \markbox{6785}{with} \markbox{6786}{the} \markbox{6787}{constants} \markbox{6788}{in} \markbox{m6789}{$\succ$} \markbox{6790}{depending} \markbox{6791}{only} \markbox{6792}{on} \markbox{m6793}{$\mathfrak S$} \markbox{6794}{and} \markbox{6795}{where} \markbox{m6796}{$K = K(\mathfrak S)>0$} \markbox{6797}{is} \markbox{6798}{chosen} \markbox{6799}{independent} \markbox{6800}{of} \markbox{6801}{the} setup.
    
    \item (Bounded \markbox{6802}{geodesic} image) \markbox{6803}{Suppose} \markbox{m6804}{$V \nest U$}, \markbox{m6805}{$C \subset \hT_U - \hd^V_U$} \markbox{6806}{is} \markbox{6807}{a} component, \markbox{6808}{then} \markbox{m6809}{$\hd^U_V(C)$} \markbox{6810}{is} \markbox{6811}{a} point.  \markbox{6812}{In} particular, \markbox{6813}{if} \markbox{m6814}{$f \in \{a,b\}$} \markbox{6815}{with} \markbox{m6816}{$\hf_U$} \markbox{6817}{contained} \markbox{6818}{in} \markbox{m6819}{$C$}, \markbox{6820}{then} \markbox{m6821}{$\hd^U_V(C) = \hf_V.$}

 \item If \markbox{m6822}{$\hx \in \calQ$}, \markbox{6823}{then} \markbox{m6824}{$\{U \in \calU| \hx_U \notin \{\ha_U,\hb_U\}\}$} \markbox{6825}{is} \markbox{6826}{pairwise} non-transverse, \markbox{6827}{and} \markbox{6828}{hence} \markbox{6829}{has} \markbox{6830}{cardinality} \markbox{6831}{bounded} \markbox{6832}{in} \markbox{6833}{terms} \markbox{6834}{of} \markbox{m6835}{$\mathfrak S$}.
   
    
    \item If \markbox{m6836}{$\hx \in \calQ$}, \markbox{6837}{then} \markbox{m6838}{$E(\hx) = \{U \in \calU| \hx_U \in \hT^e_U\}$} \markbox{6839}{is} \markbox{6840}{pairwise} orthogonal.
    
   
\end{enumerate}
\end{lemma}

\begin{remark}
Item (5) \markbox{6841}{is} \markbox{6842}{notably} \markbox{6843}{the} \markbox{6844}{first} \markbox{6845}{time} \markbox{6846}{that} \markbox{6847}{the} \markbox{6848}{constant} \markbox{m6849}{$r_2$} \markbox{6850}{from} \markbox{6851}{Definition} \ref{defn:thickening} \markbox{6852}{plays} \markbox{6853}{a} \markbox{6854}{substantial} role.  \markbox{6855}{This} \markbox{6856}{is} \markbox{6857}{important} \markbox{6858}{later} \markbox{6859}{in} \markbox{6860}{proving} \markbox{6861}{that} \markbox{6862}{the} \markbox{6863}{map} \markbox{m6864}{$\hPsi:H \to \calQ$} \markbox{6865}{between}  \markbox{m6866}{$0$}-consistent \markbox{6867}{set} \markbox{m6868}{$\calQ$} \markbox{6869}{and} \markbox{6870}{the} \markbox{6871}{hierarchical} \markbox{6872}{hull} \markbox{m6873}{$H = \hull_{\calX}(a,b)$} \markbox{6874}{is} \markbox{6875}{a} quasi-isometry.  \markbox{6876}{Another} \markbox{6877}{notable} \markbox{6878}{statement} \markbox{6879}{is} \markbox{6880}{item} (6), \markbox{6881}{which} \markbox{6882}{is} \markbox{6883}{about} \markbox{m6884}{$\nest_{\calU}$}-minimal domains, \markbox{6885}{namely} \markbox{6886}{domains} \markbox{m6887}{$U$} \markbox{6888}{for} \markbox{6889}{which} \markbox{6890}{no} \markbox{m6891}{$V \in \calU$} \markbox{6892}{has} \markbox{m6893}{$V \nest U$}.  \markbox{6894}{Here} \markbox{6895}{is} \markbox{6896}{where} \markbox{6897}{our} \markbox{6898}{largeness} \markbox{6899}{constant} \markbox{m6900}{$K$} \markbox{6901}{plays} \markbox{6902}{a} \markbox{6903}{crucial} role.  \markbox{6904}{In} particular, \markbox{6905}{since} \markbox{6906}{nothing} \markbox{6907}{nests} \markbox{6908}{into} \markbox{6909}{a} \markbox{m6910}{$\nest_{\calU}$}-minimal \markbox{6911}{domain} \markbox{m6912}{$U$}, \markbox{6913}{the} \markbox{6914}{map} \markbox{m6915}{$q_U: T_U \to \hT_U$} \markbox{6916}{only} \markbox{6917}{collapses} \markbox{6918}{the} \markbox{m6919}{$r_1$}-neighborhood \markbox{6920}{of} \markbox{6921}{each} endpoint, \markbox{6922}{and} \markbox{6923}{hence} \markbox{6924}{the} \markbox{6925}{diameter} \markbox{6926}{of} \markbox{m6927}{$\hT_U$} \markbox{6928}{is} \markbox{6929}{coarsely} \markbox{6930}{bounded} \markbox{6931}{below} \markbox{6932}{by} \markbox{m6933}{$K$}.  \markbox{6934}{This} \markbox{6935}{is} \markbox{6936}{also} \markbox{6937}{important} \markbox{6938}{for} \markbox{6939}{confirming} \markbox{6940}{that} \markbox{m6941}{$\hPsi:H \to \calQ$} \markbox{6942}{is} \markbox{6943}{a} quasi-isometry; \markbox{6944}{see} \markbox{6945}{Section} \ref{sec:hPsi qi} below.
\end{remark}

\begin{proof}
Item (1) \markbox{6946}{is}  \markbox{6947}{Proposition} \ref{prop:hPsi defined}.  \markbox{6948}{Item} (2)follows \markbox{6949}{from} \markbox{6950}{item} (2) \markbox{6951}{of} \markbox{6952}{Definition} \ref{defn:interval axioms} \markbox{6953}{by} \markbox{6954}{choosing} \markbox{m6955}{$r_1>2R$}.  Similarly, \markbox{6956}{item} (3) \markbox{6957}{follows} \markbox{6958}{from} \markbox{6959}{Definition} \ref{defn:interval axioms} (namely, \markbox{6960}{item} (1) \markbox{6961}{of} \markbox{6962}{Lemma} \ref{lem:interval control}) \markbox{6963}{by} \markbox{6964}{choosing} \markbox{m6965}{$r_1 > 2R$}.  

Item (4) \markbox{6966}{follows} \markbox{6967}{directly} \markbox{6968}{from} \markbox{6969}{the} \markbox{6970}{construction} \markbox{6971}{and} \markbox{6972}{item} (3) \markbox{6973}{of} \markbox{6974}{Definition} \ref{defn:interval axioms}.

Item (4) \markbox{6975}{is} \markbox{6976}{an} \markbox{6977}{immediate} \markbox{6978}{consequence} \markbox{6979}{of} \markbox{6980}{the} \markbox{6981}{definition} \markbox{6982}{of} \markbox{6983}{the} \markbox{6984}{hull} \markbox{m6985}{$H$} (Definition \ref{defn:hier hull}) \markbox{6986}{and} \markbox{6987}{the} \markbox{6988}{construction} \markbox{6989}{in} \markbox{6990}{this} subsection.  \markbox{6991}{In} particular, \markbox{6992}{by} \markbox{6993}{assumption} \markbox{m6994}{$\phi_U:T_U \to \calC(U)$} \markbox{6995}{is} \markbox{6996}{an} \markbox{m6997}{$(R,R)$}-quasi-geodesic \markbox{6998}{between} \markbox{m6999}{$\pi_U(a), \pi_U(b)$}, \markbox{7000}{giving} \markbox{7001}{the} \markbox{7002}{coarse} equality, \markbox{7003}{while} \markbox{7004}{the} \markbox{7005}{inequality} \markbox{7006}{follows} \markbox{7007}{because} \markbox{m7008}{$q_U:T_U\to \hT_U$} \markbox{7009}{collapses} \markbox{7010}{subintervals} \markbox{7011}{and} \markbox{7012}{therefore} \markbox{7013}{is} \markbox{7014}{distance} non-increasing.


For \markbox{7015}{item} (5), \markbox{7016}{if} \markbox{m7017}{$\hpsi_U(x),\hpsi_U(y)$} \markbox{7018}{are} \markbox{7019}{in} \markbox{7020}{distinct} clusters, \markbox{7021}{then} \markbox{m7022}{$d_{T_U}(x,y) > r_2$}, \markbox{7023}{and} \markbox{7024}{hence} \markbox{m7025}{$d_U(x,y) \succ r_2$} \markbox{7026}{by} \markbox{7027}{item} (4).  \markbox{7028}{Hence} \markbox{7029}{choosing} \markbox{m7030}{$r_2$} \markbox{7031}{large} \markbox{7032}{enough} \markbox{7033}{gives} \markbox{7034}{the} \markbox{7035}{desired} \markbox{7036}{lower} bound.

For \markbox{7037}{item} (6): \markbox{7038}{When} \markbox{m7039}{$U \in \calU$} \markbox{7040}{is} \markbox{m7041}{$\nest_{\calU}$}-minimal \markbox{7042}{with} \markbox{7043}{respect} \markbox{7044}{to} \markbox{m7045}{$\calU$}, \markbox{7046}{then} \markbox{m7047}{$q_U:T_U \to \hT_U$} \markbox{7048}{only} \markbox{7049}{collapses} \markbox{7050}{the} \markbox{m7051}{$r_1$}-neighborhoods \markbox{7052}{of} \markbox{m7053}{$a_U,b_U$} \markbox{7054}{in} \markbox{m7055}{$T_U$}.  \markbox{7056}{Since} \markbox{m7057}{$d_U(a,b)>K$} \markbox{7058}{by} assumption, \markbox{7059}{it} \markbox{7060}{follows} \markbox{7061}{that} \markbox{m7062}{$d_{T_U}(a_U,b_U) \succ K$}, \markbox{7063}{while} \markbox{7064}{the} \markbox{7065}{map} \markbox{m7066}{$q_U:T_U \to \hT_U$} \markbox{7067}{only} \markbox{7068}{collapses} \markbox{7069}{the} \markbox{m7070}{$r_1$}-neighborhoods \markbox{7071}{of} \markbox{m7072}{$a_U,b_U$}.  \markbox{7073}{Thus} \markbox{7074}{provided} \markbox{7075}{that} \markbox{m7076}{$K -2r_1 > r_2$} (which \markbox{7077}{we} \markbox{7078}{can} arrange), \markbox{7079}{the} \markbox{7080}{claim} follows.



For \markbox{7081}{item} (7): \markbox{7082}{By} \markbox{7083}{item} (1), \markbox{7084}{if} \markbox{m7085}{$\hf_U$} \markbox{7086}{is} \markbox{7087}{a} \markbox{7088}{marked} point, \markbox{7089}{then} \markbox{m7090}{$0$}-consistency \markbox{7091}{of} \markbox{m7092}{$(\hf_V) = \hPsi(f)$} \markbox{7093}{implies} \markbox{7094}{that} \markbox{m7095}{$\hd^U_V(\hf_U) = \hf_V$} \markbox{7096}{because} \markbox{m7097}{$d_{T_U}(\delta^V_U(f_U),f_V)<\alpha_0 < r_1$}, \markbox{7098}{where} \markbox{7099}{we} \markbox{7100}{note} \markbox{7101}{that} \markbox{m7102}{$\alpha_0 = \alpha_0(R, \mathfrak S)>0$} \markbox{7103}{by} \markbox{7104}{Lemma} \ref{lem:interval consistency}.  \markbox{7105}{On} \markbox{7106}{the} \markbox{7107}{other} hand, \markbox{7108}{since} \markbox{m7109}{$C \cap \hd^V_U = \emptyset$}, \markbox{7110}{we} \markbox{7111}{have} \markbox{m7112}{$d_{T_U}(q^{-1}_U(C), \delta^V_U)>R$}.  \markbox{7113}{Hence} \markbox{7114}{item} (4) \markbox{7115}{of} \markbox{7116}{Definition} \ref{defn:interval axioms} \markbox{7117}{says} \markbox{7118}{that} \markbox{m7119}{$\diam_{T_V}(\delta^U_V(C))<R$}, \markbox{7120}{while} \markbox{7121}{also} \markbox{m7122}{$\delta^U_V(f_U) \subset \delta^V_U(C)$}.  \markbox{7123}{Hence} \markbox{m7124}{$d_{T_V}(\delta^U_V(C), f_V)<\alpha_0 + R<r_1$}, \markbox{7125}{where} \markbox{7126}{we} \markbox{7127}{guarantee} \markbox{7128}{the} \markbox{7129}{last} \markbox{7130}{inequality} \markbox{7131}{by} \markbox{7132}{increasing} \markbox{m7133}{$r_1$} \markbox{7134}{as} necessary.  \markbox{7135}{It} \markbox{7136}{follows} \markbox{7137}{then} \markbox{7138}{that} \markbox{m7139}{$\hd^U_V(C) = \hf_V$}, \markbox{7140}{as} claimed.



For \markbox{7141}{item} (8): \markbox{7142}{Suppose} \markbox{m7143}{$U, V$} \markbox{7144}{are} \markbox{7145}{transverse} \markbox{7146}{and} \markbox{m7147}{$\hx_U \notin  \{\ha_U, \hb_U\}$}.  \markbox{7148}{Since} \markbox{m7149}{$\hd^V_U \in \{\ha_U,\hb_U\}$} \markbox{7150}{by} \markbox{7151}{item} (2) \markbox{7152}{and} \markbox{7153}{hence} \markbox{m7154}{$\hx_U \neq \hd^V_U$}, \markbox{7155}{it} \markbox{7156}{follows} \markbox{7157}{from} \markbox{m7158}{$0$}-consistency \markbox{7159}{of} \markbox{m7160}{$\hx$} \markbox{7161}{that} \markbox{m7162}{$\hx_V = \hd^U_V$}.  \markbox{7163}{Thus} \markbox{m7164}{$\hx_V \in \{\ha_V,\hb_V\}$} \markbox{7165}{and} \markbox{7166}{so} \markbox{7167}{the} \markbox{7168}{set} \markbox{7169}{in} \markbox{7170}{the} \markbox{7171}{statement} \markbox{7172}{of} \markbox{7173}{item} (8) \markbox{7174}{is} \markbox{7175}{pairwise} non-transverse, \markbox{7176}{and} \markbox{7177}{hence} \markbox{7178}{has} \markbox{7179}{bounded} \markbox{7180}{complexity} \markbox{7181}{by} \markbox{7182}{item} (2) \markbox{7183}{in} \markbox{7184}{Subsection} \ref{subsec:basic HHS}.

Finally, \markbox{7185}{for} \markbox{7186}{item} (9): \markbox{7187}{Recall} \markbox{7188}{that} \markbox{m7189}{$\hT^e_U = \hT_U - \hT^c_U$}, \markbox{7190}{where} \markbox{m7191}{$\hT^c_U$} \markbox{7192}{are} \markbox{7193}{the} \markbox{7194}{collapsed} points.  \markbox{7195}{Hence} \markbox{m7196}{$E(\hx)$} \markbox{7197}{is} \markbox{7198}{the} \markbox{7199}{set} \markbox{7200}{of} \markbox{7201}{domains} \markbox{7202}{where} \markbox{m7203}{$\hx_U$} \markbox{7204}{is} \markbox{7205}{not} \markbox{7206}{a} \markbox{7207}{collapsed} point.  \markbox{7208}{Supposing} \markbox{7209}{that} \markbox{m7210}{$U,V$} \markbox{7211}{are} \markbox{7212}{neither} \markbox{7213}{orthogonal} \markbox{7214}{nor} (by \markbox{7215}{item} (8)) transverse.  \markbox{7216}{When} \markbox{m7217}{$V \nest U$} \markbox{7218}{and} \markbox{m7219}{$\hx_U = \hd^V_U$}, \markbox{7220}{we} \markbox{7221}{are} \markbox{7222}{done} \markbox{7223}{by} \markbox{7224}{items} (1) \markbox{7225}{and} (3).  \markbox{7226}{When} \markbox{m7227}{$V \nest U$} \markbox{7228}{and} \markbox{m7229}{$\hx_U \neq \hd^V_U$}, \markbox{7230}{item} (7) \markbox{7231}{implies} \markbox{7232}{there} \markbox{7233}{is} \markbox{7234}{some} \markbox{m7235}{$f \in \{a,b\}$} \markbox{7236}{so} \markbox{7237}{that} \markbox{m7238}{$\hd^U_V(\hx_U) = \hf_V$}, \markbox{7239}{while} \markbox{m7240}{$0$}-consistency \markbox{7241}{says} \markbox{7242}{that} \markbox{m7243}{$\hx_V = \hd^U_V(\hx_U)$}, \markbox{7244}{giving} \markbox{m7245}{$\hx_V = \hf_V$}.  \markbox{7246}{Hence} \markbox{7247}{if} \markbox{m7248}{$U$} \markbox{7249}{and} \markbox{m7250}{$V$} \markbox{7251}{are} \markbox{7252}{not} orthogonal, \markbox{7253}{then} \markbox{7254}{one} \markbox{7255}{of} \markbox{m7256}{$\hx_U$} \markbox{7257}{or} \markbox{m7258}{$\hx_V$} \markbox{7259}{must} \markbox{7260}{be} \markbox{7261}{a} \markbox{7262}{collapsed} point, \markbox{7263}{proving} \markbox{7264}{this} item.  \markbox{7265}{This} \markbox{7266}{completes} \markbox{7267}{the} proof.



\end{proof}














\section{$\hPsi:H \to \calQ$ is a quasi-isometry} \label{sec:hPsi qi}

In \markbox{7268}{this} section, \markbox{7269}{we} \markbox{7270}{explain} \markbox{7271}{why} \markbox{7272}{the} \markbox{7273}{map} \markbox{m7274}{$\hPsi:H \to \calQ$} (Proposition \ref{prop:hPsi defined}) \markbox{7275}{between} \markbox{7276}{the} \markbox{7277}{hierarchical} \markbox{7278}{hull} \markbox{m7279}{$H = \hull_{\calX}(a,b)$} \markbox{7280}{of} \markbox{7281}{a} \markbox{7282}{pair} \markbox{7283}{of} \markbox{7284}{points} \markbox{m7285}{$a,b \in \calX$} \markbox{7286}{and} \markbox{7287}{the} \markbox{m7288}{$0$}-consistent \markbox{7289}{set} \markbox{7290}{associated} \markbox{7291}{to} \markbox{7292}{any} \markbox{7293}{sufficiently} \markbox{7294}{wide} \markbox{m7295}{$(r_1,r_2)$}-thickening \markbox{7296}{of} \markbox{7297}{an} \markbox{m7298}{$R$}-interval \markbox{7299}{system} \markbox{7300}{for} \markbox{m7301}{$a,b$} \markbox{7302}{is} \markbox{7303}{a} quasi-isometry.  \markbox{7304}{There} \markbox{7305}{are} \markbox{7306}{two} \markbox{7307}{main} \markbox{7308}{parts} \markbox{7309}{to} this:

\begin{enumerate}
\item Proving \markbox{7310}{that} \markbox{m7311}{$\hPsi:H \to \calQ$} \markbox{7312}{is} \markbox{7313}{a} quasi-isometric embedding, and
\item Proving \markbox{7314}{that} \markbox{m7315}{$\hPsi$} \markbox{7316}{is} \markbox{7317}{coarsely} surjective.  \markbox{7318}{This} \markbox{7319}{is} \markbox{7320}{accomplished} \markbox{7321}{by} \markbox{7322}{defining} \markbox{7323}{a} \markbox{7324}{coarse} \markbox{7325}{inverse} \markbox{m7326}{$\hO:\calQ \to H$}, \markbox{7327}{so} \markbox{7328}{that} \markbox{m7329}{$\hPsi \circ \hO$} \markbox{7330}{is} \markbox{7331}{coarsely} \markbox{7332}{the} \markbox{7333}{identity} \markbox{7334}{on} \markbox{m7335}{$\calQ$}.
\end{enumerate}

As \markbox{7336}{we} \markbox{7337}{shall} see, \markbox{7338}{these} \markbox{7339}{two} \markbox{7340}{results} \markbox{7341}{have} \markbox{7342}{fairly} \markbox{7343}{different} flavors---(1) \markbox{7344}{is} \markbox{7345}{essentially} \markbox{7346}{purely} hierarchical, \markbox{7347}{while} (2) \markbox{7348}{has} \markbox{7349}{distinctly} \markbox{7350}{cubical} elements.  \markbox{7351}{Item} (1) \markbox{7352}{essentially} \markbox{7353}{says} \markbox{7354}{that} \markbox{7355}{one} \markbox{7356}{can} \markbox{7357}{encode} \markbox{7358}{the} \markbox{7359}{distance} \markbox{7360}{formula} \markbox{7361}{in} \markbox{m7362}{$\calX$} \markbox{7363}{as} \markbox{7364}{the} \markbox{m7365}{$\ell^1$}-distance \markbox{7366}{in} \markbox{7367}{a} \markbox{7368}{product} \markbox{7369}{of} intervals.  \markbox{7370}{Its} \markbox{7371}{proof} \markbox{7372}{involves} \markbox{7373}{mostly} \markbox{7374}{distance} formula-type \markbox{7375}{arguments} \markbox{7376}{and} \markbox{7377}{we} \markbox{7378}{present} \markbox{7379}{it} \markbox{7380}{in} full.  \markbox{7381}{On} \markbox{7382}{the} \markbox{7383}{other} hand, \markbox{7384}{the} \markbox{7385}{proof} \markbox{7386}{of} \markbox{7387}{item} (2), \markbox{7388}{which} \markbox{7389}{is} \markbox{7390}{contained} \markbox{7391}{in} \cite[Sections 9--11]{Dur_infcube}, \markbox{7392}{is} \markbox{7393}{rather} \markbox{7394}{involved} \markbox{7395}{and} \markbox{7396}{many} \markbox{7397}{of} \markbox{7398}{the} \markbox{7399}{details} \markbox{7400}{of} \markbox{7401}{the} \markbox{7402}{argument} \markbox{7403}{are} \markbox{7404}{not} \markbox{7405}{crucial} \markbox{7406}{to} \markbox{7407}{our} \markbox{7408}{expository} \markbox{7409}{purposes} \markbox{7410}{in} \markbox{7411}{this} article.  Thus, \markbox{7412}{in} \markbox{7413}{this} section, \markbox{7414}{we} \markbox{7415}{will} \markbox{7416}{mostly} \markbox{7417}{explain} \markbox{7418}{the} \markbox{7419}{basics} \markbox{7420}{of} \markbox{7421}{the} construction, \markbox{7422}{including} \markbox{7423}{the} \markbox{7424}{points} \markbox{7425}{where} \markbox{7426}{our} \markbox{7427}{simpler} \markbox{7428}{setting} \markbox{7429}{simplifies} \markbox{7430}{things} considerably.

The \markbox{7431}{one} \markbox{7432}{exception} \markbox{7433}{here} \markbox{7434}{is} \markbox{7435}{the} \markbox{7436}{Tree} \markbox{7437}{Trimming} \markbox{7438}{Theorem} \ref{thm:tree trimming}, \markbox{7439}{which} \markbox{7440}{is} \markbox{7441}{a} distance-formula \markbox{7442}{like} \markbox{7443}{tool} \markbox{7444}{that} \markbox{7445}{we} \markbox{7446}{need} \markbox{7447}{both} \markbox{7448}{here} \markbox{7449}{and} \markbox{7450}{for} \markbox{7451}{our} \markbox{7452}{stability} \markbox{7453}{results} \markbox{7454}{in} \markbox{7455}{Section} \ref{sec:stable cubes}.  \markbox{7456}{We} \markbox{7457}{will} \markbox{7458}{discuss} \markbox{7459}{it} \markbox{7460}{in} \markbox{7461}{detail} \markbox{7462}{and} \markbox{7463}{present} \markbox{7464}{its} \markbox{7465}{proof} \markbox{7466}{in} \markbox{7467}{Appendix} \ref{app:TT}.

For \markbox{7468}{the} \markbox{7469}{rest} \markbox{7470}{of} \markbox{7471}{this} section, \markbox{7472}{fix} \markbox{m7473}{$a,b \in \calX$} \markbox{7474}{and} \markbox{7475}{let} \markbox{m7476}{$H = \hull_{\calX}(a,b)$} \markbox{7477}{to} \markbox{7478}{be} \markbox{7479}{their} \markbox{7480}{hierarchical} hull.  \markbox{7481}{Fix} \markbox{7482}{a} \markbox{7483}{largeness} \markbox{7484}{constant} \markbox{m7485}{$K$}, \markbox{7486}{which} \markbox{7487}{we} \markbox{7488}{will} \markbox{7489}{be} \markbox{7490}{able} \markbox{7491}{to} \markbox{7492}{control} \markbox{7493}{relative} \markbox{7494}{to} \markbox{7495}{all} \markbox{7496}{other} \markbox{7497}{involved} constants, \markbox{7498}{and} \markbox{7499}{set} \markbox{m7500}{$\calU = \Rel_K(a,b)$}.  Finally, \markbox{7501}{fix} \markbox{m7502}{$R>0$} \markbox{7503}{and} \markbox{7504}{an} \markbox{m7505}{$R$}-interval \markbox{7506}{system} \markbox{m7507}{$\{T_U\}_{U \in \calU}$} \markbox{7508}{for} \markbox{m7509}{$a,b$}.  \markbox{7510}{Let} \markbox{m7511}{$\{\hT_U\}_{U \in \calU}$} \markbox{7512}{denote} \markbox{7513}{the} \markbox{7514}{family} \markbox{7515}{of} \markbox{7516}{collapsed} \markbox{7517}{intervals} \markbox{7518}{corresponding} \markbox{7519}{to} \markbox{7520}{an} \markbox{m7521}{$(r_1,r_2)$}-thickening, \markbox{7522}{where} \markbox{m7523}{$r_i = r_i(R,\theta,\mathfrak S)>0$} \markbox{7524}{are} \markbox{7525}{provided} \markbox{7526}{by} \markbox{7527}{Proposition} \ref{prop:hPsi defined} \markbox{7528}{and} \markbox{7529}{Lemma} \ref{lem:collapsed interval control}.

\subsection{$\hPsi:H \to \calQ$ is a quasi-isometric embedding}\label{subsec:Q qie}

The \markbox{7530}{content} \markbox{7531}{of} \markbox{7532}{this} \markbox{7533}{subsection} \markbox{7534}{is} \markbox{7535}{roughly} \markbox{7536}{contained} \markbox{7537}{in} \cite[Section 8]{Dur_infcube}.  

Before \markbox{7538}{we} \markbox{7539}{state} \markbox{7540}{the} result, \markbox{7541}{we} \markbox{7542}{set} \markbox{7543}{some} \markbox{7544}{additional} notation: \markbox{7545}{For} \markbox{7546}{numbers} \markbox{m7547}{$A,B$}, \markbox{7548}{the} \markbox{7549}{notation} \markbox{m7550}{$[A]_B$} \markbox{7551}{means} \markbox{m7552}{$0$} \markbox{7553}{when} \markbox{m7554}{$A<B$} \markbox{7555}{and} \markbox{m7556}{$A$} \markbox{7557}{when} \markbox{m7558}{$A\geq B$}.  \markbox{7559}{For} \markbox{m7560}{$x \in H$} \markbox{7561}{and} \markbox{m7562}{$U \in \calU$}, \markbox{7563}{we} \markbox{7564}{will} write
\begin{itemize}
\item \markbox{m7565}{$x = \pi_U(x) \in \calC(U)$};
\item \markbox{m7566}{$x_U = \psi_U(x) \in T_U$};
\item \markbox{m7567}{$\hx_U = \hpsi_U(x) \in \hT_U$}.
\end{itemize}

\begin{theorem}\label{thm:Q distance estimate}
There \markbox{7568}{exists} \markbox{m7569}{$K_1 = K_1(\mathfrak S)>0$} \markbox{7570}{so} \markbox{7571}{that} \markbox{7572}{for} \markbox{7573}{any} \markbox{m7574}{$K_2 \geq K_1$} \markbox{7575}{and} \markbox{7576}{any} \markbox{m7577}{$x, y \in H$}, \markbox{7578}{we} \markbox{7579}{have} that
$$d_{\calX}(a,b) \asymp \sum_{U \in \mathfrak S} [d_U(x,y)]_{K_2} \asymp \sum_{U \in \calU} d_{\hT_U}(\hx_U,\hy_U)$$
where \markbox{7580}{the} \markbox{7581}{constants} \markbox{7582}{in} \markbox{m7583}{$\asymp$} \markbox{7584}{only} \markbox{7585}{depend} \markbox{7586}{on} \markbox{m7587}{$\mathfrak S$} \markbox{7588}{and} \markbox{7589}{the} \markbox{7590}{choice} \markbox{7591}{of} \markbox{m7592}{$K_2$}.
\end{theorem}

We \markbox{7593}{note} \markbox{7594}{that} \markbox{7595}{the} \markbox{7596}{left} \markbox{7597}{coarse} \markbox{7598}{equality} \markbox{7599}{of} \markbox{7600}{the} \markbox{7601}{above} \markbox{7602}{statement} \markbox{7603}{is} \markbox{7604}{simply} \markbox{7605}{the} \markbox{7606}{Distance} \markbox{7607}{Formula} \ref{thm:DF}, \markbox{7608}{hence} \markbox{7609}{the} \markbox{7610}{content} \markbox{7611}{is} \markbox{7612}{the} \markbox{7613}{right} \markbox{7614}{coarse} equality.  \markbox{7615}{In} fact, \markbox{7616}{one} \markbox{7617}{can} \markbox{7618}{obtain} \markbox{7619}{the} (more difficult) lower-bound \markbox{7620}{in} \markbox{7621}{the} \markbox{7622}{distance} \markbox{7623}{formula} \markbox{7624}{by} \markbox{7625}{combining} \markbox{7626}{the} \markbox{7627}{above} \markbox{7628}{theorem} \markbox{7629}{with} \markbox{7630}{the} \markbox{7631}{construction} \markbox{7632}{of} \markbox{7633}{hierarchy} \markbox{7634}{paths} \markbox{7635}{via} \markbox{7636}{cubical} models, \markbox{7637}{as} \markbox{7638}{we} \markbox{7639}{do} \markbox{7640}{below} \markbox{7641}{in} \markbox{7642}{Corollary} \ref{cor:DF lower bound}.

Before \markbox{7643}{beginning} \markbox{7644}{the} \markbox{7645}{discussion} \markbox{7646}{of} \markbox{7647}{the} \markbox{7648}{proof} properly, \markbox{7649}{we} \markbox{7650}{make} \markbox{7651}{a} \markbox{7652}{couple} \markbox{7653}{of} \markbox{7654}{simplifying} observations, \markbox{7655}{which} \markbox{7656}{are} \markbox{7657}{all} \markbox{7658}{basically} \markbox{7659}{distance} formula-type manipulations.

First, \markbox{7660}{note} \markbox{7661}{that} \markbox{7662}{if} \markbox{m7663}{$x,y \in H$} \markbox{7664}{and} \markbox{m7665}{$V \in \Rel_K(x,y)$} \markbox{7666}{but} \markbox{m7667}{$V \notin \calU$}, \markbox{7668}{then} \markbox{m7669}{$d_V(x,y) < K + \epsilon$} \markbox{7670}{for} \markbox{7671}{some} \markbox{m7672}{$\epsilon = \epsilon(\mathfrak S)>0$}.  \markbox{7673}{This} \markbox{7674}{is} \markbox{7675}{because} \markbox{m7676}{$\pi_V(x), \pi_V(y) \in \calN_{\theta}(\hull_V(a,b))$}.  \markbox{7677}{Hence} \markbox{7678}{by} \markbox{7679}{taking} \markbox{m7680}{$K_2 \geq K_1 > K + \epsilon$}, \markbox{7681}{we} \markbox{7682}{may} \markbox{7683}{increase} \markbox{7684}{the} \markbox{7685}{threshold} \markbox{7686}{to} \markbox{7687}{remove} \markbox{7688}{any} \markbox{7689}{extraneous} domains.  \markbox{7690}{That} is:
$$\sum_{U \in \mathfrak S} [d_U(x,y)]_{K_2} = \sum_{U \in \calU} [d_U(x,y)]_{K_2}.$$

We \markbox{7691}{next} \markbox{7692}{observe} \markbox{7693}{that} \markbox{7694}{for} \markbox{7695}{any} \markbox{m7696}{$x,y \in H$}, \markbox{7697}{item} (4) \markbox{7698}{of} \markbox{7699}{Lemma} \ref{lem:collapsed interval control} \markbox{7700}{implies} \markbox{7701}{that} \markbox{m7702}{$d_U(x,y) \asymp d_{T_U}(x_U, y_U)$}, \markbox{7703}{with} \markbox{7704}{constants} \markbox{7705}{depending} \markbox{7706}{only} \markbox{7707}{on} \markbox{m7708}{$\mathfrak S$}.  \markbox{7709}{Thus} \markbox{7710}{we} \markbox{7711}{can} \markbox{7712}{use} \markbox{7713}{Corollary} \ref{cor:DF replace} \markbox{7714}{to} \markbox{7715}{replace} \markbox{7716}{the} \markbox{7717}{terms} \markbox{m7718}{$d_U(x,y)$} \markbox{7719}{with} \markbox{m7720}{$d_{T_U}(x_U,y_U)$} \markbox{7721}{in} \markbox{7722}{the} sum, namely:

$$\sum_{U \in \calU} [d_U(x,y)]_{K_2} \asymp \sum_{U \in \calU} [d_{T_U}(x_U,y_U)]_{K_2}.$$

The \markbox{7723}{two} \markbox{7724}{bounds} \markbox{7725}{in} \markbox{7726}{Theorem} \ref{thm:Q distance estimate} \markbox{7727}{are} \markbox{7728}{proven} separately.  \markbox{7729}{The} \markbox{7730}{upper} \markbox{7731}{bound} \markbox{7732}{only} \markbox{7733}{requires} \markbox{7734}{the} \markbox{7735}{basic} \markbox{7736}{details} \markbox{7737}{from} \markbox{7738}{the} \markbox{7739}{construction} \markbox{7740}{of} \markbox{7741}{the} \markbox{m7742}{$\hT_U$} \markbox{7743}{and} \markbox{7744}{some} \markbox{7745}{distance} \markbox{7746}{formula} tools.  \markbox{7747}{We} \markbox{7748}{have} \markbox{7749}{included} \markbox{7750}{the} \markbox{7751}{full} \markbox{7752}{proof} \markbox{7753}{of} \markbox{7754}{the} \markbox{7755}{proposition} \markbox{7756}{for} \markbox{7757}{clarity} \markbox{7758}{but} \markbox{7759}{also} \markbox{7760}{because} \markbox{7761}{it} \markbox{7762}{is} \markbox{7763}{used} \markbox{7764}{in} \markbox{7765}{proving} \markbox{7766}{the} \markbox{7767}{existence} \markbox{7768}{of} \markbox{7769}{hierarchy} \markbox{7770}{paths} \markbox{7771}{and} \markbox{7772}{the} \markbox{7773}{upper} \markbox{7774}{bound} \markbox{7775}{of} \markbox{7776}{the} \markbox{7777}{distance} formula; moreover, \markbox{7778}{the} \markbox{7779}{argument} \markbox{7780}{is} \markbox{7781}{similar} \markbox{7782}{to} \markbox{7783}{the} \markbox{7784}{proof} \markbox{7785}{of} \markbox{7786}{Corollary} \ref{cor:DF replace}, \markbox{7787}{which} \markbox{7788}{actually} \markbox{7789}{implies} \markbox{7790}{the} proposition.

\begin{proposition}[Upper bound]\label{prop:upper bound}
There \markbox{7791}{exists} \markbox{m7792}{$K_1= K_1(\mathfrak S)>0$} \markbox{7793}{so} \markbox{7794}{that} \markbox{7795}{for} \markbox{7796}{any} \markbox{m7797}{$K_2 >K_1$} \markbox{7798}{and} \markbox{7799}{any} \markbox{m7800}{$x, y \in H$} \markbox{7801}{we} have
\begin{equation}\label{eqn:upper}
    \sum_{U \in \calU} [d_U(x,y)]_{K_2} \succ \sum_{U \in \calU} d_{\hT_U}(\hx_U,\hy_U)
\end{equation}
with \markbox{7802}{the} \markbox{7803}{constants} \markbox{7804}{in} \markbox{m7805}{$\succ$} \markbox{7806}{depending} \markbox{7807}{only} \markbox{7808}{on} \markbox{m7809}{$\mathfrak S$} \markbox{7810}{and} \markbox{m7811}{$K_2$}.
\end{proposition}

\begin{proof}

As above, \markbox{7812}{let} \markbox{m7813}{$K_1 \geq K + \epsilon$} \markbox{7814}{and} \markbox{7815}{set} \markbox{m7816}{$K_2 \geq K_1 + 100\ES$}.  \markbox{7817}{Let} \markbox{m7818}{$\calU_i = \Rel_{K_i}(x,y)$}, \markbox{7819}{so} \markbox{7820}{that} \markbox{m7821}{$\calU_2 \subset \calU_1 \subset \calU$}.  \markbox{7822}{If} \markbox{m7823}{$U \in \calU$} \markbox{7824}{satisfies} \markbox{m7825}{$\hx_U = \hy_U$}, \markbox{7826}{then} \markbox{7827}{the} \markbox{7828}{corresponding} \markbox{7829}{term} \markbox{7830}{disappears} \markbox{7831}{on} \markbox{7832}{the} right-hand side.  \markbox{7833}{Hence} \markbox{7834}{it} \markbox{7835}{suffices} \markbox{7836}{to} \markbox{7837}{account} \markbox{7838}{for} \markbox{7839}{the} \markbox{7840}{domains} \markbox{7841}{in} \markbox{m7842}{$\calV = \{V \in \calU | d_V(x,y) < K_2 \textrm{ and } \hx_U \neq \hy_U\}$}, \markbox{7843}{which} \markbox{7844}{appear} \markbox{7845}{on} \markbox{7846}{the} right-hand \markbox{7847}{side} (RHS) \markbox{7848}{but} \markbox{7849}{not} \markbox{7850}{the} left-hand \markbox{7851}{side} (LHS) \markbox{7852}{of} \markbox{7853}{equation} \eqref{eqn:upper}.

For this, \markbox{7854}{item} (9) \markbox{7855}{of} \markbox{7856}{Lemma} \ref{lem:collapsed interval control} \markbox{7857}{says} \markbox{7858}{that} \markbox{m7859}{$\hx_U$} \markbox{7860}{is} \markbox{7861}{not} \markbox{7862}{contained} \markbox{7863}{in} \markbox{7864}{some} \markbox{7865}{cluster} \markbox{7866}{point} \markbox{7867}{of} \markbox{m7868}{$\hT_U$} \markbox{7869}{for} \markbox{7870}{only} boundedly-many \markbox{m7871}{$U$}, \markbox{7872}{and} \markbox{7873}{the} \markbox{7874}{same} \markbox{7875}{for} \markbox{m7876}{$\hy_U$}.  (In fact, \markbox{7877}{we} \markbox{7878}{can} \markbox{7879}{take} \markbox{m7880}{$\hx_U = \ha_U$} \markbox{7881}{and} \markbox{m7882}{$\hy_U = \hb_U$}, \markbox{7883}{be} \markbox{7884}{this} \markbox{7885}{will} \markbox{7886}{not} \markbox{7887}{simplify} things.) \markbox{7888}{This} \markbox{7889}{means} that, \markbox{7890}{up} \markbox{7891}{to} \markbox{7892}{ignoring} \markbox{7893}{a} \markbox{7894}{bounded} \markbox{7895}{collection} \markbox{7896}{of} \markbox{7897}{domains} \markbox{m7898}{$\calV' \subset \calV$}, \markbox{7899}{if} \markbox{m7900}{$V \in \calV - \calV'$} \markbox{7901}{then} \markbox{m7902}{$\hx_V$} \markbox{7903}{and} \markbox{m7904}{$\hy_V$} \markbox{7905}{are} \markbox{7906}{at} \markbox{7907}{distinct} \markbox{7908}{cluster} points, \markbox{7909}{and} \markbox{7910}{so} \markbox{m7911}{$d_V(x,y) > 50\ES$} \markbox{7912}{by} \markbox{7913}{item} (5) \markbox{7914}{of} \markbox{7915}{Lemma} \ref{lem:collapsed interval control}, i.e., \markbox{m7916}{$\calV-\calV' \subset \Rel_{50\ES}(x,y)$}, \markbox{7917}{while} \markbox{7918}{also} \markbox{m7919}{$d_{\hT_V}(\hx_V,\hy_V) \geq r_2 \geq 1$}.

One \markbox{7920}{finishes} \markbox{7921}{the} \markbox{7922}{proof} \markbox{7923}{with} \markbox{7924}{an} \markbox{7925}{application} \markbox{7926}{of} \markbox{7927}{Proposition} \ref{prop:bounding containers} \markbox{7928}{as} follows.  \markbox{7929}{Set} \markbox{m7930}{$\calU_i = \Rel_{K_i}(x,y)$} \markbox{7931}{and} \markbox{7932}{observe} \markbox{7933}{that} \markbox{m7934}{$\calV - \calV' \subset \calU_1 - \calU_2$}.  \markbox{7935}{Proposition} \ref{prop:bounding containers} \markbox{7936}{says} \markbox{7937}{that} \markbox{7938}{up} \markbox{7939}{to} \markbox{7940}{ignoring} \markbox{7941}{a} \markbox{7942}{subset} \markbox{m7943}{$\calV'' \subset \calV - \calV'$} \markbox{7944}{with} \markbox{m7945}{$\#\calV'' \leq P(K_2)$}, \markbox{7946}{for} \markbox{7947}{each} \markbox{m7948}{$V \in \calV_0 = \calV - (\calV' \cup \calV'')$} \markbox{7949}{there} \markbox{7950}{exists} \markbox{7951}{some} \markbox{7952}{domain} \markbox{m7953}{$W \in \calU_2$} \markbox{7954}{determining} \markbox{7955}{a} \markbox{7956}{term} \markbox{7957}{on} \markbox{7958}{the} \markbox{7959}{RHS} \markbox{7960}{with} \markbox{m7961}{$V \nest W$}.  Moreover, \markbox{7962}{it} \markbox{7963}{says} \markbox{7964}{that} \markbox{7965}{the} \markbox{7966}{set} \markbox{7967}{of} \markbox{7968}{domains} \markbox{m7969}{$\calW = \{V \in \calV| V\nest W\}$} \markbox{7970}{for} \markbox{7971}{which} \markbox{7972}{each} \markbox{7973}{such} \markbox{m7974}{$W$} \markbox{7975}{accounts} \markbox{7976}{in} \markbox{7977}{this} \markbox{7978}{way} \markbox{7979}{satisfies} \markbox{m7980}{$\#\calW \leq (1+A)\cdot d_W(x,y) + A$}, \markbox{7981}{for} \markbox{7982}{some} \markbox{m7983}{$A = A(K_2, \mathfrak S)>0$}.

Combining \markbox{7984}{these} \markbox{7985}{observations} \markbox{7986}{leads} \markbox{7987}{to} \markbox{7988}{the} computation
\begin{eqnarray*}
\sum_{U \in \calU_2} d_U(x,y) &=& \sum_{U \in \calU_2} d_U(x,y) + \sum_{V \in \calV - \calV'} d_V(x,y)+ \sum_{Z \in \calV'} d_Z(x,y)\\
&\leq& \sum_{U \in \calU_2} ((1+A)\cdot d_U(x,y)+A) + K_2 \cdot P(K_2)\\
&\leq& (1+2A)\cdot \sum_{U \in \calU_2} d_U(x,y) + K_2 \cdot P(K_2)
\end{eqnarray*}
where \markbox{7989}{the} \markbox{7990}{last} \markbox{7991}{inequality} \markbox{7992}{follows} \markbox{7993}{from} \markbox{7994}{the} \markbox{7995}{fact} \markbox{7996}{that} \markbox{m7997}{$d_U(x,y) > K_2$} \markbox{7998}{for} \markbox{7999}{each} \markbox{m8000}{$U \in \calU_2$}.  \markbox{8001}{This} \markbox{8002}{completes} \markbox{8003}{the} proof. 

\end{proof}


\begin{figure}[h]
    \centering
    \includegraphics[width=.8\textwidth]{figures/lower_bound_interval.pdf}
    \caption{Proof of Proposition \ref{prop:lower bound}: The subcluster $C'$ isolates the portion of $C$ which intersects $[x_U,y_U]$ but avoids the $(\alpha_0+R)$-neighborhoods of $x_U$ and $y_U$.  The (pink) net of $\delta$-sets from $\nest_{\calU}$-minimal domains $V \nest U$ with $\delta^V_U \subset C'$ coarsely encodes the length of $C'$, with the BGIA property guaranteeing that $\hx_V = \ha_V$ and $\hy_V = \hb_V$ and hence $d_{\hT_V}(\hx_V,\hy_V) \geq K - B^2 - 2r_1$ for each such $V$.}
    \label{fig:subcluster}
\end{figure}

\begin{proposition}[Lower bound]\label{prop:lower bound}
There \markbox{8004}{exists} \markbox{m8005}{$K_1= K_1(\mathfrak S)>0$} \markbox{8006}{so} \markbox{8007}{that} \markbox{8008}{for} \markbox{8009}{any} \markbox{m8010}{$K_2 >K_1$} \markbox{8011}{and} \markbox{8012}{any} \markbox{m8013}{$x, y \in H$} \markbox{8014}{we} have
\begin{equation}\label{eqn:lower}
    \sum_{U \in \calU} [d_U(x,y)]_{K_2} \prec \sum_{U \in \calU} d_{\hT_U}(\hx_U,\hy_U)
\end{equation}
with \markbox{8015}{the} \markbox{8016}{constants} \markbox{8017}{in} \markbox{m8018}{$\prec$} \markbox{8019}{depending} \markbox{8020}{only} \markbox{8021}{on} \markbox{m8022}{$\mathfrak S$} \markbox{8023}{and} \markbox{m8024}{$K_2$}.
\end{proposition}

\begin{proof}

Observe \markbox{8025}{that} \markbox{8026}{since} \markbox{m8027}{$d_U(x,y) \prec d_{T_U}(x_U,y_U)$} \markbox{8028}{for} \markbox{8029}{each} \markbox{m8030}{$U$}, \markbox{8031}{it} \markbox{8032}{suffices} \markbox{8033}{by} \markbox{8034}{Corollary} \ref{cor:DF replace} \markbox{8035}{to} \markbox{8036}{show} \markbox{8037}{that} 
$$\sum_{U \in \calU} [d_{T_U}(x_U,y_U)]_{K_2} \prec \sum_{U \in \calU} d_{\hT_U}(\hx_U,\hy_U).$$

For \markbox{8038}{this} bound, \markbox{8039}{there} \markbox{8040}{are} \markbox{8041}{possibly} \markbox{8042}{domains} \markbox{m8043}{$U \in \calU$} \markbox{8044}{where} \markbox{m8045}{$d_{T_U}(x_U,y_U) > K_2$} \markbox{8046}{but} \markbox{8047}{there} \markbox{8048}{is} \markbox{8049}{a} \markbox{8050}{discrepancy} \markbox{m8051}{$d_{T_U}(x_U,y_U) > d_{\hT_U}(\hx_U,\hy_U)$}.  \markbox{8052}{Let} \markbox{m8053}{$\calW$} \markbox{8054}{denote} \markbox{8055}{the} \markbox{8056}{collection} \markbox{8057}{of} \markbox{8058}{such} domains.

Since \markbox{m8059}{$\hT_U$} \markbox{8060}{is} \markbox{8061}{obtained} \markbox{8062}{from} \markbox{m8063}{$T_U$} \markbox{8064}{by} \markbox{8065}{collapsing} clusters, \markbox{8066}{we} \markbox{8067}{need} \markbox{8068}{to} \markbox{8069}{analyze} \markbox{8070}{the} \markbox{8071}{clusters} \markbox{8072}{which} \markbox{8073}{separate} \markbox{m8074}{$x_U$} \markbox{8075}{from} \markbox{m8076}{$y_U$}, i.e. \markbox{8077}{those} \markbox{8078}{clusters} \markbox{m8079}{$C_1, \dots, C_n$} \markbox{8080}{which} intersect, \markbox{8081}{in} \markbox{8082}{that} order, \markbox{8083}{the} \markbox{8084}{geodesic} \markbox{m8085}{$[x_U,y_U]$} \markbox{8086}{in} \markbox{m8087}{$T_U$}.  \markbox{8088}{The} \markbox{8089}{proof} \markbox{8090}{is} \markbox{8091}{mainly} \markbox{8092}{a} \markbox{8093}{BGIA} \ref{ax:BGIA} \markbox{8094}{type} \markbox{8095}{argument} \markbox{8096}{along} \markbox{8097}{with} \markbox{8098}{an} \markbox{8099}{application} \markbox{8100}{of} \markbox{8101}{Proposition} \ref{prop:bounding containers} \markbox{8102}{and} \markbox{8103}{the} \markbox{8104}{Covering} \markbox{8105}{Lemma} \ref{lem:covering}.

Continuing \markbox{8106}{with} \markbox{8107}{the} \markbox{8108}{above} notation, \markbox{8109}{for} \markbox{8110}{each} \markbox{m8111}{$i$}, \markbox{8112}{let} \markbox{m8113}{$C'_i = C_i \cap [x_U,y_U]_{T_U} - \left(B_{\alpha_0 + R}(x_U) \cup B_{\alpha_0 + R}(y_U)\right)$}, \markbox{8114}{where} \markbox{m8115}{$\alpha_0 = \alpha(R, \mathfrak S)>0$} \markbox{8116}{is} \markbox{8117}{the} \markbox{8118}{interval} \markbox{8119}{consistency} \markbox{8120}{constant} \markbox{8121}{provided} \markbox{8122}{by} \markbox{8123}{Lemma} \ref{lem:interval consistency}; \markbox{8124}{see} \markbox{8125}{Figure} \ref{fig:subcluster}.

Observe \markbox{8126}{that} \markbox{8127}{for} \markbox{8128}{each} \markbox{m8129}{$i$}, \markbox{8130}{if} \markbox{8131}{we} \markbox{8132}{set} \markbox{m8133}{$\calV_i = \{V \in \calU|V \nest U \text{ and } \delta^V_U \subset C_i\}$} \markbox{8134}{then} \markbox{m8135}{$\{\delta^V_U| V \in \calV_i\}$} \markbox{8136}{is} \markbox{m8137}{$(r_2 + 2r_1)$}-dense \markbox{8138}{in} \markbox{m8139}{$C_i$}.  \markbox{8140}{Hence} \markbox{8141}{we} \markbox{8142}{can} \markbox{8143}{find} \markbox{8144}{a} \markbox{8145}{subcollection} \markbox{m8146}{$\calV_i'$} \markbox{8147}{so} that
\begin{itemize}
    \item Each \markbox{m8148}{$V \in \calV_i'$} \markbox{8149}{is} \markbox{m8150}{$\nest_{\calU}$}-minimal;
    \item For \markbox{8151}{each} \markbox{m8152}{$V \in \calV'$}, \markbox{8153}{we} \markbox{8154}{have} \markbox{m8155}{$\delta^V_U \subset C_i'$};
    \item \markbox{m8156}{$\{\delta^V_U| V \in \calV_i\}$} \markbox{8157}{is} \markbox{8158}{a} \markbox{m8159}{$(2r_2+4r_1, r_2)$}-net \markbox{8160}{on} \markbox{m8161}{$C_i'$} (see \markbox{8162}{Definition} \ref{defn:net} below).
\end{itemize}

Note \markbox{8163}{that} \markbox{8164}{the} \markbox{8165}{increase} \markbox{8166}{in} \markbox{8167}{the} \markbox{8168}{net} \markbox{8169}{constants} \markbox{8170}{in} \markbox{8171}{the} \markbox{8172}{third} \markbox{8173}{item} \markbox{8174}{is} \markbox{8175}{required} \markbox{8176}{to} \markbox{8177}{guarantee} \markbox{8178}{the} \markbox{8179}{second} item.  \markbox{8180}{In} particular, \markbox{8181}{we} \markbox{8182}{have} \markbox{m8183}{$\#\calV_i \succ \diam_{T_U}(C_i') \geq \diam_{T_U}(C_i \cap [x_U,y_U])- 2(\alpha_0+R)$}, \markbox{8184}{where} \markbox{m8185}{$\#\calV_i$} \markbox{8186}{denotes} \markbox{8187}{the} \markbox{8188}{cardinality} \markbox{8189}{of} \markbox{m8190}{$\calV_i$}.

Let \markbox{m8191}{$V \in \calV_i'$}.  Then, \markbox{8192}{by} construction, \markbox{m8193}{$d_{T_U}(\delta^V_U, x_U)> \alpha + R$} \markbox{8194}{and} \markbox{m8195}{$d_{T_U}(\delta^V_U, y_U)>\alpha_0 + R$}.  Hence, \markbox{8196}{up} \markbox{8197}{to} \markbox{8198}{switching} \markbox{8199}{the} \markbox{8200}{roles} \markbox{8201}{of} \markbox{m8202}{$a$} \markbox{8203}{and} \markbox{m8204}{$b$}, \markbox{8205}{the} \markbox{8206}{BGI} \markbox{8207}{property} (5) \markbox{8208}{of} \markbox{8209}{Lemma} \ref{lem:interval control} \markbox{8210}{says} \markbox{8211}{that} \markbox{m8212}{$d_{T_V}(\delta^U_V(a_V),\delta^U_V(x_V))<R$} \markbox{8213}{and} \markbox{m8214}{$d_{T_V}(\delta^U_V(b_V),\delta^U_V(y_V))<R$}. 

Lemma \ref{lem:interval consistency} \markbox{8215}{says} \markbox{8216}{that} \markbox{8217}{the} \markbox{8218}{tuples} \markbox{m8219}{$(a_U), (b_U), (x_U), (y_U)$} \markbox{8220}{are} \markbox{8221}{all} \markbox{m8222}{$\alpha_0$}-consistent.  \markbox{8223}{Thus} \markbox{8224}{since} \markbox{m8225}{$d_{T_U}(a_U, \delta^V_U)>R + \alpha_0$} \markbox{8226}{and} \markbox{8227}{similarly} \markbox{8228}{for} \markbox{m8229}{$b_U,x_U,y_U$}, \markbox{m8230}{$\alpha_0$}-consistency \markbox{8231}{forces} \markbox{8232}{that} \markbox{m8233}{$d_{T_V}(a_V, \delta^U_V(a_U)) < \alpha_0$}, \markbox{8234}{and} \markbox{8235}{similarly} \markbox{8236}{for} \markbox{m8237}{$b_V,x_V,y_V$}.  \markbox{8238}{As} such, \markbox{8239}{we} \markbox{8240}{get} \markbox{8241}{that} \markbox{m8242}{$d_{T_V}(x_V,a_V) < \alpha_0 + R$} \markbox{8243}{and} \markbox{m8244}{$d_{T_V}(y_V,b_V) < \alpha_0 + R$}, \markbox{8245}{and} \markbox{8246}{so} \markbox{8247}{that} \markbox{m8248}{$d_{T_V}(x_V,y_V) \geq d_{T_V}(a_V,b_V) - 2\alpha_0 - 2R$}, \markbox{8249}{from} \markbox{8250}{which} \markbox{8251}{we} \markbox{8252}{can} \markbox{8253}{conclude} \markbox{8254}{that} \markbox{m8255}{$\ha_V = \hx_V$} \markbox{8256}{and} \markbox{m8257}{$\hb_V = \hy_V$} \markbox{8258}{by} \markbox{8259}{requiring} \markbox{m8260}{$r_1 > \alpha_0 + R$}.




On \markbox{8261}{the} \markbox{8262}{other} hand, \markbox{8263}{since} \markbox{8264}{each} \markbox{m8265}{$V \in \calV_i'$} \markbox{8266}{is} \markbox{m8267}{$\nest_{\calU}$}-minimal \markbox{8268}{and} \markbox{m8269}{$d_V(a,b) > K$}, \markbox{8270}{item} (4) \markbox{8271}{of} \markbox{8272}{Lemma} \ref{lem:collapsed interval control} \markbox{8273}{says} \markbox{8274}{that} \markbox{m8275}{$d_{\hT_V}(\hat{a}_V,\hat{b}_V) \succ K$}.  \markbox{8276}{Hence} \markbox{8277}{we} \markbox{8278}{obtain} \markbox{8279}{that} \markbox{m8280}{$d_{\hT_V}(\hx_V,\hy_V)  = d_{\hT_V}(\ha_V,\hb_V) \succ K$}.

Thus \markbox{8281}{for} \markbox{8282}{each} \markbox{m8283}{$U \in \calW$}, \markbox{8284}{we} have
\begin{eqnarray*}
d_{T_U}(x_U,y_U) & = & d_{\hT_U}(\hx_U,\hy_U) + \sum_{i=1}^n \diam_{T_U}(C_i \cap [x_U,y_U]_{T_U})\\
&\prec& d_{\hT_U}(\hx_U,\hy_U) + \sum_{i=1}^n \#\calV_i'\\
&\prec& d_{\hT_U}(\hx_U,\hy_U) + \sum_{i=1}^n \left(\sum_{V \in \calV_i'} d_{\hT_V}(\hx_V,\hy_V)\right).
\end{eqnarray*}

Finally, \markbox{8285}{the} \markbox{8286}{Covering} \markbox{8287}{Lemma} \ref{lem:covering} \markbox{8288}{says} \markbox{8289}{that} \markbox{8290}{any} \markbox{8291}{domain} \markbox{m8292}{$V \in \calU$} \markbox{8293}{can} \markbox{8294}{nest} \markbox{8295}{into} \markbox{8296}{only} boundedly-many \markbox{8297}{domains} \markbox{8298}{in} \markbox{m8299}{$\calU$}, \markbox{8300}{with} \markbox{8301}{bounds} \markbox{8302}{determined} \markbox{8303}{by} \markbox{m8304}{$\mathfrak S$}.  Hence, \markbox{8305}{each} \markbox{m8306}{$\nest_{\calU}$}-minimal \markbox{8307}{domain} \markbox{m8308}{$V \in \calU$} \markbox{8309}{must} \markbox{8310}{account} \markbox{8311}{for} \markbox{8312}{at} \markbox{8313}{most} boundedly-many \markbox{m8314}{$U \in \calW$} \markbox{8315}{in} \markbox{8316}{the} \markbox{8317}{above} way.  Thus, \markbox{8318}{using} \markbox{8319}{an} \markbox{8320}{argument} \markbox{8321}{similar} \markbox{8322}{to} \markbox{8323}{the} \markbox{8324}{end} \markbox{8325}{of} \markbox{8326}{the} \markbox{8327}{proof} \markbox{8328}{of} \markbox{8329}{Proposition} \ref{prop:upper bound}, \markbox{8330}{we} \markbox{8331}{can} \markbox{8332}{account} \markbox{8333}{for} \markbox{8334}{the} \markbox{8335}{distance} \markbox{8336}{lost} \markbox{8337}{by} \markbox{8338}{collapsing} \markbox{8339}{clusters} \markbox{8340}{in} \markbox{8341}{each} \markbox{8342}{domain} \markbox{8343}{in} \markbox{m8344}{$\calW$} \markbox{8345}{with} \markbox{8346}{these} \markbox{8347}{large} \markbox{m8348}{$\nest_{\calU}$}-minimal \markbox{8349}{domains} \markbox{8350}{by} \markbox{8351}{increasing} \markbox{8352}{the} \markbox{8353}{multiplicative} \markbox{8354}{constant} \markbox{8355}{for} \markbox{8356}{the} \markbox{8357}{estimate} \markbox{8358}{in} \markbox{8359}{equation} \eqref{eqn:upper} \markbox{8360}{by} \markbox{8361}{a} \markbox{8362}{bounded} amount.  \markbox{8363}{This} \markbox{8364}{completes} \markbox{8365}{the} proof.
\end{proof}

We \markbox{8366}{used} \markbox{8367}{the} \markbox{8368}{following} \markbox{8369}{definition} \markbox{8370}{in} \markbox{8371}{the} \markbox{8372}{above} proof:

\begin{definition}[Net]\label{defn:net}
Given \markbox{8373}{constants} \markbox{m8374}{$a,A\geq 0$}, \markbox{8375}{a} \markbox{m8376}{$(a,A)$}-\emph{net} \markbox{8377}{on} \markbox{8378}{a} \markbox{8379}{subspace} \markbox{m8380}{$Y \subset X$} \markbox{8381}{of} \markbox{8382}{a} \markbox{8383}{metric} \markbox{8384}{space} \markbox{8385}{is} \markbox{8386}{a} \markbox{8387}{collection} \markbox{m8388}{$Z \subset Y$} \markbox{8389}{of} \markbox{8390}{points} \markbox{8391}{so} that:
\begin{enumerate}
\item \markbox{m8392}{$Z$} \markbox{8393}{is} \markbox{m8394}{$a$}-coarsely \markbox{8395}{dense} \markbox{8396}{in} \markbox{m8397}{$Y$}, i.e. \markbox{8398}{for} \markbox{8399}{every} \markbox{m8400}{$y \in Y$} \markbox{8401}{there} \markbox{8402}{is} \markbox{8403}{some} \markbox{m8404}{$z \in Z$} \markbox{8405}{with} \markbox{m8406}{$d(z,y)<a$}, and
\item For \markbox{8407}{any} \markbox{m8408}{$z,z' \in Z$}, \markbox{8409}{we} \markbox{8410}{have} \markbox{m8411}{$d_X(z,z') \geq A$}.
\end{enumerate}
\end{definition}

In particular, \markbox{8412}{an} \markbox{m8413}{$(a,A)$}-net \markbox{m8414}{$Z$} \markbox{8415}{on} \markbox{m8416}{$Y$} \markbox{8417}{satisfies} \markbox{m8418}{$\#Z \asymp \diam(Y)$} \markbox{8419}{with} \markbox{8420}{the} \markbox{8421}{constants} \markbox{8422}{depending} \markbox{8423}{only} \markbox{8424}{on} \markbox{m8425}{$a,A$}.








\subsection{The map $\hO:\calQ \to H$ and honing clusters}\label{subsec:hO defined}

With \markbox{8426}{Theorem} \ref{thm:Q distance estimate} \markbox{8427}{in} hand, \markbox{8428}{in} \markbox{8429}{order} \markbox{8430}{to} \markbox{8431}{prove} \markbox{8432}{that} \markbox{m8433}{$\hPsi:H \to \calQ$} \markbox{8434}{is} \markbox{8435}{a} quasi-isometry, \markbox{8436}{we} \markbox{8437}{need} \markbox{8438}{to} \markbox{8439}{explain} \markbox{8440}{why} \markbox{m8441}{$\hPsi$} \markbox{8442}{is} \markbox{8443}{coarsely} surjective.  \markbox{8444}{The} \markbox{8445}{proof} \markbox{8446}{of} \markbox{8447}{this} \markbox{8448}{fact} \markbox{8449}{is} \markbox{8450}{quite} \markbox{8451}{involved} \markbox{8452}{and} \markbox{8453}{beyond} \markbox{8454}{the} \markbox{8455}{scope} \markbox{8456}{of} \markbox{8457}{an} \markbox{8458}{expository} paper.  \markbox{8459}{As} such, \markbox{8460}{we} \markbox{8461}{will} \markbox{8462}{mostly} \markbox{8463}{present} \markbox{8464}{key} \markbox{8465}{ideas} \markbox{8466}{and} \markbox{8467}{not} \markbox{8468}{a} \markbox{8469}{full} \markbox{8470}{detailed} \markbox{8471}{proof} \markbox{8472}{because} \markbox{8473}{the} \markbox{8474}{proof} \markbox{8475}{is} \markbox{8476}{not} \markbox{8477}{greatly} \markbox{8478}{simplified} \markbox{8479}{versus} \markbox{8480}{the} \markbox{8481}{most} \markbox{8482}{general} version, \markbox{8483}{see} \cite[Sections 9--11]{Dur_infcube}.

In \markbox{8484}{this} subsection, \markbox{8485}{we} \markbox{8486}{will} \markbox{8487}{construct} \markbox{8488}{a} \markbox{8489}{map} \markbox{m8490}{$\Omega:\calQ \to \prod_{U \in \calU} T_U$}, \markbox{8491}{and} \markbox{8492}{sketch} \markbox{8493}{why} \markbox{8494}{its} \markbox{8495}{image} \markbox{8496}{is} \markbox{m8497}{$\beta$}-consistent \markbox{8498}{for} \markbox{8499}{some} \markbox{m8500}{$\beta = \beta(\mathfrak S, R, r_1,r_2)>0$}.   \markbox{8501}{Upgrading} \markbox{8502}{this} \markbox{8503}{to} \markbox{8504}{a} \markbox{8505}{map} \markbox{m8506}{$\hO:\calQ \to H$} \markbox{8507}{involves} \markbox{8508}{standard} \markbox{8509}{HHS} techniques.  \markbox{8510}{In} \markbox{8511}{Subsection} \ref{subsec:tree trimming}, \markbox{8512}{we} \markbox{8513}{will} \markbox{8514}{prove} \markbox{8515}{our} \markbox{8516}{Tree} \markbox{8517}{Trimming} \markbox{8518}{Theorem} \ref{thm:tree trimming}, \markbox{8519}{which} \markbox{8520}{is} \markbox{8521}{a} \markbox{8522}{useful} \markbox{8523}{distance} formula-like \markbox{8524}{tool} \markbox{8525}{that} \markbox{8526}{will} \markbox{8527}{allow} \markbox{8528}{us} \markbox{8529}{modify} \markbox{8530}{our} \markbox{8531}{collapsed} \markbox{8532}{interval} \markbox{8533}{setup} \markbox{8534}{while} \markbox{8535}{coarsely} \markbox{8536}{preserving} \markbox{8537}{the} \markbox{8538}{geometry} \markbox{8539}{of} \markbox{m8540}{$\calQ$}.  \markbox{8541}{This} \markbox{8542}{tool} \markbox{8543}{is} \markbox{8544}{a} \markbox{8545}{key} \markbox{8546}{ingredient} \markbox{8547}{in} \markbox{8548}{Subsection} \ref{subsec:upgrade to HHS}, \markbox{8549}{where} \markbox{8550}{we} \markbox{8551}{sketch} \markbox{8552}{why} \markbox{m8553}{$\hO$} \markbox{8554}{is} \markbox{8555}{a} \markbox{8556}{coarse} \markbox{8557}{inverse} \markbox{8558}{to} \markbox{m8559}{$\hPsi$}, \markbox{8560}{namely} \markbox{8561}{that} \markbox{m8562}{$d_{\calQ}(\hPsi \circ \hO(\hx), \hx)$} \markbox{8563}{is} \markbox{8564}{bounded} \markbox{8565}{independently} \markbox{8566}{of} \markbox{m8567}{$\hx \in \calQ$}.

We \markbox{8568}{can} \markbox{8569}{now} \markbox{8570}{set} \markbox{8571}{about} \markbox{8572}{defining} \markbox{8573}{the} \markbox{8574}{map} \markbox{m8575}{$\Omega:\calQ \to \prod_{U \in \calU} T_U$}, \markbox{8576}{which} \markbox{8577}{is} \markbox{8578}{defined} coordinate-wise.  \markbox{8579}{To} \markbox{8580}{put} \markbox{8581}{things} \markbox{8582}{more} precisely, \markbox{8583}{we} \markbox{8584}{want} \markbox{8585}{to} \markbox{8586}{define} \markbox{m8587}{$\Omega$} \markbox{8588}{so} that:

\begin{itemize}
    \item For \markbox{8589}{each} \markbox{m8590}{$\hx \in \calQ$}, \markbox{8591}{the} \markbox{8592}{tuple} \markbox{m8593}{$\Omega(\hx)$} \markbox{8594}{is} \markbox{m8595}{$\omega$}-consistent \markbox{8596}{for} \markbox{8597}{some} \markbox{m8598}{$\omega = \omega(\mathfrak S)>0$}, and
    \item when \markbox{m8599}{$\hx  = (\hx_U)\in \calQ$} \markbox{8600}{and} \markbox{m8601}{$(x_U) = \Omega(\hx)$}, \markbox{8602}{then} \markbox{m8603}{$q_U(x_U) = \hx_U$} \markbox{8604}{for} \markbox{8605}{each} \markbox{m8606}{$U \in \calU$}.
\end{itemize}


Unsurprisingly, \markbox{8607}{the} \markbox{8608}{cluster} subintervals, \markbox{8609}{which} \markbox{8610}{are} \markbox{8611}{collapsed} \markbox{8612}{under} \markbox{8613}{each} \markbox{m8614}{$q_U:T_U \to \hT_U$}, \markbox{8615}{play} \markbox{8616}{a} \markbox{8617}{key} role.  \markbox{8618}{In} particular, \markbox{8619}{these} \markbox{8620}{cluster} \markbox{8621}{subintervals} \markbox{8622}{can} \markbox{8623}{have} \markbox{8624}{arbitrarily} \markbox{8625}{large} diameter, \markbox{8626}{and} \markbox{8627}{so} \markbox{8628}{if} \markbox{8629}{a} \markbox{8630}{coordinate} \markbox{m8631}{$\hx_U\in \hT_U$} \markbox{8632}{lies} \markbox{8633}{in} \markbox{8634}{a} \markbox{8635}{cluster} \markbox{8636}{point} \markbox{8637}{of} \markbox{m8638}{$\hT_U$}, \markbox{8639}{then} \markbox{8640}{its} \markbox{8641}{preimage} \markbox{m8642}{$q_U^{-1}(\hx_U)$} \markbox{8643}{is} \markbox{8644}{that} \markbox{8645}{whole} cluster.  \markbox{8646}{Choosing} \markbox{8647}{a} \markbox{8648}{point} \markbox{8649}{within} \markbox{8650}{that} \markbox{8651}{cluster} \markbox{8652}{then} \markbox{8653}{requires} \markbox{8654}{utilizing} \markbox{8655}{the} \markbox{8656}{coordinates} \markbox{8657}{for} \markbox{m8658}{$V \nest U$} \markbox{8659}{with} \markbox{m8660}{$\hd^V_U = \hx_U$}.  \markbox{8661}{We} \markbox{8662}{think} \markbox{8663}{of} \markbox{8664}{this} \markbox{8665}{process} \markbox{8666}{as} \emph{honing} \markbox{8667}{the} cluster.


\smallskip


\textbf{\underline{Honing clusters}}: \markbox{8668}{Let} \markbox{m8669}{$\hx = (\hx_U) \in \calQ$}.  \markbox{8670}{When} \markbox{m8671}{$U\in \calU$} \markbox{8672}{has} \markbox{m8673}{$\hx_U \in \hT^e_U$}, \markbox{8674}{then} \markbox{8675}{the} \markbox{8676}{definition} \markbox{8677}{is} simple: \markbox{m8678}{$x_U = q_U^{-1}(\hx_U)$}, \markbox{8679}{which} \markbox{8680}{is} \markbox{8681}{a} \markbox{8682}{unique} point.  \markbox{8683}{For} \markbox{8684}{the} \markbox{8685}{other} domains, \markbox{8686}{we} \markbox{8687}{need} \markbox{8688}{some} \markbox{8689}{more} setup.

\begin{remark}
    \markbox{8690}{The} \markbox{8691}{reader} \markbox{8692}{should} \markbox{8693}{be} \markbox{8694}{warned} \markbox{8695}{here} \markbox{8696}{that} \markbox{8697}{one} \markbox{8698}{has} \markbox{8699}{to} \markbox{8700}{deal} \markbox{8701}{with} \markbox{8702}{the} \markbox{8703}{case} \markbox{8704}{where} \markbox{8705}{all} \markbox{8706}{coordinates} \markbox{m8707}{$\hx_U$} \markbox{8708}{are} \markbox{8709}{contained} \markbox{8710}{in} \markbox{8711}{a} \markbox{8712}{collapsed} point.  \markbox{8713}{When} \markbox{8714}{this} happens, \markbox{8715}{there} \markbox{8716}{is} \markbox{8717}{not} \markbox{8718}{an} \markbox{8719}{obvious} \markbox{8720}{choice} \markbox{8721}{of} \markbox{8722}{collection} \markbox{8723}{of} \markbox{8724}{minimal} \markbox{8725}{domains} \markbox{8726}{to} \markbox{8727}{work} with, \markbox{8728}{and} \markbox{8729}{in} \markbox{8730}{order} \markbox{8731}{to} \markbox{8732}{determine} \markbox{8733}{coordinates} \markbox{8734}{back} \markbox{8735}{in} \markbox{8736}{the} \markbox{8737}{intervals} \markbox{m8738}{$T_U$}, \markbox{8739}{one} \markbox{8740}{must} \markbox{8741}{use} \markbox{8742}{all} \markbox{8743}{of} \markbox{8744}{the} \markbox{8745}{hierarchical} \markbox{8746}{data} \markbox{8747}{at} hand. 
\end{remark}

Suppose \markbox{8748}{that} \markbox{m8749}{$U \in \calU$} \markbox{8750}{and} \markbox{m8751}{$\hx_U \notin \hT^e_U$}.  \markbox{8752}{Let} \markbox{m8753}{$C$} \markbox{8754}{denote} \markbox{8755}{the} \markbox{8756}{cluster} \markbox{8757}{in} \markbox{m8758}{$T_U$} \markbox{8759}{so} \markbox{8760}{that} \markbox{m8761}{$q_U(C) = \hx_U$}.  \markbox{8762}{The} \markbox{8763}{first} \markbox{8764}{step} \markbox{8765}{is} \markbox{8766}{to} \markbox{8767}{associate} \markbox{8768}{a} \markbox{8769}{marked} \markbox{8770}{point} \markbox{m8771}{$l_V \in \{a,b\}$} \markbox{8772}{to} \markbox{8773}{each} \markbox{m8774}{$\nest_{\calU}$}-minimal \markbox{8775}{domain} \markbox{m8776}{$V \nest U$} \markbox{8777}{with} \markbox{m8778}{$\delta^V_U \subset C$}.  \markbox{8779}{We} \markbox{8780}{then} \markbox{8781}{use} \markbox{8782}{these} \markbox{m8783}{$l_V$} \markbox{8784}{to} \markbox{8785}{hone} \markbox{8786}{the} \markbox{8787}{clusters} \markbox{8788}{of} \markbox{8789}{the} \markbox{8790}{larger} \markbox{m8791}{$U \in \calU$} \markbox{8792}{in} \markbox{8793}{which} \markbox{8794}{such} \markbox{m8795}{$V$} \markbox{8796}{are} involved.

Suppose \markbox{8797}{then} \markbox{8798}{that} \markbox{m8799}{$U \in \calU$} \markbox{8800}{is} \markbox{m8801}{$\nest_{\calU}$}-minimal.  \markbox{8802}{Since} \markbox{m8803}{$\hT_U$} \markbox{8804}{has} \markbox{8805}{no} \markbox{8806}{internal} \markbox{8807}{cluster} points, \markbox{m8808}{$\hat{x}_U$} \markbox{8809}{is} \markbox{8810}{either} \markbox{8811}{a} \markbox{8812}{marked} point---either \markbox{m8813}{$\ha_U$} \markbox{8814}{or} \markbox{m8815}{$\hb_U$}---or \markbox{8816}{a} \markbox{8817}{point} \markbox{8818}{in} \markbox{m8819}{$\hT^e_U$}.  \markbox{8820}{If} \markbox{8821}{the} former, \markbox{8822}{let} \markbox{m8823}{$l_U$} \markbox{8824}{be} \markbox{8825}{the} \markbox{8826}{corresponding} \markbox{8827}{marked} point---i.e. \markbox{8828}{either} \markbox{m8829}{$a,b$}.  \markbox{8830}{If} \markbox{8831}{the} latter, \markbox{8832}{set} \markbox{m8833}{$l_U = \emptyset$}.  \markbox{8834}{We} \markbox{8835}{note} \markbox{8836}{that} \markbox{m8837}{$\ha_U \neq \hb_U$} \markbox{8838}{by} \markbox{8839}{construction} \markbox{8840}{when} \markbox{m8841}{$U$} \markbox{8842}{is} \markbox{m8843}{$\nest_{\calU}$}-minimal.

Now \markbox{8844}{suppose} \markbox{8845}{that} \markbox{m8846}{$U \in \calU$} \markbox{8847}{is} \markbox{8848}{not} \markbox{m8849}{$\nest_{\calU}$}-minimal.  \markbox{8850}{We} \markbox{8851}{have} \markbox{8852}{that} \markbox{8853}{either} \markbox{m8854}{$\hat{x}_U \in \hT^e_U$}, \markbox{8855}{in} \markbox{8856}{which} \markbox{8857}{case} \markbox{8858}{we} \markbox{8859}{set} \markbox{m8860}{$l_U = \emptyset$} \markbox{8861}{and} \markbox{m8862}{$x_U = q_U^{-1}(\hat{x}_U)$}.  Otherwise, \markbox{m8863}{$\hat{x}_U$} \markbox{8864}{is} \markbox{8865}{contained} \markbox{8866}{in} \markbox{8867}{a} \markbox{8868}{collapsed} \markbox{8869}{cluster} \markbox{m8870}{$q_U(C)$} \markbox{8871}{for} \markbox{8872}{the} \markbox{8873}{cluster} \markbox{m8874}{$C \subset T_U$}.  \markbox{8875}{Let} \markbox{m8876}{$\calB_{\min}(C)$} \markbox{8877}{denote} \markbox{8878}{the} \markbox{8879}{set} \markbox{8880}{of} \markbox{m8881}{$\nest$}-minimal \markbox{8882}{domains} \markbox{m8883}{$V\nest U$} \markbox{8884}{so} \markbox{8885}{that} \markbox{m8886}{$\delta^V_U \subset C$}.  \markbox{8887}{Observe} \markbox{8888}{that} \markbox{8889}{if} \markbox{m8890}{$\BM(C) = \emptyset$}, \markbox{8891}{then} \markbox{m8892}{$\diam_{T_U}(C)$} \markbox{8893}{is} \markbox{8894}{bounded} \markbox{8895}{in} \markbox{8896}{terms} \markbox{8897}{of} \markbox{m8898}{$r_1,r_2$} \markbox{8899}{and} \markbox{8900}{hence} \markbox{8901}{in} \markbox{8902}{terms} \markbox{8903}{of} \markbox{m8904}{$\mathfrak S$}.

We \markbox{8905}{now} \markbox{8906}{explain} \markbox{8907}{the} \markbox{8908}{honing} \markbox{8909}{process} \markbox{8910}{for} \markbox{8911}{domains} \markbox{8912}{in} \markbox{m8913}{$\BM(C)$}, \markbox{8914}{which} \markbox{8915}{will} \markbox{8916}{associate} \markbox{8917}{to} \markbox{m8918}{$\hx_U$} \markbox{8919}{a} \markbox{8920}{bounded} \markbox{8921}{diameter} \markbox{8922}{subset} \markbox{8923}{of} \markbox{8924}{the} \markbox{8925}{cluster} \markbox{m8926}{$C$} \markbox{8927}{in} \markbox{m8928}{$T_U$} (Lemma \ref{lem:bdd int total}).

Let \markbox{m8929}{$V \in \BM(C)$}.  \markbox{8930}{Then} \markbox{8931}{we} \markbox{8932}{set} 
$$C^V_U = \hull_C(C \cap (\calN_{r_2}(\delta^V_U) \cup l_V)),$$
which \markbox{8933}{is} \markbox{8934}{a} \markbox{8935}{subinterval} \markbox{8936}{of} \markbox{m8937}{$C$}, \markbox{8938}{see} \markbox{8939}{Figure} \ref{fig:C^V_U}.  Finally, \markbox{8940}{let} \markbox{m8941}{$B_U(\hx) = \bigcap_{V \in \BM(C)} C^V_U$} \markbox{8942}{be} \markbox{8943}{the} \markbox{8944}{total} \markbox{8945}{intersection} \markbox{8946}{of} \markbox{8947}{the} \markbox{m8948}{$C^V_U$}.

\begin{figure}
    \centering
    \includegraphics[width=.8\textwidth]{figures/C_V_U_interval.pdf}
    \caption{The cluster $C$ (green) in $T_U$ is identified with $\hx_U$ in $\hT_U$.  Since $V \in \BM(C)$, its shadow $\delta^V_U$ (orange) avoids all branches of $T_U$.  The marked points and leaves $l_V$ (pink) chosen by $\hx_V$ determine the half-subtree $C^V_U$ (blue) of $C$ chosen by $V$.} 
    \label{fig:C^V_U}
\end{figure}



In \markbox{8949}{Lemma} \ref{lem:bdd int pair} below, \markbox{8950}{we} \markbox{8951}{prove} \markbox{8952}{that} \markbox{8953}{if} \markbox{m8954}{$V, W \in \BM(C)$}, \markbox{8955}{then} \markbox{m8956}{$C^V_U \cap C^W_U \neq \emptyset$}.  \markbox{8957}{Since} \markbox{8958}{each} \markbox{m8959}{$C^V_U$} \markbox{8960}{is} \markbox{8961}{a} subinterval, \markbox{8962}{it} \markbox{8963}{follows} \markbox{8964}{from} \markbox{8965}{the} \markbox{8966}{Helly} \markbox{8967}{property} \markbox{8968}{for} \markbox{8969}{trees} \markbox{8970}{that} \markbox{m8971}{$B_U(x)$} \markbox{8972}{is} nonempty.  Finally, \markbox{8973}{in} \markbox{8974}{Lemma} \ref{lem:bdd int total} \markbox{8975}{we} \markbox{8976}{prove} \markbox{8977}{that} \markbox{8978}{this} \markbox{8979}{intersection} \markbox{8980}{has} \markbox{8981}{diameter} \markbox{8982}{bounded} \markbox{8983}{in} \markbox{8984}{terms} \markbox{8985}{of} \markbox{m8986}{$\mathfrak S$}.

Thus \markbox{8987}{we} \markbox{8988}{can} \markbox{8989}{define} \markbox{8990}{a} \markbox{8991}{tuple} \markbox{m8992}{$\Omega(\hx) = (x_U)_{U \in \calU}$} \markbox{8993}{as} follows:
\begin{itemize}
    \item For \markbox{m8994}{$U \in \calU$} \markbox{8995}{with} \markbox{m8996}{$U \in E(\hx)$}, \markbox{8997}{we} \markbox{8998}{set} \markbox{m8999}{$x_U = q_U^{-1}(\hx_U)$}.
    \item For \markbox{m9000}{$U \in \calU$} \markbox{9001}{with} \markbox{m9002}{$U \notin E(\hx)$} \markbox{9003}{and} \markbox{m9004}{$U \nest_{\calU}$}-minimal, \markbox{9005}{we} \markbox{9006}{let} \markbox{m9007}{$x_U$} \markbox{9008}{be} \markbox{9009}{any} \markbox{9010}{point} \markbox{9011}{in} \markbox{m9012}{$q_U^{-1}(\hx_U)$}.
    \item Otherwise, \markbox{9013}{we} \markbox{9014}{let} \markbox{m9015}{$x_U \in B_U(\hx)$}.
\end{itemize}

The \markbox{9016}{following} \markbox{9017}{is} \markbox{9018}{immediate} \markbox{9019}{from} \markbox{9020}{the} construction:

\begin{lemma}\label{lem:B_U in cluster}
For \markbox{9021}{every} \markbox{m9022}{$\hx \in \calQ$} \markbox{9023}{and} \markbox{m9024}{$U \in \calU$}, \markbox{9025}{we} \markbox{9026}{have} \markbox{m9027}{$q_U(x_U) = \hx_U$}.
\end{lemma}


In \markbox{9028}{Proposition} \ref{prop:Q-consistent} below, \markbox{9029}{we} \markbox{9030}{prove} \markbox{9031}{that} \markbox{m9032}{$(x_U)$} \markbox{9033}{is} \markbox{9034}{a} \markbox{m9035}{$\omega$}-consistent \markbox{9036}{tuple} \markbox{9037}{for} \markbox{m9038}{$\omega = \omega(\mathfrak S)>0$}.

\begin{remark}[Cubical flavor]
The \markbox{9039}{process} \markbox{9040}{of} \markbox{9041}{cluster} \markbox{9042}{honing} \markbox{9043}{is} \markbox{9044}{one} \markbox{9045}{of} \markbox{9046}{the} \markbox{9047}{few} \markbox{9048}{places} \markbox{9049}{where} \markbox{9050}{one} \markbox{9051}{sees} cubical-like \markbox{9052}{features} \markbox{9053}{appearing} \markbox{9054}{in} \markbox{9055}{a} non-explicitly \markbox{9056}{cubical} \markbox{9057}{part} \markbox{9058}{of} \markbox{9059}{the} construction.  \markbox{9060}{In} particular, \markbox{9061}{it} \markbox{9062}{is} \markbox{9063}{crucial} \markbox{9064}{that} \markbox{9065}{the} \markbox{9066}{two} \markbox{9067}{endpoints} \markbox{m9068}{$\ha_V, \hb_V$} \markbox{9069}{for} \markbox{9070}{every} \markbox{m9071}{$\nest_{\calU}$}-minimal \markbox{m9072}{$V$} \markbox{9073}{are} \markbox{9074}{distinct} \markbox{9075}{in} \markbox{m9076}{$\hT_V$}.  \markbox{9077}{Hence} \markbox{m9078}{$\nest$}-minimal \markbox{9079}{domains} \markbox{9080}{determine} \markbox{9081}{a} \markbox{9082}{choice} \markbox{9083}{of} \markbox{9084}{endpoint} \markbox{9085}{between} \markbox{m9086}{$a,b$}, \markbox{9087}{like} \markbox{9088}{a} \markbox{9089}{wall} \markbox{9090}{choosing} \markbox{9091}{a} half-space.

When \markbox{m9092}{$U$} \markbox{9093}{is} \markbox{9094}{not} \markbox{m9095}{$\nest_{\calU}$}-minimal \markbox{9096}{and} \markbox{m9097}{$\hd^V_U = \hx_U$}, \markbox{9098}{then} \markbox{9099}{the} \markbox{9100}{coordinate} \markbox{m9101}{$\hx_V$} \markbox{9102}{either} \markbox{9103}{chooses} \markbox{9104}{neither} \markbox{9105}{endpoint} \markbox{9106}{of} \markbox{m9107}{$\hT_V$} (if \markbox{m9108}{$\hx_V \in \hT^e_V$}), \markbox{9109}{or} \markbox{9110}{chooses} \markbox{9111}{one} \markbox{9112}{of} \markbox{m9113}{$\ha_V,\hb_V$}.  \markbox{9114}{This} \markbox{9115}{choice} \markbox{9116}{then} \markbox{9117}{determines} \markbox{9118}{a} \markbox{9119}{sort} \markbox{9120}{of} ``half-interval'' \markbox{m9121}{$C^V_U$} \markbox{9122}{of} \markbox{m9123}{$C$}, \markbox{9124}{where} \markbox{9125}{we} \markbox{9126}{can} \markbox{9127}{think} \markbox{9128}{of} \markbox{m9129}{$\delta^V_U$} \markbox{9130}{as} \markbox{9131}{functioning} \markbox{9132}{like} \markbox{9133}{a} \markbox{9134}{hyperplane} here.  \markbox{9135}{In} \markbox{9136}{Lemmas} \ref{lem:bdd int pair} \markbox{9137}{and} \ref{lem:bdd int total} below, \markbox{9138}{we} \markbox{9139}{see} \markbox{9140}{that} \markbox{9141}{the} \markbox{9142}{intersection} \markbox{9143}{over} \markbox{9144}{all} \markbox{9145}{such} ``half-intervals'' \markbox{m9146}{$B_U = \bigcap_{V \in \BM(C)} C^V_U$} \markbox{9147}{is} \markbox{9148}{nonempty} \markbox{9149}{and} \markbox{9150}{has} \markbox{9151}{bounded} diameter, \markbox{9152}{and} \markbox{9153}{this} ultra-filter-like \markbox{9154}{behavior} \markbox{9155}{is} \markbox{9156}{forced} \markbox{9157}{by} \markbox{9158}{consistency} \markbox{9159}{of} \markbox{9160}{the} \markbox{9161}{tuple} \markbox{m9162}{$\hx$}.
\end{remark}

\begin{remark}[A warning]
    \markbox{9163}{The} \markbox{9164}{reader} \markbox{9165}{should} \markbox{9166}{be} \markbox{9167}{warned} \markbox{9168}{that} \markbox{9169}{one} \markbox{9170}{has} \markbox{9171}{to} \markbox{9172}{deal} \markbox{9173}{with} \markbox{9174}{the} \markbox{9175}{case} \markbox{9176}{of} \markbox{m9177}{$\hx \in \calQ$} \markbox{9178}{where} \markbox{m9179}{$\hx_U$} \markbox{9180}{is} \markbox{9181}{a} \markbox{9182}{cluster} \markbox{9183}{or} \markbox{9184}{endpoint} \markbox{9185}{for} \markbox{9186}{every} \markbox{9187}{coordinate} \markbox{m9188}{$U$}.  While, \markbox{9189}{as} \markbox{9190}{in} \markbox{9191}{the} \markbox{9192}{previous} remark, \markbox{9193}{such} \markbox{9194}{points} \markbox{9195}{determine} \markbox{9196}{unambiguous} \markbox{9197}{coordinates} \markbox{9198}{in} \markbox{m9199}{$T_U$} \markbox{9200}{for} \markbox{9201}{all} \markbox{m9202}{$\nest$}-minimal \markbox{9203}{domains} \markbox{m9204}{$U \in \calU$}, \markbox{9205}{there} \markbox{9206}{is} \markbox{9207}{no} \markbox{9208}{way} \markbox{9209}{to} \markbox{9210}{leverage} \markbox{9211}{this} \markbox{9212}{data} \markbox{9213}{alone} \markbox{9214}{into} \markbox{9215}{choosing} \markbox{9216}{coordinates} \markbox{9217}{in} \markbox{m9218}{$T_V$} \markbox{9219}{for} \markbox{9220}{domains} \markbox{m9221}{$V$} \markbox{9222}{higher} \markbox{9223}{up} \markbox{9224}{the} \markbox{m9225}{$\nest$}-lattice.  \markbox{9226}{One} \markbox{9227}{must} \markbox{9228}{utilize} \markbox{9229}{the} \markbox{9230}{full} \markbox{9231}{set} \markbox{9232}{of} \markbox{9233}{relations} \markbox{9234}{between} \markbox{9235}{all} \markbox{9236}{of} \markbox{9237}{the} domains.
\end{remark}






\subsection{Bounding intersections}

In \markbox{9238}{this} subsection, \markbox{9239}{we} \markbox{9240}{prove} \markbox{9241}{the} \markbox{9242}{supporting} \markbox{9243}{statements} \markbox{9244}{we} \markbox{9245}{need} \markbox{9246}{to} \markbox{9247}{define} \markbox{9248}{the} \markbox{9249}{map} \markbox{m9250}{$\Omega:\calQ \to \prod_{U \in \calU} T_U$}.  \markbox{9251}{Again} \markbox{9252}{fix} \markbox{m9253}{$\hx \in \calQ$}.

The \markbox{9254}{first} \markbox{9255}{says} \markbox{9256}{that} \markbox{9257}{the} \markbox{m9258}{$C^V_U$} \markbox{9259}{for} \markbox{m9260}{$V \in \BM(C)$} \markbox{9261}{have} \markbox{9262}{pairwise} \markbox{9263}{nonempty} intersection:

\begin{lemma}\label{lem:bdd int pair}
If \markbox{m9264}{$V, W \in \BM(C)$}, \markbox{9265}{then} \markbox{m9266}{$C^V_U \cap C^W_U \neq \emptyset$}.  Moreover, \markbox{9267}{if} \markbox{m9268}{$d_{T_U}(\delta^V_U, \delta^W_U)>r_2$}, \markbox{9269}{then} \markbox{9270}{at} \markbox{9271}{least} \markbox{9272}{one} \markbox{9273}{of} \markbox{m9274}{$\delta^V_U \subset C^W_U$} \markbox{9275}{or} \markbox{m9276}{$\delta^W_U \subset C^V_U$} holds.
\end{lemma}

\begin{proof}[Sketch \markbox{9277}{of} proof]

We \markbox{9278}{provide} \markbox{9279}{a} \markbox{9280}{sketch} \markbox{9281}{of} \markbox{9282}{the} proof, \markbox{9283}{see} \cite[Lemma 9.9]{Dur_infcube}.  \markbox{9284}{We} \markbox{9285}{shall} \markbox{9286}{observe} \markbox{9287}{item} (1) \markbox{9288}{during} \markbox{9289}{the} \markbox{9290}{course} \markbox{9291}{of} \markbox{9292}{the} \markbox{9293}{proof} \markbox{9294}{of} \markbox{9295}{the} sketch.

By \markbox{9296}{definition} \markbox{9297}{of} \markbox{m9298}{$C^V_U = \hull_C((\calN_{r_2}(\delta^V_U) \cup l_V)\cap C)$}, \markbox{9299}{we} \markbox{9300}{may} \markbox{9301}{assume} \markbox{9302}{that} \markbox{m9303}{$\calN_{r_2}(\delta^V_U) \cap \calN_{r_2}(\delta^W_U) = \emptyset$}, \markbox{9304}{and} \markbox{9305}{hence} \markbox{9306}{that} \markbox{m9307}{$V \pitchfork W$} \markbox{9308}{by} \markbox{9309}{item} (3) \markbox{9310}{of} \markbox{9311}{Lemma} \ref{lem:interval control}.  \markbox{9312}{The} \markbox{9313}{idea} \markbox{9314}{now} \markbox{9315}{is} \markbox{9316}{that} \markbox{m9317}{$\delta^V_U, \delta^W_U$} \markbox{9318}{must} \markbox{9319}{occur} \markbox{9320}{separately} \markbox{9321}{along} \markbox{9322}{the} \markbox{9323}{cluster} \markbox{m9324}{$C$}.  \markbox{9325}{Without} \markbox{9326}{loss} \markbox{9327}{of} generality, \markbox{9328}{we} \markbox{9329}{can} \markbox{9330}{assume} \markbox{9331}{that} \markbox{m9332}{$\delta^V_U$} \markbox{9333}{separates} \markbox{m9334}{$a_U$} \markbox{9335}{from} \markbox{m9336}{$\delta^W_U$}.  \markbox{9337}{One} \markbox{9338}{can} \markbox{9339}{then} \markbox{9340}{use} \markbox{9341}{the} \markbox{9342}{consistency} \markbox{9343}{of} \markbox{m9344}{$(\hx_U)$} \markbox{9345}{and} \markbox{9346}{Lemma} \ref{lem:interval control} \markbox{9347}{and} \ref{lem:collapsed interval control} \markbox{9348}{to} \markbox{9349}{show} \markbox{9350}{that} \markbox{9351}{at} \markbox{9352}{least} \markbox{9353}{one} \markbox{9354}{of} \markbox{m9355}{$l_V = b$} \markbox{9356}{or} \markbox{m9357}{$l_W = a$}, \markbox{9358}{which} \markbox{9359}{would} \markbox{9360}{force} \markbox{m9361}{$C^V_U \cap C^W_U \neq \emptyset$}, \markbox{9362}{as} required; \markbox{9363}{see} \markbox{9364}{Figure} \ref{fig:cluster_int}.

\begin{figure}
    \centering
    \includegraphics[width=.8\textwidth]{figures/cluster_int_interval.pdf}
    \caption{The impossible situation in which $V\pitchfork W \in \BM(C)$ choose non-intersecting sides $C^V_U$ (pink) and $C^W_U$ (blue) of $C$ (green).  This forces inconsistency of $\hx_V$ and $\hx_W$.} 
    \label{fig:cluster_int}
\end{figure}
\end{proof}

As \markbox{9365}{discussed} above, \markbox{9366}{we} \markbox{9367}{can} \markbox{9368}{define} \markbox{m9369}{$B_U = \bigcap_{V \in \BM(C)}C^V_U$} \markbox{9370}{and} \markbox{9371}{it} \markbox{9372}{must} \markbox{9373}{be} non-empty \markbox{9374}{by} \markbox{9375}{the} \markbox{9376}{Helly} \markbox{9377}{property} \markbox{9378}{for} \markbox{9379}{trees} \markbox{9380}{as} \markbox{9381}{long} \markbox{9382}{as} \markbox{m9383}{$\BM(C) \neq \emptyset$}.

\begin{remark}\label{rem:Helly}
The \markbox{9384}{Helly} \markbox{9385}{property} \markbox{9386}{for} \markbox{9387}{trees} \markbox{9388}{says} \markbox{9389}{that} \markbox{9390}{if} \markbox{9391}{one} \markbox{9392}{has} \markbox{9393}{a} pairwise-intersecting \markbox{9394}{collection} \markbox{9395}{of} \markbox{9396}{subtrees} \markbox{9397}{then} \markbox{9398}{the} \markbox{9399}{collection} \markbox{9400}{has} \markbox{9401}{nonempty} \markbox{9402}{total} intersection.  \markbox{9403}{In} \markbox{9404}{the} \markbox{9405}{general} \markbox{9406}{version} \markbox{9407}{of} \markbox{9408}{our} \markbox{9409}{current} \markbox{9410}{construction} \markbox{9411}{from} \cite{Dur_infcube}, \markbox{9412}{the} \markbox{9413}{trees} \markbox{9414}{and} \markbox{9415}{subtrees} \markbox{9416}{in} \markbox{9417}{question} \markbox{9418}{need} \markbox{9419}{not} \markbox{9420}{be} \markbox{9421}{finite} diameter.  \markbox{9422}{This} \markbox{9423}{is} \markbox{9424}{one} \markbox{9425}{place} \markbox{9426}{where} \markbox{9427}{the} \markbox{9428}{arguments} \markbox{9429}{in} \markbox{9430}{our} \markbox{9431}{current} \markbox{9432}{context} \markbox{9433}{are} \markbox{9434}{simpler} \markbox{9435}{than} \markbox{9436}{that} \markbox{9437}{considered} \markbox{9438}{in} \cite{Dur_infcube}.
\end{remark}

The \markbox{9439}{next} \markbox{9440}{lemma} \markbox{9441}{bounds} \markbox{9442}{the} \markbox{9443}{diameter} \markbox{9444}{of} \markbox{m9445}{$B_U$}:

\begin{lemma}\label{lem:bdd int total}
There \markbox{9446}{exists} \markbox{m9447}{$B_1 = B_1(\mathfrak S,r_2)>0$} \markbox{9448}{such} \markbox{9449}{that} \markbox{9450}{for} \markbox{9451}{all} \markbox{m9452}{$U \in \calU$}, \markbox{9453}{we} \markbox{9454}{have} 
\markbox{m9455}{$\diam_{T_U}(B_U) < B_1$}.
\end{lemma}

\begin{proof}

If \markbox{m9456}{$B_U$} \markbox{9457}{is} \markbox{9458}{too} \markbox{9459}{wide} (relative \markbox{9460}{to} \markbox{m9461}{$r_2$}), \markbox{9462}{then} \markbox{9463}{we} \markbox{9464}{can} \markbox{9465}{find} \markbox{m9466}{$V, W \in \BM(C)$} \markbox{9467}{with} \markbox{m9468}{$\delta^V_U, \delta^W_U \subset B_U$} \markbox{9469}{and} \markbox{m9470}{$r'< d_{T_U}(\delta^V_U, \delta^W_U) < 2r'$} \markbox{9471}{for} \markbox{m9472}{$r' = r'(r_2)>0$}, \markbox{9473}{since} \markbox{9474}{the} \markbox{m9475}{$\delta$}-sets \markbox{9476}{for} \markbox{9477}{domains} \markbox{9478}{in} \markbox{m9479}{$\BM(C)$} \markbox{9480}{coarsely} \markbox{9481}{cover} \markbox{m9482}{$C$} \markbox{9483}{with} \markbox{9484}{coarseness} \markbox{9485}{depending} \markbox{9486}{only} \markbox{9487}{on} \markbox{m9488}{$r_2$}.  \markbox{9489}{By} \markbox{9490}{Lemma} \ref{lem:bdd int pair}, \markbox{9491}{we} \markbox{9492}{must} \markbox{9493}{have} \markbox{9494}{at} \markbox{9495}{least} \markbox{9496}{one} \markbox{9497}{of} \markbox{m9498}{$\delta^V_U \subset C^W_U$} \markbox{9499}{or} \markbox{m9500}{$\delta^W_U \subset C^V_U$}, \markbox{9501}{or} \markbox{9502}{possibly} both.  \markbox{9503}{In} fact, \markbox{9504}{both} \markbox{9505}{must} hold, \markbox{9506}{for} \markbox{9507}{if} \markbox{m9508}{$\delta^V_U \notin C^W_U$}, \markbox{9509}{then} \markbox{m9510}{$\delta^V_U \notin B_U$}, \markbox{9511}{which} \markbox{9512}{is} impossible.  \markbox{9513}{But} \markbox{9514}{then} \markbox{m9515}{$C^V_U \cap C^W_U \subset \hull_C(\calN_{r_2}(\delta^V_U) \cup \calN_{r_2}(\delta^W_U))$}, \markbox{9516}{which} \markbox{9517}{has} \markbox{9518}{diameter} \markbox{9519}{bounded} \markbox{9520}{by} \markbox{m9521}{$2r' + 2r_2$} \markbox{9522}{since} \markbox{m9523}{$d_{T_U}(\delta^V_U, \delta^W_U) < 2r'$}.  \markbox{9524}{Since} \markbox{m9525}{$B_U \subset C^V_U \cap C^W_U$}, \markbox{9526}{this} \markbox{9527}{completes} \markbox{9528}{the} proof.
\end{proof}

We \markbox{9529}{are} \markbox{9530}{now} \markbox{9531}{in} \markbox{9532}{place} \markbox{9533}{to} \markbox{9534}{state} \markbox{9535}{the} \markbox{9536}{consistency} result:

\begin{proposition}\label{prop:Q-consistent}
There \markbox{9537}{exist} \markbox{m9538}{$\alpha_{\omega}=\alpha_{\omega}(\mathfrak S,r_1,r_2,R)>0$} \markbox{9539}{and} \markbox{9540}{a} \markbox{9541}{map} \markbox{m9542}{$\Omega: \calQ \to \calY$} \markbox{9543}{so} \markbox{9544}{that} \markbox{9545}{for} \markbox{9546}{any} \markbox{m9547}{$\hx \in \calQ$}, \markbox{9548}{the} \markbox{9549}{tuple} \markbox{m9550}{$\Omega(\hx)$} \markbox{9551}{is} \markbox{m9552}{$\alpha_{\omega}$}-consistent.  Moreover, \markbox{9553}{if} \markbox{m9554}{$\Omega(\hx) = (x_U)$}, \markbox{9555}{then} \markbox{m9556}{$q_U(x_U) = \hx_U$} \markbox{9557}{for} \markbox{9558}{each} \markbox{m9559}{$U \in \calU$}.
\end{proposition}

The \markbox{9560}{proof} \markbox{9561}{of} \markbox{9562}{this} \markbox{9563}{proposition} \markbox{9564}{is} \markbox{9565}{a} \markbox{9566}{somewhat} \markbox{9567}{elaborate} \markbox{9568}{exercise} \markbox{9569}{in} \markbox{9570}{the} \markbox{9571}{definition} \markbox{9572}{of} \markbox{m9573}{$\Omega$} \markbox{9574}{and} \markbox{9575}{the} \markbox{9576}{construction} \markbox{9577}{of} \markbox{9578}{the} clusters, \markbox{9579}{in} \markbox{9580}{which} \markbox{9581}{one} \markbox{9582}{utilizes} \markbox{9583}{many} \markbox{9584}{standard} HHS-type arguments.  \markbox{9585}{Unlike} \markbox{9586}{other} \markbox{9587}{proofs} \markbox{9588}{in} \markbox{9589}{this} paper, \markbox{9590}{the} \markbox{9591}{proof} \markbox{9592}{of} \markbox{9593}{this} \markbox{9594}{fact} \markbox{9595}{in} \markbox{9596}{our} \markbox{9597}{current} \markbox{9598}{setting} \markbox{9599}{is} \markbox{9600}{not} \markbox{9601}{substantially} \markbox{9602}{different} \markbox{9603}{from} \markbox{9604}{proof} \markbox{9605}{in} \markbox{9606}{the} \markbox{9607}{general} \markbox{9608}{case} \markbox{9609}{in} \cite[Subsection 9.5]{Dur_infcube}, \markbox{9610}{beyond} \markbox{9611}{the} \markbox{9612}{need} \markbox{9613}{for} \markbox{9614}{working} \markbox{9615}{with} \markbox{m9616}{$\nest$}-minimal \emph{bipartite domains} \markbox{9617}{as} \markbox{9618}{defined} \markbox{9619}{in} \cite[Definition 9.2]{Dur_infcube} \markbox{9620}{instead} \markbox{9621}{of} \markbox{9622}{all} \markbox{m9623}{$\nest$}-minimal domains.  \markbox{9624}{Thus} \markbox{9625}{instead} \markbox{9626}{of} \markbox{9627}{repeating} \markbox{9628}{it} here, \markbox{9629}{we} \markbox{9630}{leave} \markbox{9631}{it} \markbox{9632}{to} \markbox{9633}{the} \markbox{9634}{interested} \markbox{9635}{reader} \markbox{9636}{to} \markbox{9637}{check} \markbox{9638}{the} details.

\subsection{Tree trimming}\label{subsec:tree trimming}

In \markbox{9639}{this} subsection, \markbox{9640}{we} \markbox{9641}{introduce} \markbox{9642}{a} \markbox{9643}{useful} \markbox{9644}{tool} \markbox{9645}{for} \markbox{9646}{modifying} \markbox{9647}{collapsed} \markbox{9648}{interval} \markbox{9649}{systems} \markbox{9650}{and} \markbox{9651}{their} \markbox{9652}{associated} \markbox{m9653}{$0$}-consistent sets.  \markbox{9654}{These} ``tree-trimming'' \markbox{9655}{techniques} \markbox{9656}{will} \markbox{9657}{allow} \markbox{9658}{us} \markbox{9659}{to} \markbox{9660}{perform} \markbox{9661}{controlled} \markbox{9662}{collapses} \markbox{9663}{of} \markbox{9664}{subintervals} \markbox{9665}{across} \markbox{9666}{the} \markbox{9667}{various} \markbox{9668}{collapsed} \markbox{9669}{intervals} \markbox{m9670}{$\hT_U$} \markbox{9671}{while} \markbox{9672}{coarsely} \markbox{9673}{preserving} \markbox{9674}{the} \markbox{9675}{associated} \markbox{m9676}{$\calQ$}-distance.  \markbox{9677}{We} \markbox{9678}{think} \markbox{9679}{of} \markbox{9680}{them} \markbox{9681}{as} \markbox{9682}{a} \markbox{9683}{more} \markbox{9684}{flexible} \markbox{9685}{version} \markbox{9686}{of} \markbox{9687}{the} \markbox{9688}{distance} formula, \markbox{9689}{as} \markbox{9690}{they} \markbox{9691}{allow} \markbox{9692}{us} \markbox{9693}{to} \markbox{9694}{modify} \markbox{9695}{distance} \markbox{9696}{terms} \markbox{9697}{instead} \markbox{9698}{of} \markbox{9699}{just} \markbox{9700}{throwing} \markbox{9701}{them} \markbox{9702}{out} \markbox{9703}{by} \markbox{9704}{increasing} \markbox{9705}{a} threshold.  \markbox{9706}{For} \markbox{9707}{our} purposes, \markbox{9708}{they} \markbox{9709}{will} \markbox{9710}{be} \markbox{9711}{used} \markbox{9712}{in} \markbox{9713}{two} \markbox{9714}{different} ways: \markbox{9715}{We} \markbox{9716}{will} \markbox{9717}{need} \markbox{9718}{them} \markbox{9719}{in} \markbox{9720}{the} \markbox{9721}{proof} \markbox{9722}{of} \markbox{9723}{coarse} \markbox{9724}{surjectivity} \markbox{9725}{of} \markbox{m9726}{$\hPsi:H \to \calQ$}, \markbox{9727}{and} \markbox{9728}{they} \markbox{9729}{will} \markbox{9730}{also} \markbox{9731}{be} \markbox{9732}{useful} \markbox{9733}{later} \markbox{9734}{in} \markbox{9735}{Subsection} \ref{subsec:tt cube} \markbox{9736}{to} \markbox{9737}{modify} \markbox{9738}{the} \markbox{9739}{cubical} \markbox{9740}{structure} \markbox{9741}{on} \markbox{m9742}{$\calQ$}.

The \markbox{9743}{main} \markbox{9744}{idea} \markbox{9745}{is} simple: \markbox{9746}{Given} \markbox{9747}{a} \markbox{9748}{family} \markbox{9749}{of} \markbox{9750}{subintervals} \markbox{m9751}{$\calB$} \markbox{9752}{across} \markbox{9753}{of} \markbox{9754}{the} \markbox{9755}{family} \markbox{9756}{of} \markbox{9757}{intervals} \markbox{m9758}{$\hT_U$}, \markbox{9759}{we} \markbox{9760}{want} \markbox{9761}{to} \markbox{9762}{collapse} \markbox{9763}{these} \markbox{9764}{subintervals} \markbox{m9765}{$\Delta_U:\hT_U \to \hT_{U,0}$} coordinate-wise \markbox{9766}{and} \markbox{9767}{then} \markbox{9768}{combine} \markbox{9769}{them} \markbox{9770}{into} \markbox{9771}{a} \markbox{9772}{global} \markbox{9773}{collapsing} \markbox{9774}{map} \markbox{m9775}{$\Delta:\calQ \to \calQ'$}, \markbox{9776}{where} \markbox{m9777}{$\calQ'$} \markbox{9778}{is} \markbox{9779}{the} \markbox{m9780}{$0$}-consistent \markbox{9781}{set} \markbox{9782}{of} \markbox{m9783}{$\prod_{U \in \calU} \hT_{U,0}$}, \markbox{9784}{defined} \markbox{9785}{the} \markbox{9786}{same} \markbox{9787}{way} \markbox{9788}{as} \markbox{9789}{in} \markbox{9790}{Definition} \ref{defn:Q defined}.  Formally, \markbox{9791}{we} \markbox{9792}{use} \markbox{9793}{the} \markbox{9794}{following} definition:

\begin{definition}[Admissible \markbox{9795}{trimming} setup]\label{defn:trimming setup}
Given \markbox{m9796}{$B>0$}, \markbox{9797}{a} \markbox{m9798}{$B$}-\emph{admissible trimming setup} \markbox{9799}{is} \markbox{9800}{a} \markbox{9801}{collection} \markbox{9802}{of} \emph{trimming intervals} \markbox{m9803}{$\calB$} \markbox{9804}{in} \markbox{9805}{the} \markbox{9806}{various} \markbox{m9807}{$\hT_{U,e}$} \markbox{9808}{satisfying} \markbox{9809}{the} following:
\begin{itemize}
\item For \markbox{9810}{each} \markbox{9811}{component}  \markbox{m9812}{$E \in \pi_0(\hT_{U,e})$}, \markbox{9813}{there} \markbox{9814}{are} \markbox{9815}{at} \markbox{9816}{most} \markbox{m9817}{$B$}-many \markbox{9818}{components} \markbox{m9819}{$D \in \calB$} \markbox{9820}{with} \markbox{m9821}{$D \subset E$}.
\item For \markbox{9822}{each} \markbox{9823}{component} \markbox{m9824}{$D \in \calB$} \markbox{9825}{satisfies} \markbox{m9826}{$|D|<B$}.
\end{itemize}
\end{definition}

Given \markbox{9827}{a} \markbox{m9828}{$B$}-admissible \markbox{9829}{trimming} \markbox{9830}{setup} \markbox{m9831}{$\calB$} \markbox{9832}{on} \markbox{m9833}{$\{\hT_U\}_{U \in\calU}$}, \markbox{9834}{for} \markbox{9835}{each} \markbox{m9836}{$U \in \calU$} \markbox{9837}{let} \markbox{m9838}{$\Delta_U:\hT_U \to \hT_{U,0}$} \markbox{9839}{denote} \markbox{9840}{the} \markbox{9841}{map} \markbox{9842}{which} \markbox{9843}{collapses} \markbox{9844}{each} \markbox{9845}{trimming} \markbox{9846}{interval} \markbox{9847}{in} \markbox{m9848}{$\hT_U$} \markbox{9849}{to} \markbox{9850}{a} point.  \markbox{9851}{These} \markbox{9852}{allow} \markbox{9853}{us} \markbox{9854}{to} \markbox{9855}{induce} \markbox{9856}{projection} \markbox{9857}{data} \markbox{9858}{on} \markbox{9859}{the} \markbox{m9860}{$\hT_{U,0}$} \markbox{9861}{as} follows: \markbox{9862}{For} \markbox{m9863}{$V \nest U$} \markbox{9864}{and} \markbox{m9865}{$V \pitchfork U$}, \markbox{9866}{we} \markbox{9867}{set} \markbox{m9868}{$(\hd^V_U)_0 = \Delta_U(\hd^V_U)$}, \markbox{9869}{and} \markbox{9870}{if} \markbox{m9871}{$U \nest V$}, \markbox{9872}{we} \markbox{9873}{set} \markbox{m9874}{$(\hd^V_U)_0 = \Delta_U \circ \hd^V_U \circ \Delta^{-1}_V$}.  \markbox{9875}{We} \markbox{9876}{let} \markbox{m9877}{$\Delta: \prod_{\calU} \hT_U \to \prod_{\calU} \hT_{U,0}$} \markbox{9878}{denote} \markbox{9879}{the} \markbox{9880}{product} map.


\begin{theorem}[Tree Trimming]\label{thm:tree trimming}
There \markbox{9881}{exists} \markbox{m9882}{$B_{tt} = B_{tt}(\mathfrak S, K)>0$} \markbox{9883}{so} \markbox{9884}{that} \markbox{9885}{for} \markbox{9886}{any} \markbox{m9887}{$B < B_{tt}$}, \markbox{9888}{there} \markbox{9889}{exists} \markbox{m9890}{$L =L(\mathfrak S, B)>0$} \markbox{9891}{so} \markbox{9892}{that} \markbox{9893}{the} \markbox{9894}{following} hold:

\begin{enumerate}
\item We \markbox{9895}{have} \markbox{m9896}{$\Delta(\calQ) \subset \calQ'$}.
\item There \markbox{9897}{is} \markbox{9898}{a} \markbox{9899}{map} \markbox{m9900}{$\Xi:\calQ' \to \calQ$} \markbox{9901}{so} \markbox{9902}{that} \markbox{m9903}{$\Delta \circ \Xi = id_{\calQ'}$}.  \markbox{9904}{In} particular, \markbox{m9905}{$\Delta(\calQ) = \calQ'$}.
\item The \markbox{9906}{map} \markbox{m9907}{$\Delta:\calQ \to \calQ'$} \markbox{9908}{is} \markbox{9909}{an} \markbox{m9910}{$(L,L)$}-quasi-isometry.
\end{enumerate}
\end{theorem}

While \markbox{9911}{the} \markbox{9912}{statement} \markbox{9913}{is} \markbox{9914}{quite} \markbox{9915}{believable} \markbox{9916}{in} \markbox{9917}{light} \markbox{9918}{of} \markbox{9919}{the} \markbox{9920}{Distance} \markbox{9921}{Formula} \ref{thm:DF}, \markbox{9922}{the} \markbox{9923}{proof} \markbox{9924}{of} \markbox{9925}{this} \markbox{9926}{theorem} \markbox{9927}{is} \markbox{9928}{quite} involved.  \markbox{9929}{While} \markbox{9930}{these} \markbox{9931}{ideas} \markbox{9932}{were} \markbox{9933}{first} \markbox{9934}{developed} \markbox{9935}{in} \markbox{9936}{greater} \markbox{9937}{generality} \markbox{9938}{in} \cite[Section 10]{Dur_infcube}---where \markbox{9939}{it} \markbox{9940}{also} \markbox{9941}{works} \markbox{9942}{when} \markbox{9943}{the} \markbox{9944}{underlying} \markbox{9945}{data} \markbox{9946}{involves} \markbox{9947}{more} \markbox{9948}{than} \markbox{9949}{two} \markbox{9950}{points} \markbox{9951}{and} \markbox{9952}{also} \markbox{9953}{hierarchy} rays---the \markbox{9954}{proof} \markbox{9955}{these} \markbox{9956}{is} \markbox{9957}{only} \markbox{9958}{slightly} \markbox{9959}{more} \markbox{9960}{involved} \markbox{9961}{than} \markbox{9962}{that} \markbox{9963}{required} \markbox{9964}{in} \markbox{9965}{our} setting.  Moreover, \markbox{9966}{many} \markbox{9967}{of} \markbox{9968}{the} \markbox{9969}{technicalities} \markbox{9970}{from} \markbox{9971}{dealing} \markbox{9972}{with} \markbox{9973}{rays} \markbox{9974}{are} \markbox{9975}{dealt} \markbox{9976}{with} \markbox{9977}{in} \markbox{9978}{separate} arguments, \markbox{9979}{so} \markbox{9980}{the} \markbox{9981}{interested} \markbox{9982}{reader} \markbox{9983}{is} \markbox{9984}{encouraged} \markbox{9985}{to} \markbox{9986}{see} \markbox{9987}{a} \markbox{9988}{full} \markbox{9989}{proof} there.

Instead, \markbox{9990}{we} \markbox{9991}{will} \markbox{9992}{present} \markbox{9993}{a} \markbox{9994}{short} \markbox{9995}{sketch} below, \markbox{9996}{which} \markbox{9997}{will} \markbox{9998}{hopefully} \markbox{9999}{provide} \markbox{10000}{enough} \markbox{10001}{intuition} \markbox{10002}{to} \markbox{10003}{make} \markbox{10004}{the} \markbox{10005}{statement} believable.  \markbox{10006}{We} \markbox{10007}{have} \markbox{10008}{included} \markbox{10009}{a} \markbox{10010}{proof} \markbox{10011}{of} \markbox{10012}{the} \markbox{10013}{stated} \markbox{10014}{version} \markbox{10015}{of} \markbox{10016}{Theorem} \ref{thm:tree trimming} \markbox{10017}{in} \markbox{10018}{Appendix} \ref{app:TT}.



\begin{proof}[Sketch \markbox{10019}{of} proof]
The \markbox{10020}{fact} \markbox{10021}{that} \markbox{m10022}{$\Delta(\calQ) \subset \calQ'$}, \markbox{10023}{namely} \markbox{10024}{that} \markbox{m10025}{$\Delta$} \markbox{10026}{preserves} \markbox{m10027}{$0$}-consistency, \markbox{10028}{is} \markbox{10029}{immediate} \markbox{10030}{from} \markbox{10031}{the} \markbox{10032}{fact} \markbox{10033}{that} \markbox{10034}{the} \markbox{m10035}{$\Delta_U$} \markbox{10036}{just} \markbox{10037}{collapse} subintervals, \markbox{10038}{so} \markbox{10039}{coordinates} \markbox{10040}{which} \markbox{10041}{were} \markbox{10042}{collapsed} \markbox{10043}{projections} \markbox{10044}{remain} \markbox{10045}{collapsed} projections, \markbox{10046}{showing} \markbox{10047}{item} (1).

Item (2) \markbox{10048}{is} \markbox{10049}{the} \markbox{10050}{most} \markbox{10051}{involved} part.  \markbox{10052}{For} \markbox{10053}{each} \markbox{m10054}{$U \in \calU$}, \markbox{10055}{let} \markbox{m10056}{$C_U = \Delta^{-1}_U(\hy_U)$}.  \markbox{10057}{The} \markbox{10058}{goal} \markbox{10059}{is} \markbox{10060}{to} pick, \markbox{10061}{for} \markbox{10062}{each} \markbox{m10063}{$U \in \calU$}, \markbox{10064}{a} \markbox{10065}{point} \markbox{m10066}{$\hx_U \in C_U$} \markbox{10067}{and} \markbox{10068}{then} \markbox{10069}{prove} \markbox{m10070}{$0$}-consistency \markbox{10071}{of} \markbox{10072}{the} \markbox{10073}{tuple} \markbox{m10074}{$\hx = (\hx_U)$}.  \markbox{10075}{Note} \markbox{10076}{that} \markbox{m10077}{$\Delta(\hx) =\hy$} \markbox{10078}{for} \markbox{10079}{such} \markbox{10080}{a} tuple, \markbox{10081}{by} construction.

The \markbox{10082}{proof} \markbox{10083}{is} \markbox{10084}{similar} \markbox{10085}{in} \markbox{10086}{spirit} \markbox{10087}{to} \markbox{10088}{the} cluster-honing \markbox{10089}{procedure} \markbox{10090}{from} \markbox{10091}{Subsection} \ref{subsec:hO defined}.  \markbox{10092}{The} \markbox{10093}{main} \markbox{10094}{difference} \markbox{10095}{is} \markbox{10096}{that} \markbox{10097}{the} \markbox{10098}{collapsing} \markbox{10099}{subintervals} \markbox{10100}{are} \markbox{10101}{not} \markbox{10102}{automatically} \markbox{10103}{associated} \markbox{10104}{to} \markbox{10105}{a} \markbox{10106}{collection} \markbox{10107}{of} domains, \markbox{10108}{and} \markbox{10109}{this} \markbox{10110}{is} \markbox{10111}{where} \markbox{10112}{the} \markbox{10113}{work} lies.  \markbox{10114}{The} \markbox{10115}{argument} \markbox{10116}{is} \markbox{10117}{inductive} \markbox{10118}{on} \markbox{10119}{level} \markbox{10120}{in} \markbox{10121}{the} \markbox{m10122}{$\nest$}-lattice \markbox{10123}{and} \markbox{10124}{requires} \markbox{10125}{a} \markbox{10126}{careful} \markbox{10127}{analysis} \markbox{10128}{of} \markbox{10129}{the} \markbox{10130}{construction} \markbox{10131}{and} \markbox{10132}{number} \markbox{10133}{of} \markbox{10134}{hierarchal} techniques.

Finally, \markbox{10135}{for} \markbox{10136}{item} (3), \markbox{10137}{since} \markbox{m10138}{$\Delta|_{\calQ}$} \markbox{10139}{is} \markbox{10140}{surjective} \markbox{10141}{and} \markbox{10142}{distance} non-increasing, \markbox{10143}{it} \markbox{10144}{suffices} \markbox{10145}{to} \markbox{10146}{prove} \markbox{10147}{that} \markbox{m10148}{$d_{\calQ} \prec d_{\calQ'}$}, \markbox{10149}{and} \markbox{10150}{for} \markbox{10151}{this} \markbox{10152}{it} \markbox{10153}{suffices} \markbox{10154}{to} \markbox{10155}{bound} \markbox{10156}{the} \markbox{10157}{distances} \markbox{10158}{in} \markbox{10159}{each} \markbox{m10160}{$U \in \calU$}.

Given \markbox{m10161}{$\hx, \hy \in \calQ$} \markbox{10162}{with} \markbox{m10163}{$\hx' = \Delta(\hx)$} \markbox{10164}{and} \markbox{m10165}{$\hy' = \Delta(\hy)$}, \markbox{10166}{the} \markbox{10167}{concern} \markbox{10168}{is} \markbox{10169}{that} \markbox{10170}{somehow} \markbox{10171}{one} \markbox{10172}{will} \markbox{10173}{have} \markbox{10174}{arbitrarily} \markbox{10175}{shrunk} \markbox{10176}{distances} \markbox{10177}{during} \markbox{10178}{the} \markbox{10179}{trimming} process.  However, \markbox{10180}{each} \markbox{10181}{edge} \markbox{10182}{component} \markbox{10183}{of} \markbox{m10184}{$\hT_U$} \markbox{10185}{through} \markbox{10186}{which} \markbox{10187}{the} \markbox{10188}{geodesic} \markbox{m10189}{$[\hx_U,\hy_U]$} \markbox{10190}{passes} \markbox{10191}{can} \markbox{10192}{only} \markbox{10193}{contain} boundedly-many \markbox{10194}{subintervals} collapsed.  However, \markbox{10195}{all} \markbox{10196}{but} \markbox{10197}{at} \markbox{10198}{most} \markbox{10199}{two} \markbox{10200}{of} \markbox{10201}{such} \markbox{10202}{edge} \markbox{10203}{components} \markbox{10204}{have} \markbox{10205}{endpoints} \markbox{10206}{which} \markbox{10207}{are} \markbox{10208}{cluster} \markbox{10209}{points} \markbox{10210}{labeled} \markbox{10211}{by} \markbox{m10212}{$\hd^V_U$} \markbox{10213}{for} \markbox{m10214}{$V$} \markbox{m10215}{$\nest$}-minimal.  \markbox{10216}{Since} \markbox{10217}{for} \markbox{10218}{such} \markbox{m10219}{$V$}, \markbox{10220}{the} \markbox{10221}{map} \markbox{m10222}{$\Delta_V:\hT_V \to \hT'_V$} \markbox{10223}{collapses} \markbox{10224}{subintervals} \markbox{10225}{of} \markbox{10226}{total} \markbox{10227}{diameter} \markbox{10228}{at} \markbox{10229}{most} \markbox{m10230}{$B^2$}, \markbox{10231}{we} \markbox{10232}{can} \markbox{10233}{use} \markbox{10234}{these} \markbox{m10235}{$\nest$}-minimal \markbox{10236}{domains} \markbox{10237}{to} \markbox{10238}{account} \markbox{10239}{for} \markbox{10240}{all} \markbox{10241}{information} \markbox{10242}{lost} \markbox{10243}{up} \markbox{10244}{the} hierarchy.

Making \markbox{10245}{this} \markbox{10246}{precise} \markbox{10247}{takes} \markbox{10248}{care} \markbox{10249}{and} \markbox{10250}{utilizes} \markbox{10251}{Proposition} \ref{prop:bounding containers}.  \markbox{10252}{The} \markbox{10253}{interested} \markbox{10254}{reader} \markbox{10255}{can} \markbox{10256}{see} \cite[Section 10]{Dur_infcube}. 
\end{proof}

\subsection{Converting to simplicial intervals}

One \markbox{10257}{application} \markbox{10258}{of} \markbox{10259}{the} \markbox{10260}{Tree} \markbox{10261}{Trimming} \markbox{10262}{Theorem} \ref{thm:tree trimming} \markbox{10263}{is} \markbox{10264}{that} \markbox{10265}{we} \markbox{10266}{can} \markbox{10267}{replace} \markbox{10268}{the} \markbox{10269}{family} \markbox{10270}{of} \markbox{10271}{collapsed} \markbox{10272}{intervals} \markbox{m10273}{$\hT_U$} \markbox{10274}{with} \markbox{10275}{a} \markbox{10276}{family} \markbox{10277}{of} \markbox{10278}{simplicial} intervals, \markbox{10279}{where} \markbox{10280}{the} \markbox{10281}{cluster} \markbox{10282}{and} \markbox{10283}{marked} \markbox{10284}{points} \markbox{10285}{lie} \markbox{10286}{at} vertices.  \markbox{10287}{The} \markbox{10288}{idea} \markbox{10289}{here} \markbox{10290}{is} \markbox{10291}{that} \markbox{10292}{one} \markbox{10293}{can} \markbox{10294}{trim} \markbox{10295}{each} \markbox{10296}{edge} \markbox{10297}{component} \markbox{m10298}{$E \subset \hT^e_U$} \markbox{10299}{to} \markbox{10300}{have} \markbox{10301}{a} \markbox{10302}{nonnegative} \markbox{10303}{integer} \markbox{10304}{length} \markbox{10305}{simply} \markbox{10306}{by} \markbox{10307}{collapsing} \markbox{10308}{some} \markbox{10309}{small} \markbox{10310}{segment} \markbox{10311}{of} \markbox{m10312}{$E$} \markbox{10313}{of} \markbox{10314}{length} \markbox{10315}{less} \markbox{10316}{than} \markbox{m10317}{$1$}.  \markbox{10318}{The} \markbox{10319}{family} \markbox{10320}{of} \markbox{10321}{such} \markbox{10322}{segments} \markbox{10323}{is} \markbox{10324}{an} \markbox{m10325}{$1$}-admissible \markbox{10326}{trimming} setup, \markbox{10327}{and} \markbox{10328}{this} \markbox{10329}{provides} \markbox{10330}{us} \markbox{10331}{a} \markbox{10332}{family} \markbox{10333}{of} \markbox{10334}{intervals} \markbox{m10335}{$\{\hT'_U\}_{U \in \calU}$} \markbox{10336}{where} \markbox{m10337}{$\Delta_U:\hT_U\to \hT'_U$} \markbox{10338}{collapses} \markbox{10339}{these} \markbox{10340}{small} segments, \markbox{10341}{and} \markbox{m10342}{$\Delta:\calQ \to \calQ'$} \markbox{10343}{combines} \markbox{10344}{these} \markbox{10345}{to} \markbox{10346}{a} \markbox{10347}{map} \markbox{10348}{between} \markbox{10349}{their} \markbox{m10350}{$0$}-consistent sets.

\begin{corollary}\label{cor:simplicial version}
Suppose \markbox{10351}{that} \markbox{m10352}{$\{\hT_U\}_{U \in \calU}$} \markbox{10353}{are} \markbox{10354}{the} \markbox{10355}{collapsed} \markbox{10356}{intervals} \markbox{10357}{associated} \markbox{10358}{to} \markbox{10359}{an} \markbox{m10360}{$(r_1,r_2)$}-thickening \markbox{10361}{of} \markbox{10362}{an} \markbox{m10363}{$R$}-interval \markbox{10364}{system} \markbox{10365}{for} \markbox{m10366}{$a,b \in \calX$}.  \markbox{10367}{There} \markbox{10368}{exists} \markbox{m10369}{$L_{simp} = L_{simp}(R, \calX)>0$} \markbox{10370}{so} \markbox{10371}{that} \markbox{m10372}{$\Delta:\calQ \to \calQ'$} \markbox{10373}{is} \markbox{10374}{an} \markbox{m10375}{$(L_{simp},L_{simp})$}-quasi-isometry.

\begin{itemize}
\item In particular, \markbox{10376}{up} \markbox{10377}{to} \markbox{10378}{a} \markbox{10379}{uniform} quasi-isometry \markbox{10380}{of} \markbox{m10381}{$\calQ$}, \markbox{10382}{we} \markbox{10383}{can} \markbox{10384}{assume} \markbox{10385}{that} \markbox{10386}{the} \markbox{10387}{collapsed} \markbox{10388}{intervals} \markbox{m10389}{$\hT_U$} \markbox{10390}{are} \markbox{10391}{all} \markbox{10392}{simplicial} \markbox{10393}{intervals} \markbox{10394}{with} \markbox{10395}{cluster} \markbox{10396}{and} \markbox{10397}{marked} \markbox{10398}{points} \markbox{10399}{at} vertices. 
\end{itemize}
\end{corollary}

See \cite[Subsection 10.1]{Dur_infcube} \markbox{10400}{for} \markbox{10401}{more} discussion.  \markbox{10402}{We} \markbox{10403}{note} \markbox{10404}{that} \markbox{10405}{the} \markbox{10406}{above} \markbox{10407}{corollary} \markbox{10408}{will} \markbox{10409}{not} \markbox{10410}{be} \markbox{10411}{used} \markbox{10412}{in} \markbox{10413}{the} \markbox{10414}{proof} \markbox{10415}{of} \markbox{10416}{the} \markbox{10417}{Main} \markbox{10418}{Theorem} \ref{thmi:main}, \markbox{10419}{because} \markbox{10420}{we} \markbox{10421}{will} \markbox{10422}{carefully} \markbox{10423}{construct} \markbox{10424}{stable} \markbox{10425}{intervals} \markbox{10426}{to} \markbox{10427}{be} simplicial.  However, \markbox{10428}{it} \markbox{10429}{is} \markbox{10430}{necessary} \markbox{10431}{for} \markbox{10432}{taking} \markbox{10433}{general} \markbox{10434}{intervals} \markbox{10435}{in} \markbox{10436}{each} \markbox{10437}{hyperbolic} \markbox{10438}{spaces} \markbox{10439}{and} \markbox{10440}{performing} \markbox{10441}{the} \markbox{10442}{above} \markbox{10443}{constructions} \markbox{10444}{to} \markbox{10445}{form} \markbox{10446}{a} \markbox{10447}{hierarchical} \markbox{10448}{family} \markbox{10449}{of} \markbox{10450}{intervals} (see \markbox{10451}{Definition} \ref{defn:HFI}, \markbox{10452}{which} \markbox{10453}{is} \markbox{10454}{necessary} \markbox{10455}{for} \markbox{10456}{our} \markbox{10457}{proof} \markbox{10458}{of} \markbox{10459}{the} \markbox{10460}{distance} \markbox{10461}{formula} \markbox{10462}{below} (Corollary \ref{cor:DF lower bound}).


\subsection{From $\Omega:\calQ \to \prod_{U \in \calU} T_U$ to $\hO:\calQ \to H$} \label{subsec:upgrade to HHS}

We \markbox{10463}{return} \markbox{10464}{to} \markbox{10465}{our} \markbox{10466}{main} task, \markbox{10467}{namely} \markbox{10468}{defining} \markbox{10469}{a} quasi-isometry \markbox{m10470}{$\hO:\calQ \to H$}.  \markbox{10471}{So} far, \markbox{10472}{we} \markbox{10473}{have} \markbox{10474}{defined} \markbox{10475}{a} \markbox{10476}{map} \markbox{m10477}{$\Omega:\calQ \to \prod_{U \in \calU} T_U$}, \markbox{10478}{which} \markbox{10479}{was} \markbox{10480}{the} \markbox{10481}{bulk} \markbox{10482}{of} \markbox{10483}{the} work.  \markbox{10484}{Our} \markbox{10485}{next} \markbox{10486}{step} \markbox{10487}{is} \markbox{10488}{to} \markbox{10489}{upgrade} \markbox{10490}{this} \markbox{10491}{to} \markbox{10492}{a} \markbox{10493}{map} \markbox{m10494}{$\hO:\calQ \to H$}.  \markbox{10495}{Since} \markbox{10496}{this} \markbox{10497}{part} \markbox{10498}{of} \markbox{10499}{the} \markbox{10500}{argument} \markbox{10501}{mostly} \markbox{10502}{uses} \markbox{10503}{standard} \markbox{10504}{HHS} techniques, \markbox{10505}{we} \markbox{10506}{will} \markbox{10507}{just} \markbox{10508}{outline} it, \markbox{10509}{with} \markbox{10510}{appropriate} \markbox{10511}{citations} \markbox{10512}{to} \cite{Dur_infcube}.

For \markbox{10513}{each} \markbox{m10514}{$\hx \in \calQ$}, \markbox{10515}{we} \markbox{10516}{first} \markbox{10517}{take} \markbox{10518}{our} \markbox{10519}{tuple} \markbox{m10520}{$\Omega(\hx) = (x_U) \subset \prod_{\calU} T_U$} \markbox{10521}{and} \markbox{10522}{push} \markbox{10523}{it} \markbox{10524}{forward} \markbox{10525}{to} \markbox{10526}{a} \markbox{10527}{tuple} \markbox{m10528}{$(y_U) \in \prod_{\calU} \calC(U)$} \markbox{10529}{by} \markbox{m10530}{$\phi_U(x_U) = y_U$}, \markbox{10531}{where} \markbox{m10532}{$\phi_U:T_U \to \calC(U)$} \markbox{10533}{are} \markbox{10534}{the} \markbox{10535}{maps} \markbox{10536}{provided} \markbox{10537}{by} \markbox{10538}{the} \markbox{m10539}{$R$}-interval \markbox{10540}{system} \markbox{10541}{structure} (Definition \ref{defn:interval axioms}).  \markbox{10542}{These} \markbox{10543}{combine} \markbox{10544}{to} \markbox{10545}{define} \markbox{10546}{a} \markbox{10547}{map} \markbox{m10548}{$\Phi:\prod_{U \in \calU} T_U \to \prod_{U \in \calU} \calC(U)$}.  \markbox{10549}{By} \markbox{10550}{Proposition} \ref{prop:Q-consistent}, \markbox{10551}{there} \markbox{10552}{is} \markbox{10553}{some} \markbox{m10554}{$\alpha_{\omega} = \alpha_{\omega}(\mathfrak S, R,r_1,r_2)>0$} \markbox{10555}{so} \markbox{10556}{that} \markbox{10557}{the} \markbox{10558}{tuple} \markbox{m10559}{$\Omega(\hx) \in \prod_{U \in \calU}T_U$} \markbox{10560}{is} \markbox{m10561}{$\alpha_{\omega}$}-consistent.  \markbox{10562}{Using} \markbox{10563}{just} \markbox{10564}{the} \markbox{m10565}{$R$}-system \markbox{10566}{axioms} \markbox{10567}{and} \markbox{10568}{standard} \markbox{10569}{HHS} techniques, \cite[Proposition 6.17]{Dur_infcube} \markbox{10570}{implies} \markbox{10571}{that} \markbox{m10572}{$(y_U) \in \prod_{U \in \calU} \calC(U)$} \markbox{10573}{is} \markbox{10574}{consistent} \markbox{10575}{in} \markbox{10576}{the} \markbox{10577}{sense} \markbox{10578}{of} \markbox{10579}{Definition} \ref{defn:consistency} \markbox{10580}{for} \markbox{10581}{some} \markbox{10582}{consistency} \markbox{10583}{constant} \markbox{10584}{depending} \markbox{10585}{only} \markbox{10586}{on} \markbox{m10587}{$\mathfrak S, \alpha_{\omega}$}. 

Since \markbox{m10588}{$d_V(a,b) < K$} \markbox{10589}{for} \markbox{10590}{all} \markbox{m10591}{$V \in \mathfrak S - \calU$}, \markbox{10592}{it} \markbox{10593}{follows} \markbox{10594}{that} \markbox{10595}{by} \markbox{10596}{choosing} \markbox{m10597}{$y_V \in \pi_V(a)$} \markbox{10598}{for} \markbox{10599}{all} \markbox{m10600}{$V \in \mathfrak S - \calU$}, \markbox{10601}{then} \markbox{10602}{the} \markbox{10603}{complete} \markbox{10604}{tuple} \markbox{m10605}{$(y_U) \in \prod_{U \in \mathfrak S} \calC(U)$} \markbox{10606}{is} \markbox{m10607}{$\beta$}-consistent \markbox{10608}{for} \markbox{m10609}{$\beta = \beta(\mathfrak S, R, K)>0$} (as \markbox{m10610}{$\alpha_{\omega}$} \markbox{10611}{only} \markbox{10612}{depended} \markbox{10613}{on} \markbox{m10614}{$\mathfrak S$} \markbox{10615}{and} \markbox{m10616}{$R$}).

Now \markbox{10617}{with} \markbox{10618}{a} \markbox{10619}{complete} \markbox{10620}{consistent} \markbox{10621}{tuple} \markbox{10622}{in} hand, \markbox{10623}{we} \markbox{10624}{can} \markbox{10625}{apply} \markbox{10626}{the} \markbox{10627}{Realization} \markbox{10628}{Theorem} \ref{thm:realization} \markbox{10629}{to} \markbox{10630}{define} \markbox{10631}{a} \markbox{10632}{map} \markbox{m10633}{$\mathrm{Real}_{\beta}:\prod_{U \in \mathfrak S} \calC(U) \to \calX$} \markbox{10634}{which} \markbox{10635}{takes} \markbox{10636}{each} \markbox{m10637}{$\beta$}-consistent \markbox{10638}{tuple} \markbox{10639}{and} \markbox{10640}{produces} \markbox{10641}{a} \markbox{10642}{point} \markbox{m10643}{$x \in \calX$} \markbox{10644}{whose} \markbox{10645}{projections} \markbox{10646}{coarsely} \markbox{10647}{coincide} \markbox{10648}{with} \markbox{10649}{the} tuple, \markbox{10650}{with} \markbox{10651}{error} \markbox{10652}{depending} \markbox{10653}{on} \markbox{m10654}{$\beta, \mathfrak S$}.

Finally, \cite[Lemma 6.6]{Dur_infcube}, \markbox{10655}{which} \markbox{10656}{depends} \markbox{10657}{on} \markbox{10658}{the} \markbox{10659}{more} \markbox{10660}{general} \markbox{10661}{fact} \cite[Proposition 6.3]{HHS_II}, \markbox{10662}{provides} \markbox{10663}{a} \markbox{m10664}{$(J,J)$}-coarse \markbox{10665}{retraction} \markbox{10666}{map} \markbox{m10667}{$\mathrm{ret}_H:\calX \to H$}, \markbox{10668}{where} \markbox{m10669}{$H = \hull_{\calX}(a,b)$} \markbox{10670}{where} \markbox{m10671}{$J = J(\mathfrak S)>0$}.  \markbox{10672}{This} \markbox{10673}{map} \markbox{10674}{is} \markbox{10675}{just} closest-point \markbox{10676}{projection} \markbox{10677}{to} \markbox{m10678}{$\hull_U(a,b)$} \markbox{10679}{in} \markbox{10680}{each} \markbox{m10681}{$\calC(U)$} \markbox{10682}{plus} \markbox{10683}{Theorem} \ref{thm:realization}. 

Combining these, \markbox{10684}{we} \markbox{10685}{get} \markbox{10686}{a} \markbox{10687}{map} \markbox{m10688}{$\hO:\calQ \to H$} \markbox{10689}{given} \markbox{10690}{by} \markbox{m10691}{$\hO = \mathrm{ret}_H \circ \mathrm{Real}_{\beta} \circ \Phi \circ \Omega$}.  \markbox{10692}{Our} \markbox{10693}{main} \markbox{10694}{goal} \markbox{10695}{is} \markbox{10696}{to} \markbox{10697}{show} \markbox{10698}{that} \markbox{m10699}{$\hPsi \circ \hO:\calQ \to \calQ$} \markbox{10700}{is} \markbox{10701}{coarsely} \markbox{10702}{the} identity, \markbox{10703}{where} \markbox{m10704}{$\hPsi:H \to \calQ$} \markbox{10705}{is} \markbox{10706}{the} \markbox{10707}{map} \markbox{10708}{defined} \markbox{10709}{in} \markbox{10710}{Proposition} \ref{prop:hPsi defined}.

Before \markbox{10711}{analyzing} \markbox{10712}{this} \markbox{10713}{total} composition, \markbox{10714}{we} \markbox{10715}{want} \markbox{10716}{to} \markbox{10717}{look} \markbox{10718}{at} \markbox{10719}{an} \markbox{10720}{intermediate} step.  \markbox{10721}{For} convenience, \markbox{10722}{if} \markbox{m10723}{$\alpha>0$}, \markbox{10724}{we} \markbox{10725}{let} \markbox{m10726}{$\calZ_{\alpha}$} \markbox{10727}{denote} \markbox{10728}{the} \markbox{10729}{collection} \markbox{10730}{of} \markbox{m10731}{$\alpha$}-consistent \markbox{10732}{tuples} \markbox{10733}{in} \markbox{m10734}{$\prod_{U \in \calU} T_U$}.  Define
$$\Phi_{\alpha}:\calZ_{\alpha} \to H$$ \markbox{10735}{by} \markbox{m10736}{$\mathrm{ret}_H \circ \mathrm{Real}_{\beta} \circ \Phi$}.

The \markbox{10737}{following} \markbox{10738}{proposition} \markbox{10739}{says} \markbox{10740}{that} \markbox{10741}{this} \markbox{10742}{map} \markbox{10743}{behaves} coordinate-wise \markbox{10744}{as} \markbox{10745}{one} \markbox{10746}{might} \markbox{10747}{expect} \markbox{10748}{upon} \markbox{10749}{composition} \markbox{10750}{with} \markbox{10751}{the} \markbox{10752}{coordinate} \markbox{10753}{maps} \markbox{m10754}{$\psi_U:\calX \to T_U$}, \markbox{10755}{which} \markbox{10756}{we} \markbox{10757}{recall} \markbox{10758}{are} \markbox{10759}{defined} \markbox{10760}{by} \markbox{m10761}{$\psi_U = \phi^{-1}_U\circ p_U \circ \pi_U$}, \markbox{10762}{where} \markbox{m10763}{$p_U:\calC(U) \to \phi_U(T_U)$} \markbox{10764}{is} closest-point projection.  

\begin{proposition}\label{prop:interval coordinate control}
There \markbox{10765}{exists} \markbox{m10766}{$D_1 = D_1(K, \mathfrak S)>0$} \markbox{10767}{so} \markbox{10768}{that} \markbox{10769}{if} \markbox{m10770}{$x = (x_V) \in \calZ_{\alpha_{\omega}}$}, \markbox{10771}{then} \markbox{10772}{we} have
\begin{enumerate}
\item \markbox{m10773}{$d_{T_U}(x_U, \psi_U \circ \Phi_{\alpha_{\omega}}(x))<D_1$} \markbox{10774}{for} \markbox{10775}{all} \markbox{m10776}{$U \in \calU$}, and
\item \markbox{m10777}{$\#\{U \in \calU| d_{T_U}(x_U, \psi_U \circ \Phi_{\alpha_{\omega}}(x)) > 2\alpha_{\omega} + 3R\} < D_1$}.
\end{enumerate}
\begin{itemize}
\item In particular, \markbox{10778}{by} \markbox{10779}{choosing} \markbox{m10780}{$L>2\alpha_{\omega} + 3R$}, \markbox{10781}{we} get
$$\sum_{U \in \calU} [d_{T_U}(x_U, \psi_U \circ \Phi_{\alpha_{\omega}}(x)]_L < D_1^2.$$
\end{itemize}
\end{proposition}

\begin{proof}[Sketch]
This \markbox{10782}{proposition} \markbox{10783}{is} \markbox{10784}{a} \markbox{10785}{special} \markbox{10786}{case} \markbox{10787}{of} \cite[Proposition 11.4]{Dur_infcube}, \markbox{10788}{and} \markbox{10789}{the} \markbox{10790}{proof} \markbox{10791}{is} \markbox{10792}{almost} \markbox{10793}{entirely} \markbox{10794}{the} same.  \markbox{10795}{The} \markbox{10796}{proof} \markbox{10797}{of} \markbox{10798}{item} (1) \markbox{10799}{is} \markbox{10800}{a} \markbox{10801}{definition} chase.  \markbox{10802}{It} \markbox{10803}{is} \markbox{10804}{basically} \markbox{10805}{saying} \markbox{10806}{that} \markbox{10807}{consistency} \markbox{10808}{in} \markbox{10809}{the} \markbox{10810}{interval} \markbox{10811}{setting} \markbox{10812}{is} \markbox{10813}{roughly} \markbox{10814}{consistency} \markbox{10815}{in} \markbox{10816}{the} \markbox{10817}{hierarchical} setting, \markbox{10818}{and} \markbox{10819}{that} \markbox{10820}{flowing} \markbox{10821}{from} \markbox{10822}{the} \markbox{10823}{former} \markbox{10824}{to} \markbox{10825}{the} \markbox{10826}{latter} \markbox{10827}{and} \markbox{10828}{back} \markbox{10829}{only} \markbox{10830}{moves} \markbox{10831}{coordinates} \markbox{10832}{a} \markbox{10833}{bounded} amount.

On \markbox{10834}{the} \markbox{10835}{other} hand, \markbox{10836}{the} \markbox{10837}{proof} \markbox{10838}{of} (2)---which \markbox{10839}{says} \markbox{10840}{that} \markbox{10841}{only} boundedly-many \markbox{10842}{coordinates} \markbox{10843}{move} \markbox{10844}{more} \markbox{10845}{than} \markbox{10846}{a} \markbox{10847}{bounded} amount---is \markbox{10848}{more} involved, \markbox{10849}{but} \markbox{10850}{also} \markbox{10851}{fairly} standard.  \markbox{10852}{It} \markbox{10853}{uses} \markbox{10854}{a} \markbox{10855}{variation} \markbox{10856}{on} \markbox{10857}{the} Passing-Up \markbox{10858}{property} \markbox{10859}{from} \markbox{10860}{Lemma} \ref{lem:passing-up}, \markbox{10861}{and} \markbox{10862}{the} \markbox{10863}{BGI} \markbox{10864}{property} \markbox{10865}{from} \markbox{10866}{Definition} \ref{defn:interval axioms}.  \markbox{10867}{Set} \markbox{m10868}{$\psi_U \circ \Phi_{\alpha_{\omega}}(x) = y = (y_U)$}.  \markbox{10869}{The} \markbox{10870}{idea} \markbox{10871}{here} \markbox{10872}{is} \markbox{10873}{that} \markbox{10874}{if} \markbox{10875}{there} \markbox{10876}{are} \markbox{10877}{too} \markbox{10878}{many} \markbox{10879}{coordinates} \markbox{10880}{where} \markbox{m10881}{$d_{T_U}(x_U, y_U) > 2\alpha_{\omega} + 3R$}, \markbox{10882}{then} \markbox{10883}{we} \markbox{10884}{can} \markbox{10885}{force} \markbox{10886}{the} \markbox{10887}{existence} \markbox{10888}{of} \markbox{10889}{some} \markbox{10890}{coordinate} \markbox{m10891}{$T_W$} \markbox{10892}{where} \markbox{m10893}{$d_{T_W}(x_W,y_W)>D_1$}, \markbox{10894}{which} \markbox{10895}{is} \markbox{10896}{impossible} \markbox{10897}{by} (1).
\end{proof}

\subsection{The map $\hO:\calQ \to H$ and coarse surjectivity of $\hPsi$}

We \markbox{10898}{are} \markbox{10899}{ready} \markbox{10900}{to} \markbox{10901}{analyze} \markbox{10902}{the} \markbox{10903}{map} \markbox{m10904}{$\hO = \Phi_{\alpha_{\omega}} \circ \Omega:\calQ \to H$}.    \markbox{10905}{Since} \markbox{m10906}{$\hPsi(H) \subset \calQ$} \markbox{10907}{by} \markbox{10908}{Proposition} \ref{prop:hPsi defined}, \markbox{10909}{we} \markbox{10910}{see} \markbox{10911}{that} \markbox{m10912}{$\hPsi \circ \hO:\calQ \to \calQ$}.  \markbox{10913}{We} \markbox{10914}{prove} \markbox{10915}{that} \markbox{10916}{this} \markbox{10917}{map} \markbox{10918}{is} \markbox{10919}{coarsely} \markbox{10920}{the} identity:

\begin{proposition}\label{prop:coarse surjectivity}
There \markbox{10921}{exists} \markbox{m10922}{$M_0 = M_0(R, \mathfrak S)>0$} \markbox{10923}{so} \markbox{10924}{that} \markbox{10925}{for} \markbox{10926}{any} \markbox{m10927}{$\hx \in \calQ$}, \markbox{10928}{we} \markbox{10929}{have} \markbox{m10930}{$d_{\calQ}(\hx, \hPsi \circ \hO(\hx)) < M_0$}. 
\end{proposition}

\begin{proof}[Sketch]
This \markbox{10931}{proposition} \markbox{10932}{is} \markbox{10933}{a} \markbox{10934}{special} \markbox{10935}{case} \markbox{10936}{of} \markbox{10937}{the} \markbox{10938}{proof} \markbox{10939}{contained} \markbox{10940}{in} \cite[Subsection 11.2]{Dur_infcube}.  \markbox{10941}{Since} \markbox{10942}{the} \markbox{10943}{details} \markbox{10944}{of} \markbox{10945}{the} \markbox{10946}{proof} \markbox{10947}{are} \markbox{10948}{very} \markbox{10949}{similar} \markbox{10950}{to} \markbox{10951}{the} original, \markbox{10952}{we} \markbox{10953}{will} \markbox{10954}{again} \markbox{10955}{only} \markbox{10956}{provide} \markbox{10957}{a} sketch.

Fix \markbox{m10958}{$\hx \in \calQ$} \markbox{10959}{and} \markbox{10960}{let} \markbox{m10961}{$\hy \in \hPsi \circ \hO(\hx)$}. \markbox{10962}{We} \markbox{10963}{will} \markbox{10964}{argue} coordinate-wise \markbox{10965}{since} \markbox{10966}{that} \markbox{10967}{is} \markbox{10968}{how} \markbox{10969}{the} \markbox{m10970}{$\ell^1$} \markbox{10971}{distance} \markbox{10972}{on} \markbox{m10973}{$\calQ$} \markbox{10974}{is} defined.  \markbox{10975}{The} \markbox{10976}{difference} \markbox{10977}{from} \markbox{10978}{the} \markbox{10979}{usual} \markbox{10980}{HHS} \markbox{10981}{style} \markbox{10982}{argument} \markbox{10983}{here} \markbox{10984}{is} \markbox{10985}{that} \markbox{m10986}{$d_{\calQ}$} \markbox{10987}{is} \markbox{10988}{an} \markbox{m10989}{$\ell^1$} \markbox{10990}{sum} \markbox{10991}{not} \markbox{10992}{involving} \markbox{10993}{a} threshold.  \markbox{10994}{To} \markbox{10995}{get} \markbox{10996}{around} \markbox{10997}{that} issue, \markbox{10998}{we} \markbox{10999}{will} \markbox{11000}{make} \markbox{11001}{an} \markbox{11002}{argument} \markbox{11003}{using} \markbox{11004}{Proposition} \ref{prop:interval coordinate control} \markbox{11005}{and} \markbox{11006}{Tree} \markbox{11007}{Trimming} \ref{thm:tree trimming} \markbox{11008}{as} follows.  \markbox{11009}{We} \markbox{11010}{show} \markbox{11011}{that} \markbox{11012}{all} \markbox{11013}{coordinate} \markbox{11014}{distances} \markbox{m11015}{$d_{\hT_U}(\hx_U, \hy_U)$} \markbox{11016}{are} \markbox{11017}{bounded} \markbox{11018}{in} \markbox{11019}{terms} \markbox{11020}{of} \markbox{m11021}{$\mathfrak S$} \markbox{11022}{and} \markbox{m11023}{$K$}, \markbox{11024}{with} \markbox{11025}{all} \markbox{11026}{but} boundedly-many (in \markbox{11027}{terms} \markbox{11028}{of} \markbox{m11029}{$\mathfrak S$}) \markbox{11030}{being} \markbox{11031}{bounded} \markbox{11032}{in} \markbox{11033}{terms} \markbox{11034}{of} \markbox{m11035}{$\mathfrak S$}.  \markbox{11036}{We} \markbox{11037}{can} \markbox{11038}{then} \markbox{11039}{collapse} \markbox{11040}{the} \markbox{11041}{subintervals} \markbox{11042}{between} \markbox{m11043}{$\hx_U$} \markbox{11044}{and} \markbox{m11045}{$\hy_U$} \markbox{11046}{in} \markbox{11047}{the} \markbox{11048}{latter} \markbox{11049}{domains} \markbox{11050}{while} \markbox{11051}{only} \markbox{11052}{incurring} \markbox{11053}{a} \markbox{11054}{bounded} \markbox{11055}{error} globally, \markbox{11056}{resulting} \markbox{11057}{in} \markbox{11058}{images} \markbox{11059}{for} \markbox{m11060}{$\hx,\hy$} \markbox{11061}{which} \markbox{11062}{are} \markbox{11063}{bounded} \markbox{11064}{distance} \markbox{11065}{in} \markbox{11066}{the} quotient, \markbox{11067}{showing} \markbox{11068}{that} \markbox{m11069}{$\hx,\hy$} \markbox{11070}{were} \markbox{11071}{bounded} \markbox{11072}{distance} \markbox{11073}{in} \markbox{m11074}{$\calQ$}.

Let \markbox{m11075}{$\Omega(\hx) = (x_U)$} \markbox{11076}{and} \markbox{m11077}{$\Psi \circ \hO(\hx) = (y_U)$}, \markbox{11078}{and} \markbox{11079}{observe} \markbox{11080}{that} \markbox{11081}{since} \markbox{m11082}{$q\circ \Omega(\hx) = \hx$}, \markbox{11083}{the} \markbox{11084}{tuples} \markbox{m11085}{$(x_U), (y_U)$} \markbox{11086}{are} \markbox{11087}{exactly} \markbox{11088}{the} \markbox{11089}{type} \markbox{11090}{in} \markbox{11091}{the} \markbox{11092}{statement} \markbox{11093}{of} \markbox{11094}{Proposition} \ref{prop:interval coordinate control}.  Moreover, \markbox{11095}{since} \markbox{m11096}{$q \circ \Omega(\hy) = \hy$} \markbox{11097}{by} construction, \markbox{11098}{while} \markbox{m11099}{$q$} \markbox{11100}{is} \markbox{m11101}{$1$}-Lipschitz \markbox{11102}{by} \markbox{11103}{item} (4) \markbox{11104}{of} \markbox{11105}{Lemma} \ref{lem:collapsed interval control}, \markbox{11106}{it} \markbox{11107}{will} \markbox{11108}{suffice} \markbox{11109}{to} \markbox{11110}{control} \markbox{11111}{the} coordinate-wise \markbox{11112}{distances} \markbox{11113}{of} \markbox{11114}{the} \markbox{m11115}{$d_{T_U}(x_U,y_U)$} \markbox{11116}{in} \markbox{11117}{order} \markbox{11118}{to} \markbox{11119}{utilize} \markbox{11120}{the} \markbox{11121}{above} argument.

Let \markbox{m11122}{$\calV = \{U \in \calU| \hx_U \neq \hy_U\}$}.  \markbox{11123}{One} \markbox{11124}{proceeds} \markbox{11125}{inductively} \markbox{11126}{on} \markbox{11127}{the} \markbox{m11128}{$\nest_{\calU}$}-level.  \markbox{11129}{Let} \markbox{m11130}{$\calV_{min} \subset \calV$} \markbox{11131}{denote} \markbox{11132}{the} \markbox{m11133}{$\nest_{\calU}$}-minimal \markbox{11134}{domains} \markbox{11135}{in} \markbox{m11136}{$\calV$}.

By \markbox{11137}{item} (8) \markbox{11138}{of} \markbox{11139}{Lemma} \ref{lem:collapsed interval control}, \markbox{11140}{for} \markbox{11141}{all} \markbox{11142}{but} \markbox{m11143}{$A$}-many \markbox{m11144}{$U \in \calV_{min}$} \markbox{11145}{with} \markbox{m11146}{$A = A(\mathfrak S)>0$}, \markbox{11147}{we} \markbox{11148}{have} \markbox{m11149}{$\hx_U,\hy_U \in \{\ha_U,\hb_U\}$}, \markbox{11150}{and} \markbox{11151}{hence} \markbox{11152}{for} \markbox{11153}{all} \markbox{11154}{but} \markbox{11155}{at} \markbox{11156}{most} \markbox{m11157}{$A$} \markbox{11158}{domains} \markbox{11159}{in} \markbox{m11160}{$\calV_{min}$}, \markbox{11161}{we} \markbox{11162}{have} \markbox{11163}{that} \markbox{m11164}{$\hx_U,\hy_U$} \markbox{11165}{are} \markbox{11166}{the} (opposite) \markbox{11167}{endpoints} \markbox{11168}{of} \markbox{m11169}{$\hT_U$}.  \markbox{11170}{By} \markbox{11171}{item} (6) \markbox{11172}{of} \markbox{11173}{that} lemma, \markbox{m11174}{$d_{T_U}(a_U,b_U) > d_{\hT_U}(\ha_U,\hb_U) \succ K$}, \markbox{11175}{while} \markbox{m11176}{$K$} \markbox{11177}{can} \markbox{11178}{be} \markbox{11179}{taken} \markbox{11180}{to} \markbox{11181}{be} \markbox{11182}{as} \markbox{11183}{much} \markbox{11184}{larger} \markbox{11185}{than} \markbox{m11186}{$2\alpha_{\omega} + 3R$} \markbox{11187}{as} \markbox{11188}{we} need, \markbox{11189}{as} \markbox{m11190}{$\alpha_{\omega}$} \markbox{11191}{and} \markbox{m11192}{$R$} \markbox{11193}{depend} \markbox{11194}{only} \markbox{11195}{on} \markbox{m11196}{$\mathfrak S$}.  \markbox{11197}{Since} \markbox{11198}{Proposition} \ref{prop:interval coordinate control} \markbox{11199}{bounds} \markbox{11200}{the} \markbox{11201}{number} \markbox{11202}{of} \markbox{11203}{domains} \markbox{m11204}{$U \in \calU$} \markbox{11205}{where} \markbox{m11206}{$d_{T_U}(x_U,y_U)> 2\alpha_{\omega} + 3R$}, \markbox{11207}{we} \markbox{11208}{can} \markbox{11209}{conclude} \markbox{11210}{that} \markbox{m11211}{$\#\calV_{min} < D_1 + A$}.

Now \markbox{11212}{let} \markbox{m11213}{$\calV' \subset \calV - \calV_{min}$} \markbox{11214}{denote} \markbox{11215}{the} \markbox{11216}{set} \markbox{11217}{of} non-minimal \markbox{11218}{domains} \markbox{m11219}{$V$} \markbox{11220}{where} \markbox{m11221}{$\hx_V \neq \hy_V$} \markbox{11222}{and} \markbox{m11223}{$d_{T_V}(x_V,y_V) < 2\alpha_{\omega} + 3R$}, \markbox{11224}{which} \markbox{11225}{we} \markbox{11226}{note} \markbox{11227}{only} \markbox{11228}{excludes} boundedly-many \markbox{11229}{domains} \markbox{11230}{by} \markbox{11231}{item} (2) \markbox{11232}{of} \markbox{11233}{Proposition} \ref{prop:interval coordinate control}.

Since \markbox{11234}{the} \markbox{11235}{maps} \markbox{m11236}{$q_V:T_V \to \hT_V$} \markbox{11237}{are} \markbox{m11238}{$1$}-Lipschitz (item (4) \markbox{11239}{of} \markbox{11240}{Lemma} \ref{lem:collapsed interval control}), \markbox{11241}{we} \markbox{11242}{have} \markbox{m11243}{$d_{\hT_V}(\hx_V,\hy_V) < 2\alpha_{\omega} + 3R$}.  \markbox{11244}{The} \markbox{11245}{idea} \markbox{11246}{now} \markbox{11247}{is} \markbox{11248}{to} \markbox{11249}{use} \markbox{11250}{the} \markbox{11251}{Tree} \markbox{11252}{Trimming} \markbox{11253}{Theorem} \ref{thm:tree trimming} \markbox{11254}{to} \markbox{11255}{collapse} \markbox{11256}{the} \markbox{11257}{geodesics} \markbox{m11258}{$[\hx_V,\hy_V]$} \markbox{11259}{between} \markbox{m11260}{$\hx_V,\hy_V$} \markbox{11261}{in} \markbox{m11262}{$\hT_V$} \markbox{11263}{to} points.  \markbox{11264}{Each} \markbox{11265}{interval} \markbox{m11266}{$\hT_V$} \markbox{11267}{contains} \markbox{11268}{at} \markbox{11269}{most} \markbox{11270}{one} \markbox{11271}{such} geodesic, \markbox{11272}{and} \markbox{11273}{each} \markbox{11274}{such} \markbox{11275}{geodesic} \markbox{11276}{has} \markbox{11277}{a} \markbox{11278}{length} \markbox{11279}{bounded} \markbox{11280}{independently} \markbox{11281}{of} \markbox{m11282}{$K$}.  \markbox{11283}{Hence} \markbox{11284}{the} \markbox{11285}{set} \markbox{11286}{of} \markbox{11287}{such} \markbox{11288}{intervals} \markbox{11289}{across} \markbox{11290}{both} \markbox{m11291}{$\nest$}-minimal \markbox{11292}{and} non-minimal \markbox{11293}{domains} \markbox{11294}{with} \markbox{11295}{this} \markbox{11296}{distance} \markbox{11297}{bound} \markbox{11298}{is} \markbox{11299}{an} \markbox{11300}{admissible} \markbox{11301}{trimming} \markbox{11302}{set} \markbox{11303}{in} \markbox{11304}{the} \markbox{11305}{sense} \markbox{11306}{required} \markbox{11307}{for} \markbox{11308}{Theorem} \ref{thm:tree trimming}.

If \markbox{11309}{we} \markbox{11310}{take} \markbox{m11311}{$\hT'_V$} \markbox{11312}{to} \markbox{11313}{be} \markbox{11314}{the} \markbox{11315}{interval} \markbox{11316}{obtained} \markbox{11317}{from} \markbox{m11318}{$\hT_V$} post-trimming \markbox{11319}{and} \markbox{m11320}{$\calQ'$} \markbox{11321}{the} \markbox{11322}{corresponding} \markbox{m11323}{$0$}-consistent set, \markbox{11324}{then} \markbox{11325}{the} \markbox{11326}{images} \markbox{m11327}{$\hx', \hy'$} \markbox{11328}{of} \markbox{m11329}{$\hx,\hy$} \markbox{11330}{now} \markbox{11331}{satisfy} \markbox{m11332}{$\hx'_V = \hy'_V$} \markbox{11333}{for} \markbox{11334}{all} \markbox{11335}{but} boundedly-many \markbox{m11336}{$V$}, \markbox{11337}{and} \markbox{11338}{the} \markbox{11339}{remaining} \markbox{11340}{distances} \markbox{11341}{are} \markbox{11342}{all} \markbox{11343}{bounded} \markbox{11344}{by} \markbox{11345}{some} \markbox{11346}{function} \markbox{11347}{of} \markbox{m11348}{$D_1$} \markbox{11349}{by} \markbox{11350}{item} (1) \markbox{11351}{of} \markbox{11352}{Proposition} \ref{prop:interval coordinate control}.  \markbox{11353}{In} particular, \markbox{m11354}{$d_{\calQ'}(\hx,\hy)$} \markbox{11355}{is} bounded.  \markbox{11356}{But} \markbox{11357}{the} \markbox{11358}{map} \markbox{m11359}{$\Delta:\calQ \to \calQ'$} \markbox{11360}{is} \markbox{11361}{a} \markbox{11362}{uniform} quasi-isometry, \markbox{11363}{so} \markbox{11364}{that} \markbox{11365}{means} \markbox{11366}{that} \markbox{m11367}{$d_{\calQ}(\hx,\hy)$} \markbox{11368}{is} \markbox{11369}{also} bounded, \markbox{11370}{which} \markbox{11371}{is} \markbox{11372}{what} \markbox{11373}{we} wanted.  \markbox{11374}{We} \markbox{11375}{leave} \markbox{11376}{checking} \markbox{11377}{the} \markbox{11378}{details} \markbox{11379}{to} \markbox{11380}{the} reader.
\end{proof}

\section{Building a cube complex from a hierarchical family of intervals}\label{sec:cubulation}

The \markbox{11381}{goal} \markbox{11382}{of} \markbox{11383}{this} \markbox{11384}{section} \markbox{11385}{is} \markbox{11386}{to} \markbox{11387}{explain} \markbox{11388}{how} \markbox{11389}{to} \markbox{11390}{take} \markbox{11391}{a} \markbox{11392}{special} \markbox{11393}{collection} \markbox{11394}{of} \markbox{11395}{intervals} \markbox{11396}{satisfying} \markbox{11397}{certain} HHS-like properties, \markbox{11398}{and} \markbox{11399}{to} \markbox{11400}{produce} \markbox{11401}{from} \markbox{11402}{them} \markbox{11403}{a} CAT(0) \markbox{11404}{cube} complex.  \markbox{11405}{The} \markbox{11406}{details} \markbox{11407}{of} \markbox{11408}{this} \markbox{11409}{construction} \markbox{11410}{motivate} \markbox{11411}{the} \markbox{11412}{stabilization} \markbox{11413}{techniques} \markbox{11414}{we} \markbox{11415}{develop} \markbox{11416}{later} \markbox{11417}{in} \markbox{11418}{this} article.


\subsection{Hierarchical families of intervals}

In \markbox{11419}{this} subsection, \markbox{11420}{we} \markbox{11421}{axiomatize} \markbox{11422}{the} \markbox{11423}{properties} \markbox{11424}{we} \markbox{11425}{need} \markbox{11426}{from} \markbox{11427}{a} \markbox{11428}{family} \markbox{11429}{of} \markbox{11430}{intervals} \markbox{11431}{in} \markbox{11432}{order} \markbox{11433}{to} \markbox{11434}{build} \markbox{11435}{a} \markbox{11436}{cube} complex.  \markbox{11437}{The} \markbox{11438}{purpose} \markbox{11439}{of} \markbox{11440}{this} \markbox{11441}{axiomatization} \markbox{11442}{is} \markbox{11443}{to} \markbox{11444}{allow} \markbox{11445}{us} \markbox{11446}{to} \markbox{11447}{modify} \markbox{11448}{our} \markbox{11449}{construction} \markbox{11450}{in} \markbox{11451}{various} \markbox{11452}{ways} \markbox{11453}{while} \markbox{11454}{preserving} \markbox{11455}{the} axioms, \markbox{11456}{as} \markbox{11457}{any} \markbox{11458}{setup} \markbox{11459}{which} \markbox{11460}{satisfies} \markbox{11461}{the} \markbox{11462}{axioms} \markbox{11463}{produces} \markbox{11464}{a} \markbox{11465}{cube} complex.  \markbox{11466}{The} \markbox{11467}{properties} \markbox{11468}{themselves} \markbox{11469}{are} \markbox{11470}{motivated} \markbox{11471}{by} \markbox{11472}{the} \markbox{11473}{HHS} \markbox{11474}{axioms} \markbox{11475}{and} \markbox{11476}{the} \markbox{11477}{properties} \markbox{11478}{in} \markbox{11479}{Lemma} \ref{lem:collapsed interval control}.

\begin{definition}[Hierarchical \markbox{11480}{family} \markbox{11481}{of} intervals] \label{defn:HFI}
A \emph{hierarchical family of intervals (HFI)} \markbox{11482}{is} \markbox{11483}{the} \markbox{11484}{following} \markbox{11485}{collection} \markbox{11486}{of} \markbox{11487}{objects} \markbox{11488}{and} properties:

\begin{enumerate}
\item A \markbox{11489}{finite} \markbox{11490}{index} \markbox{11491}{set} \markbox{m11492}{$\calU$} \markbox{11493}{of} \emph{domains} \markbox{11494}{with} \emph{relations} \markbox{m11495}{$\nest, \pitchfork, \perp$} \markbox{11496}{so} that
\begin{itemize}
    \item \markbox{m11497}{$\nest$} \markbox{11498}{is} anti-reflexive \markbox{11499}{and} anti-symmetric, \markbox{11500}{and} \markbox{11501}{gives} \markbox{11502}{a} \markbox{11503}{partial} \markbox{11504}{order} \markbox{11505}{with} \markbox{11506}{a} \markbox{11507}{bound} \markbox{11508}{on} \markbox{11509}{the} \markbox{11510}{length} \markbox{11511}{of} chains;
    \item \markbox{m11512}{$\pitchfork$} \markbox{11513}{is} \markbox{11514}{symmetric} \markbox{11515}{and} anti-reflexive;
    \item There \markbox{11516}{is} \markbox{11517}{a} \markbox{11518}{unique} \markbox{m11519}{$\nest$}-maximal \markbox{11520}{element} \markbox{m11521}{$S$};
    \item Any \markbox{11522}{pair} \markbox{11523}{of} \markbox{11524}{domains} \markbox{m11525}{$U,V \in \calU$} \markbox{11526}{satisfies} \markbox{11527}{exactly} \markbox{11528}{one} \markbox{11529}{of} \markbox{11530}{the} relations. 
\end{itemize}
\item There \markbox{11531}{is} \markbox{11532}{a} \markbox{11533}{bound} \markbox{11534}{on} \markbox{11535}{the} \markbox{11536}{size} \markbox{11537}{of} \markbox{11538}{any} \markbox{11539}{pairwise} \markbox{m11540}{$\perp$}-comparable \markbox{11541}{subset} \markbox{11542}{of} \markbox{m11543}{$\calU$}. \label{item:finite dim}
\item To \markbox{11544}{each} \markbox{m11545}{$U \in \calU$} \markbox{11546}{there} \markbox{11547}{is} \markbox{11548}{an} \markbox{11549}{associated} \markbox{11550}{finite} \markbox{11551}{simplicial} \markbox{11552}{interval} \markbox{m11553}{$\hT_U$}. \label{item:simplicial}
\item A \markbox{11554}{pair} \markbox{11555}{of} \markbox{11556}{labels} \markbox{m11557}{$F = \{x,y\}$} \markbox{11558}{which} \markbox{11559}{determined} \markbox{11560}{the} endpoints, \markbox{11561}{called} \emph{marked points} \markbox{m11562}{$\hx_U, \hy_U$}, \markbox{11563}{of} \markbox{11564}{the} \markbox{11565}{interval} \markbox{m11566}{$\hT_U$} \markbox{11567}{for} \markbox{11568}{each} \markbox{m11569}{$U \in \calU$}.
\item A \markbox{11570}{family} \markbox{11571}{of} \emph{relative projections} determining:
\begin{itemize}
    \item For \markbox{11572}{each} \markbox{m11573}{$U, V \in \calU$} \markbox{11574}{with} \markbox{m11575}{$V \nest U$} \markbox{11576}{or} \markbox{m11577}{$V \pitchfork U$}, \markbox{11578}{there} \markbox{11579}{is} \markbox{11580}{a} \markbox{11581}{vertex} \markbox{m11582}{$\hd^V_U \in \hT^{(0)}_U$} \markbox{11583}{called} \markbox{11584}{a} \emph{cluster point}.
 
\end{itemize}
    \item There \markbox{11585}{exist} \markbox{11586}{projection} \markbox{11587}{maps} \markbox{m11588}{$\hd^U_V: \hT_U \to \hT_V$} \markbox{11589}{when} \markbox{m11590}{$V \nest U$}, \markbox{11591}{satisfying} \markbox{11592}{the} \markbox{11593}{following} properties:\label{item:BGI HFI}
    \begin{enumerate}
    	\item (Consistency) \markbox{11594}{For} \markbox{11595}{each} \markbox{m11596}{$f \in F$}, \markbox{11597}{we} \markbox{11598}{have} \markbox{m11599}{$\hd^U_V(\hf_U) = \hf_V$}.
        \item (BGI) \markbox{11600}{If} \markbox{m11601}{$C \subset \hT_U - \hd^V_U$} \markbox{11602}{is} \markbox{11603}{a} component, \markbox{11604}{then} \markbox{m11605}{$\hd^U_V(C)$} \markbox{11606}{coincides} \markbox{11607}{with} \markbox{m11608}{$\hf_V$} \markbox{11609}{for} \markbox{m11610}{$f \in F$} \markbox{11611}{with} \markbox{m11612}{$\hf_U \in C$}. 
    \end{enumerate}

\item If \markbox{m11613}{$U,V,W \in \calU$} \markbox{11614}{with} \markbox{m11615}{$V,W \nest U$}, \markbox{m11616}{$V \pitchfork W$}, \markbox{11617}{and} \markbox{m11618}{$\hd^V_U \neq \hd^W_U$}, \markbox{11619}{then} \markbox{m11620}{$\hd^U_V(\hd^W_U) = \hd^W_V \in \hT_V$}. \label{item:delta control HFI}
\end{enumerate}
\end{definition}

\begin{remark}
In \cite[Definition 12.1]{Dur_infcube}, \markbox{11621}{the} \markbox{11622}{definition} \markbox{11623}{of} \markbox{11624}{a} \emph{hierarchical family of trees} \markbox{11625}{allows} \markbox{11626}{for} \markbox{11627}{the} \markbox{11628}{trees} \markbox{11629}{to} \markbox{11630}{have} \markbox{11631}{more} \markbox{11632}{than} \markbox{m11633}{$2$} leaves.  \markbox{11634}{This} \markbox{11635}{is} \markbox{11636}{only} \markbox{11637}{needed} \markbox{11638}{for} \markbox{11639}{modeling} \markbox{11640}{tuples} \markbox{11641}{of} \markbox{m11642}{$3$} \markbox{11643}{or} \markbox{11644}{more} points.
\end{remark}

The \markbox{11645}{following} \markbox{11646}{is} \markbox{11647}{an} \markbox{11648}{immediate} \markbox{11649}{consequence} \markbox{11650}{of} \markbox{11651}{our} \markbox{11652}{work} \markbox{11653}{in} \markbox{11654}{Section} \ref{sec:interval systems}, \markbox{11655}{especially} \markbox{11656}{Lemma} \ref{lem:collapsed interval control}:

\begin{lemma}\label{lem:HHS to HFI}
Let \markbox{m11657}{$R>0$}, \markbox{m11658}{$r_1 > R_1=R_1(R,\mathfrak S)>0$} \markbox{11659}{as} \markbox{11660}{in} \markbox{11661}{Proposition} \ref{prop:hPsi defined} \markbox{11662}{and} \markbox{m11663}{$r_2 > R_2=R_2(R,\mathfrak S)>0$} \markbox{11664}{as} \markbox{11665}{in} \markbox{11666}{Lemma} \ref{lem:collapsed interval control}.  \markbox{11667}{For} \markbox{11668}{any} \markbox{m11669}{$(r_1,r_2)$}-thickening \markbox{11670}{of} \markbox{11671}{an} \markbox{m11672}{$R$}-interval \markbox{11673}{system} \markbox{11674}{for} \markbox{m11675}{$a,b \in \calX$}, \markbox{11676}{the} \markbox{11677}{associated} \markbox{11678}{family} \markbox{11679}{of} \markbox{11680}{collapsed} \markbox{11681}{intervals} \markbox{11682}{and} \markbox{11683}{their} \markbox{11684}{collapsed} \markbox{11685}{projections} \markbox{11686}{form} \markbox{11687}{a} \markbox{11688}{hierarchical} \markbox{11689}{family} \markbox{11690}{of} intervals.
\end{lemma}

As \markbox{11691}{above} \markbox{11692}{in} \markbox{11693}{Definition} \ref{defn:Q defined}, \markbox{11694}{we} \markbox{11695}{can} \markbox{11696}{define} \markbox{11697}{a} \markbox{m11698}{$0$}-consistent \markbox{11699}{subset} \markbox{11700}{of} \markbox{11701}{the} \markbox{11702}{product} \markbox{m11703}{$\prod_U \hT_U$}.  \markbox{11704}{Our} \markbox{11705}{next} \markbox{11706}{goal} \markbox{11707}{is} \markbox{11708}{the} \markbox{11709}{following} theorem:

\begin{theorem}\label{thm:Q CCC}
The \markbox{m11710}{$0$}-consistent \markbox{11711}{subset} \markbox{11712}{of} \markbox{11713}{an} \markbox{11714}{HFI} \markbox{11715}{is} \markbox{11716}{a} CAT(0) \markbox{11717}{cube} complex.  Moreover, \markbox{11718}{there} \markbox{11719}{is} \markbox{11720}{a} \markbox{11721}{bijective} \markbox{11722}{correspondence} \markbox{11723}{between} \markbox{11724}{its} \markbox{11725}{hyperplanes} \markbox{11726}{and} \markbox{11727}{the} \markbox{11728}{edges} \markbox{11729}{of} \markbox{11730}{the} factors. 
\end{theorem}
    

\subsection{Median graphs and dual cube complexes}

The \markbox{11731}{proof} \markbox{11732}{of} \markbox{11733}{Theorem} \ref{thm:Q CCC} \markbox{11734}{that} \markbox{11735}{we} \markbox{11736}{give} \markbox{11737}{here} \markbox{11738}{will} \markbox{11739}{use} \markbox{11740}{the} \markbox{11741}{notion} \markbox{11742}{of} \markbox{11743}{median} spaces.  \markbox{11744}{The} \markbox{11745}{connection} \markbox{11746}{between} \markbox{11747}{median} \markbox{11748}{graphs} \markbox{11749}{and} CAT(0) \markbox{11750}{cube} \markbox{11751}{complexes} \markbox{11752}{goes} \markbox{11753}{back} \markbox{11754}{to} Roller's \cite{Roller} \markbox{11755}{reframing} \markbox{11756}{of} Sageev's \markbox{11757}{construction} \cite{Sageev:cubulation}, \markbox{11758}{see} \markbox{11759}{also} \cite{CN05, Nica}.  Notably, \markbox{11760}{Chepoi} \cite[Theorem 6.1]{Che00} \markbox{11761}{showed} \markbox{11762}{that} \markbox{11763}{every} \markbox{11764}{median} \markbox{11765}{graph} \markbox{11766}{is} \markbox{11767}{the} \markbox{m11768}{$1$}-skeleton \markbox{11769}{of} \markbox{11770}{a} \markbox{11771}{unique} CAT(0) \markbox{11772}{cube} complex.  \markbox{11773}{Bowditch} \markbox{11774}{explains} \markbox{11775}{these} \markbox{11776}{connections} \markbox{11777}{in} \markbox{11778}{detail} \markbox{11779}{in} \cite[Section 11]{bowditch2022median}.

Let \markbox{m11780}{$X$} \markbox{11781}{be} \markbox{11782}{a} \markbox{11783}{space} \markbox{11784}{and} \markbox{m11785}{$\mm:X^3\to X$} \markbox{11786}{a} \markbox{11787}{ternary} operator.  \markbox{11788}{We} \markbox{11789}{call} \markbox{m11790}{$(X,\mm)$} \markbox{11791}{a} \emph{median algebra} \markbox{11792}{if} \markbox{11793}{for} \markbox{11794}{all} \markbox{m11795}{$a,b,c,d,e \in X$} \markbox{11796}{we} have
$$\mm(a,b,c) = \mm(b,a,c) = \mm(c,a,b), \hspace{.1in} \mm(a,a,b) = a, \hspace{.1in} \mm(a,b,\mm(c,d,e)) = \mm(\mm(a,b,c),\mm(a,b,d),e).$$


A \markbox{11797}{graph} \markbox{m11798}{$\Gamma$} \markbox{11799}{is} \emph{median} \markbox{11800}{if} \markbox{11801}{all} \markbox{11802}{choices} \markbox{11803}{of} \markbox{m11804}{$v_1,v_2,v_3 \in \Gamma^{(0)}$}, \markbox{11805}{there} \markbox{11806}{exists} \markbox{11807}{a} \markbox{11808}{unique} \markbox{11809}{point} \markbox{11810}{lying} \markbox{11811}{on} \markbox{11812}{some} \markbox{11813}{geodesic} \markbox{11814}{from} \markbox{m11815}{$v_i,v_j$} \markbox{11816}{for} \markbox{11817}{all} \markbox{m11818}{$i,j$}; \markbox{11819}{then} \markbox{m11820}{$\mm(v_1,v_2,v_3)$} \markbox{11821}{is} \markbox{11822}{that} \markbox{11823}{unique} point.

Given \markbox{m11824}{$a,b \in X$}, \markbox{11825}{the} (median) \emph{interval} \markbox{11826}{between} \markbox{m11827}{$a,b$} \markbox{11828}{is} \markbox{m11829}{$I(a,b) = \{x \in X| \hspace{.01in} \mm(a,x,b) = x\}$}.  \markbox{11830}{We} \markbox{11831}{say} \markbox{11832}{a} \markbox{11833}{median} \markbox{11834}{algebra} \markbox{m11835}{$(X, \mm)$} \markbox{11836}{is} \emph{discrete} \markbox{11837}{when} \markbox{m11838}{$I(a,b)$} \markbox{11839}{is} \markbox{11840}{finite} \markbox{11841}{for} \markbox{11842}{every} \markbox{m11843}{$a,b \in X$}.  \markbox{11844}{A} \emph{subalgebra} \markbox{11845}{is} \markbox{11846}{a} \markbox{11847}{subset} \markbox{m11848}{$S \subset X$} \markbox{11849}{which} \markbox{11850}{is} \markbox{11851}{closed} \markbox{11852}{under} \markbox{m11853}{$\mm$}.  \markbox{11854}{In} particular, \markbox{11855}{locally} \markbox{11856}{finite} \markbox{11857}{median} \markbox{11858}{graphs} \markbox{11859}{are} \markbox{11860}{discrete} \markbox{11861}{median} algebras.


Every \markbox{11862}{median} \markbox{11863}{algebra} \markbox{m11864}{$(X,\mm)$} \markbox{11865}{determines} \markbox{11866}{a} \markbox{11867}{graph} \markbox{11868}{called} \markbox{11869}{its} \emph{adjacency graph} \markbox{m11870}{$\Gamma(X)$} \markbox{11871}{as} follows.  \markbox{11872}{We} \markbox{11873}{say} \markbox{11874}{that} \markbox{m11875}{$a,b \in X$} \markbox{11876}{are} \emph{adjacent} \markbox{11877}{when} \markbox{m11878}{$I(a,b) = \emptyset$}.  \markbox{11879}{The} \markbox{11880}{vertices} \markbox{11881}{of} \markbox{m11882}{$\Gamma(X)$} \markbox{11883}{are} \markbox{11884}{the} \markbox{11885}{points} \markbox{11886}{of} \markbox{m11887}{$X$}, \markbox{11888}{with} \markbox{m11889}{$a,b \in X$} \markbox{11890}{connected} \markbox{11891}{by} \markbox{11892}{an} \markbox{11893}{edge} \markbox{11894}{in} \markbox{m11895}{$\Gamma(X)$} \markbox{11896}{exactly} \markbox{11897}{when} \markbox{m11898}{$a,b$} \markbox{11899}{are} adjacent.  \markbox{11900}{This} \markbox{11901}{graph} \markbox{11902}{is} \markbox{11903}{median} \markbox{11904}{exactly} \markbox{11905}{when} \markbox{m11906}{$(X,\mm)$} \markbox{11907}{is} \markbox{11908}{a} \markbox{11909}{discrete} \markbox{11910}{median} \markbox{11911}{algebra} \cite[Lemma 16.1.2]{bowditch2022median}.

Every CAT(0) \markbox{11912}{cube} \markbox{11913}{complex} \markbox{m11914}{$X$} \markbox{11915}{admits} \markbox{11916}{a} \markbox{11917}{canonical} \markbox{11918}{median} \markbox{11919}{structure} \markbox{11920}{as} follows.  \markbox{11921}{For} \markbox{11922}{any} \markbox{m11923}{$a,b \in X^{(0)}$}, \markbox{11924}{let} \markbox{m11925}{$J(a,b)$} \markbox{11926}{denote} \markbox{11927}{the} \markbox{11928}{set} \markbox{11929}{of} \markbox{m11930}{$\ell^1$}-geodesics \markbox{11931}{between} \markbox{m11932}{$a,b$}.  \markbox{11933}{Then} \markbox{11934}{given} \markbox{m11935}{$a,b,c \in X^{(0)}$}, \markbox{11936}{we} \markbox{11937}{have} \markbox{m11938}{$\mm(a,b,c) = J(a,b) \cap J(a,c) \cap J(b,c)$} \markbox{11939}{is} \markbox{11940}{a} \markbox{11941}{single} point, \markbox{11942}{and} \markbox{m11943}{$(X, \mm)$} \markbox{11944}{is} \markbox{11945}{a} \markbox{11946}{median} \markbox{11947}{structure} \markbox{11948}{with} \markbox{m11949}{$X^{(1)}$} \markbox{11950}{a} \markbox{11951}{median} graph, \markbox{11952}{with} \markbox{11953}{notably} \markbox{m11954}{$J(a,b) = I(a,b)$} \markbox{11955}{for} \markbox{11956}{all} \markbox{m11957}{$a, b \in X^{(0)}$}.  Moreover, \markbox{11958}{it} \markbox{11959}{is} \markbox{11960}{immediate} \markbox{11961}{that} \markbox{m11962}{$X^{(1)} = \Gamma(X^{(0)})$}, \markbox{11963}{since} \markbox{11964}{median} \markbox{11965}{adjacent} \markbox{11966}{vertices} \markbox{11967}{in} \markbox{m11968}{$X^{(0)}$} \markbox{11969}{are} \markbox{11970}{exactly} \markbox{11971}{those} \markbox{11972}{spanning} \markbox{11973}{an} \markbox{11974}{edge} \markbox{11975}{in} \markbox{m11976}{$X^{(1)}$}.

\begin{proof}[Proof \markbox{11977}{of} \markbox{11978}{Theorem} \ref{thm:Q CCC}]
   First, \markbox{11979}{observe} \markbox{11980}{that} \markbox{m11981}{$\calY = \prod_{U \in \calU} \hT_U$} \markbox{11982}{is} \markbox{11983}{a} \markbox{11984}{product} \markbox{11985}{of} \markbox{11986}{simplicial} \markbox{11987}{trees} \markbox{11988}{and} \markbox{11989}{hence} \markbox{11990}{a} CAT(0) \markbox{11991}{cube} complex.
   
   Next, \markbox{11992}{observe} \markbox{11993}{that} \markbox{m11994}{$\calQ \subset \calY$} \markbox{11995}{is} \markbox{11996}{a} \markbox{11997}{cubical} \markbox{11998}{subcomplex} \markbox{11999}{as} follows.  \markbox{12000}{For} \markbox{12001}{any} \markbox{m12002}{$\hx \in \calQ$}, \markbox{12003}{let} \markbox{m12004}{$C \subset \calY$} \markbox{12005}{be} \markbox{12006}{the} \markbox{12007}{minimal} \markbox{12008}{cube} \markbox{12009}{containing} \markbox{m12010}{$\hx$} \markbox{12011}{in} \markbox{12012}{its} interior.  \markbox{12013}{Presuming} \markbox{m12014}{$C$} \markbox{12015}{is} \markbox{12016}{not} \markbox{12017}{a} vertex, \markbox{12018}{minimality} \markbox{12019}{says} \markbox{12020}{that} \markbox{m12021}{$\hx_U$} \markbox{12022}{is} \markbox{12023}{in} \markbox{12024}{the} \markbox{12025}{interior} \markbox{12026}{of} \markbox{12027}{an} \markbox{12028}{edge} \markbox{12029}{in} \markbox{12030}{each} \markbox{12031}{of} \markbox{12032}{the} \markbox{12033}{defining} \markbox{12034}{coordinate} \markbox{12035}{intervals} \markbox{12036}{of} \markbox{m12037}{$C$}, \markbox{12038}{whose} \markbox{12039}{domain} \markbox{12040}{labels} \markbox{12041}{are} \markbox{12042}{pairwise} \markbox{12043}{orthogonal} \markbox{12044}{by} \markbox{12045}{item} (9) \markbox{12046}{of} \markbox{12047}{Lemma} \ref{lem:collapsed interval control}.  \markbox{12048}{This} \markbox{12049}{means} \markbox{12050}{that} \markbox{12051}{we} \markbox{12052}{can} \markbox{12053}{freely} \markbox{12054}{alter} \markbox{12055}{those} \markbox{12056}{coordinates} \markbox{12057}{of} \markbox{m12058}{$\hx$} \markbox{12059}{to} \markbox{12060}{be} \markbox{12061}{any} \markbox{12062}{choice} \markbox{12063}{of} \markbox{12064}{points} \markbox{12065}{in} \markbox{12066}{those} edges, \markbox{12067}{meaning} \markbox{m12068}{$C \subset \calQ$}.  \markbox{12069}{Hence} \markbox{m12070}{$\calQ$} \markbox{12071}{is} \markbox{12072}{a} \markbox{12073}{cubical} \markbox{12074}{subcomplex} \markbox{12075}{of} \markbox{m12076}{$\calY$}.

   \markbox{12077}{It} \markbox{12078}{is} \markbox{12079}{enough} \markbox{12080}{then} \markbox{12081}{to} \markbox{12082}{show} \markbox{12083}{that} \markbox{m12084}{$\calQ^{(0)} \subset \calY$} \markbox{12085}{is} \markbox{12086}{a} \markbox{12087}{discrete} \markbox{12088}{median} subalgebra.  \markbox{12089}{For} \markbox{12090}{once} \markbox{12091}{that} \markbox{12092}{is} done, \markbox{12093}{it} \markbox{12094}{will} \markbox{12095}{follow} \markbox{12096}{that} \markbox{m12097}{$\Gamma(\calQ)$} \markbox{12098}{is} \markbox{12099}{a} \markbox{12100}{median} graph, \markbox{12101}{but} \markbox{12102}{evidently} \markbox{m12103}{$\Gamma(\calQ) = \calQ^{(1)}$}, \markbox{12104}{as} \markbox{m12105}{$\calQ$} \markbox{12106}{is} \markbox{12107}{a} \markbox{12108}{cubical} \markbox{12109}{subcomplex} \markbox{12110}{of} \markbox{m12111}{$\calY$}.  \markbox{12112}{Since} \markbox{12113}{every} \markbox{12114}{median} \markbox{12115}{graph} \markbox{12116}{is} \markbox{12117}{the} \markbox{m12118}{$1$}-skeleton \markbox{12119}{of} \markbox{12120}{a} \markbox{12121}{unique} CAT(0) \markbox{12122}{cube} \markbox{12123}{complex} \cite[Theorem 6.1]{Che00}, \markbox{12124}{it} \markbox{12125}{follows} \markbox{12126}{that} \markbox{m12127}{$\calQ$} \markbox{12128}{must} \markbox{12129}{be} \markbox{12130}{that} \markbox{12131}{cube} complex, \markbox{12132}{completing} \markbox{12133}{the} proof.

   \markbox{12134}{The} \markbox{12135}{claim} \markbox{12136}{boils} \markbox{12137}{down} \markbox{12138}{to} \markbox{12139}{three} \markbox{12140}{exercises} \markbox{12141}{that} \markbox{12142}{we} \markbox{12143}{leave} \markbox{12144}{for} \markbox{12145}{the} reader:
   \begin{itemize}
       \item Any (finite) \markbox{12146}{product} \markbox{12147}{of} \markbox{12148}{median} \markbox{12149}{spaces} \markbox{12150}{admits} \markbox{12151}{the} \markbox{12152}{structure} \markbox{12153}{of} \markbox{12154}{a} \markbox{12155}{median} space, \markbox{12156}{where} \markbox{12157}{the} \markbox{12158}{median} \markbox{12159}{on} \markbox{12160}{the} \markbox{12161}{product} \markbox{12162}{is} \markbox{12163}{the} \markbox{12164}{tuple} \markbox{12165}{of} \markbox{12166}{medians} \markbox{12167}{in} \markbox{12168}{the} coordinates.
       \item For \markbox{12169}{any} \markbox{m12170}{$\ha,\hb,\hc \in \calQ^{(0)}$}, \markbox{12171}{we} \markbox{12172}{have} \markbox{m12173}{$\left(\mm_U(\ha_U,\hb_U,\hc_U)\right)_U \in \calQ$}.  \markbox{12174}{This} \markbox{12175}{can} \markbox{12176}{be} \markbox{12177}{proven} \markbox{12178}{using} \markbox{12179}{a} \markbox{12180}{basic} \markbox{12181}{consistency} \markbox{12182}{argument} (see \cite[Lemma 15.12]{Dur_infcube}).
       \item With \markbox{12183}{this} \markbox{12184}{median} structure, \markbox{m12185}{$a,b \in \calQ^{(0)}$} \markbox{12186}{are} \markbox{12187}{median} \markbox{12188}{adjacent} \markbox{12189}{exactly} \markbox{12190}{when} \markbox{12191}{they} \markbox{12192}{span} \markbox{12193}{an} \markbox{12194}{edge} \markbox{12195}{in} \markbox{m12196}{$\calQ^{(1)}$}.
   \end{itemize}

   Finally, \markbox{12197}{observe} \markbox{12198}{that} \markbox{12199}{the} \markbox{12200}{hyperplanes} \markbox{12201}{of} \markbox{m12202}{$\calY$} \markbox{12203}{are} \markbox{12204}{of} \markbox{12205}{the} \markbox{12206}{form} \markbox{m12207}{$\hh \times \prod_{V\neq U} \hT_V$} \markbox{12208}{for} \markbox{m12209}{$\hh$} \markbox{12210}{some} \markbox{12211}{hyperplane} \markbox{12212}{in} \markbox{m12213}{$\hT_U$}.  \markbox{12214}{Since} \markbox{m12215}{$\calQ$} \markbox{12216}{is} \markbox{12217}{a} \markbox{12218}{median} \markbox{12219}{subalgebra} \markbox{12220}{of} \markbox{m12221}{$\calY$}, \markbox{12222}{the} \markbox{12223}{hyperplanes} \markbox{12224}{of} \markbox{m12225}{$\calQ$} \markbox{12226}{are} \markbox{12227}{just} \markbox{12228}{hyperplanes} \markbox{12229}{of} \markbox{m12230}{$\calY$} \markbox{12231}{intersected} \markbox{12232}{with} \markbox{m12233}{$\calQ$}, \markbox{12234}{so} \markbox{12235}{the} \markbox{12236}{moreover} \markbox{12237}{statement} follows.  \markbox{12238}{This} \markbox{12239}{completes} \markbox{12240}{the} proof.
\end{proof}














\subsection{More tree trimming and hyperplane deletions}\label{subsec:tt cube}


In \markbox{12241}{Subsection} \ref{subsec:tree trimming}, \markbox{12242}{we} \markbox{12243}{introduced} \markbox{12244}{our} \markbox{12245}{tree} \markbox{12246}{trimming} techniques, \markbox{12247}{which} \markbox{12248}{allowed} \markbox{12249}{us} \markbox{12250}{to} \markbox{12251}{take} \markbox{12252}{a} \markbox{12253}{family} \markbox{12254}{of} \markbox{12255}{collapsed} \markbox{12256}{intervals} \markbox{12257}{and} \markbox{12258}{collapse} \markbox{12259}{a} \markbox{12260}{further} \markbox{12261}{family} \markbox{12262}{of} \markbox{12263}{subintervals} \markbox{12264}{while} \markbox{12265}{maintaining} \markbox{12266}{control} \markbox{12267}{over} \markbox{12268}{their} \markbox{12269}{associated} \markbox{m12270}{$0$}-consistent subsets.  \markbox{12271}{In} \markbox{12272}{this} subsection, \markbox{12273}{we} \markbox{12274}{need} \markbox{12275}{a} \markbox{12276}{further} \markbox{12277}{refinement} \markbox{12278}{applied} \markbox{12279}{to} \markbox{12280}{HFIs} \markbox{12281}{and} \markbox{12282}{their} \markbox{12283}{associated} \markbox{12284}{cube} complexes.

To \markbox{12285}{set} \markbox{12286}{up} \markbox{12287}{the} statement, \markbox{12288}{let} \markbox{m12289}{$\{\hT_U\}_{U \in \calU}$} \markbox{12290}{be} \markbox{12291}{a} \markbox{12292}{hierarchical} \markbox{12293}{family} \markbox{12294}{of} intervals, \markbox{12295}{as} \markbox{12296}{in} \markbox{12297}{Definition} \ref{defn:HFI}.  \markbox{12298}{Fix} \markbox{12299}{a} \markbox{12300}{constant} \markbox{m12301}{$B>0$}, \markbox{12302}{which} \markbox{12303}{will} \markbox{12304}{control} \markbox{12305}{the} \markbox{12306}{size} \markbox{12307}{and} \markbox{12308}{number} \markbox{12309}{of} \markbox{12310}{subintervals} \markbox{12311}{we} \markbox{12312}{will} \markbox{12313}{collapse} \markbox{12314}{across} \markbox{12315}{all} \markbox{12316}{of} \markbox{12317}{the} intervals.  \markbox{12318}{In} \markbox{12319}{our} applications, \markbox{12320}{we} \markbox{12321}{will} \markbox{12322}{be} \markbox{12323}{able} \markbox{12324}{to} \markbox{12325}{control} \markbox{12326}{the} \markbox{12327}{size} \markbox{12328}{of} \markbox{m12329}{$B$}, \markbox{12330}{but} \markbox{12331}{notably} \markbox{12332}{not} \markbox{12333}{with} \markbox{12334}{respect} \markbox{12335}{to} \markbox{12336}{the} \markbox{12337}{largeness} \markbox{12338}{constant} \markbox{m12339}{$K$}, \markbox{12340}{unlike} \markbox{12341}{in} \markbox{12342}{the} \markbox{12343}{statement} \markbox{12344}{of} \markbox{12345}{Theorem} \ref{thm:tree trimming}.

\begin{definition}[Admissible \markbox{12346}{simplicial} \markbox{12347}{trimming} setup]\label{defn:simplicial trimming setup}
Given \markbox{m12348}{$B>0$}, \markbox{12349}{a} \markbox{m12350}{$B$}-\emph{admissible simplicial trimming setup} \markbox{12351}{is} \markbox{12352}{a} \markbox{12353}{collection} \markbox{12354}{of} \emph{trimming intervals} \markbox{m12355}{$\calB$} \markbox{12356}{in} \markbox{12357}{the} \markbox{12358}{various} \markbox{m12359}{$\hT_{U,e}$} \markbox{12360}{satisfying} \markbox{12361}{the} following:
\begin{enumerate}
\item For \markbox{12362}{each} \markbox{m12363}{$D \in \calB$} \markbox{12364}{with} \markbox{m12365}{$D \subset E \in \pi_0(\hT_{U,e})$}, \markbox{12366}{we} \markbox{12367}{have} \label{item:trimming integer}
\begin{enumerate}
\item \markbox{m12368}{$D$} \markbox{12369}{is} \markbox{12370}{a} \markbox{12371}{subinterval} \markbox{12372}{of} \markbox{m12373}{$E$} \markbox{12374}{with} \markbox{12375}{endpoints} \markbox{12376}{at} vertices, and
\item the \markbox{12377}{length} \markbox{m12378}{$l(D)$} \markbox{12379}{of} \markbox{m12380}{$D$} \markbox{12381}{is} \markbox{12382}{a} \markbox{12383}{positive} \markbox{12384}{integer} \markbox{12385}{whose} \markbox{12386}{length} \markbox{12387}{is} \markbox{12388}{bounded} \markbox{12389}{above} \markbox{12390}{by} \markbox{m12391}{$B$}.
\end{enumerate}
\item The \markbox{12392}{number} \markbox{12393}{of} \markbox{12394}{subintervals} \markbox{12395}{in} \markbox{m12396}{$\calB$} \markbox{12397}{is} \markbox{12398}{bounded} \markbox{12399}{by} \markbox{m12400}{$B$}, \markbox{12401}{that} \markbox{12402}{is} \markbox{m12403}{$\#\calB < B$}.
\end{enumerate}
\end{definition}

\begin{remark}
We \markbox{12404}{note} \markbox{12405}{that} \markbox{12406}{the} \markbox{12407}{conditions} \markbox{12408}{in} \markbox{12409}{Definition} \ref{defn:simplicial trimming setup} \markbox{12410}{guarantee} \markbox{12411}{that} \markbox{12412}{each} \markbox{12413}{quotient} \markbox{12414}{interval} \markbox{m12415}{$\hT_{U,0}$} \markbox{12416}{is} \markbox{12417}{a} \markbox{12418}{simplicial} \markbox{12419}{interval} \markbox{12420}{of} \markbox{12421}{the} \markbox{12422}{usual} \markbox{12423}{type} \markbox{12424}{we} consider.  \markbox{12425}{The} \markbox{12426}{requirement} \markbox{12427}{that} \markbox{12428}{each} \markbox{12429}{segment} \markbox{m12430}{$D \in \calB$} \markbox{12431}{has} \markbox{12432}{endpoints} \markbox{12433}{at} \markbox{12434}{vertices} \markbox{12435}{guarantees} \markbox{12436}{that} \markbox{12437}{when} \markbox{12438}{we} \markbox{12439}{collapse} \markbox{12440}{such} \markbox{12441}{a} segment, \markbox{12442}{then} \markbox{12443}{it} \markbox{12444}{only} \markbox{12445}{affects} \markbox{12446}{the} interval-hyperplanes \markbox{12447}{it} contains, \markbox{12448}{preserving} \markbox{12449}{those} \markbox{12450}{in} \markbox{12451}{its} complement.
\end{remark}

We \markbox{12452}{use} \markbox{12453}{the} \markbox{12454}{same} \markbox{12455}{associated} \markbox{12456}{notation} \markbox{12457}{as} \markbox{12458}{in} \markbox{12459}{Subsection} \ref{subsec:tree trimming}.  Furthermore, \markbox{12460}{we} \markbox{12461}{note} \markbox{12462}{that} \markbox{12463}{if} \markbox{m12464}{$\hT^e_U \subset \calB$}, \markbox{12465}{then} \markbox{m12466}{$\diam (\hT_U) < B^2$} \markbox{12467}{and} \markbox{m12468}{$\hT_{U,0}$} \markbox{12469}{is} \markbox{12470}{a} point.  \markbox{12471}{Let} \markbox{m12472}{$\calU_0 \subset \calU$} \markbox{12473}{denote} \markbox{12474}{the} \markbox{12475}{subset} \markbox{12476}{of} \markbox{12477}{domains} \markbox{12478}{for} \markbox{12479}{which} \markbox{m12480}{$\hT_{U,0}$} \markbox{12481}{is} \markbox{12482}{not} \markbox{12483}{a} point.  \markbox{12484}{By} \markbox{12485}{ignoring} \markbox{12486}{the} \markbox{12487}{domains} \markbox{12488}{in} \markbox{m12489}{$\calU - \calU_0$}, \markbox{12490}{we} \markbox{12491}{can} \markbox{12492}{consider} \markbox{12493}{the} \markbox{12494}{set} \markbox{12495}{of} \markbox{12496}{collapsed} \markbox{12497}{intervals} \markbox{m12498}{$\{\hT_{U,0}\}_{U \in \calU_0}$}, \markbox{12499}{where} \markbox{12500}{we} \markbox{12501}{remove} \markbox{12502}{any} \markbox{12503}{labels} \markbox{m12504}{$\hd^V_U$} \markbox{12505}{from} \markbox{m12506}{$\hT_U$} \markbox{12507}{from} \markbox{12508}{any} \markbox{12509}{domain} \markbox{m12510}{$V \nest U$} \markbox{12511}{with} \markbox{m12512}{$V \in \calU - \calU_0$}.

The \markbox{12513}{following} \markbox{12514}{theorem} \markbox{12515}{expands} \markbox{12516}{on} \markbox{12517}{Theorem} \ref{thm:tree trimming} \markbox{12518}{in} \markbox{12519}{the} \markbox{12520}{HFI} setting:

\begin{theorem}\label{thm:simplicial tree trimming}
Let \markbox{m12521}{$B>0$} \markbox{12522}{and} \markbox{m12523}{$\{\hT_U\}_{U \in \calU}$} \markbox{12524}{be} \markbox{12525}{an} HFI.  \markbox{12526}{For} \markbox{12527}{any} \markbox{m12528}{$B$}-admissible \markbox{12529}{simplicial} \markbox{12530}{trimming} \markbox{12531}{setup} \markbox{m12532}{$\calB$}, \markbox{12533}{the} \markbox{12534}{following} hold:

\begin{enumerate}
\item The \markbox{12535}{collections} \markbox{m12536}{$\{\hT_{U,0}\}_{U \in \calU}$} \markbox{12537}{and} \markbox{m12538}{$\{\hT_{U,0}\}_{U \in \calU_0}$} \markbox{12539}{are} HFIs.  \markbox{12540}{We} \markbox{12541}{let} \markbox{m12542}{$\calQ', \calQ_0$} \markbox{12543}{denote} \markbox{12544}{their} \markbox{12545}{corresponding} \markbox{m12546}{$0$}-consistent subsets.
\item We \markbox{12547}{have} \markbox{m12548}{$\Delta(\calQ) = \calQ'$}, \markbox{12549}{where} \markbox{m12550}{$\Delta:\prod_U \hT_U \to \prod_U \hT'_U$} \markbox{12551}{is} \markbox{12552}{the} \markbox{12553}{global} \markbox{12554}{collapsing} map.
\item There \markbox{12555}{exists} \markbox{12556}{a} \markbox{12557}{map} \markbox{m12558}{$\Xi:\calQ' \to \calQ$} \markbox{12559}{with} \markbox{m12560}{$\Delta \circ \Xi = id_{\calQ'}$}.
\item The \markbox{12561}{map} \markbox{m12562}{$\Delta|_{\calQ}: \calQ \to \calQ'$} \markbox{12563}{is} \markbox{12564}{a} \markbox{m12565}{$(1, B^2)$}-quasi-isometry.
\item At \markbox{12566}{the} \markbox{12567}{level} \markbox{12568}{of} \markbox{12569}{cube} complexes, \markbox{12570}{the} \markbox{12571}{map} \markbox{m12572}{$\Delta:\calQ \to \calQ'$} \markbox{12573}{is} \markbox{12574}{a} \markbox{12575}{hyperplane} \markbox{12576}{deletion} \markbox{12577}{map} \markbox{12578}{deleting} \markbox{12579}{at} \markbox{12580}{most} \markbox{m12581}{$B^2$}-many hyperplanes.
\end{enumerate}

\end{theorem}

\begin{proof}
Item (1) \markbox{12582}{is} straightforward, \markbox{12583}{since} \markbox{12584}{we} \markbox{12585}{are} \markbox{12586}{just} \markbox{12587}{collapsing} \markbox{12588}{simplicial} subintervals.  \markbox{12589}{Items} (2)--(3) \markbox{12590}{follow} \markbox{12591}{from} \markbox{12592}{Theorem} \ref{thm:tree trimming}, \markbox{12593}{where} \markbox{12594}{in} \markbox{12595}{the} \markbox{12596}{argument} \markbox{12597}{we} \markbox{12598}{just} \markbox{12599}{replace} \markbox{12600}{the} \markbox{12601}{HFI} \markbox{12602}{axioms} (Definition \ref{defn:HFI}) \markbox{12603}{with} \markbox{12604}{the} \markbox{12605}{appropriate} \markbox{12606}{properties} \markbox{12607}{from} \markbox{12608}{Lemma} \ref{lem:collapsed interval control}.  \markbox{12609}{The} \markbox{12610}{fact} \markbox{12611}{that} \markbox{m12612}{$\Delta$} \markbox{12613}{deletes} \markbox{12614}{at} \markbox{12615}{most} \markbox{m12616}{$B^2$}-many \markbox{12617}{hyperplanes} \markbox{12618}{from} \markbox{m12619}{$\prod_U \hT_U$}, \markbox{12620}{so} \markbox{12621}{item} (5) \markbox{12622}{follows} \markbox{12623}{from} \markbox{12624}{the} ``moreover'' \markbox{12625}{part} \markbox{12626}{of} \markbox{12627}{Theorem} \ref{thm:Q CCC}.  Finally, \markbox{12628}{item} (4) \markbox{12629}{follows} \markbox{12630}{immediately} \markbox{12631}{from} \markbox{12632}{item} (5).  \markbox{12633}{This} \markbox{12634}{completes} \markbox{12635}{the} proof.


\end{proof}







\subsection{Hierarchy paths and the distance formula}\label{subsec:HP and DF}

With \markbox{12636}{Theorem} \ref{thm:Q CCC} \markbox{12637}{in} hand, \markbox{12638}{we} \markbox{12639}{can} \markbox{12640}{make} \markbox{12641}{some} \markbox{12642}{observations} \markbox{12643}{about} \markbox{12644}{the} \markbox{12645}{cubical} \markbox{12646}{structure} \markbox{12647}{of} \markbox{m12648}{$\calQ$} \markbox{12649}{and} \markbox{12650}{how} \markbox{12651}{it} \markbox{12652}{relates} \markbox{12653}{to} \markbox{12654}{its} \markbox{12655}{hierarchical} nature.  \markbox{12656}{In} particular, \markbox{12657}{we} \markbox{12658}{get} \markbox{12659}{a} \markbox{12660}{proof} \markbox{12661}{of} \markbox{12662}{the} (more difficult) \markbox{12663}{lower} \markbox{12664}{bound} \markbox{12665}{of} \markbox{12666}{the} \markbox{12667}{Distance} \markbox{12668}{Formula} \ref{thm:DF} \markbox{12669}{and} \markbox{12670}{the} \markbox{12671}{existence} \markbox{12672}{of} \markbox{12673}{hierarchy} paths.

The \markbox{12674}{following} \markbox{12675}{lemma} \markbox{12676}{is} \cite[Lemma 14.7]{Dur_infcube}, \markbox{12677}{and} \markbox{12678}{we} \markbox{12679}{have} \markbox{12680}{included} \markbox{12681}{its} \markbox{12682}{proof} \markbox{12683}{here} \markbox{12684}{for} completeness.


\begin{lemma}\label{lem:NR hp in Q}
Let \markbox{m12685}{$\hx,\hy \in \calQ$}.  \markbox{12686}{Let} \markbox{m12687}{$\gamma$} \markbox{12688}{be} \markbox{12689}{any} \markbox{12690}{combinatorial} \markbox{12691}{geodesic} \markbox{12692}{in} \markbox{m12693}{$\calQ$} \markbox{12694}{from} \markbox{m12695}{$\hx$} \markbox{12696}{to} \markbox{m12697}{$\hy$}.  \markbox{12698}{Then} \markbox{12699}{for} \markbox{12700}{all} \markbox{m12701}{$U \in \calU$}, \markbox{12702}{the} \markbox{12703}{projection} \markbox{m12704}{$\hpi_U(\gamma) \subset \hT_U$} \markbox{12705}{is} \markbox{12706}{an} \markbox{12707}{unparameterized} \markbox{12708}{geodesic} \markbox{12709}{between} \markbox{m12710}{$\hx_U$} \markbox{12711}{and} \markbox{m12712}{$\hy_U$}.
\end{lemma} 

\begin{proof}
Since \markbox{12713}{combinatorial} \markbox{12714}{geodesics} \markbox{12715}{do} \markbox{12716}{not} \markbox{12717}{cross} \markbox{12718}{a} \markbox{12719}{hyperplane} \markbox{12720}{twice} \markbox{12721}{and} \markbox{12722}{the} \markbox{12723}{restriction} \markbox{12724}{quotient} \markbox{m12725}{$\hpi_U:\calQ \to \hT_U$} \markbox{12726}{is} \markbox{m12727}{$1$}-Lipschitz, \markbox{12728}{it} \markbox{12729}{follows} \markbox{12730}{that} \markbox{m12731}{$\hpi_U(\gamma)$} \markbox{12732}{does} \markbox{12733}{not} \markbox{12734}{backtrack} either.  \markbox{12735}{This} \markbox{12736}{completes} \markbox{12737}{the} proof.





\end{proof}

This \markbox{12738}{lemma} \markbox{12739}{plays} \markbox{12740}{two} roles: it's \markbox{12741}{useful} \markbox{12742}{for} \markbox{12743}{proving} \markbox{12744}{that} \markbox{12745}{an} \markbox{12746}{isomorphism} \markbox{12747}{of} \markbox{12748}{HFIs} \markbox{12749}{induces} \markbox{12750}{an} \markbox{12751}{isomorphism} \markbox{12752}{of} \markbox{12753}{their} \markbox{12754}{cubical} \markbox{12755}{duals} (Proposition \ref{prop:HFI isomorphism}), and, \markbox{12756}{in} \markbox{12757}{the} \markbox{12758}{next} proposition, \markbox{12759}{we} \markbox{12760}{use} \markbox{12761}{it} \markbox{12762}{directly} \markbox{12763}{to} \markbox{12764}{show} \markbox{12765}{that} \markbox{12766}{combinatorial} \markbox{12767}{geodesics} \markbox{12768}{in} \markbox{12769}{a} \markbox{12770}{cubical} \markbox{12771}{model} \markbox{12772}{get} \markbox{12773}{sent} \markbox{12774}{to} \markbox{12775}{hierarchy} \markbox{12776}{paths} (Definition \ref{defn:hp}) \markbox{12777}{in} \markbox{12778}{the} \markbox{12779}{ambient} HHS.  \markbox{12780}{That} \markbox{12781}{is} \markbox{12782}{the} \markbox{12783}{content} \markbox{12784}{of} \markbox{12785}{the} \markbox{12786}{next} proposition, \markbox{12787}{which} \markbox{12788}{is} \markbox{12789}{simplified} \markbox{12790}{version} \markbox{12791}{of} \cite[Proposition 14.8]{Dur_infcube}:

\begin{proposition}\label{prop:cubical hp}
Let \markbox{m12792}{$a,b \in \calX$}, \markbox{m12793}{$K \geq K_0$} \markbox{12794}{where} \markbox{m12795}{$K_0 = K_0(\mathfrak S)>0$} \markbox{12796}{is} \markbox{12797}{from} \markbox{12798}{Theorem} \ref{thm:DF}, \markbox{m12799}{$\calU = \Rel_K(a,b)$}, \markbox{12800}{and} \markbox{12801}{let} \markbox{m12802}{$H = \hull_{\calX}(a,b)$}.  \markbox{12803}{Let} \markbox{m12804}{$\{T_U\}_{U \in \calU}$} \markbox{12805}{be} \markbox{12806}{any} \markbox{m12807}{$R$}-interval \markbox{12808}{system} \markbox{12809}{for} \markbox{m12810}{$a,b$} \markbox{12811}{and} \markbox{m12812}{$\{\hT_U\}_{U \in \calU}$} \markbox{12813}{the} \markbox{12814}{HFI} \markbox{12815}{associated} \markbox{12816}{to} \markbox{12817}{any} \markbox{m12818}{$(r_1,r_2)$}-thickening \markbox{12819}{for} \markbox{m12820}{$r_1 \geq R_1, r_2 \geq R_2$}  \markbox{12821}{with} \markbox{m12822}{$r_1$} \markbox{12823}{a} \markbox{12824}{positive} integer.  \markbox{12825}{Let} \markbox{m12826}{$\calQ$} \markbox{12827}{be} \markbox{12828}{the} \markbox{12829}{corresponding} \markbox{m12830}{$0$}-consistent \markbox{12831}{set} \markbox{12832}{and} \markbox{m12833}{$\hO:\calQ \to H$} \markbox{12834}{the} quasi-isometry \markbox{12835}{constructed} \markbox{12836}{in} \markbox{12837}{Section} \ref{sec:hPsi qi}.
\begin{itemize}
\item If \markbox{m12838}{$\ha, \hb$} \markbox{12839}{are} \markbox{12840}{the} \markbox{12841}{points} \markbox{m12842}{$\calQ$} \markbox{12843}{corresponding} \markbox{12844}{to} \markbox{m12845}{$a, b$} \markbox{12846}{and} \markbox{m12847}{$\gamma$} \markbox{12848}{is} \markbox{12849}{a} \markbox{12850}{combinatorial} \markbox{12851}{geodesic} \markbox{12852}{between} them, \markbox{12853}{then} \markbox{m12854}{$\hO(\gamma) \subset H$} \markbox{12855}{is} \markbox{12856}{an} \markbox{m12857}{$(L_{hp},L_{hp})$}-hierarchy \markbox{12858}{path} \markbox{12859}{between} \markbox{m12860}{$a,b$} \markbox{12861}{for} \markbox{m12862}{$L_{hp} = L_{hp}(R,r_1,r_2,K, \mathfrak S)>0$}.
\end{itemize} 
\end{proposition}

\begin{proof}
The \markbox{12863}{following} \markbox{12864}{is} \markbox{12865}{a} \markbox{12866}{fairly} \markbox{12867}{complete} \markbox{12868}{sketch} \markbox{12869}{of} \markbox{12870}{the} proof, \markbox{12871}{which} \markbox{12872}{is} \markbox{12873}{simpler} \markbox{12874}{than} \markbox{12875}{the} \markbox{12876}{more} \markbox{12877}{general} \markbox{12878}{version} \markbox{12879}{from} \cite[Proposition 14.8]{Dur_infcube}.

Since \markbox{12880}{the} \markbox{12881}{map} \markbox{m12882}{$\hO:\calQ \to H$} \markbox{12883}{is} \markbox{12884}{effectively} \markbox{12885}{defined} coordinate-wise, \markbox{12886}{its} \markbox{12887}{enough} \markbox{12888}{to} \markbox{12889}{consider} \markbox{12890}{the} coordinate-wise \markbox{12891}{maps} \markbox{m12892}{$B_U:\hT_U \to T_U$} \markbox{12893}{as} \markbox{12894}{described} \markbox{12895}{in} \markbox{12896}{Subsection} \ref{subsec:hO defined}, \markbox{12897}{as} \markbox{12898}{the} \markbox{12899}{map} \markbox{m12900}{$\phi_U:T_U\to \calC(U)$} \markbox{12901}{is} \markbox{12902}{an} \markbox{m12903}{$(R,R)$}-quasi-isometric \markbox{12904}{embedding} \markbox{12905}{by} assumption.  \markbox{12906}{For} this, \markbox{12907}{we} \markbox{12908}{can} \markbox{12909}{let} \markbox{m12910}{$\gamma_U$} \markbox{12911}{denote} \markbox{12912}{the} coordinate-wise \markbox{12913}{projection} \markbox{12914}{of} \markbox{m12915}{$\gamma$} \markbox{12916}{to} \markbox{12917}{each} \markbox{m12918}{$\hT_U$}, \markbox{12919}{and} \markbox{12920}{we} \markbox{12921}{want} \markbox{12922}{to} \markbox{12923}{show} \markbox{12924}{that} \markbox{m12925}{$B_U(\gamma_U)$} \markbox{12926}{is} \markbox{12927}{an} \markbox{12928}{unparameterized} quasi-geodesic \markbox{12929}{in} \markbox{m12930}{$T_U$}.

By construction, \markbox{m12931}{$B_U(\gamma_U) \subset [a_U,b_U] = T_U$}, \markbox{12932}{so} \markbox{12933}{it} \markbox{12934}{suffices} \markbox{12935}{to} \markbox{12936}{show} \markbox{12937}{that} \markbox{12938}{this} \markbox{12939}{path} \markbox{12940}{never} \markbox{12941}{backtracks} \markbox{12942}{an} \markbox{12943}{unbounded} amount.  \markbox{12944}{Proceeding} \markbox{12945}{by} \markbox{12946}{induction} \markbox{12947}{in} \markbox{12948}{the} \markbox{m12949}{$\nest_{\calU}$}-level \markbox{12950}{in} \markbox{m12951}{$\calU$}, \markbox{12952}{if} \markbox{m12953}{$U \in \calU$} \markbox{12954}{is} \markbox{m12955}{$\nest$}-minimal, \markbox{12956}{then} \markbox{12957}{the} \markbox{12958}{amount} \markbox{12959}{of} \markbox{12960}{collapsing} \markbox{12961}{in} \markbox{m12962}{$q_U:T_U \to \hT_U$} \markbox{12963}{is} \markbox{12964}{bounded} \markbox{12965}{by} \markbox{m12966}{$2r_1$}, \markbox{12967}{and} \markbox{12968}{we} \markbox{12969}{are} \markbox{12970}{done} \markbox{12971}{by} \markbox{12972}{Lemma} \ref{lem:NR hp in Q}.  \markbox{12973}{For} non-minimal \markbox{12974}{domains} \markbox{m12975}{$U \in \calU$}, \markbox{12976}{note} \markbox{12977}{that} \markbox{12978}{by} \markbox{12979}{Lemma} \ref{lem:NR hp in Q}, \markbox{12980}{backtracking} \markbox{12981}{in} \markbox{m12982}{$T_U$} \markbox{12983}{is} \markbox{12984}{only} \markbox{12985}{possible} \markbox{12986}{if} \markbox{m12987}{$\gamma_U(t), \gamma_U(s)$} \markbox{12988}{are} \markbox{12989}{at} \markbox{12990}{the} \markbox{12991}{same} \markbox{12992}{collapsed} \markbox{12993}{point} \markbox{12994}{corresponding} \markbox{12995}{to} \markbox{12996}{some} \markbox{12997}{cluster} \markbox{m12998}{$C$}.  \markbox{12999}{If} \markbox{13000}{there} \markbox{13001}{are} \markbox{13002}{times} \markbox{m13003}{$s < t$} \markbox{13004}{so} \markbox{13005}{that} \markbox{m13006}{$d_{T_U}(B_U(\gamma(s), b_U) - d_{T_U}(B_U(\gamma(s)),b_U) \gg 100r_2 + 100r_1$}, \markbox{13007}{then} \markbox{13008}{there} \markbox{13009}{is} \markbox{13010}{some} \markbox{m13011}{$\nest_{\calU}$}-minimal \markbox{13012}{domain} \markbox{m13013}{$V \nest U$} \markbox{13014}{with} \markbox{m13015}{$\hd^V_U = q_U(C)$} \markbox{13016}{for} \markbox{13017}{which} \markbox{m13018}{$B_U(\gamma_U(t))$} \markbox{13019}{is} \markbox{13020}{on} \markbox{13021}{the} \markbox{13022}{side} \markbox{13023}{of} \markbox{m13024}{$a_U$} \markbox{13025}{while} \markbox{m13026}{$B_U(\gamma_U(s))$} \markbox{13027}{is} \markbox{13028}{on} \markbox{13029}{the} \markbox{13030}{side} \markbox{13031}{of} \markbox{m13032}{$b_U$}, \markbox{13033}{with} \markbox{13034}{both} \markbox{m13035}{$(50r_2 + 50r_1)$}-away \markbox{13036}{from} \markbox{m13037}{$\delta^V_U$}.  \markbox{13038}{But} \markbox{13039}{then} \markbox{13040}{consistency} \markbox{13041}{and} \markbox{13042}{the} \markbox{13043}{BGI} \markbox{13044}{properties} \markbox{13045}{from} \markbox{13046}{Lemma} \ref{lem:interval control} \markbox{13047}{implies} \markbox{13048}{that} \markbox{m13049}{$B_V(\gamma_V(t)), a_V$} \markbox{13050}{and} \markbox{m13051}{$B_V(\gamma_V(s)),b_V$} \markbox{13052}{are} \markbox{m13053}{$R$}-close, \markbox{13054}{and} \markbox{13055}{so} \markbox{m13056}{$\gamma_V(t) = \ha_V$} \markbox{13057}{and} \markbox{m13058}{$\gamma_V(s) = \hb_V$}, \markbox{13059}{which} \markbox{13060}{contradicts} \markbox{13061}{the} \markbox{13062}{base} \markbox{13063}{case} \markbox{13064}{of} \markbox{13065}{this} induction.  \markbox{13066}{This} \markbox{13067}{completes} \markbox{13068}{the} proof.
\end{proof}

\begin{remark}
     \markbox{13069}{Since} \markbox{13070}{the} \markbox{13071}{map} \markbox{m13072}{$\hO: \calQ \to \calX$} \markbox{13073}{is} \markbox{13074}{uniformly} quasi-median \cite[Section 15]{Dur_infcube}, \markbox{13075}{one} \markbox{13076}{could} \markbox{13077}{alternatively} \markbox{13078}{use} \markbox{13079}{the} \markbox{13080}{fact} \markbox{13081}{that} \markbox{13082}{median} \markbox{13083}{paths} \markbox{13084}{in} \markbox{13085}{HHSes} \markbox{13086}{are} \markbox{13087}{hierarchy} \markbox{13088}{paths} \cite[Lemma 1.37]{HHS_quasi}.
\end{remark}

As \markbox{13089}{a} \markbox{13090}{consequence} \markbox{13091}{of} \markbox{13092}{Propositions} \ref{prop:cubical hp} \markbox{13093}{and} \ref{prop:lower bound}, \markbox{13094}{we} \markbox{13095}{obtain} \markbox{13096}{the} \markbox{13097}{lower} \markbox{13098}{bound} \markbox{13099}{of} \markbox{13100}{the} \markbox{13101}{Distance} \markbox{13102}{Formula} \ref{thm:DF}:

\begin{corollary}\label{cor:DF lower bound}
There \markbox{13103}{exists} \markbox{m13104}{$K_0 = K_0(\mathfrak S)>0$} \markbox{13105}{such} \markbox{13106}{that} \markbox{13107}{for} \markbox{13108}{all} \markbox{m13109}{$K>K_0$} \markbox{13110}{and} \markbox{13111}{any} \markbox{m13112}{$x, y \in \calX$}, \markbox{13113}{we} have
$$\sum_{U \in \mathfrak S} \left[d_U(x,y)\right]_K \prec d_{\calX}(x,y).$$
\end{corollary}

\subsection{Isomorphisms of HFIs and their associated cube complexes}

In \markbox{13114}{this} \markbox{13115}{final} subsection, \markbox{13116}{we} \markbox{13117}{will} \markbox{13118}{discuss} \markbox{13119}{when} \markbox{13120}{two} \markbox{13121}{HFIs} \markbox{13122}{to} \markbox{13123}{determine} \markbox{13124}{isomorphic} \markbox{13125}{cube} complexes.  \markbox{13126}{This} statement, \markbox{13127}{while} unsurprising, \markbox{13128}{motivates} \markbox{13129}{what} \markbox{13130}{happens} \markbox{13131}{in} \markbox{13132}{the} \markbox{13133}{subsequent} sections, \markbox{13134}{hence} \markbox{13135}{its} \markbox{13136}{placement} here.

Let \markbox{m13137}{$\{\hT_U\}_{U \in \calU}$} \markbox{13138}{and} \markbox{m13139}{$\{\hT'_U\}_{U \in \calU}$} \markbox{13140}{be} \markbox{13141}{two} \markbox{13142}{HFIs} \markbox{13143}{over} \markbox{13144}{a} \markbox{13145}{common} \markbox{13146}{index} \markbox{13147}{set} \markbox{m13148}{$\calU$} \markbox{13149}{and} \markbox{13150}{common} relations, i.e. \markbox{m13151}{$U,V \in \calU$} \markbox{13152}{have} \markbox{13153}{the} \markbox{13154}{same} \markbox{13155}{relation} \markbox{13156}{in} \markbox{13157}{both} HFIs.  \markbox{13158}{Any} \markbox{13159}{family} \markbox{13160}{of} \markbox{13161}{maps} \markbox{m13162}{$i_U:\hT_U \to \hT'_U$} \markbox{13163}{induces} \markbox{13164}{a} \markbox{13165}{global} \markbox{13166}{map} \markbox{m13167}{$I:\prod_{U \in \calU} \hT_U \to \prod_{U \in \calU} \hT'_U$}, \markbox{13168}{where} \markbox{m13169}{$I((\hx_U)) = (i_U(\hx_U))$}.

The \markbox{13170}{following} proposition, \markbox{13171}{which} \markbox{13172}{is} \markbox{13173}{an} \markbox{13174}{interval} \markbox{13175}{version} \markbox{13176}{of} \cite[Proposition 14.12]{Dur_infcube}, \markbox{13177}{gives} \markbox{13178}{sufficient} \markbox{13179}{conditions} \markbox{13180}{for} \markbox{13181}{the} \markbox{13182}{induced} \markbox{13183}{map} \markbox{13184}{to} \markbox{13185}{be} \markbox{13186}{an} \markbox{13187}{isometry} \markbox{m13188}{$I:\calQ \to \calQ'$} \markbox{13189}{which} \markbox{13190}{induces} \markbox{13191}{a} \markbox{13192}{cubical} \markbox{13193}{isomorphism} \markbox{13194}{between} \markbox{13195}{their} \markbox{13196}{dual} \markbox{13197}{cube} complexes.

\begin{proposition}\label{prop:HFI isomorphism}
Let \markbox{m13198}{$\{\hT_U\}_{U \in \calU}$} \markbox{13199}{and} \markbox{m13200}{$\{\hT'_U\}_{U \in \calU}$} \markbox{13201}{be} \markbox{13202}{two} \markbox{13203}{HFIs} \markbox{13204}{over} \markbox{13205}{a} \markbox{13206}{common} \markbox{13207}{index} \markbox{13208}{set} \markbox{m13209}{$\calU$} \markbox{13210}{with} \markbox{13211}{marked} \markbox{13212}{points} \markbox{m13213}{$F = \{a,b\}$}, \markbox{13214}{and} \markbox{13215}{let} \markbox{m13216}{$\calQ, \calQ'$} \markbox{13217}{be} \markbox{13218}{their} \markbox{13219}{corresponding} \markbox{m13220}{$0$}-consistent sets.  \markbox{13221}{Suppose} \markbox{13222}{that} \markbox{13223}{for} \markbox{13224}{each} \markbox{m13225}{$U \in \calU$}, \markbox{13226}{there} \markbox{13227}{is} \markbox{13228}{a} \markbox{13229}{simplicial} \markbox{13230}{isometry} \markbox{m13231}{$i_U:\hT_U \to \hT'_U$} \markbox{13232}{which} \markbox{13233}{also} satisfies:
\begin{enumerate}
	\item We \markbox{13234}{have} \markbox{m13235}{$i_U(\ha_U) = \ha'_U \in \hT'_U$} \markbox{13236}{and} \markbox{m13237}{$i_U(\hb_U) = \hb'_U \in \hT'_U$}.
	\item For \markbox{13238}{all} \markbox{m13239}{$V  \in \calU$} \markbox{13240}{with} \markbox{m13241}{$V \nest U$} \markbox{13242}{or} \markbox{m13243}{$V \pitchfork U$}, \markbox{13244}{we} \markbox{13245}{have} \markbox{m13246}{$i_U(\hd^V_U) = \left(\hd^V_U\right)'$}.
	\item For \markbox{13247}{all} \markbox{m13248}{$V \in \calU$} \markbox{13249}{with} \markbox{m13250}{$U \nest V$} \markbox{13251}{and} \markbox{m13252}{$\hx_V \in \hT_V$}, \markbox{13253}{we} \markbox{13254}{have} \markbox{m13255}{$\left(\hd^V_U\right)'(i_V(\hx_V)) = i_U(\hd^V_U(\hx_V))$}.
\end{enumerate}
Then \markbox{13256}{the} \markbox{13257}{corresponding} \markbox{13258}{map} \markbox{13259}{induces} \markbox{13260}{a} \markbox{13261}{cubical} \markbox{13262}{isomorphism} \markbox{m13263}{$I:\calQ \to \calQ'$}.
\end{proposition}

\begin{proof}[Sketch \markbox{13264}{of} proof]


The \markbox{13265}{proof} \markbox{13266}{of} \markbox{13267}{this} \markbox{13268}{version} \markbox{13269}{below} \markbox{13270}{is} \markbox{13271}{the} \markbox{13272}{same} \markbox{13273}{as} \markbox{13274}{the} original, \markbox{13275}{which} is, \markbox{13276}{in} turn, \markbox{13277}{an} \markbox{13278}{exercise} \markbox{13279}{in} \markbox{13280}{the} \markbox{13281}{construction} \markbox{13282}{from} \markbox{13283}{this} \markbox{13284}{section} \markbox{13285}{plus} \markbox{13286}{Lemma} \ref{lem:NR hp in Q}.  \markbox{13287}{The} \markbox{13288}{main} \markbox{13289}{idea} \markbox{13290}{is} \markbox{13291}{that} \markbox{13292}{items} \markbox{13293}{in} \markbox{13294}{the} \markbox{13295}{statement} \markbox{13296}{guarantee} \markbox{13297}{that} \markbox{13298}{the} \markbox{13299}{global} \markbox{13300}{map} \markbox{m13301}{$I$} \markbox{13302}{induced} \markbox{13303}{from} \markbox{13304}{the} coordinate-wise \markbox{13305}{isometries} \markbox{13306}{preserves} \markbox{m13307}{$0$}-consistency \markbox{13308}{and} distances, i.e. \markbox{13309}{we} \markbox{13310}{have} \markbox{m13311}{$I:\calQ \to \calQ'$} \markbox{13312}{is} \markbox{13313}{an} \markbox{13314}{isometric} embedding, \markbox{13315}{with} \markbox{13316}{surjectivity} \markbox{13317}{following} \markbox{13318}{from} \markbox{13319}{a} \markbox{13320}{consistency} argument.  \markbox{13321}{Since} \markbox{13322}{the} interval-wise \markbox{13323}{maps} \markbox{13324}{respect} \markbox{13325}{the} \markbox{13326}{simplicial} structure, \markbox{13327}{we} \markbox{13328}{have} \markbox{13329}{that} \markbox{m13330}{$I$} \markbox{13331}{is} \markbox{13332}{also} \markbox{13333}{a} \markbox{13334}{cubical} \markbox{13335}{isomorphism} \markbox{13336}{via} \markbox{13337}{Lemma} \ref{lem:halfspaces_bijection}.  \markbox{13338}{We} \markbox{13339}{leave} \markbox{13340}{the} \markbox{13341}{details} \markbox{13342}{to} \markbox{13343}{the} reader.



\end{proof}
















\section{Controlling domains} \label{sec:controlling domains}

In \markbox{13344}{this} section, \markbox{13345}{we} \markbox{13346}{turn} \markbox{13347}{toward} \markbox{13348}{the} \markbox{13349}{proof} \markbox{13350}{of} \markbox{13351}{our} \markbox{13352}{main} \markbox{13353}{technical} result, \markbox{13354}{namely} \markbox{13355}{the} \markbox{13356}{Stable} \markbox{13357}{Cubical} \markbox{13358}{Interval} \markbox{13359}{Theorem} \ref{thm:stable cubes}, \markbox{13360}{which} \markbox{13361}{is} \markbox{13362}{a} \markbox{13363}{stabilized} \markbox{13364}{version} \markbox{13365}{of} \markbox{13366}{the} \markbox{13367}{cubical} \markbox{13368}{model} \markbox{13369}{construction} \markbox{13370}{for} \markbox{13371}{a} \markbox{13372}{pair} \markbox{13373}{of} \markbox{13374}{points} \markbox{m13375}{$a,b$} \markbox{13376}{in} \markbox{13377}{any} \markbox{13378}{HHS} \markbox{m13379}{$\calX$}.  \markbox{13380}{The} \markbox{13381}{goal} \markbox{13382}{is} \markbox{13383}{to} \markbox{13384}{show} \markbox{13385}{that} \markbox{13386}{if} \markbox{13387}{we} \markbox{13388}{perturb} \markbox{m13389}{$a,b$} \markbox{13390}{a} \markbox{13391}{small} \markbox{13392}{amount} \markbox{13393}{to} \markbox{13394}{a} \markbox{13395}{pair} \markbox{13396}{of} \markbox{13397}{points} \markbox{m13398}{$a',b'$} \markbox{13399}{with} \markbox{m13400}{$d_{\calX}(a,a') \leq 1$} \markbox{13401}{and} \markbox{m13402}{$d_{\calX}(b,b') \leq 1$}, \markbox{13403}{then} \markbox{13404}{we} \markbox{13405}{can} \markbox{13406}{produce} \markbox{13407}{cubical} \markbox{13408}{models} \markbox{m13409}{$\calQ$} \markbox{13410}{for} \markbox{m13411}{$a,b$} \markbox{13412}{and} \markbox{m13413}{$\calQ'$} \markbox{13414}{for} \markbox{m13415}{$a',b'$} \markbox{13416}{which} \markbox{13417}{are} \markbox{13418}{isomorphic} \markbox{13419}{up} \markbox{13420}{to} \markbox{13421}{deleting} boundedly-many hyperplanes.  \markbox{13422}{Doing} \markbox{13423}{so} \markbox{13424}{requires} \markbox{13425}{carefully} \markbox{13426}{controlling} \markbox{13427}{the} \markbox{13428}{main} \markbox{13429}{inputs} \markbox{13430}{into} \markbox{13431}{the} \markbox{13432}{cubulation} machine---namely \markbox{13433}{the} \markbox{13434}{families} \markbox{13435}{of} \markbox{13436}{intervals} \markbox{13437}{we} \markbox{13438}{construct} \markbox{13439}{from} \markbox{13440}{the} \markbox{13441}{projections} \markbox{13442}{of} \markbox{13443}{the} points.

The \markbox{13444}{first} \markbox{13445}{step} \markbox{13446}{in} \markbox{13447}{the} \markbox{13448}{process} \markbox{13449}{involves} \markbox{13450}{explaining} \markbox{13451}{how} \markbox{13452}{to} \markbox{13453}{gain} \markbox{13454}{control} \markbox{13455}{over} \markbox{13456}{the} \markbox{13457}{set} \markbox{13458}{of} \markbox{13459}{relevant} \markbox{13460}{domains} (Definition \ref{defn:relevant}) \markbox{13461}{for} \markbox{13462}{a} \markbox{13463}{pair} \markbox{13464}{of} \markbox{13465}{points} \markbox{m13466}{$F = \{a,b\} \subset \calX$} \markbox{13467}{and} \markbox{13468}{its} \markbox{13469}{perturbation} \markbox{m13470}{$F' = \{a',b'\}$}  \markbox{13471}{as} above.  \markbox{13472}{In} \markbox{13473}{the} \markbox{13474}{next} sections, \markbox{13475}{we} \markbox{13476}{explain} \markbox{13477}{how} \markbox{13478}{to} \markbox{13479}{take} \markbox{13480}{this} \markbox{13481}{projection} \markbox{13482}{data} \markbox{13483}{to} \markbox{13484}{build} \markbox{13485}{a} \markbox{13486}{family} \markbox{13487}{of} \markbox{13488}{stable} \markbox{13489}{intervals} \markbox{13490}{that} \markbox{13491}{we} \markbox{13492}{can} \markbox{13493}{plug} \markbox{13494}{into} \markbox{13495}{the} \markbox{13496}{cubulation} machine.

The \markbox{13497}{main} \markbox{13498}{bit} \markbox{13499}{of} \markbox{13500}{work} \markbox{13501}{for} \markbox{13502}{this} \markbox{13503}{first} \markbox{13504}{part} \markbox{13505}{has} \markbox{13506}{already} \markbox{13507}{been} \markbox{13508}{done} \markbox{13509}{for} \markbox{13510}{us} \markbox{13511}{by} Bestvina--Bromberg--Fujiwara \cite{BBF} \markbox{13512}{and} Bestvina--Bromberg--Fujiwara--Sisto \cite{BBFS}.  \markbox{13513}{The} \markbox{13514}{work} \markbox{13515}{we} \markbox{13516}{did} \markbox{13517}{with} \markbox{13518}{Minsky} \markbox{13519}{and} \markbox{13520}{Sisto} \markbox{13521}{in} \cite{DMS_bary} \markbox{13522}{mostly} \markbox{13523}{adapts} \markbox{13524}{their} \markbox{13525}{setup} \markbox{13526}{to} \markbox{13527}{the} \markbox{13528}{HHS} setting, \markbox{13529}{and} \markbox{13530}{makes} \markbox{13531}{some} straight-forward \markbox{13532}{but} \markbox{13533}{important} observations.

In \cite[Subsections 2.3 \markbox{13534}{and} 2.4]{DMS_bary}, \markbox{13535}{we} \markbox{13536}{were} \markbox{13537}{dealing} \markbox{13538}{with} \markbox{13539}{the} \markbox{13540}{situation} \markbox{13541}{where} \markbox{m13542}{$F,F'$} \markbox{13543}{were} \markbox{13544}{finite} \markbox{13545}{sets} \markbox{13546}{of} \markbox{13547}{points} \markbox{13548}{with} \markbox{13549}{cardinality} \markbox{13550}{possibly} \markbox{13551}{larger} \markbox{13552}{than} \markbox{m13553}{$2$}.  Nonetheless, \markbox{13554}{all} \markbox{13555}{of} \markbox{13556}{the} \markbox{13557}{arguments} \markbox{13558}{there} \markbox{13559}{reduce} \markbox{13560}{to} \markbox{13561}{considering} \markbox{13562}{pairs} \markbox{13563}{of} points, \markbox{13564}{and} \markbox{13565}{so} \markbox{13566}{the} \markbox{13567}{proofs} \markbox{13568}{for} \markbox{13569}{our} \markbox{13570}{current} \markbox{13571}{setting} \markbox{13572}{are} \markbox{13573}{essentially} \markbox{13574}{the} same.  \markbox{13575}{As} such, \markbox{13576}{we} \markbox{13577}{will} \markbox{13578}{mainly} \markbox{13579}{explain} \markbox{13580}{the} \markbox{13581}{setup} \markbox{13582}{and} \markbox{13583}{key} statements, \markbox{13584}{only} \markbox{13585}{giving} \markbox{13586}{minimal} \markbox{13587}{sketches} \markbox{13588}{of} proofs.

\subsection{Colorability}

The \markbox{13589}{hierarchical} \markbox{13590}{setting} \markbox{13591}{in} \markbox{13592}{which} \cite{BBFS} \markbox{13593}{works} \markbox{13594}{is} \markbox{13595}{for} \markbox{13596}{the} \markbox{13597}{following} class, \markbox{13598}{which} \markbox{13599}{was} \markbox{13600}{first} \markbox{13601}{defined} \markbox{13602}{in} \cite[Definition 2.8]{DMS_bary} \markbox{13603}{and} \markbox{13604}{later} \markbox{13605}{used} \markbox{13606}{in} \cite{HP_proj,Petyt_quasicube}:

\begin{definition}[Colorable HHS]\label{defn:colorable}
We \markbox{13607}{say} \markbox{13608}{that} \markbox{13609}{an} HHS
\markbox{m13610}{$(\calX, \mathfrak S)$} \markbox{13611}{is} \emph{colorable} \markbox{13612}{if} \markbox{13613}{there} \markbox{13614}{exists} \markbox{13615}{a} \markbox{13616}{decomposition} of
\markbox{m13617}{$\mathfrak S$} \markbox{13618}{into} \markbox{13619}{finitely} \markbox{13620}{many} \markbox{13621}{families} \markbox{m13622}{$\mathfrak S_i$}, \markbox{13623}{so} \markbox{13624}{that} \markbox{13625}{each} \markbox{m13626}{$\mathfrak S_i$} is
pairwise-\markbox{m13627}{$\pitchfork$}.

\begin{itemize}
\item We \markbox{13628}{refer} \markbox{13629}{to} \markbox{13630}{the} \markbox{m13631}{$\mathfrak S_i$} \markbox{13632}{as} \emph{BBF families}.
\end{itemize}
\end{definition}

\begin{remark}
The \markbox{13633}{notion} \markbox{13634}{of} \markbox{13635}{colorability} \markbox{13636}{was} \markbox{13637}{inspired} \markbox{13638}{by} \markbox{13639}{work} \markbox{13640}{of} Bestvina-Bromberg-Fujiwara \cite{BBF}, \markbox{13641}{who} \markbox{13642}{proved} \markbox{13643}{that} \markbox{13644}{the} \markbox{13645}{curve} \markbox{13646}{graph} \markbox{13647}{is} finitely-colorable.  \markbox{13648}{As} \markbox{13649}{a} \markbox{13650}{consequence} \markbox{13651}{of} this, \markbox{13652}{the} \markbox{13653}{set} \markbox{13654}{of} \markbox{13655}{subsurfaces} \markbox{13656}{of} \markbox{13657}{a} \markbox{13658}{given} finite-type \markbox{13659}{surface} \markbox{m13660}{$S$} \markbox{13661}{can} \markbox{13662}{be} \markbox{13663}{decomposed} \markbox{13664}{into} finitely-many \markbox{13665}{families} \markbox{13666}{of} pairwise-interlocking subsurfaces, \markbox{13667}{which} \markbox{13668}{the} \markbox{13669}{above} \markbox{13670}{definition} \markbox{13671}{directly} generalizes.  \markbox{13672}{See} \cite[Subsection 2.3]{DMS_bary} \markbox{13673}{for} \markbox{13674}{a} \markbox{13675}{detailed} \markbox{13676}{discussion} \markbox{13677}{of} \markbox{13678}{this} connection.
\end{remark}

\subsection{Stable projections}

Our \markbox{13679}{next} \markbox{13680}{goal} \markbox{13681}{is} \markbox{13682}{to} \markbox{13683}{state} \markbox{13684}{a} \markbox{13685}{theorem} \markbox{13686}{which} \markbox{13687}{equips} \markbox{13688}{any} \markbox{13689}{colorable} \markbox{13690}{HHS} \markbox{13691}{with} \markbox{13692}{a} \markbox{13693}{set} \markbox{13694}{of} \markbox{13695}{projections} \markbox{13696}{which} \markbox{13697}{satisfy} \markbox{13698}{certain} \markbox{13699}{key} \markbox{13700}{stability} properties.  \markbox{13701}{We} \markbox{13702}{need} \markbox{13703}{some} \markbox{13704}{definitions} first.

Given \markbox{13705}{a} \markbox{13706}{pair} \markbox{13707}{of} \markbox{13708}{points} \markbox{m13709}{$F = \{x,y\} \subset \calX$} \markbox{13710}{and} \markbox{m13711}{$K>0$}, \markbox{13712}{we} \markbox{13713}{let} \markbox{m13714}{$\calU(F) = \Rel_K(F)$}.  \markbox{13715}{If} \markbox{m13716}{$V \in \calU(F)$}, \markbox{13717}{then} \markbox{13718}{we} \markbox{13719}{let} \markbox{m13720}{$\calU^V(F) = \{W \in \calU(F) | W \sqsubsetneq V\}$}.

The \markbox{13721}{following} \markbox{13722}{definition} \cite[Definition 2.13]{DMS_bary} \markbox{13723}{describes} \markbox{13724}{the} \markbox{13725}{domains} \markbox{13726}{we} \markbox{13727}{want} \markbox{13728}{to} \markbox{13729}{control} \markbox{13730}{when} \markbox{13731}{perturbing} \markbox{m13732}{$F$}:

\begin{definition}[Involved domains]\label{defn:involved}
Let \markbox{m13733}{$F = \{x,y\}, F' = \{x', y'\} \subset \calX$} \markbox{13734}{be} \markbox{13735}{so} \markbox{13736}{that} \markbox{m13737}{$d_{\calX}(x,x') \leq 1 $} \markbox{13738}{and} \markbox{m13739}{$d_{\calX}(y,y') \leq 1$}.  \markbox{13740}{For} \markbox{m13741}{$K>0$}, \markbox{13742}{we} \markbox{13743}{say} \markbox{13744}{that} \markbox{m13745}{$V \in \calU(F) \cup \calU(F')$} \markbox{13746}{is} \emph{involved in the transition} \markbox{13747}{between} \markbox{m13748}{$F$} \markbox{13749}{and} \markbox{m13750}{$F'$} \markbox{13751}{if} \markbox{13752}{one} \markbox{13753}{of} \markbox{13754}{the} \markbox{13755}{following} holds:

\begin{enumerate}
\item \markbox{m13756}{$\pi_V(F) \neq \pi_V(F')$}.
\item \markbox{m13757}{$\calU^V(F) \neq \calU^V(F')$}.
\end{enumerate}
\end{definition}

The following, \markbox{13758}{which} \markbox{13759}{combines} \markbox{13760}{the} \markbox{13761}{statements} \markbox{13762}{of} \cite[Theorem 2.9 \markbox{13763}{and} \markbox{13764}{Proposition} 2.14]{DMS_bary}, \markbox{13765}{states} that, \markbox{13766}{for} \markbox{13767}{any} \markbox{13768}{colorable} \markbox{13769}{HHS} \markbox{m13770}{$\calX$}, \markbox{13771}{we} \markbox{13772}{can} \markbox{13773}{replace} \markbox{13774}{its} \markbox{13775}{given} \markbox{13776}{projections} \markbox{13777}{with} \markbox{13778}{coarsely} \markbox{13779}{equivalent} \markbox{13780}{projections} \markbox{13781}{with} \markbox{13782}{which} \markbox{13783}{we} \markbox{13784}{can} \markbox{13785}{control} \markbox{13786}{involved} \markbox{13787}{domains} \markbox{13788}{up} \markbox{13789}{to} \markbox{13790}{a} \markbox{13791}{bounded} error:

\begin{theorem}\label{thm:controlling domains}
Let \markbox{m13792}{$(\calX, \mathfrak S)$} \markbox{13793}{be} \markbox{13794}{a} \markbox{13795}{colorable} \markbox{13796}{HHS} \markbox{13797}{with} \markbox{13798}{standard} \markbox{13799}{projections} \markbox{m13800}{$\hat{\pi}_{-}, \hat{\rho}^{-}_{-}$}.  \markbox{13801}{Then} \markbox{13802}{there} \markbox{13803}{exists} \markbox{m13804}{$\theta>0$} \markbox{13805}{and} \markbox{13806}{new} \markbox{13807}{projections} \markbox{m13808}{$\pi_{-}, \rho^{-}_{-}$} \markbox{13809}{with} \markbox{13810}{the} \markbox{13811}{same} \markbox{13812}{domains} \markbox{13813}{and} ranges, respectively, \markbox{13814}{such} \markbox{13815}{that} \markbox{13816}{the} \markbox{13817}{following} hold:

\begin{enumerate}
\item The \markbox{13818}{new} \markbox{13819}{projections} \markbox{m13820}{$\pi_{-}, \rho^{-}_{-}$} \markbox{13821}{coarsely} \markbox{13822}{coincide} \markbox{13823}{with} \markbox{13824}{the} \markbox{13825}{old} \markbox{13826}{ones} \markbox{m13827}{$\hat{\pi}_{-}, \hat{\rho}^{-}_{-}$}.  \markbox{13828}{More} precisely:
\begin{enumerate}
\item If \markbox{m13829}{$X,Y$} \markbox{13830}{lie} \markbox{13831}{in} \markbox{13832}{different} \markbox{m13833}{$\mathfrak S_j$} \markbox{13834}{and} \markbox{m13835}{$\hat{\rho}^X_Y$} \markbox{13836}{is} defined, \markbox{13837}{then} \markbox{m13838}{$\rho^X_Y = \hat{\rho}^X_Y$}.
\item If \markbox{m13839}{$X,Y \in \mathfrak S_j$}, \markbox{13840}{then} \markbox{m13841}{$d^{Haus}_{Y}(\rho^X_Y, \hat{\rho}^X_Y)<\theta.$}
\item If \markbox{m13842}{$x \in \calX$} \markbox{13843}{and} \markbox{m13844}{$Y \in \mathfrak S$}, \markbox{13845}{then} \markbox{m13846}{$d^{Haus}_Y(\pi_Y(x),\hat{\pi}_Y(x))<\theta$}.
\end{enumerate}
\item There \markbox{13847}{exists} \markbox{m13848}{$K_0 = K_0(\calX)>0$} \markbox{13849}{and} \markbox{m13850}{$N_0(\calX)>0$} \markbox{13851}{so} \markbox{13852}{that} \markbox{13853}{if} \markbox{m13854}{$K>K_0$}, \markbox{13855}{then} \markbox{13856}{the} \markbox{13857}{following} holds.  \markbox{13858}{Let} \markbox{m13859}{$x,y,x',y' \in \calX$} \markbox{13860}{with} \markbox{m13861}{$d_{\calX}(x,x') \leq 1 $} \markbox{13862}{and} \markbox{m13863}{$d_{\calX}(y,y') \leq 1$}, \markbox{13864}{and} \markbox{13865}{let} \markbox{m13866}{$\calU = \Rel_K(\{x,y\})$} \markbox{13867}{and} \markbox{m13868}{$\calU' = \Rel_K(\{x',y'\})$} \markbox{13869}{be} \markbox{13870}{the} \markbox{13871}{relevant} \markbox{13872}{sets} \markbox{13873}{for} \markbox{13874}{the} \markbox{13875}{new} \markbox{13876}{projections} \markbox{m13877}{$\pi_-$}.  Then:
\begin{enumerate}
\item \markbox{m13878}{$\#(\calU \triangle \calU') < N_0$}, \markbox{13879}{and} \markbox{13880}{if} \markbox{m13881}{$V \in \calU \triangle \calU'$}, \markbox{13882}{then} \markbox{m13883}{$d_V(x,y) \prec K$} \markbox{13884}{and} \markbox{m13885}{$d_V(x',y') \prec K$}. \label{item:bounded symdiff}
\item  There \markbox{13886}{are} \markbox{13887}{at} \markbox{13888}{most} \markbox{m13889}{$N_0$} \markbox{13890}{domains} \markbox{m13891}{$V \in \calU(F) \cup \calU(F')$} \markbox{13892}{involved} \markbox{13893}{in} \markbox{13894}{the} \markbox{13895}{transition} \markbox{13896}{between} \markbox{m13897}{$F$} \markbox{13898}{and} \markbox{m13899}{$F'$}. \label{item:bounded involved}
\end{enumerate}
\end{enumerate}
\end{theorem}

\begin{proof}[Sketch \markbox{13900}{of} proof]
The \markbox{13901}{existence} \markbox{13902}{of} \markbox{13903}{new} \markbox{13904}{projections} \markbox{13905}{satisfying} \markbox{13906}{the} \markbox{13907}{conditions} \markbox{13908}{of} \markbox{13909}{item} (1) \markbox{13910}{is} \markbox{13911}{essentially} \markbox{13912}{an} \markbox{13913}{immediate} \markbox{13914}{consequence} \markbox{13915}{of} \markbox{13916}{the} \markbox{13917}{construction} \markbox{13918}{in} \cite[Theorem 4.1]{BBFS}.  \markbox{13919}{Item} (2), \markbox{13920}{which} \markbox{13921}{regards} \markbox{13922}{stability} \markbox{13923}{of} \markbox{13924}{the} \markbox{13925}{relevant} \markbox{13926}{sets} \markbox{m13927}{$\calU, \calU'$}, \markbox{13928}{requires} \markbox{13929}{a} \markbox{13930}{bit} \markbox{13931}{more} work, \markbox{13932}{but} \markbox{13933}{the} \markbox{13934}{key} \markbox{13935}{ideas} \markbox{13936}{are} \markbox{13937}{as} follows:

Using \cite[Proposition 2.8]{HHS_II} (which \markbox{13938}{generalizes} \cite{CLM12, BKMM:qirigid, BBF}), \markbox{13939}{there} \markbox{13940}{is} \markbox{13941}{a} \markbox{13942}{partial} \markbox{13943}{order} \markbox{m13944}{$\prec$} \markbox{13945}{on} \markbox{m13946}{$\Rel(x,y)$}, \markbox{13947}{which} \markbox{13948}{becomes} \markbox{13949}{a} \markbox{13950}{total} \markbox{13951}{order} \markbox{13952}{on} \markbox{m13953}{$\Rel^i(x,y) = \Rel_K(x,y) \cap \mathfrak S_i$} \markbox{13954}{for} \markbox{13955}{each} \markbox{m13956}{$i$}.  \markbox{13957}{In} particular, \markbox{13958}{we} \markbox{13959}{can} \markbox{13960}{think} \markbox{13961}{of} \markbox{13962}{each} \markbox{m13963}{$\Rel^i(x,y)$} \markbox{13964}{as} \markbox{13965}{an} \markbox{13966}{interval} \markbox{m13967}{$X_1 \prec \cdots \prec X_n$}.  \markbox{13968}{One} \markbox{13969}{of} \markbox{13970}{the} \markbox{13971}{additional} \markbox{13972}{properties} \markbox{13973}{that} \markbox{13974}{the} \markbox{13975}{new} \markbox{13976}{projections} \markbox{m13977}{$\pi_{-}, \rho^{-}_{-}$} \markbox{13978}{satisfy} (see \cite[Theorem 2.9]{DMS_bary}) \markbox{13979}{is} \markbox{13980}{that} \markbox{13981}{if} \markbox{m13982}{$X \prec Y$} \markbox{13983}{along} \markbox{13984}{both} \markbox{m13985}{$\Rel(x,y)$} \markbox{13986}{and} \markbox{m13987}{$\Rel(x',y')$}, \markbox{13988}{then} \markbox{m13989}{$\pi_Y(x) = \pi_Y(x') = \rho^X_Y$} \markbox{13990}{and} \markbox{m13991}{$\pi_X(y) = \pi_X(y') = \rho^Y_X$}.  \markbox{13992}{Using} this, \markbox{13993}{one} \markbox{13994}{can} \markbox{13995}{show} \markbox{13996}{that} \markbox{m13997}{$\Rel(x,y)$} \markbox{13998}{and} \markbox{m13999}{$\Rel(x',y')$} \markbox{14000}{can} \markbox{14001}{only} \markbox{14002}{differ} \markbox{14003}{at} \markbox{14004}{their} \markbox{14005}{first} \markbox{14006}{or} \markbox{14007}{last} \markbox{14008}{elements} \markbox{14009}{in} \markbox{14010}{the} \markbox{14011}{order} \markbox{m14012}{$\prec$}.  \markbox{14013}{Hence} \markbox{m14014}{$\#\left(\Rel^i(x,y) \triangle \Rel^i(x',y')\right) \leq 4$}; \markbox{14015}{see} \cite[Lemma 2.11 \markbox{14016}{and} \markbox{14017}{Proposition} 2.12]{DMS_bary}.  \markbox{14018}{Since} \markbox{14019}{there} \markbox{14020}{are} \markbox{14021}{only} boundedly-many \markbox{14022}{BBF} \markbox{14023}{families} \markbox{m14024}{$\mathfrak S_i$}, \markbox{14025}{item} \eqref{item:bounded symdiff} \markbox{14026}{follows} easily.

A \markbox{14027}{similar} \markbox{14028}{argument} \markbox{14029}{can} \markbox{14030}{now} \markbox{14031}{be} \markbox{14032}{used} \markbox{14033}{to} \markbox{14034}{control} \markbox{14035}{the} \markbox{14036}{number} \markbox{14037}{of} \markbox{14038}{involved} \markbox{14039}{domains} \markbox{14040}{of} \markbox{14041}{type} (1) \markbox{14042}{of} \markbox{14043}{Definition} \ref{defn:involved}, \markbox{14044}{see} \markbox{14045}{the} \markbox{14046}{proof} \markbox{14047}{of} \cite[Proposition 2.14]{DMS_bary}.  \markbox{14048}{For} \markbox{14049}{involved} \markbox{14050}{domains} \markbox{14051}{of} \markbox{14052}{type} (2), \markbox{14053}{this} \markbox{14054}{is} \markbox{14055}{an} \markbox{14056}{immediate} \markbox{14057}{consequence} \markbox{14058}{of} \markbox{14059}{item} \eqref{item:bounded symdiff} \markbox{14060}{and} \markbox{14061}{the} \markbox{14062}{Covering} \markbox{14063}{Lemma} \ref{lem:covering}, \markbox{14064}{which} \markbox{14065}{bounds} \markbox{14066}{the} \markbox{14067}{number} \markbox{14068}{of} \markbox{14069}{domains} \markbox{m14070}{$W \in \calU$} \markbox{14071}{into} \markbox{14072}{which} \markbox{14073}{a} \markbox{14074}{given} \markbox{m14075}{$V \in \calU$} \markbox{14076}{can} nest.
\end{proof}





\section{Stable Intervals}\label{sec:stable intervals}

With \markbox{14077}{the} \markbox{14078}{new} \markbox{14079}{HHS} \markbox{14080}{projections} \markbox{14081}{provided} \markbox{14082}{by} \markbox{14083}{Theorem} \ref{thm:controlling domains}, \markbox{14084}{we} \markbox{14085}{now} \markbox{14086}{turn} \markbox{14087}{toward} \markbox{14088}{converting} \markbox{14089}{stabilized} \markbox{14090}{projection} \markbox{14091}{data} \markbox{14092}{into} \markbox{14093}{stable} \markbox{14094}{families} \markbox{14095}{of} intervals, \markbox{14096}{in} \markbox{14097}{partivuvlar} \markbox{14098}{stabilizing} \markbox{14099}{the} \markbox{14100}{input} \markbox{14101}{into} \markbox{14102}{the} \markbox{14103}{cubical} \markbox{14104}{model} \markbox{14105}{construction} \markbox{14106}{from} \markbox{14107}{Section} \ref{sec:interval systems}.


Our \markbox{14108}{ultimate} \markbox{14109}{goal} \markbox{14110}{is} \markbox{14111}{to} \markbox{14112}{produce} \markbox{14113}{cubical} \markbox{14114}{models} \markbox{14115}{for} \markbox{14116}{pairs} \markbox{14117}{of} \markbox{14118}{nearby} \markbox{14119}{points} \markbox{14120}{that} \markbox{14121}{differ} \markbox{14122}{by} \markbox{14123}{a} \markbox{14124}{controlled} \markbox{14125}{number} \markbox{14126}{of} \markbox{14127}{hyperplane} \markbox{14128}{deletions} (Theorem \ref{thm:stable cubes}). \markbox{14129}{Since} \markbox{14130}{the} \markbox{14131}{hyperplanes} \markbox{14132}{in} \markbox{14133}{the} \markbox{14134}{cubical} \markbox{14135}{models} \markbox{14136}{come} \markbox{14137}{from} \markbox{14138}{edges} \markbox{14139}{of} \markbox{14140}{the} \markbox{14141}{simplicial} \markbox{14142}{intervals} \markbox{14143}{in} \markbox{14144}{our} \markbox{14145}{HFIs} (Theorem \ref{thm:Q CCC}), \markbox{14146}{it} \markbox{14147}{will} \markbox{14148}{suffice} \markbox{14149}{to} \markbox{14150}{build} \markbox{14151}{HFIs} \markbox{14152}{where} \markbox{14153}{the} \markbox{14154}{intervals} \markbox{14155}{only} \markbox{14156}{differ} \markbox{14157}{by} boundedly-many bounded-size \markbox{14158}{collections} \markbox{14159}{of} edges.  \markbox{14160}{That} \markbox{14161}{is} \markbox{14162}{the} \markbox{14163}{content} \markbox{14164}{of} \markbox{14165}{the} \markbox{14166}{Stable} \markbox{14167}{Intervals} \markbox{14168}{Theorem} \ref{thm:stable intervals}. 



We \markbox{14169}{first} \markbox{14170}{explain} \markbox{14171}{the} build-up \markbox{14172}{to} \markbox{14173}{this} \markbox{14174}{theorem} \markbox{14175}{and} \markbox{14176}{defer} \markbox{14177}{the} \markbox{14178}{explicit} statement.  \markbox{14179}{We} \markbox{14180}{will} \markbox{14181}{work} \markbox{14182}{in} \markbox{14183}{the} \markbox{14184}{setting} \markbox{14185}{of} \markbox{14186}{a} \markbox{14187}{hyperbolic} \markbox{14188}{space} \markbox{14189}{with} \markbox{14190}{a} hierarchical-like configuration.  \markbox{14191}{The} \markbox{14192}{construction} \markbox{14193}{is} \markbox{14194}{a} \markbox{14195}{somewhat} \markbox{14196}{long} \markbox{14197}{and} \markbox{14198}{delicate} \markbox{14199}{exercise} \markbox{14200}{in} \markbox{14201}{hyperbolic} \markbox{14202}{geometry} \markbox{14203}{and} \markbox{14204}{we} \markbox{14205}{will} \markbox{14206}{mainly} \markbox{14207}{provide} \markbox{14208}{a} \markbox{14209}{detailed} sketch.

\subsection{Basic setup and assumptions}\label{subsec:stable setup}

For \markbox{14210}{the} \markbox{14211}{rest} \markbox{14212}{of} \markbox{14213}{this} section, \markbox{14214}{let} \markbox{14215}{us} \markbox{14216}{assume} \markbox{14217}{that} \markbox{m14218}{$\calZ$} \markbox{14219}{is} \markbox{14220}{a} \markbox{m14221}{$\delta$}-hyperbolic \markbox{14222}{geodesic} space.  \markbox{14223}{The} \markbox{14224}{first} \markbox{14225}{bit} \markbox{14226}{of} \markbox{14227}{notation} \markbox{14228}{we} \markbox{14229}{want} \markbox{14230}{to} \markbox{14231}{set} \markbox{14232}{is} \markbox{14233}{a} \markbox{14234}{choice} \markbox{14235}{of} \markbox{14236}{geodesic} \markbox{14237}{between} \markbox{14238}{any} \markbox{14239}{pair} \markbox{14240}{of} points.  \markbox{14241}{That} is, \markbox{14242}{for} \markbox{14243}{any} \markbox{m14244}{$x,y \in \calZ$}, \markbox{14245}{we} \markbox{14246}{fix} (once \markbox{14247}{and} \markbox{14248}{for} all) \markbox{14249}{a} \markbox{14250}{geodesic} \markbox{m14251}{$\lambda(x,y)$}.  \markbox{14252}{More} generally, \markbox{14253}{if} \markbox{m14254}{$C,C' \subset \calZ$} \markbox{14255}{are} \markbox{14256}{finite} subsets, \markbox{14257}{then} \markbox{14258}{we} \markbox{14259}{let} \markbox{m14260}{$\lambda(C,C')$} \markbox{14261}{denote} \markbox{14262}{a} \markbox{14263}{choice} \markbox{14264}{of} \markbox{14265}{geodesic} \markbox{14266}{between} \markbox{14267}{them} \markbox{14268}{whose} \markbox{14269}{length} \markbox{14270}{satisfies} \markbox{m14271}{$|\lambda(C,C')| = d_{\calZ}(C,C')$}, \markbox{14272}{and} \markbox{14273}{we} \markbox{14274}{require} symmetry, \markbox{14275}{namely} \markbox{m14276}{$\lambda(C,C') = \lambda(C',C)$}.

It \markbox{14277}{will} \markbox{14278}{also} \markbox{14279}{be} \markbox{14280}{necessary} \markbox{14281}{to} \markbox{14282}{perform} \markbox{14283}{a} \markbox{14284}{slight} \markbox{14285}{modification} \markbox{14286}{on} \markbox{14287}{the} \markbox{14288}{geodesic} \markbox{14289}{function} \markbox{m14290}{$\lambda$}, \markbox{14291}{so} \markbox{14292}{that} \markbox{14293}{its} \markbox{14294}{resulting} \markbox{14295}{length} \markbox{14296}{is} \markbox{14297}{an} integer.  \markbox{14298}{To} \markbox{14299}{fix} this, \markbox{14300}{we} \markbox{14301}{let} \markbox{m14302}{$\lambda_0(C,C')$} \markbox{14303}{denote} \markbox{14304}{the} \markbox{14305}{restriction} \markbox{14306}{of} \markbox{m14307}{$\lambda(C,C'):[0, d_{\calZ}(C,C')]\to \calZ$} \markbox{14308}{to} \markbox{14309}{the} \markbox{14310}{interval} \markbox{m14311}{$[0, \lfloor{d_{\calZ}(C,C')}\rfloor]$}.  \markbox{14312}{The} \markbox{14313}{effect} \markbox{14314}{of} \markbox{14315}{this} \markbox{14316}{is} \markbox{14317}{to} \markbox{14318}{trim} \markbox{m14319}{$\lambda(A,B)$} \markbox{14320}{so} \markbox{14321}{that} \markbox{14322}{it} \markbox{14323}{has} \markbox{14324}{positive} \markbox{14325}{integer} \markbox{14326}{length} \markbox{14327}{and} \markbox{14328}{their} \markbox{14329}{lengths} \markbox{14330}{satisfy} \markbox{m14331}{$l(\lambda(C,C')) -l(\lambda_0(C,C')) < 1$}.  \markbox{14332}{While} \markbox{14333}{not} necessary, \markbox{14334}{one} \markbox{14335}{could} \markbox{14336}{make} \markbox{14337}{this} \markbox{14338}{symmetric} \markbox{14339}{by} \markbox{14340}{trimming} \markbox{14341}{both} \markbox{14342}{the} \markbox{14343}{sides} \markbox{14344}{by} \markbox{14345}{half} \markbox{14346}{of} \markbox{m14347}{$l(\lambda(C,C')) -l(\lambda_0(C,C'))$}.  \markbox{14348}{In} \markbox{14349}{the} \markbox{14350}{course} \markbox{14351}{of} \markbox{14352}{the} arguments, however, \markbox{14353}{one} \markbox{14354}{can} \markbox{14355}{usually} \markbox{14356}{work} \markbox{14357}{with} \markbox{m14358}{$\lambda$} \markbox{14359}{instead} \markbox{14360}{of} \markbox{m14361}{$\lambda_0$}.

Now, \markbox{14362}{for} \markbox{14363}{the} \markbox{14364}{rest} \markbox{14365}{of} \markbox{14366}{this} section, \markbox{14367}{we} \markbox{14368}{fix} \markbox{14369}{a} \markbox{14370}{pair} \markbox{14371}{of} \markbox{14372}{points} \markbox{m14373}{$\{a,b\} \subset \calZ$}.  Furthermore, \markbox{14374}{let} \markbox{m14375}{$\calY \subset \calZ$} \markbox{14376}{be} \markbox{14377}{a} \markbox{14378}{finite} (but \markbox{14379}{possibly} \markbox{14380}{arbitrarily} large) \markbox{14381}{set} \markbox{14382}{of} \markbox{14383}{points} \markbox{14384}{of} \markbox{m14385}{$\calZ$} \markbox{14386}{and} \markbox{14387}{let} \markbox{m14388}{$\epsilon>0$} \markbox{14389}{so} \markbox{14390}{that} \markbox{m14391}{$d_{\calZ}(\lambda(a,b), y) < \epsilon/2$} \markbox{14392}{for} \markbox{14393}{all} \markbox{m14394}{$y \in \calY$}.  \markbox{14395}{We} \markbox{14396}{call} \markbox{14397}{such} \markbox{14398}{an} \markbox{14399}{arrangement} \markbox{m14400}{$(a,b;\calY)$} \markbox{14401}{an} \markbox{m14402}{$\epsilon$}-\emph{setup} \markbox{14403}{in} \markbox{m14404}{$\calZ$}.

In \markbox{14405}{the} \markbox{14406}{hierarchical} setting, \markbox{m14407}{$\calZ$} \markbox{14408}{will} \markbox{14409}{be} \markbox{14410}{one} \markbox{14411}{of} \markbox{14412}{the} \markbox{14413}{hyperbolic} \markbox{14414}{spaces} \markbox{m14415}{$\calC(U)$} \markbox{14416}{for} \markbox{m14417}{$U \in \calU$}, \markbox{14418}{and} \markbox{14419}{the} \markbox{14420}{points} \markbox{m14421}{$\calY$} \markbox{14422}{will} \markbox{14423}{be} \markbox{14424}{the} \markbox{14425}{points} \markbox{14426}{in} \markbox{m14427}{$\rho^V_U$} \markbox{14428}{for} \markbox{m14429}{$V \nest U \in \calU$}.  \markbox{14430}{The} \markbox{14431}{proximity} \markbox{14432}{condition} \markbox{14433}{of} \markbox{14434}{the} \markbox{14435}{points} \markbox{14436}{in} \markbox{m14437}{$\calY$} \markbox{14438}{to} \markbox{m14439}{$\lambda(a,b)$} \markbox{14440}{comes} \markbox{14441}{from} \markbox{14442}{BGIA} \ref{ax:BGIA}.

\begin{notation}[\markbox{m14443}{$O(\epsilon)$}-notation]
In \markbox{14444}{this} section, \markbox{14445}{we} \markbox{14446}{will} \markbox{14447}{often} \markbox{14448}{want} \markbox{14449}{to} \markbox{14450}{get} \markbox{14451}{controlled} \markbox{14452}{bounds} \markbox{14453}{over} \markbox{14454}{various} \markbox{14455}{distance} quantities, \markbox{14456}{where} \markbox{14457}{the} \markbox{14458}{bounds} \markbox{14459}{will} \markbox{14460}{depend} \markbox{14461}{on} \markbox{14462}{our} \markbox{14463}{choice} \markbox{14464}{of} \markbox{m14465}{$\epsilon$} \markbox{14466}{and} \markbox{14467}{the} \markbox{14468}{hyperbolicity} \markbox{14469}{constant} \markbox{m14470}{$\delta$} \markbox{14471}{for} \markbox{m14472}{$\calZ$}.  \markbox{14473}{When} \markbox{14474}{a} \markbox{14475}{number} \markbox{m14476}{$A$} \markbox{14477}{is} \markbox{14478}{bounded} \markbox{14479}{above} \markbox{14480}{as} \markbox{14481}{a} \markbox{14482}{function} \markbox{14483}{of} \markbox{m14484}{$\epsilon, \delta$}, \markbox{14485}{we} \markbox{14486}{will} \markbox{14487}{simply} \markbox{14488}{write} 
$$A < O(\epsilon),$$
since \markbox{m14489}{$\delta$} \markbox{14490}{is} \markbox{14491}{given} \markbox{14492}{to} us, \markbox{14493}{while} \markbox{14494}{we} \markbox{14495}{need} \markbox{14496}{some} \markbox{14497}{flexibility} \markbox{14498}{to} \markbox{14499}{choose} \markbox{m14500}{$\epsilon$}.
\end{notation}

The \markbox{14501}{following} lemma, \markbox{14502}{which} \markbox{14503}{is} \markbox{14504}{essentially} \markbox{14505}{a} \markbox{14506}{consequence} \markbox{14507}{of} \markbox{14508}{the} \markbox{14509}{Morse} \markbox{14510}{Lemma} \markbox{14511}{for} \markbox{14512}{hyperbolic} spaces, \markbox{14513}{gives} \markbox{14514}{us} \markbox{14515}{control} \markbox{14516}{over} \markbox{14517}{how} \markbox{14518}{far} \markbox{m14519}{$\lambda(C,C')$} \markbox{14520}{can} \markbox{14521}{get} \markbox{14522}{from} \markbox{m14523}{$\lambda(a,b)$} \markbox{14524}{when} \markbox{m14525}{$C, C' \subset \calY$}, \markbox{14526}{and} \markbox{14527}{are} \markbox{14528}{thus} \markbox{m14529}{$\epsilon$}-close \markbox{14530}{to} \markbox{m14531}{$\lambda(a,b)$}:

\begin{lemma}[Fellow-traveling, \markbox{m14532}{$\delta$}-hyperbolic]\label{lem:Morse close}
Let \markbox{m14533}{$\calZ$} \markbox{14534}{be} \markbox{m14535}{$\delta$}-hyperbolic \markbox{14536}{and} geodesic, \markbox{14537}{and} \markbox{m14538}{$\gamma$} \markbox{14539}{a} \markbox{14540}{geodesic} \markbox{14541}{between} \markbox{m14542}{$a,b \in \calZ$}.  \markbox{14543}{For} \markbox{14544}{every} \markbox{m14545}{$\epsilon>0$} \markbox{14546}{there} \markbox{14547}{exists} \markbox{m14548}{$\epsilon'=O(\epsilon)>0$} \markbox{14549}{so} \markbox{14550}{that} \markbox{14551}{the} \markbox{14552}{following} holds:

\begin{itemize}
\item Suppose \markbox{m14553}{$\gamma'$} \markbox{14554}{is} \markbox{14555}{a} \markbox{14556}{geodesic} \markbox{14557}{connecting} \markbox{14558}{points} \markbox{m14559}{$x,y \in \calN_{\epsilon}(\gamma)$}, \markbox{14560}{and} \markbox{14561}{that} \markbox{m14562}{$x',y'$} \markbox{14563}{are} \markbox{14564}{closest} \markbox{14565}{points} \markbox{14566}{to} \markbox{m14567}{$x,y$} \markbox{14568}{on} \markbox{m14569}{$\gamma$}, respectively.  \markbox{14570}{Then} \markbox{14571}{any} \markbox{14572}{geodesic} \markbox{m14573}{$[x,y]$} \markbox{14574}{satisfies} \markbox{m14575}{$d_{\calZ}^{Haus}([x,y], [x',y']) < \epsilon'$}.
\end{itemize}
\end{lemma}

As \markbox{14576}{a} consequence, \markbox{14577}{if} \markbox{m14578}{$C, C' \subset \calY$} \markbox{14579}{are} \markbox{14580}{finite} subsets, \markbox{14581}{then} \markbox{m14582}{$\lambda(C,C') \subset \calN_{\epsilon'}(\lambda(a,b))$}.  Finally, \markbox{14583}{it} \markbox{14584}{will} \markbox{14585}{be} \markbox{14586}{convenient} \markbox{14587}{for} \markbox{14588}{us} \markbox{14589}{to} \markbox{14590}{assume} \markbox{14591}{that} \markbox{m14592}{$\epsilon' > \epsilon$}.



  
\subsection{Clusters and the cluster graph} \label{subsec:clusters}

Our \markbox{14593}{first} \markbox{14594}{goal} \markbox{14595}{is} \markbox{14596}{to} \markbox{14597}{group} \markbox{14598}{the} \markbox{14599}{points} \markbox{14600}{of} \markbox{m14601}{$\calY$} \markbox{14602}{into} \emph{clusters} \markbox{14603}{of} \markbox{14604}{nearby} sets.  \markbox{14605}{To} \markbox{14606}{that} end, \markbox{14607}{let} \markbox{m14608}{$E = E(\epsilon)> \epsilon$} \markbox{14609}{be} \markbox{14610}{sufficiently} large, \markbox{14611}{to} \markbox{14612}{be} \markbox{14613}{determined} below.

Let \markbox{m14614}{$\calC_E$} \markbox{14615}{denote} \markbox{14616}{the} \markbox{14617}{graph} \markbox{14618}{whose} \markbox{14619}{vertices} \markbox{14620}{are} \markbox{14621}{points} \markbox{14622}{of} \markbox{m14623}{$\calY \cup \{a,b\}$}, \markbox{14624}{with} \markbox{14625}{two} \markbox{14626}{points} \markbox{m14627}{$x,y \in \calY \cup \{a,b\}$} \markbox{14628}{connected} \markbox{14629}{by} \markbox{14630}{an} \markbox{14631}{edge} \markbox{14632}{exactly} \markbox{14633}{when} \markbox{m14634}{$d_{\calZ}(x,y) < E$}.  \markbox{14635}{The} \markbox{14636}{connected} \markbox{14637}{components} \markbox{14638}{of} \markbox{m14639}{$\calC_E$} \markbox{14640}{are} \markbox{14641}{called} \markbox{m14642}{$E$}-\emph{clusters}, \markbox{14643}{or} \markbox{14644}{simply} \emph{clusters} \markbox{14645}{when} \markbox{m14646}{$E$} \markbox{14647}{is} fixed.

For \markbox{14648}{any} \markbox{m14649}{$E$}-cluster \markbox{m14650}{$C$}, \markbox{14651}{let} \markbox{m14652}{$s(C) = \hull_{\lambda(a,b)}(p_{\lambda(a,b)}(C))$} \markbox{14653}{denote} \markbox{14654}{the} \markbox{14655}{hull} (in \markbox{m14656}{$\lambda(a,b)$}) \markbox{14657}{of} \markbox{14658}{the} \markbox{14659}{closest} \markbox{14660}{point} \markbox{14661}{projection} \markbox{14662}{of} \markbox{m14663}{$C$} \markbox{14664}{to} \markbox{m14665}{$\lambda(a,b)$}.  \markbox{14666}{The} \markbox{14667}{set} \markbox{m14668}{$s(C)$} \markbox{14669}{is} \markbox{14670}{called} \markbox{14671}{the} \emph{shadow} \markbox{14672}{of} \markbox{m14673}{$C$} \markbox{14674}{on} \markbox{m14675}{$\lambda(a,b)$}.

The \markbox{14676}{following} \markbox{14677}{lemma} \markbox{14678}{controls} \markbox{14679}{how} \markbox{14680}{shadows} \markbox{14681}{of} \markbox{14682}{clusters} \markbox{14683}{are} \markbox{14684}{arranged} \markbox{14685}{along} \markbox{m14686}{$\lambda(a,b)$}. \markbox{14687}{Its} \markbox{14688}{proof} \markbox{14689}{is} \markbox{14690}{straightforward} (see \cite[Lemma 3.6]{DMS_bary}), \markbox{14691}{so} \markbox{14692}{we} \markbox{14693}{leave} \markbox{14694}{it} \markbox{14695}{to} \markbox{14696}{the} \markbox{14697}{reader} \markbox{14698}{to} \markbox{14699}{check} (:

\begin{lemma} \label{lem:cluster arrangement}
If \markbox{m14700}{$E > 5\epsilon$} \markbox{14701}{and} \markbox{m14702}{$C \neq C'$} \markbox{14703}{are} \markbox{14704}{distinct} \markbox{m14705}{$E$}-clusters, \markbox{14706}{then} \markbox{m14707}{$s(C) \cap s(C') = \emptyset$}.
\end{lemma}




In \markbox{14708}{what} follows, \markbox{14709}{we} \markbox{14710}{will} \markbox{14711}{need} \markbox{14712}{to} \markbox{14713}{adjust} \markbox{14714}{the} \markbox{14715}{cluster} \markbox{14716}{constant} \markbox{m14717}{$E$} \markbox{14718}{a} \markbox{14719}{number} \markbox{14720}{of} times, \markbox{14721}{but} \markbox{14722}{we} \markbox{14723}{will} \markbox{14724}{usually} \markbox{14725}{omit} \markbox{14726}{the} \markbox{14727}{constant} \markbox{14728}{and} \markbox{14729}{refer} \markbox{14730}{to} \markbox{14731}{them} \markbox{14732}{simply} \markbox{14733}{as} clusters.

We \markbox{14734}{now} \markbox{14735}{can} \markbox{14736}{define} \markbox{14737}{our} \markbox{14738}{notion} \markbox{14739}{of} \markbox{14740}{cluster} \markbox{14741}{separation} \markbox{14742}{using} \markbox{14743}{Lemma} \ref{lem:Morse close}.  \markbox{14744}{The} \markbox{14745}{idea} \markbox{14746}{here} \markbox{14747}{is} \markbox{14748}{that} \markbox{14749}{clusters} \markbox{14750}{are} \markbox{m14751}{$\epsilon$}-close \markbox{14752}{to} \markbox{m14753}{$\lambda(a,b)$}, \markbox{14754}{and} \markbox{14755}{hence} \markbox{14756}{geodesics} \markbox{14757}{connecting} \markbox{14758}{them} \markbox{14759}{stay} \markbox{m14760}{$\epsilon'$}-close \markbox{14761}{to} \markbox{m14762}{$\lambda(a,b)$} \markbox{14763}{by} \markbox{14764}{Lemma} \ref{lem:Morse close}.

\begin{definition}
Let \markbox{m14765}{$C_1, C_2, C_3$} \markbox{14766}{be} clusters.  \markbox{14767}{Given} \markbox{m14768}{$\epsilon'>0$}, \markbox{14769}{we} \markbox{14770}{say} \markbox{m14771}{$C_2$} \markbox{m14772}{$\epsilon'$}-\emph{separates} \markbox{m14773}{$C_1$} \markbox{14774}{from} \markbox{m14775}{$C_3$} \markbox{14776}{if} \markbox{14777}{there} \markbox{14778}{exists} \markbox{14779}{a} \markbox{14780}{minimal} \markbox{14781}{length} \markbox{14782}{geodesic} \markbox{14783}{connecting} \markbox{m14784}{$C_1$} \markbox{14785}{to} \markbox{m14786}{$C_3$} \markbox{14787}{which} \markbox{14788}{passes} \markbox{14789}{within} \markbox{m14790}{$2\epsilon'$} \markbox{14791}{of} \markbox{m14792}{$C_2$}.

\begin{itemize}
\item Given \markbox{m14793}{$E>0$}, \markbox{14794}{the} \emph{$E$-cluster separation graph} \markbox{14795}{for} \markbox{m14796}{$(a,b; \calY)$}, \markbox{14797}{denoted} \markbox{m14798}{$\calG_E = \calG_{E,\epsilon'}(a,b;\calY)$} \markbox{14799}{is} \markbox{14800}{defined} \markbox{14801}{as} follows: \markbox{14802}{The} \markbox{14803}{vertices} \markbox{14804}{of} \markbox{m14805}{$\calG_E$} \markbox{14806}{are} clusters, \markbox{14807}{and} \markbox{14808}{two} \markbox{14809}{vertices} \markbox{14810}{are} \markbox{14811}{connected} \markbox{14812}{by} \markbox{14813}{an} \markbox{14814}{edge} \markbox{14815}{if} \markbox{14816}{and} \markbox{14817}{only} \markbox{14818}{if} \markbox{14819}{they} \markbox{14820}{are} \markbox{14821}{not} \markbox{m14822}{$2\epsilon'$}-separated \markbox{14823}{by} \markbox{14824}{another} cluster.
\end{itemize}
\end{definition}


The \markbox{14825}{following} \markbox{14826}{is} \markbox{14827}{essentially} \markbox{14828}{a} \markbox{14829}{consequence} \markbox{14830}{of} \markbox{14831}{Lemma} \ref{lem:cluster arrangement}.  \markbox{14832}{It} \markbox{14833}{states} \markbox{14834}{that} \markbox{14835}{the} \markbox{14836}{cluster} \markbox{14837}{graph} \markbox{14838}{is} \markbox{14839}{an} \markbox{14840}{interval} \markbox{14841}{with} \markbox{14842}{the} \markbox{14843}{order} \markbox{14844}{of} \markbox{14845}{vertices} \markbox{14846}{corresponding} \markbox{14847}{to} \markbox{14848}{the} \markbox{14849}{order} \markbox{14850}{of} \markbox{14851}{the} \markbox{14852}{cluster} \markbox{14853}{shadows} \markbox{14854}{along} \markbox{m14855}{$\lambda(a,b)$}.  \markbox{14856}{We} \markbox{14857}{omit} \markbox{14858}{its} proof, \markbox{14859}{which} \markbox{14860}{uses} \markbox{14861}{only} \markbox{14862}{hyperbolic} \markbox{14863}{geometry} \markbox{14864}{and} \markbox{14865}{Lemma} \ref{lem:cluster arrangement}.


\begin{proposition}\label{prop:cluster sep graph}
Let \markbox{m14866}{$\calZ$} \markbox{14867}{be} \markbox{m14868}{$\delta$}-hyperbolic, \markbox{m14869}{$\lambda(a,b)$} \markbox{14870}{a} \markbox{14871}{geodesic} \markbox{14872}{connecting} \markbox{m14873}{$a,b \in \calZ$}, \markbox{14874}{and} \markbox{m14875}{$\calY \subset \calZ$} \markbox{14876}{finite} \markbox{14877}{with} \markbox{m14878}{$\calY \subset \calN_{\epsilon}(\lambda(a,b))$}.  \markbox{14879}{Also} \markbox{14880}{let} \markbox{m14881}{$\epsilon' = \epsilon'(\epsilon, \delta)>0$} \markbox{14882}{as} \markbox{14883}{in} \markbox{14884}{Lemma} \ref{lem:Morse close}, \markbox{14885}{with} \markbox{14886}{also} \markbox{m14887}{$\epsilon' > \epsilon$}.

There \markbox{14888}{exists} \markbox{m14889}{$E = E(\epsilon, \delta)>0$} \markbox{14890}{so} \markbox{14891}{that} \markbox{14892}{the} \markbox{m14893}{$E$}-cluster \markbox{14894}{separation} \markbox{14895}{graph} \markbox{m14896}{$\calG_{E,\epsilon'}(a,b;\calY)$} \markbox{14897}{is} \markbox{14898}{an} \markbox{14899}{interval} \markbox{14900}{whose} \markbox{14901}{order} \markbox{14902}{coincides} \markbox{14903}{with} \markbox{14904}{the} \markbox{14905}{order} \markbox{14906}{of} \markbox{14907}{cluster} \markbox{14908}{shadows} \markbox{14909}{along} \markbox{m14910}{$\lambda(a,b)$}, \markbox{14911}{with} \markbox{14912}{the} \markbox{14913}{endpoint} \markbox{14914}{clusters} \markbox{14915}{containing} \markbox{m14916}{$a,b$}, respectively. 
\end{proposition}



\subsection{Stable intervals defined}

We \markbox{14917}{are} \markbox{14918}{now} \markbox{14919}{ready} \markbox{14920}{to} \markbox{14921}{describe} \markbox{14922}{the} \markbox{14923}{stable} intervals.

By \markbox{14924}{Proposition} \ref{prop:cluster sep graph}, \markbox{14925}{the} \markbox{14926}{cluster} \markbox{14927}{separation} \markbox{14928}{graph} \markbox{14929}{is} \markbox{14930}{an} interval.  \markbox{14931}{Our} \markbox{14932}{stable} \markbox{14933}{intervals} \markbox{14934}{admit} \markbox{14935}{a} \markbox{14936}{decomposition} \markbox{14937}{into} \markbox{14938}{two} \markbox{14939}{families} \markbox{14940}{of} intervals, \markbox{14941}{namely} \markbox{14942}{of} \emph{edge} \markbox{14943}{components} \markbox{14944}{and} \emph{cluster} components.  \markbox{14945}{An} \markbox{14946}{edge} \markbox{14947}{component} \markbox{14948}{connects} \markbox{14949}{adjacent} \markbox{14950}{clusters} \markbox{14951}{at} \markbox{14952}{their} \markbox{14953}{nearest} points, \markbox{14954}{while} \markbox{14955}{a} \markbox{14956}{cluster} \markbox{14957}{component} \markbox{14958}{connects} \markbox{14959}{the} \markbox{14960}{endpoints} \markbox{14961}{of}  \markbox{14962}{whatever} \markbox{14963}{edge} \markbox{14964}{components} \markbox{14965}{are} \markbox{14966}{connected} \markbox{14967}{to} \markbox{14968}{a} \markbox{14969}{given} cluster.

\begin{definition}[Stable interval]\label{defn:stable interval}
Let \markbox{m14970}{$\calZ$} \markbox{14971}{be} \markbox{m14972}{$\delta$}-hyperbolic, \markbox{m14973}{$a,b \in \calZ$} \markbox{14974}{with} \markbox{m14975}{$\lambda(a,b)$} \markbox{14976}{a} \markbox{14977}{geodesic} \markbox{14978}{connecting} them, \markbox{14979}{and} \markbox{m14980}{$\calY \subset \calZ$} \markbox{14981}{finite} \markbox{14982}{with} \markbox{m14983}{$\calY \subset \calN_{\epsilon/2}(\lambda(a,b))$}.  \markbox{14984}{The} \emph{stable interval} \markbox{14985}{for} \markbox{14986}{this} \markbox{14987}{setup} \markbox{14988}{is} \markbox{14989}{the} \markbox{14990}{union} \markbox{14991}{of} \markbox{14992}{the} \markbox{14993}{following} \markbox{14994}{two} \markbox{14995}{families} \markbox{14996}{of} \markbox{14997}{geodesic} segments:

\begin{enumerate}
\item (Edge components) \markbox{14998}{For} \markbox{14999}{each} \markbox{15000}{adjacent} \markbox{15001}{pair} \markbox{15002}{of} \markbox{m15003}{$C, C'$} \markbox{15004}{of} \markbox{15005}{clusters} \markbox{15006}{in} \markbox{m15007}{$\calG = \calG_{E,\epsilon'}(a,b;\calY)$}, \markbox{15008}{the} \emph{edge component} \markbox{15009}{between} \markbox{15010}{them} \markbox{15011}{is} \markbox{m15012}{$\lambda_0(C,C')$}.
\begin{itemize}
\item The \markbox{15013}{edge} \markbox{15014}{components} \markbox{15015}{comprise} \markbox{15016}{the} \emph{edge forest}, \markbox{15017}{which} \markbox{15018}{we} \markbox{15019}{denote} \markbox{15020}{by} \markbox{m15021}{$T_e$}.
\end{itemize}
\item (Cluster components) \markbox{15022}{For} \markbox{15023}{each} \markbox{15024}{cluster} \markbox{m15025}{$C$}, \markbox{15026}{we} \markbox{15027}{let} \markbox{m15028}{$C_1,C_2$} \markbox{15029}{be} \markbox{15030}{the} \markbox{15031}{clusters} \markbox{15032}{adjacent} \markbox{15033}{to} \markbox{m15034}{$C$} \markbox{15035}{in} \markbox{m15036}{$\calG$}.  \markbox{15037}{Let} \markbox{m15038}{$r(C) = C \cap (\lambda(C_1,C) \cup \lambda(C,C_2) \cup \{a,b\})$}, \markbox{15039}{where} \markbox{m15040}{$\lambda(C_i,C) = \emptyset$} \markbox{15041}{if} \markbox{m15042}{$C$} \markbox{15043}{is} \markbox{15044}{an} \markbox{15045}{endpoint} cluster, \markbox{15046}{for} \markbox{15047}{the} \markbox{15048}{appropriate} \markbox{m15049}{$i \in \{1,2\}$}.  \markbox{15050}{The} \markbox{15051}{cluster} \markbox{m15052}{$C$} \markbox{15053}{then} \markbox{15054}{determines} \markbox{15055}{the} \emph{cluster component} \markbox{m15056}{$\mu(C) = \lambda(r(C))$}.
\begin{itemize}
\item The \markbox{15057}{cluster} \markbox{15058}{components} \markbox{15059}{comprise} \markbox{15060}{the} \emph{cluster forest}, \markbox{15061}{which} \markbox{15062}{we} \markbox{15063}{denote} \markbox{15064}{by} \markbox{m15065}{$T_c$}.
\end{itemize} 
\end{enumerate}

\begin{itemize}
\item The \emph{stable interval} \markbox{15066}{is}  \markbox{m15067}{$T(a,b; \calY) = T_e \sqcup T_c$}, \markbox{15068}{by} \markbox{15069}{which} \markbox{15070}{we} \markbox{15071}{mean} \markbox{15072}{the} \markbox{15073}{abstract} \markbox{15074}{union} \markbox{15075}{of} \markbox{15076}{these} \markbox{15077}{two} forests, \markbox{15078}{where} \markbox{15079}{we} \markbox{15080}{attach} \markbox{m15081}{$\lambda_0(C_1,C_2)$} \markbox{15082}{to} \markbox{15083}{the} \markbox{15084}{corresponding} \markbox{15085}{endpoints} \markbox{15086}{of} \markbox{m15087}{$\mu(C_1), \mu(C_2)$} \markbox{15088}{for} \markbox{15089}{adjacent} \markbox{m15090}{$C_1, C_2$} \markbox{15091}{as} \markbox{15092}{determined} \markbox{15093}{by} \markbox{m15094}{$\calG$}.
\item We \markbox{15095}{let} \markbox{m15096}{$\phi:T(a,b;\calY) \to \calZ$} \markbox{15097}{denote} \markbox{15098}{the} \markbox{15099}{map} \markbox{15100}{induced} \markbox{15101}{from} \markbox{15102}{the} \markbox{15103}{fact} \markbox{15104}{that} \markbox{15105}{its} \markbox{15106}{pieces} \markbox{15107}{are} \markbox{15108}{geodesics} \markbox{15109}{in} \markbox{m15110}{$\calZ$}. 
\end{itemize}
\end{definition}




\begin{remark}
    \markbox{15111}{We} \markbox{15112}{note} \markbox{15113}{that} \markbox{15114}{stable} \markbox{15115}{intervals} \markbox{15116}{are} \markbox{15117}{abstractly} intervals, \markbox{15118}{but} \markbox{15119}{not} \markbox{15120}{necessarily} \markbox{15121}{as} \markbox{15122}{subsets} \markbox{15123}{of} \markbox{m15124}{$\calZ$}.  \markbox{15125}{In} particular, \markbox{15126}{the} \markbox{15127}{points} \markbox{m15128}{$a,b$} \markbox{15129}{need} \markbox{15130}{not} \markbox{15131}{be} \markbox{15132}{the} ``endpoints'' \markbox{15133}{of} \markbox{15134}{the} \markbox{15135}{stable} \markbox{15136}{interval} \markbox{m15137}{$T$}, \markbox{15138}{either} \markbox{15139}{abstractly} \markbox{15140}{or} \markbox{15141}{in} \markbox{m15142}{$\calZ$}.  However, \markbox{15143}{their} \markbox{15144}{images} \markbox{15145}{in} \markbox{15146}{the} \markbox{15147}{collapsed} \markbox{15148}{stable} \markbox{15149}{interval} \markbox{15150}{will} \markbox{15151}{be} \markbox{15152}{the} endpoints, \markbox{15153}{see} \markbox{15154}{Subsection} \ref{subsec:collapsed stable intervals}.
\end{remark}


The \markbox{15155}{following} \markbox{15156}{lemma} \markbox{15157}{is} \markbox{15158}{the} \markbox{15159}{key} \markbox{15160}{to} \markbox{15161}{controlling} \markbox{15162}{the} \markbox{15163}{structure} \markbox{15164}{of} \markbox{m15165}{$T(a,b;\calY)$}.  \markbox{15166}{We} \markbox{15167}{omit} \markbox{15168}{its} \markbox{15169}{proof} \markbox{15170}{since} \markbox{15171}{it} \markbox{15172}{again} \markbox{15173}{uses} \markbox{15174}{only} \markbox{15175}{hyperbolic} geometry, \markbox{15176}{though} \markbox{15177}{see} \markbox{15178}{Figure} \ref{fig:cluster close} \markbox{15179}{for} \markbox{15180}{a} schematic:

\begin{lemma}\label{lem:cluster close}
Let \markbox{m15181}{$C_1, C_2$} \markbox{15182}{be} \markbox{15183}{distinct} \markbox{15184}{clusters} \markbox{15185}{along} \markbox{m15186}{$\lambda(a,b)$}.  \markbox{15187}{Suppose} \markbox{15188}{that} \markbox{m15189}{$p_1 \in C_1$} \markbox{15190}{and} \markbox{m15191}{$p_2 \in C_2$} \markbox{15192}{are} \markbox{15193}{closest} points, \markbox{15194}{while} \markbox{m15195}{$x_1 \in s(C_1)$} \markbox{15196}{and} \markbox{m15197}{$x_2 \in s(C_2)$} \markbox{15198}{are} \markbox{15199}{closest} points.  \markbox{15200}{Then} \markbox{m15201}{$d_{\calZ}(x_i, p_i) \leq 7\epsilon$} \markbox{15202}{for} \markbox{m15203}{$i=1,2$}.

As \markbox{15204}{a} consequence, \markbox{15205}{the} \markbox{15206}{following} hold:
\begin{enumerate}
\item For \markbox{15207}{distinct} \markbox{15208}{clusters} \markbox{m15209}{$C_1,C_2$}, \markbox{15210}{we} \markbox{15211}{have} \markbox{m15212}{$|d(C_1,C_2) - d(s(C_1),s(C_2))| < 14\epsilon.$}
\item For \markbox{15213}{any} \markbox{m15214}{$p \in T_e$}, \markbox{15215}{we} \markbox{15216}{have} \markbox{15217}{that} \markbox{m15218}{$d_{\calZ}(p, \calY \cup \{a,b\}) \leq d_{\calZ}(p, \partial T_e) + O(\epsilon).$}
\item For \markbox{15219}{any} \markbox{15220}{components} \markbox{m15221}{$V,W$} \markbox{15222}{of} \markbox{m15223}{$T = T_e \cup T_c$}, \markbox{15224}{we} \markbox{15225}{have} \markbox{m15226}{$\diam_{\calZ}(s(V)\cap s(W)) < O(\epsilon)$}.
\end{enumerate}
\end{lemma}



\begin{figure}
    \centering
    \includegraphics[width=.75\textwidth]{figures/cluster_close}
    \caption{Proof of Lemma \ref{lem:cluster close}: Clusters can have multiple pairs of closest points.  In this example, the red and pink points on $C_1$ are equidistant from their matching point on $C_2$, while the red and pink cluster points in $C_1$ are both within $7\epsilon$ of the endpoint of the shadow $s(C_1)$ nearest $s(C_2)$, and the same for the roles of $C_1,C_2$ switched.  In subsequent arguments, this will allow us to conclude that connecting points between clusters are close even after we alter the clusters.}
    \label{fig:cluster close}
\end{figure}




\begin{figure}
    \centering
    \includegraphics[width=1\textwidth]{figures/pathologies.pdf}
    \caption{This figure, which is essentially \cite[Figure 11]{DMS_bary}, is an example of two phenomena.  First, the edge components of a stable interval can have bounded overlap in the space $\calZ$.  This can lead to a bounded multiplicative error in the quasi-isometric embedding $\phi:T(a,b;\calY) \to \calZ$; see item (3) of Proposition \ref{prop:stable interval structure}.  In the figure, the multiplicative constant is at least $\frac{102}{100}$.  Second, the image of $T(a,b;\calY)$ in $\calZ$ need not itself be an interval, as the clusters can form leaves on the image.}
    \label{fig:pathologies}
\end{figure}


With \markbox{15227}{the} \markbox{15228}{above} \markbox{15229}{lemma} \markbox{15230}{in} hand, \markbox{15231}{we} \markbox{15232}{can} \markbox{15233}{prove} \markbox{15234}{the} \markbox{15235}{following} \markbox{15236}{structural} proposition:                                                                                                                                                                                                                      
 
 \begin{proposition}\label{prop:stable interval structure}
 
There \markbox{15237}{exists} \markbox{m15238}{$L_0 = L_0(\delta, \epsilon)>0$} \markbox{15239}{so} \markbox{15240}{that} \markbox{15241}{the} \markbox{15242}{following} hold:

\begin{enumerate}
\item \markbox{m15243}{$T(a,b;\calY)$} \markbox{15244}{is} \markbox{15245}{an} \markbox{15246}{interval} \markbox{15247}{with} \markbox{15248}{endpoints} \markbox{15249}{contained} \markbox{15250}{in} \markbox{m15251}{$\calY \cup \{a,b\}$} \markbox{15252}{whose} \markbox{15253}{images} \markbox{15254}{in} \markbox{m15255}{$\calZ$} \markbox{15256}{are} \markbox{m15257}{$O(\epsilon)$} \markbox{15258}{of} \markbox{m15259}{$a,b \in \calZ$}.
\item For \markbox{15260}{every} \markbox{15261}{cluster} \markbox{m15262}{$C$},we \markbox{15263}{have} \markbox{15264}{that} \markbox{m15265}{$d_{\calZ}^{Haus}(\mu(C), C) < L_0$} \markbox{15266}{and} \markbox{m15267}{$\phi(T_C) \subset \calN_{L_0}(\calY \cup \{a,b\})$}. 
\item The \markbox{15268}{map} \markbox{m15269}{$\phi:T(a,b;\calY) \to \calZ$} \markbox{15270}{is} \markbox{15271}{an} \markbox{m15272}{$(L_0,L_0)$}-quasi-isometric \markbox{15273}{embedding} \markbox{15274}{with} \markbox{15275}{image} \markbox{m15276}{$L_0$}-Hausdorff \markbox{15277}{close} \markbox{15278}{to} \markbox{m15279}{$\lambda(a,b)$}.
\item Each \markbox{15280}{edge} \markbox{15281}{component} \markbox{15282}{of} \markbox{m15283}{$T$} \markbox{15284}{has} \markbox{15285}{positive} \markbox{15286}{integer} length.
\end{enumerate}
 \end{proposition}
 
 \begin{proof}
 
 \markbox{15287}{For} (1), \markbox{15288}{observe} \markbox{15289}{that} \markbox{m15290}{$T(a,b;\calZ)$} \markbox{15291}{is} \markbox{15292}{an} \markbox{15293}{interval} \markbox{15294}{by} \markbox{15295}{construction} \markbox{15296}{and} \markbox{15297}{Proposition} \ref{prop:cluster sep graph}, \markbox{15298}{and} \markbox{15299}{the} \markbox{15300}{end} \markbox{15301}{clusters} \markbox{15302}{contain} \markbox{m15303}{$a,b$}, respectively, \markbox{15304}{also} \markbox{15305}{by} \markbox{15306}{that} proposition.  \markbox{15307}{Since} \markbox{15308}{each} \markbox{15309}{cluster} \markbox{m15310}{$C \subset \calN_{E}(\lambda(a,b))$}, \markbox{15311}{if} \markbox{m15312}{$a \in C$}, \markbox{15313}{then} \markbox{15314}{the} outer-most \markbox{15315}{endpoint} \markbox{15316}{of} \markbox{m15317}{$\mu(C)$} \markbox{15318}{must} \markbox{15319}{be} \markbox{15320}{within} \markbox{m15321}{$E$} \markbox{15322}{of} \markbox{m15323}{$a$}, \markbox{15324}{as} required.
 
 \markbox{15325}{For} (2), \markbox{15326}{observe} \markbox{15327}{that} \markbox{15328}{each} \markbox{15329}{cluster} \markbox{m15330}{$C$} \markbox{15331}{is} \markbox{15332}{within} \markbox{15333}{Hausdorff} \markbox{15334}{distance} \markbox{m15335}{$O(\epsilon)$} \markbox{15336}{of} \markbox{m15337}{$s(C)$}, \markbox{15338}{while} \markbox{15339}{Lemma} \ref{lem:cluster close} \markbox{15340}{implies} \markbox{15341}{that} \markbox{m15342}{$\mu(C)$} \markbox{15343}{is} \markbox{15344}{within} \markbox{15345}{Hausdorff} \markbox{15346}{distance} \markbox{m15347}{$O(\epsilon)$} \markbox{15348}{of} \markbox{m15349}{$s(C)$}.  \markbox{15350}{The} \markbox{15351}{conclusion} follows.
 
 \markbox{15352}{Item} (3) \markbox{15353}{is} \markbox{15354}{essentially} \markbox{15355}{a} \markbox{15356}{consequence} \markbox{15357}{of} \markbox{15358}{Lemma} \ref{lem:cluster close} \markbox{15359}{and} \markbox{15360}{the} \markbox{15361}{construction} \markbox{15362}{as} follows.  \markbox{15363}{By} \markbox{15364}{Lemma} \ref{lem:Morse close}, \markbox{15365}{the} \markbox{15366}{image} \markbox{15367}{under} \markbox{15368}{the} \markbox{15369}{map} \markbox{m15370}{$\phi:T \to \calZ$} \markbox{15371}{of} \markbox{15372}{each} \markbox{15373}{component} \markbox{15374}{of} \markbox{m15375}{$T_e$} \markbox{15376}{and} \markbox{m15377}{$T_c$} \markbox{15378}{is} \markbox{15379}{within} \markbox{m15380}{$O(\epsilon)$} \markbox{15381}{of} \markbox{15382}{its} \markbox{15383}{shadow} \markbox{15384}{on} \markbox{m15385}{$\lambda(a,b)$}.  \markbox{15386}{In} \markbox{15387}{other} words, \markbox{15388}{for} \markbox{15389}{any} \markbox{15390}{component} \markbox{m15391}{$V$} \markbox{15392}{of} \markbox{m15393}{$T_e$} \markbox{15394}{or} \markbox{m15395}{$T_c$}, \markbox{15396}{the} \markbox{15397}{shadow} \markbox{15398}{map} \markbox{15399}{induces} \markbox{15400}{a} \markbox{m15401}{$(1,O(\epsilon))$}-quasi-isometry \markbox{m15402}{$s:\phi(V) \to s(\phi(V))$}.  \markbox{15403}{On} \markbox{15404}{the} \markbox{15405}{other} hand, \markbox{15406}{Lemma} \ref{lem:cluster close} \markbox{15407}{says} \markbox{15408}{every} \markbox{15409}{pair} \markbox{15410}{of} \markbox{15411}{components} \markbox{15412}{of} \markbox{m15413}{$T$} \markbox{15414}{have} \markbox{15415}{shadows} \markbox{15416}{on} \markbox{m15417}{$\lambda(a,b)$} \markbox{15418}{with} \markbox{m15419}{$O(\epsilon)$}-bounded overlap.  \markbox{15420}{It} \markbox{15421}{follows} \markbox{15422}{that} \markbox{m15423}{$\phi:T \to \calZ$} \markbox{15424}{is} \markbox{15425}{an} \markbox{m15426}{$(O(\epsilon), O(\epsilon))$}-quasi-isometric embedding, \markbox{15427}{as} required.
 
 Finally, \markbox{15428}{item} (4) \markbox{15429}{follows} \markbox{15430}{because} \markbox{15431}{we} \markbox{15432}{have} \markbox{15433}{used} \markbox{15434}{the} \markbox{15435}{function} \markbox{m15436}{$\lambda_0$} \markbox{15437}{as} \markbox{15438}{our} \markbox{15439}{connectors} \markbox{15440}{in} \markbox{15441}{Definition} \ref{defn:stable interval}, \markbox{15442}{which} \markbox{15443}{performs} \markbox{15444}{a} \markbox{15445}{small} \markbox{15446}{surgery} \markbox{15447}{at} \markbox{15448}{one} \markbox{15449}{of} \markbox{15450}{the} \markbox{15451}{ends} \markbox{15452}{of} \markbox{m15453}{$\lambda$} \markbox{15454}{so} \markbox{15455}{that} \markbox{15456}{the} \markbox{15457}{result} \markbox{15458}{has} \markbox{15459}{integer} length.  \markbox{15460}{This} \markbox{15461}{completes} \markbox{15462}{the} proof.
\end{proof}


\subsection{Stable decompositions}\label{subsec:stable decomp}

Having \markbox{15463}{defined} \markbox{15464}{stable} \markbox{15465}{intervals} above, \markbox{15466}{we} \markbox{15467}{are} \markbox{15468}{almost} \markbox{15469}{ready} \markbox{15470}{to} \markbox{15471}{state} \markbox{15472}{the} \markbox{15473}{Stable} \markbox{15474}{Intervals} \markbox{15475}{Theorem} \ref{thm:stable intervals}.  \markbox{15476}{The} \markbox{15477}{motivation} \markbox{15478}{for} \markbox{15479}{the} \markbox{15480}{definitions} \markbox{15481}{in} \markbox{15482}{this} \markbox{15483}{section} \markbox{15484}{comes} \markbox{15485}{from} \markbox{15486}{our} \markbox{15487}{desire} \markbox{15488}{to} \markbox{15489}{plug} \markbox{15490}{things} \markbox{15491}{into} \markbox{15492}{our} \markbox{15493}{cubical} \markbox{15494}{model} machinery.  \markbox{15495}{We} \markbox{15496}{describe} \markbox{15497}{how} \markbox{15498}{this} \markbox{15499}{works} \markbox{15500}{in} \markbox{15501}{Subsection} \ref{subsec:perturbed to stable} below, \markbox{15502}{and} \markbox{15503}{we} \markbox{15504}{point} \markbox{15505}{the} \markbox{15506}{reader} \markbox{15507}{to} \markbox{15508}{it} \markbox{15509}{for} \markbox{15510}{motivation} \markbox{15511}{for} \markbox{15512}{what} follows.

A \markbox{15513}{stable} \markbox{15514}{decomposition} \markbox{15515}{involves} \markbox{15516}{decomposing} \markbox{15517}{a} \markbox{15518}{pair} \markbox{15519}{of} \markbox{15520}{stable} \markbox{15521}{intervals} \markbox{15522}{for} \markbox{15523}{a} \markbox{15524}{pair} \markbox{15525}{of} \markbox{15526}{admissible} \markbox{15527}{setups} \markbox{15528}{into} subintervals, \markbox{15529}{with} \markbox{15530}{some} \markbox{15531}{maps} \markbox{15532}{which} \markbox{15533}{identify} \markbox{15534}{and} \markbox{15535}{organize} \markbox{15536}{the} \markbox{15537}{various} pieces.  \markbox{15538}{The} \markbox{15539}{purpose} \markbox{15540}{of} \markbox{15541}{the} \markbox{15542}{next} \markbox{15543}{definition} \markbox{15544}{is} \markbox{15545}{to} \markbox{15546}{give} \markbox{15547}{shorthand} \markbox{15548}{for} \markbox{15549}{requiring} \markbox{15550}{that} \markbox{15551}{the} \markbox{15552}{various} \markbox{15553}{maps} \markbox{15554}{involved} \markbox{15555}{respect} \markbox{15556}{how} \markbox{15557}{the} \markbox{15558}{various} \markbox{15559}{pieces} \markbox{15560}{are} \markbox{15561}{oriented} \markbox{15562}{towards} \markbox{15563}{the} \markbox{15564}{endpoints} \markbox{15565}{of} \markbox{15566}{the} \markbox{15567}{ambient} intervals.

\begin{definition}[Order-preserving maps]\label{defn:order preserving}
Let \markbox{m15568}{$T_1, T_2$} \markbox{15569}{be} \markbox{15570}{two} \markbox{15571}{intervals} \markbox{15572}{with} \markbox{15573}{the} \markbox{15574}{endpoints} \markbox{15575}{of} \markbox{m15576}{$T_i$} \markbox{15577}{labeled} \markbox{15578}{by} \markbox{m15579}{$a_i,b_i$}.  \markbox{15580}{Suppose} \markbox{15581}{that} \markbox{m15582}{$T_i = T_{i,1} \sqcup T_{i,2}$} \markbox{15583}{are} \markbox{15584}{subdivisions} \markbox{15585}{of} \markbox{m15586}{$T_i$} \markbox{15587}{into} \markbox{15588}{finite} \markbox{15589}{collections} \markbox{15590}{of} \markbox{15591}{subintervals} \markbox{15592}{with} \markbox{m15593}{$\# T_{1,1} = \#T_{2,1}$} (and \markbox{15594}{hence} \markbox{m15595}{$\#T_{1,2} = \#T_{2,2}$}).

\begin{itemize}
\item We \markbox{15596}{say} \markbox{15597}{an} \markbox{15598}{isometry} \markbox{m15599}{$i_{E,E'}:E \to E'$} \markbox{15600}{between} \markbox{15601}{components} \markbox{m15602}{$E \subset T_{1,1}$} \markbox{15603}{and} \markbox{m15604}{$E' \subset T_{2,1}$} \markbox{15605}{is} \emph{order preserving} \markbox{15606}{if} \markbox{m15607}{$i_{E,E'}$} \markbox{15608}{sends} \markbox{15609}{the} \markbox{15610}{endpoint} \markbox{15611}{of} \markbox{m15612}{$E$} \markbox{15613}{closest} \markbox{15614}{to} \markbox{m15615}{$a_1$} \markbox{15616}{to} \markbox{15617}{the} \markbox{15618}{endpoint} \markbox{15619}{of} \markbox{m15620}{$E'$} \markbox{15621}{closest} \markbox{15622}{to} \markbox{m15623}{$a_2$}.
\item We \markbox{15624}{say} \markbox{15625}{a} \markbox{15626}{bijection} \markbox{m15627}{$\alpha:\pi_0(T_{1,1}) \to \pi_0(T_{2,1})$} \markbox{15628}{is} \emph{order-preserving} \markbox{15629}{if} \markbox{15630}{it} \markbox{15631}{coincides} \markbox{15632}{with} \markbox{15633}{the} \markbox{15634}{bijection} \markbox{15635}{obtained} \markbox{15636}{by} \markbox{15637}{recording} \markbox{15638}{the} \markbox{15639}{orders} \markbox{15640}{of} \markbox{15641}{appearance} \markbox{15642}{of} \markbox{15643}{the} \markbox{15644}{components} \markbox{15645}{of} \markbox{m15646}{$T_{i,1}$} \markbox{15647}{along} \markbox{m15648}{$T_i$} \markbox{15649}{from} \markbox{m15650}{$a_i$} \markbox{15651}{to} \markbox{m15652}{$b_i$}.
\end{itemize}
\end{definition}

\begin{remark}\label{rem:order preserving}
Using \markbox{15653}{the} \markbox{15654}{above} notation, \markbox{15655}{note} \markbox{15656}{that} \markbox{15657}{an} order-preserving \markbox{15658}{bijection} \markbox{m15659}{$\alpha:\pi_0(T_{1,1}) \to \pi_0(T_{2,1})$} \markbox{15660}{automatically} \markbox{15661}{induces} \markbox{15662}{an} order-preserving \markbox{15663}{bijection} \markbox{m15664}{$\beta:\pi_0(T_{1,2}) \to \pi_0(T_{2,2})$}.  Moreover, \markbox{15665}{in} \markbox{15666}{this} paper, \markbox{15667}{we} \markbox{15668}{will} \markbox{15669}{only} \markbox{15670}{be} \markbox{15671}{working} \markbox{15672}{with} \markbox{15673}{intervals} \markbox{15674}{between} \markbox{15675}{a} \markbox{15676}{pair} \markbox{15677}{of} points, \markbox{15678}{which} \markbox{15679}{are} \markbox{15680}{usually} \markbox{15681}{denoted} \markbox{15682}{by} (some \markbox{15683}{form} of) \markbox{m15684}{$a,b$}.  \markbox{15685}{We} \markbox{15686}{will} \markbox{15687}{always} \markbox{15688}{take} order-preserving \markbox{15689}{to} \markbox{15690}{mean} \markbox{15691}{as} \markbox{15692}{one} \markbox{15693}{moves} \markbox{15694}{from} \markbox{15695}{the} \markbox{m15696}{$a$}-side \markbox{15697}{to} \markbox{15698}{the} \markbox{m15699}{$b$}-side \markbox{15700}{of} \markbox{15701}{the} \markbox{15702}{given} intervals.
\end{remark}

We \markbox{15703}{also} \markbox{15704}{set} \markbox{15705}{one} \markbox{15706}{last} \markbox{15707}{bit} \markbox{15708}{of} notation: \markbox{15709}{Given} \markbox{15710}{a} \markbox{15711}{stable} \markbox{15712}{tree} \markbox{m15713}{$T = T_e \cup T_c$} \markbox{15714}{for} \markbox{15715}{an} \markbox{m15716}{$\epsilon$}-setup \markbox{m15717}{$(\calY; \{a,b\})$}, \markbox{15718}{if} \markbox{m15719}{$y \in \calY \cup \{a,b\}$}, \markbox{15720}{we} \markbox{15721}{let} \markbox{m15722}{$C_y$} \markbox{15723}{denote} \markbox{15724}{the} \markbox{15725}{cluster} \markbox{15726}{containing} \markbox{m15727}{$y$}, \markbox{15728}{and} \markbox{m15729}{$\mu(C_y)$} \markbox{15730}{the} \markbox{15731}{corresponding} \markbox{15732}{component} \markbox{15733}{of} \markbox{m15734}{$T^c$}.

The \markbox{15735}{following} \markbox{15736}{definition} \markbox{15737}{contains} \markbox{15738}{the} \markbox{15739}{stability} \markbox{15740}{properties} \markbox{15741}{we} want:

\begin{definition}[Stable decomposition] \label{defn:stable decomp}
Let \markbox{m15742}{$\calZ$} \markbox{15743}{be} \markbox{m15744}{$\delta$}-hyperbolic \markbox{15745}{and} geodesic.  
\begin{enumerate}
\item Given \markbox{m15746}{$N>0$}, \markbox{15747}{two} \markbox{m15748}{$\epsilon$}-setups \markbox{m15749}{$(a,b; \calY)$} \markbox{15750}{and} \markbox{m15751}{$(a',b'; \calY')$} \markbox{15752}{are} \markbox{m15753}{$(N,\epsilon)$}-\emph{admissible} if
\begin{enumerate}
\item \markbox{m15754}{$d_{\calZ}(a,a'), d_{\calZ}(b,b') \leq \epsilon$},
\item \markbox{m15755}{$\calY, \calY' \subset \calN_{\epsilon/2}(\lambda(a,b)) \cap \calN_{\epsilon/2}(\lambda(a',b'))$},
\item \markbox{m15756}{$|\calY \triangle \calY'| < N$}.
\end{enumerate}
\item Given \markbox{15757}{an} \markbox{m15758}{$\epsilon$}-setup \markbox{m15759}{$(a,b;\calY)$}, \markbox{15760}{an} \emph{edge decomposition} \markbox{15761}{of} \markbox{15762}{its} \markbox{15763}{stable} \markbox{15764}{interval} \markbox{m15765}{$T = T_e \cup T_c$} \markbox{15766}{is} \markbox{15767}{a} \markbox{15768}{collection} \markbox{15769}{of} \markbox{15770}{subintervals} \markbox{m15771}{$T_s \subset T_e$}.
\item Given \markbox{m15772}{$L>0$}, \markbox{m15773}{$\calY_0 \subset \calY \cap \calY'$}, \markbox{15774}{and} \markbox{15775}{two} \markbox{m15776}{$(N,\epsilon)$}-admissible \markbox{15777}{setups} \markbox{m15778}{$(a,b;\calY)$} \markbox{15779}{and} \markbox{m15780}{$(a',b'; \calY')$}, \markbox{15781}{we} \markbox{15782}{say} \markbox{15783}{that} \markbox{15784}{two} \markbox{15785}{edge} \markbox{15786}{decompositions} \markbox{m15787}{$T_s \subset T_e$} \markbox{15788}{and} \markbox{m15789}{$T'_s \subset T'_e$} \markbox{15790}{are} \markbox{m15791}{$\calY_0$}-\emph{stably} \markbox{m15792}{$L$}-\emph{compatible} if
\begin{enumerate}
\item Each \markbox{15793}{component} \markbox{15794}{of} \markbox{m15795}{$T_s$} \markbox{15796}{and} \markbox{m15797}{$T'_s$} \markbox{15798}{has} \markbox{15799}{positive} \markbox{15800}{integer} \markbox{15801}{length} \markbox{15802}{with} \markbox{15803}{endpoints} \markbox{15804}{at} \markbox{15805}{vertices} \markbox{15806}{of} \markbox{m15807}{$T_e$} \markbox{15808}{and} \markbox{m15809}{$T'_e$}, respectively. \label{item:integer length}
\item There \markbox{15810}{is} \markbox{15811}{an} order-preserving \markbox{15812}{bijection} \markbox{m15813}{$\alpha:\pi_0(T_s) \to \pi_0(T'_s)$} \markbox{15814}{between} \markbox{15815}{the} \markbox{15816}{sets} \markbox{15817}{of} \markbox{15818}{stable} components. \label{item:stable bijection}
\item For \markbox{15819}{each} \emph{stable pair} \markbox{m15820}{$(E, E')$} \markbox{15821}{identified} \markbox{15822}{by} \markbox{m15823}{$\alpha$}, \markbox{15824}{there} \markbox{15825}{exists} \markbox{15826}{an} order-preserving \markbox{15827}{isometry} \markbox{m15828}{$i_{E,E'}:E \to E'$}. \label{item:stable pairs}
\item For \markbox{15829}{all} \markbox{15830}{but} \markbox{15831}{at} \markbox{15832}{most} \markbox{m15833}{$L$} \markbox{15834}{pairs} \markbox{15835}{of} \markbox{15836}{stable} \markbox{15837}{components} \markbox{m15838}{$(E,E')$}, \markbox{15839}{we} \markbox{15840}{have} \markbox{m15841}{$\phi(E) = \phi(E')$} \markbox{15842}{are} \markbox{15843}{identical} \markbox{15844}{with} \markbox{m15845}{$\phi(x) = \phi'(i_{E,E'}(x))$} \markbox{15846}{for} \markbox{15847}{all} \markbox{m15848}{$x \in E$}. \label{item:identical pairs}
\item For \markbox{15849}{the} (at most) \markbox{m15850}{$L$}-many \markbox{15851}{remaining} \markbox{15852}{stable} \markbox{15853}{pairs} \markbox{m15854}{$(E,E')$}, \markbox{15855}{we} \markbox{15856}{have} \markbox{m15857}{$d_{\calZ}(\phi(x), \phi'(i_{E,E'}(x)))< L$} \markbox{15858}{for} \markbox{15859}{all} \markbox{m15860}{$x \in E$}. \label{item:close pairs}
\item The \markbox{15861}{complements} \markbox{m15862}{$T_{e} - T_s$} \markbox{15863}{and} \markbox{m15864}{$T'_{e} - T'_s$} \markbox{15865}{consist} \markbox{15866}{of} \markbox{15867}{at} \markbox{15868}{most} \markbox{m15869}{$L$}-many \emph{unstable components} \markbox{15870}{of} \markbox{15871}{diameter} \markbox{15872}{at} \markbox{15873}{most} \markbox{m15874}{$L$}.\label{item:unstable components}
\item The \markbox{15875}{induced} order-preserving \markbox{15876}{bijection} \markbox{m15877}{$\beta:\pi_0(T-T_s) \to \pi_0(T' - T'_s)$} satisfies: \label{item:adjacency}
\begin{enumerate}
\item (Endpoints) \markbox{15878}{Let} \markbox{m15879}{$D_a$} \markbox{15880}{denote} \markbox{15881}{the} \markbox{15882}{component} \markbox{15883}{of} \markbox{m15884}{$T-T_s$} \markbox{15885}{containing} \markbox{m15886}{$\mu(C_a)$}, \markbox{15887}{and} \markbox{15888}{define} \markbox{m15889}{$D_b,D_{a'},D_{b'}$} similarly.  \markbox{15890}{Then} \markbox{m15891}{$\beta(D_a) = D_{a'}$} \markbox{15892}{and} \markbox{m15893}{$\beta(D_b) = D_{b'}$}. \label{item:endpoint condition}
\item (Identifying clusters) \markbox{15894}{For} \markbox{15895}{any} \markbox{m15896}{$y \in \calY_0$}, \markbox{15897}{let} \markbox{m15898}{$D_y, D'_y$} \markbox{15899}{denote} \markbox{15900}{the} \markbox{15901}{components} \markbox{15902}{of} \markbox{m15903}{$T-T_s$} \markbox{15904}{and} \markbox{m15905}{$T' - T'_s$} \markbox{15906}{containing} \markbox{m15907}{$\mu(C_y), \mu(C'_y)$}, respectively.  \markbox{15908}{Then} \markbox{m15909}{$\beta(D_y) = D'_y$}. \label{item:cluster identify}
\end{enumerate}
\end{enumerate}
\end{enumerate}
\end{definition}

\begin{remark}%% remark 8.13
The \markbox{15910}{above} \markbox{15911}{definition} \markbox{15912}{is} \markbox{15913}{a} \markbox{15914}{refinement} \markbox{15915}{of} \markbox{15916}{the} \markbox{15917}{properties} \markbox{15918}{contained} \markbox{15919}{in} \cite[Stable \markbox{15920}{Tree} \markbox{15921}{Theorem} 3.2]{DMS_bary}, \markbox{15922}{where} \markbox{15923}{we} \markbox{15924}{have} \markbox{15925}{set} \markbox{15926}{up} \markbox{15927}{these} \markbox{15928}{stable} \markbox{15929}{decompositions} \markbox{15930}{to} \markbox{15931}{plug} \markbox{15932}{nicely} \markbox{15933}{into} \markbox{15934}{the} \markbox{15935}{cubical} \markbox{15936}{model} \markbox{15937}{machinery} \markbox{15938}{described} \markbox{15939}{earlier} \markbox{15940}{in} \markbox{15941}{the} paper. \markbox{15942}{How} \markbox{15943}{this} \markbox{15944}{process} \markbox{15945}{works} \markbox{15946}{is} \markbox{15947}{described} \markbox{15948}{below} \markbox{15949}{in} \markbox{15950}{more} \markbox{15951}{detail} \markbox{15952}{in} Subsection~\ref{subsec:perturbed to stable}, \markbox{15953}{but} \markbox{15954}{for} \markbox{15955}{now} \markbox{15956}{we} \markbox{15957}{motivate} \markbox{15958}{some} \markbox{15959}{parts} \markbox{15960}{of} \markbox{15961}{the} definition.  \markbox{15962}{Roughly} speaking, \markbox{15963}{the} \markbox{15964}{points} \markbox{m15965}{$\calY$} \markbox{15966}{and} \markbox{m15967}{$\calY'$} \markbox{15968}{stand} \markbox{15969}{in} \markbox{15970}{for} \markbox{15971}{the} \markbox{15972}{relative} \markbox{15973}{projection} \markbox{15974}{data} \markbox{15975}{on} \markbox{15976}{each} interval, \markbox{15977}{with} \markbox{15978}{each} \markbox{15979}{component} \markbox{15980}{of} \markbox{m15981}{$T - T_s$} \markbox{15982}{and} \markbox{m15983}{$T' - T'_s$} \markbox{15984}{being} \markbox{15985}{labeled} \markbox{15986}{by} \markbox{15987}{some} \markbox{15988}{such} point.  Eventually, \markbox{15989}{we} \markbox{15990}{will} \markbox{15991}{collapse} \markbox{15992}{each} \markbox{15993}{of} \markbox{15994}{the} \markbox{15995}{components} \markbox{15996}{of} \markbox{m15997}{$T - T_s$} \markbox{15998}{and} \markbox{m15999}{$T' - T'_s$} \markbox{16000}{to} points.  \markbox{16001}{Item} \eqref{item:adjacency} \markbox{16002}{says} \markbox{16003}{that} \markbox{16004}{the} \markbox{16005}{common} \markbox{16006}{labels} \markbox{m16007}{$\calY \cap \calY'$} \markbox{16008}{are} identified, \markbox{16009}{as} \markbox{16010}{well} \markbox{16011}{as} \markbox{16012}{the} \markbox{16013}{endpoint} \markbox{16014}{pairs} \markbox{m16015}{$a,a'$} \markbox{16016}{and} \markbox{m16017}{$b,b'$}.  \markbox{16018}{The} \markbox{16019}{rest} \markbox{16020}{of} \markbox{16021}{the} \markbox{16022}{statement} \markbox{16023}{now} \markbox{16024}{says} \markbox{16025}{that} \markbox{16026}{the} \markbox{16027}{components} \markbox{16028}{of} \markbox{m16029}{$T_s$} \markbox{16030}{and} \markbox{m16031}{$T'_s$} \markbox{16032}{are} \markbox{16033}{in} \markbox{16034}{bijection} \markbox{16035}{with} \markbox{16036}{each} other, \markbox{16037}{where} \markbox{16038}{identified} \markbox{16039}{components} \markbox{16040}{are} isometric, \markbox{16041}{and} \markbox{16042}{the} order-preserving \markbox{16043}{properties} \markbox{16044}{explain} \markbox{16045}{how} \markbox{16046}{to} \markbox{16047}{glue} \markbox{16048}{these} \markbox{16049}{components} \markbox{16050}{to} \markbox{16051}{obtain} \markbox{16052}{an} \markbox{16053}{isometry} \markbox{16054}{between} \markbox{16055}{collapsed} intervals.  Finally, \markbox{16056}{the} \markbox{16057}{proximity} \markbox{16058}{properties} \markbox{16059}{in} \markbox{16060}{items} \eqref{item:identical pairs} \markbox{16061}{and} \eqref{item:close pairs} \markbox{16062}{are} \markbox{16063}{necessary} \markbox{16064}{for} \markbox{16065}{controlling} \markbox{16066}{the} \markbox{16067}{maps} \markbox{16068}{back} \markbox{16069}{into} \markbox{16070}{the} \markbox{16071}{ambient} HHS; \markbox{16072}{see} \markbox{16073}{the} \markbox{16074}{proof} \markbox{16075}{of} \markbox{16076}{Theorem} \ref{thm:stable cubes}.  \markbox{16077}{A} \markbox{16078}{more} \markbox{16079}{general} \markbox{16080}{version} \markbox{16081}{can} \markbox{16082}{be} \markbox{16083}{found} \markbox{16084}{in} \cite[Definition 10.18]{DMS_FJ}. 
\end{remark}

\subsection{The stable interval theorem}

With \markbox{16085}{Definition} \ref{defn:stable decomp} \markbox{16086}{in} hand, \markbox{16087}{we} \markbox{16088}{can} \markbox{16089}{now} \markbox{16090}{state} \markbox{16091}{the} \markbox{16092}{main} \markbox{16093}{result} \markbox{16094}{of} \markbox{16095}{this} section, \markbox{16096}{Theorem} \ref{thm:stable intervals} below.  \markbox{16097}{It} \markbox{16098}{says} \markbox{16099}{that} \markbox{16100}{the} \markbox{16101}{stable} \markbox{16102}{intervals} \markbox{16103}{for} \markbox{16104}{a} \markbox{16105}{pair} \markbox{16106}{of} \markbox{16107}{admissible} \markbox{m16108}{$\epsilon$}-setups \markbox{16109}{admit} \markbox{16110}{compatible} \markbox{16111}{stable} decompositions---that is, \markbox{16112}{decompositions} \markbox{16113}{into} \markbox{16114}{subintervals} \markbox{16115}{which} \markbox{16116}{are} \markbox{16117}{in} \markbox{16118}{bijective} \markbox{16119}{correspondence} \markbox{16120}{with} \markbox{16121}{idenitified} \markbox{16122}{pairs} \markbox{16123}{uniformly} close, \markbox{16124}{up} \markbox{16125}{to} \markbox{16126}{ignored} \markbox{16127}{a} \markbox{16128}{bounded} \markbox{16129}{collection} \markbox{16130}{of} bounded-length subintervals.  \markbox{16131}{We} \markbox{16132}{first} \markbox{16133}{state} \markbox{16134}{this} \markbox{16135}{technical} result, \markbox{16136}{and} \markbox{16137}{then} \markbox{16138}{prove} \markbox{16139}{a} \markbox{16140}{corollary} \markbox{16141}{which} \markbox{16142}{gives} \markbox{16143}{the} \markbox{16144}{main} \markbox{16145}{upshot} \markbox{16146}{for} \markbox{16147}{our} \markbox{16148}{purposes} \markbox{16149}{of} \markbox{16150}{building} \markbox{16151}{stable} \markbox{16152}{cubical} models.  

For \markbox{16153}{a} \markbox{16154}{bit} \markbox{16155}{of} setup, \markbox{16156}{recall} \markbox{16157}{the} \markbox{16158}{notion} \markbox{16159}{of} \markbox{16160}{a} \markbox{16161}{thickening} \markbox{16162}{of} \markbox{16163}{an} \markbox{16164}{interval} \markbox{16165}{from} \markbox{16166}{Subsection} \ref{subsec:thickenings}.  \markbox{16167}{This} \markbox{16168}{was} \markbox{16169}{a} \markbox{16170}{way} \markbox{16171}{of} \markbox{16172}{taking} \markbox{16173}{an} \markbox{16174}{interval} \markbox{16175}{with} \markbox{16176}{a} \markbox{16177}{decomposition} \markbox{m16178}{$T = A \cup B$} \markbox{16179}{into} \markbox{16180}{collections} \markbox{16181}{of} segments, \markbox{16182}{and} \markbox{16183}{expanding} \markbox{16184}{and} \markbox{16185}{combining} \markbox{16186}{one} \markbox{16187}{collection} \markbox{16188}{of} \markbox{16189}{the} segments.  \markbox{16190}{Our} \markbox{16191}{stable} \markbox{16192}{intervals} \markbox{16193}{come} \markbox{16194}{with} \markbox{16195}{such} \markbox{16196}{a} \markbox{16197}{decomposition} \markbox{m16198}{$T = T_e \cup T_c$}, \markbox{16199}{and} \markbox{16200}{we} \markbox{16201}{will} \markbox{16202}{always} \markbox{16203}{mean} \markbox{16204}{a} \markbox{16205}{thickening} \markbox{16206}{of} \markbox{16207}{a} \markbox{16208}{stable} \markbox{16209}{interval} \markbox{m16210}{$T$} \markbox{16211}{to} \markbox{16212}{be} \markbox{16213}{a} \markbox{16214}{thickening} \markbox{16215}{of} \markbox{m16216}{$T$} \markbox{16217}{along} \markbox{16218}{the} \markbox{16219}{components} \markbox{16220}{of} \markbox{16221}{the} \markbox{16222}{cluster} \markbox{16223}{forest} \markbox{m16224}{$T_c$}.  Finally, \markbox{16225}{we} \markbox{16226}{denote} \markbox{16227}{the} \markbox{16228}{components} \markbox{16229}{of} \markbox{16230}{the} \markbox{16231}{resulting} \markbox{16232}{thickening} \markbox{16233}{by} \markbox{m16234}{$T = \bT_{e} \cup \bT_c$}, \markbox{16235}{and} \markbox{16236}{we} \markbox{16237}{note} \markbox{16238}{that} \markbox{m16239}{$\bT_e \subset T_e$} \markbox{16240}{and} \markbox{m16241}{$T_c \subset \bT_c$}. 

\begin{theorem}[Stable intervals]\label{thm:stable intervals}
Let \markbox{m16242}{$\calZ$} \markbox{16243}{be} \markbox{m16244}{$\delta$}-hyperbolic \markbox{16245}{and} geodesic.  \markbox{16246}{For} \markbox{16247}{any} \markbox{m16248}{$\epsilon, N>0$} \markbox{16249}{and} \markbox{16250}{positive} \markbox{16251}{integers} \markbox{m16252}{$r_1,r_2>0$}, \markbox{16253}{there} \markbox{16254}{exist} \markbox{m16255}{$L_1 = L_1(\delta, \epsilon, N)>0$} \markbox{16256}{and} \markbox{m16257}{$L_2 = L_2(\delta, \epsilon, N,r_1,r_2)>0$} \markbox{16258}{so} \markbox{16259}{that} \markbox{16260}{the} \markbox{16261}{following} holds.  \markbox{16262}{Suppose} \markbox{m16263}{$(a,b;\calY)$} \markbox{16264}{and} \markbox{m16265}{$(a',b';\calY')$} \markbox{16266}{are} \markbox{m16267}{$(N,\epsilon)$}-admissible \markbox{m16268}{$\epsilon$}-setups \markbox{16269}{and} \markbox{16270}{let} \markbox{m16271}{$T = T_e \cup T_c$} \markbox{16272}{and} \markbox{m16273}{$T' = T'_e \cup T'_c$} \markbox{16274}{denote} \markbox{16275}{their} \markbox{16276}{stable} intervals.  Then
\begin{enumerate}
\item There \markbox{16277}{exist} \markbox{m16278}{$(\calY \cap \calY')$}-stable \markbox{m16279}{$L_1$}-compatible \markbox{16280}{decompositions} \markbox{m16281}{$T_s \subset T_e$} \markbox{16282}{and} \markbox{m16283}{$T'_s \subset T'_e$}, and
\item There \markbox{16284}{exist} \markbox{m16285}{$(\calY \cap \calY')$}-stable \markbox{m16286}{$L_2$}-compatible \markbox{16287}{edge} \markbox{16288}{decompositions} \markbox{m16289}{$\bT_{s} \subset \bT_{e}$} \markbox{16290}{and} \markbox{m16291}{$\bT'_{s} \subset \bT'_{e}$} \markbox{16292}{of} \markbox{16293}{the} \markbox{m16294}{$(r_1,r_2)$}-thickenings \markbox{16295}{of} \markbox{m16296}{$T, T'$} \markbox{16297}{along} \markbox{m16298}{$T_c,T'_c$}.
\begin{itemize}
\item Moreover, \markbox{16299}{we} \markbox{16300}{have} \markbox{m16301}{$\bT_s \subset T_s$} \markbox{16302}{and} \markbox{m16303}{$\bT_s \subset T'_s$}.
\end{itemize}
\end{enumerate}

\end{theorem}

\begin{remark}
In \markbox{16304}{the} \markbox{16305}{HHS} setting, \markbox{16306}{we} \markbox{16307}{will} \markbox{16308}{be} \markbox{16309}{able} \markbox{16310}{to} \markbox{16311}{control} \markbox{16312}{each} \markbox{16313}{of} \markbox{16314}{the} \markbox{16315}{constants} \markbox{m16316}{$\delta, \epsilon, N, r_1,r_2$} \markbox{16317}{in} \markbox{16318}{terms} \markbox{16319}{of} \markbox{16320}{the} \markbox{16321}{ambient} \markbox{16322}{HHS} structure.  \markbox{16323}{We} \markbox{16324}{have} \markbox{16325}{written} \markbox{16326}{the} \markbox{16327}{statement} \markbox{16328}{with} \markbox{16329}{two} \markbox{16330}{conclusions} \markbox{16331}{because} \markbox{16332}{the} \markbox{16333}{first} \markbox{16334}{conclusion} \markbox{16335}{is} \markbox{16336}{a} \markbox{16337}{mild} \markbox{16338}{reformulation} \markbox{16339}{of} \markbox{16340}{the} \markbox{16341}{original} \markbox{16342}{theorem} \cite[Theorem 3.2]{DMS_bary}, \markbox{16343}{while} \markbox{16344}{the} \markbox{16345}{second} \markbox{16346}{is} \markbox{16347}{what} \markbox{16348}{we} \markbox{16349}{actually} \markbox{16350}{need} \markbox{16351}{for} \markbox{16352}{the} \markbox{16353}{cubulation} \markbox{16354}{machine} \markbox{16355}{discussed} \markbox{16356}{in} \markbox{16357}{this} paper.  Notably, \markbox{16358}{the} \markbox{16359}{second} \markbox{16360}{statement} \markbox{16361}{will} \markbox{16362}{be} \markbox{16363}{an} \markbox{16364}{easy} \markbox{16365}{consequence} \markbox{16366}{of} \markbox{16367}{the} first.
\end{remark}

Before \markbox{16368}{we} \markbox{16369}{move} \markbox{16370}{onto} \markbox{16371}{the} proof, \markbox{16372}{we} \markbox{16373}{observe} \markbox{16374}{the} \markbox{16375}{following} corollary, \markbox{16376}{whose} \markbox{16377}{statement} \markbox{16378}{and} \markbox{16379}{proof} \markbox{16380}{motivate} \markbox{16381}{the} \markbox{16382}{statement} \markbox{16383}{of} \markbox{16384}{Theorem} \ref{thm:stable intervals}.  \markbox{16385}{In} particular, \markbox{16386}{this} \markbox{16387}{corollary} \markbox{16388}{will} \markbox{16389}{allow} \markbox{16390}{us} \markbox{16391}{to} \markbox{16392}{verify} \markbox{16393}{the} interval-wise \markbox{16394}{condition} \markbox{16395}{in} \markbox{16396}{Proposition} \ref{prop:HFI isomorphism} \markbox{16397}{and} \markbox{16398}{give} \markbox{16399}{us} \markbox{16400}{the} \markbox{16401}{cubical} \markbox{16402}{isomorphism} \markbox{16403}{we} \markbox{16404}{need} \markbox{16405}{for} \markbox{16406}{the} \markbox{16407}{Stable} \markbox{16408}{Cubulations} \markbox{16409}{Theorem} \ref{thm:stable cubes}; \markbox{16410}{see} \markbox{16411}{Subsection} \ref{subsec:perturbed to stable}.

\begin{corollary}\label{cor:interval isometry}
Let \markbox{m16412}{$(a,b;\calY)$} \markbox{16413}{and} \markbox{m16414}{$(a',b'; \calY')$} \markbox{16415}{be} \markbox{m16416}{$(N,\epsilon)$}-admissible \markbox{m16417}{$\epsilon$}-setups \markbox{16418}{with} \markbox{m16419}{$(\calY \cap \calY')$}-stable \markbox{m16420}{$L$}-compatible \markbox{16421}{decompositions} \markbox{m16422}{$T_s \subset T_e$} \markbox{16423}{and} \markbox{m16424}{$T'_s \subset T'_e$}.   \markbox{16425}{Let} \markbox{m16426}{$\Delta:T \to \hT$} \markbox{16427}{and} \markbox{m16428}{$\Delta':T' \to \hT'$} \markbox{16429}{denote} \markbox{16430}{the} \markbox{16431}{quotients} \markbox{16432}{obtained} \markbox{16433}{by} \markbox{16434}{collapsing} \markbox{16435}{each} \markbox{16436}{component} \markbox{16437}{of} \markbox{m16438}{$T-T_s$} \markbox{16439}{and} \markbox{m16440}{$T'-T'_s$} \markbox{16441}{to} \markbox{16442}{a} point.  \markbox{16443}{The} \markbox{16444}{following} hold:
\begin{enumerate}
\item \markbox{m16445}{$\hT$} \markbox{16446}{and} \markbox{m16447}{$\hT'$} \markbox{16448}{are} \markbox{16449}{simplicial} \markbox{16450}{intervals} \markbox{16451}{where} \markbox{16452}{each} \markbox{16453}{collapsed} \markbox{16454}{component} \markbox{16455}{of} \markbox{m16456}{$T-T_s$} \markbox{16457}{and} \markbox{m16458}{$T'-T'_s$} \markbox{16459}{is} \markbox{16460}{a} vertex, and
\item There \markbox{16461}{exists} \markbox{16462}{an} \markbox{16463}{isometry} \markbox{m16464}{$\Phi:\hT \to \hT'$} \markbox{16465}{which} \markbox{16466}{is} \markbox{16467}{induced} \markbox{16468}{from} \markbox{16469}{the} \markbox{16470}{bijections} \markbox{m16471}{$\alpha:\pi_0(T_s) \to \pi_0(T'_s)$} \markbox{16472}{and} \markbox{m16473}{$\beta:\pi_0(T-T_s) \to \pi_0(T'-T'_s)$}, \markbox{16474}{and} \markbox{16475}{the} \markbox{16476}{isometries} \markbox{16477}{of} \markbox{16478}{pairs} \markbox{16479}{of} \markbox{16480}{stable} \markbox{16481}{components} \markbox{m16482}{$i_{E,\alpha(E)}:E \to \alpha(E)$} \markbox{16483}{for} \markbox{m16484}{$E \subset T_s$}.   Moreover, \markbox{16485}{we} have
\begin{enumerate}
\item \markbox{m16486}{$\Phi(\Delta(a)) = \Delta'(a')$} \markbox{16487}{and} \markbox{m16488}{$\Phi(\Delta(b)) = \Delta'(b')$},
\item If \markbox{m16489}{$y \in \calY \cap \calY'$} \markbox{16490}{and} \markbox{m16491}{$D_y \in \pi_0(T - T_s)$} \markbox{16492}{and} \markbox{m16493}{$D'_y \in \pi_0(T - T_s)$} \markbox{16494}{contain} \markbox{m16495}{$\mu(C_y)$} \markbox{16496}{and} \markbox{m16497}{$\mu(C'_y)$}, respectively, \markbox{16498}{then} \markbox{m16499}{$\Phi(\Delta(D_y)) = \Delta'(D'_y)$}. 
\end{enumerate}
\end{enumerate}
\end{corollary}


\begin{proof}
First, \markbox{16500}{observe} \markbox{16501}{that} \markbox{m16502}{$\hT$} \markbox{16503}{and} \markbox{m16504}{$\hT'$} \markbox{16505}{are} \markbox{16506}{intervals} \markbox{16507}{because} \markbox{m16508}{$T,T'$} \markbox{16509}{are} \markbox{16510}{and} \markbox{16511}{each} \markbox{16512}{component} \markbox{16513}{of} \markbox{m16514}{$T-T_s$} \markbox{16515}{and} \markbox{m16516}{$T'-T'_s$} \markbox{16517}{is} \markbox{16518}{a} subinterval.  \markbox{16519}{They} \markbox{16520}{are} \markbox{16521}{simplicial} \markbox{16522}{intervals} \markbox{16523}{with} \markbox{16524}{the} \markbox{16525}{given} \markbox{16526}{description} \markbox{16527}{because} \markbox{16528}{Theorem} \ref{thm:stable intervals} (specifically \markbox{16529}{item} (4a) \markbox{16530}{of} \markbox{16531}{Definition} \ref{defn:stable decomp}) \markbox{16532}{provides} \markbox{16533}{that} \markbox{16534}{each} \markbox{16535}{component} \markbox{16536}{of} \markbox{m16537}{$T_s,T'_s$} \markbox{16538}{has} \markbox{16539}{positive} \markbox{16540}{integer} length, \markbox{16541}{and} \markbox{16542}{so} \markbox{16543}{the} \markbox{16544}{distance} \markbox{16545}{between} \markbox{16546}{the} \markbox{16547}{points} \markbox{16548}{corresponding} \markbox{16549}{to} \markbox{16550}{pairs} \markbox{16551}{of} \markbox{16552}{collapsed} \markbox{16553}{components} \markbox{16554}{of} \markbox{m16555}{$T-T_s$} \markbox{16556}{and} \markbox{m16557}{$T'-T'_s$} \markbox{16558}{is} \markbox{16559}{a} \markbox{16560}{positive} integer.

For \markbox{16561}{the} \markbox{16562}{second} conclusion, \markbox{16563}{we} \markbox{16564}{can} \markbox{16565}{define} \markbox{m16566}{$\Phi:\hT\to \hT'$} \markbox{16567}{as} follows: \markbox{16568}{For} \markbox{16569}{each} \markbox{16570}{vertex} \markbox{m16571}{$v \in \hT$} \markbox{16572}{corresponding} \markbox{16573}{to} \markbox{16574}{a} \markbox{16575}{component} \markbox{m16576}{$C \in \pi_0(T-T_s)$}, \markbox{16577}{we} \markbox{16578}{define} \markbox{m16579}{$\Phi(v) = v'$}, \markbox{16580}{where} \markbox{m16581}{$v'$} \markbox{16582}{is} \markbox{16583}{the} \markbox{16584}{vertex} \markbox{16585}{of} \markbox{m16586}{$\hT'$} \markbox{16587}{corresponding} \markbox{16588}{to} \markbox{m16589}{$\beta(C) \in \pi_0(T'-T'_s)$}.  \markbox{16590}{If} \markbox{16591}{now} \markbox{m16592}{$x \in \hT$} \markbox{16593}{is} \markbox{16594}{not} \markbox{16595}{such} \markbox{16596}{a} vertex, \markbox{16597}{then} \markbox{m16598}{$x \in \Delta(E)$} \markbox{16599}{for} \markbox{16600}{some} \markbox{16601}{component} \markbox{m16602}{$E \in \pi_0(T_s)$}.  \markbox{16603}{So} \markbox{16604}{we} \markbox{16605}{define} \markbox{m16606}{$\Phi(x) = \Delta'(i_{E, \alpha(E)}(x))$}.  \markbox{16607}{The} \markbox{16608}{fact} \markbox{16609}{that} \markbox{16610}{these} piece-wise \markbox{16611}{maps} \markbox{16612}{glue} \markbox{16613}{coherently} \markbox{16614}{is} \markbox{16615}{a} \markbox{16616}{direct} \markbox{16617}{consequence} \markbox{16618}{of} \markbox{16619}{the} \markbox{16620}{fact} \markbox{16621}{that} \markbox{m16622}{$\alpha$} \markbox{16623}{is} order-preserving.  \markbox{16624}{The} \markbox{16625}{subitems} \markbox{16626}{of} (2) \markbox{16627}{are} \markbox{16628}{direct} \markbox{16629}{consequences} \markbox{16630}{of} \markbox{16631}{item} \eqref{item:adjacency} \markbox{16632}{of} \markbox{16633}{Definition} \ref{defn:stable decomp}.  \markbox{16634}{This} \markbox{16635}{completes} \markbox{16636}{the} proof.
\end{proof}

\begin{remark}
Notably, \markbox{16637}{the} \markbox{16638}{above} \markbox{16639}{corollary} \markbox{16640}{holds} \markbox{16641}{whenever} \markbox{16642}{we} \markbox{16643}{have} \markbox{16644}{a} \markbox{16645}{stable} decomposition, \markbox{16646}{so} \markbox{16647}{in} \markbox{16648}{particular} \markbox{16649}{when} \markbox{16650}{this} \markbox{16651}{is} \markbox{16652}{a} \markbox{16653}{stable} \markbox{16654}{decomposition} \markbox{16655}{arising} \markbox{16656}{from} \markbox{16657}{the} \markbox{16658}{thickened} \markbox{16659}{versions} \markbox{16660}{of} \markbox{16661}{our} \markbox{16662}{stable} intervals.
\end{remark}

\subsection{Detailed sketch of the proof} \label{subsec:detailed sketch}

In \markbox{16663}{lieu} \markbox{16664}{of} \markbox{16665}{a} \markbox{16666}{full} \markbox{16667}{proof} (see \markbox{16668}{Appendix} \ref{app:SI}), \markbox{16669}{we} \markbox{16670}{provide} \markbox{16671}{a} \markbox{16672}{detailed} \markbox{16673}{sketch} \markbox{16674}{of} \markbox{16675}{Theorem} \ref{thm:stable intervals} \markbox{16676}{with} \markbox{16677}{figures} \markbox{16678}{illustrating} \markbox{16679}{the} \markbox{16680}{key} \markbox{16681}{technical} arguments, \markbox{16682}{which} \markbox{16683}{are} \markbox{16684}{easier} \markbox{16685}{to} \markbox{16686}{understand} \markbox{16687}{at} \markbox{16688}{a} \markbox{16689}{fairly} \markbox{16690}{close} \markbox{16691}{level} \markbox{16692}{than} \markbox{16693}{to} \markbox{16694}{write} \markbox{16695}{down} carefully.  \markbox{16696}{Our} \markbox{16697}{proof} \markbox{16698}{strategy} \markbox{16699}{here} \markbox{16700}{follows} \markbox{16701}{more} \markbox{16702}{closely} \markbox{16703}{the} \markbox{16704}{proof} \markbox{16705}{of} \cite[Theorem 10.23]{DMS_FJ} \markbox{16706}{than} \markbox{16707}{the} \markbox{16708}{original} \cite[Theorem 3.1]{DMS_bary}.

The \markbox{16709}{goal} \markbox{16710}{is} \markbox{16711}{to} \markbox{16712}{show} \markbox{16713}{that} \markbox{16714}{the} \markbox{16715}{stable} \markbox{16716}{intervals} (Definition \ref{defn:stable interval}) \markbox{16717}{for} \markbox{16718}{pairs} \markbox{16719}{of} \markbox{16720}{admissible} \markbox{m16721}{$\epsilon$}-setups \markbox{16722}{admit} \markbox{16723}{stable} \markbox{16724}{decompositions} \markbox{16725}{in} \markbox{16726}{the} \markbox{16727}{sense} \markbox{16728}{of} \markbox{16729}{Definition} \ref{defn:stable decomp}.  Roughly, \markbox{16730}{these} \markbox{16731}{are} \markbox{16732}{decompositions} \markbox{16733}{of} \markbox{16734}{the} \markbox{16735}{intervals} \markbox{16736}{into} \markbox{16737}{collections} \markbox{16738}{of} subintervals, \markbox{16739}{which} \markbox{16740}{are} \markbox{16741}{either} \markbox{16742}{identical} (as \markbox{16743}{in} \markbox{16744}{item} (d)), \markbox{16745}{or} \markbox{16746}{the} \markbox{16747}{same} \markbox{16748}{length} \markbox{16749}{and} \markbox{16750}{uniformly} \markbox{16751}{close} (as \markbox{16752}{in} \markbox{16753}{item} (e)), \markbox{16754}{or} \markbox{16755}{are} \markbox{16756}{one} \markbox{16757}{of} boundedly-many \markbox{16758}{unstable} \markbox{16759}{components} \markbox{16760}{we} \markbox{16761}{can} \markbox{16762}{ignore} (as \markbox{16763}{in} \markbox{16764}{item} (f)).  \markbox{16765}{We} \markbox{16766}{need} \markbox{16767}{to} \markbox{16768}{show} \markbox{16769}{how} \markbox{16770}{to} \markbox{16771}{constraints} \markbox{16772}{on} \markbox{16773}{the} \markbox{16774}{input} \markbox{16775}{data} \markbox{16776}{assumed} \markbox{16777}{in} \markbox{16778}{item} (1) \markbox{16779}{translates} \markbox{16780}{into} \markbox{16781}{control} \markbox{16782}{over} \markbox{16783}{the} \markbox{16784}{components} \markbox{16785}{of} \markbox{16786}{the} \markbox{16787}{stable} intervals.

To \markbox{16788}{begin} \markbox{16789}{the} sketch, \markbox{16790}{first} \markbox{16791}{observe} \markbox{16792}{that} \markbox{16793}{the} \markbox{16794}{two} \markbox{16795}{main} \markbox{16796}{assumptions} \markbox{16797}{of} \markbox{16798}{Theorem} \ref{thm:stable intervals} \markbox{16799}{on} \markbox{16800}{the} \markbox{16801}{setups} \markbox{m16802}{$(a,b;\calY)$} \markbox{16803}{and} \markbox{m16804}{$(a',b';\calY')$} \markbox{16805}{are} that
\begin{itemize}
\item The \markbox{16806}{sets} \markbox{16807}{of} \markbox{16808}{cluster} \markbox{16809}{points} \markbox{m16810}{$\calY, \calY'$} \markbox{16811}{are} \markbox{16812}{close} \markbox{16813}{to} \markbox{16814}{both} \markbox{m16815}{$\lambda(a,b)$} \markbox{16816}{and} \markbox{m16817}{$\lambda(a',b')$} \markbox{16818}{and} \markbox{16819}{have} \markbox{16820}{bounded} \markbox{16821}{symmetric} difference, \markbox{16822}{and} 
\item The \markbox{16823}{endpoints} \markbox{16824}{pairs} \markbox{m16825}{$(a,b)$} \markbox{16826}{and} \markbox{m16827}{$(a',b')$} \markbox{16828}{are} \markbox{16829}{within} \markbox{m16830}{$\epsilon$} \markbox{16831}{of} \markbox{16832}{each} other.
\end{itemize}

This \markbox{16833}{suggests} \markbox{16834}{the} \markbox{16835}{following} \markbox{16836}{iterated} \markbox{16837}{proof} strategy: 
\begin{enumerate}
\item First, \markbox{16838}{show} \markbox{16839}{that} \markbox{16840}{we} \markbox{16841}{can} \markbox{16842}{build} \markbox{16843}{a} \markbox{16844}{stable} \markbox{16845}{decomposition} \markbox{16846}{when} \markbox{16847}{we} \markbox{16848}{add} \markbox{16849}{a} \markbox{16850}{single} \markbox{16851}{nearby} \markbox{16852}{cluster} point, \markbox{16853}{while} \markbox{16854}{keeping} \markbox{16855}{the} \markbox{16856}{endpoints} \markbox{16857}{the} same.
\item Next, \markbox{16858}{show} \markbox{16859}{that} \markbox{16860}{we} \markbox{16861}{can} \markbox{16862}{iteratively} \markbox{16863}{combine} \markbox{16864}{stable} \markbox{16865}{decompositions} \markbox{16866}{to} \markbox{16867}{obtain} \markbox{16868}{a} \markbox{16869}{stable} decomposition.
\item Finally, \markbox{16870}{show} \markbox{16871}{that} \markbox{16872}{we} \markbox{16873}{can} \markbox{16874}{build} \markbox{16875}{a} \markbox{16876}{stable} \markbox{16877}{decomposition} \markbox{16878}{when} \markbox{16879}{we} \markbox{16880}{only} \markbox{16881}{wiggle} \markbox{16882}{a} \markbox{16883}{single} \markbox{16884}{endpoint} \markbox{16885}{and} \markbox{16886}{keep} \markbox{16887}{everything} \markbox{16888}{else} (including \markbox{16889}{the} \markbox{16890}{cluster} sets) \markbox{16891}{the} same.

\end{enumerate}

Steps (1) \markbox{16892}{and} (3) \markbox{16893}{can} \markbox{16894}{be} \markbox{16895}{thought} \markbox{16896}{of} \markbox{16897}{as} \emph{moves}, \markbox{16898}{where} \markbox{16899}{we} \markbox{16900}{only} \markbox{16901}{change} \markbox{16902}{one} \markbox{16903}{piece} \markbox{16904}{of} \markbox{16905}{data} \markbox{16906}{at} \markbox{16907}{a} time, \markbox{16908}{and} \markbox{16909}{we} \markbox{16910}{will} \markbox{16911}{see} \markbox{16912}{that} \markbox{16913}{type} (3) \markbox{16914}{moves} \markbox{16915}{are} \markbox{16916}{basically} \markbox{16917}{type} (1) moves.  \markbox{16918}{For} \markbox{16919}{step} (2), \markbox{16920}{we} \markbox{16921}{will} \markbox{16922}{want} \markbox{16923}{to} \markbox{16924}{iteratively} \markbox{16925}{perform} \markbox{16926}{type} (1) \markbox{16927}{moves} \markbox{16928}{by} \markbox{16929}{adding} \markbox{16930}{the} \markbox{16931}{extra} \markbox{16932}{cluster} \markbox{16933}{points} \markbox{16934}{of} \markbox{m16935}{$\calY' - \calY$} \markbox{16936}{to} \markbox{16937}{the} \markbox{16938}{setup} \markbox{m16939}{$(a,b;\calY)$}, \markbox{16940}{thereby} \markbox{16941}{shifting} \markbox{16942}{from} \markbox{m16943}{$(a,b;\calY)$} \markbox{16944}{to} \markbox{m16945}{$(a,b;\calY \cup \calY')$}.  \markbox{16946}{Then} \markbox{16947}{we} \markbox{16948}{make} \markbox{16949}{two} \markbox{16950}{type} (3) \markbox{16951}{moves} \markbox{16952}{to} \markbox{16953}{shift} \markbox{m16954}{$(a,b;\calY \cup \calY') \to (a',b;\calY \cup \calY') \to (a',b';\calY \cup \calY')$}.  Finally, \markbox{16955}{we} \markbox{16956}{make} \markbox{16957}{another} \markbox{16958}{sequence} \markbox{16959}{of} \markbox{16960}{iterated} \markbox{16961}{type} (1) \markbox{16962}{moves} \markbox{16963}{to} \markbox{16964}{shift} \markbox{16965}{from} \markbox{m16966}{$(a',b';\calY \cup \calY')$} \markbox{16967}{down} \markbox{16968}{to} \markbox{m16969}{$(a',b';\calY')$}.  \markbox{16970}{Since} \markbox{16971}{this} \markbox{16972}{total} \markbox{16973}{sequence} \markbox{16974}{of} \markbox{16975}{moves} \markbox{16976}{is} \markbox{16977}{bounded} \markbox{16978}{by} \markbox{m16979}{$N+2$}, \markbox{16980}{we} \markbox{16981}{will} \markbox{16982}{be} done.

For \markbox{16983}{step} (1), \markbox{16984}{there} \markbox{16985}{are} \markbox{16986}{two} \markbox{16987}{main} cases---the \emph{split cluster} case, \markbox{16988}{where} \markbox{16989}{we} \markbox{16990}{add} \markbox{16991}{a} \markbox{16992}{point} \markbox{m16993}{$z$} \markbox{16994}{to} \markbox{m16995}{$\calY$} \markbox{16996}{far} \markbox{16997}{from} \markbox{16998}{all} \markbox{m16999}{$\calY$}-clusters; \markbox{17000}{and} \markbox{17001}{the} \emph{affected cluster} case, \markbox{17002}{where} \markbox{m17003}{$z$} \markbox{17004}{is} \markbox{17005}{close} \markbox{17006}{to} \markbox{17007}{some} \markbox{17008}{existing} \markbox{m17009}{$\calY$}-cluster.  \markbox{17010}{See} \markbox{17011}{Figures} \ref{fig:split cluster} \markbox{17012}{and} \ref{fig:affected cluster}, respectively, \markbox{17013}{for} \markbox{17014}{relevant} schematics.  \markbox{17015}{The} \markbox{17016}{philosophy} \markbox{17017}{here} \markbox{17018}{is} simple: \markbox{17019}{adding} \markbox{17020}{a} \markbox{17021}{cluster} \markbox{17022}{point} \markbox{17023}{only} \markbox{17024}{affects} \markbox{17025}{things} locally, \markbox{17026}{thus} \markbox{17027}{one} \markbox{17028}{only} \markbox{17029}{needs} \markbox{17030}{to} \markbox{17031}{make} \markbox{17032}{bounded} \markbox{17033}{local} modifications.


Step (2) \markbox{17034}{of} \markbox{17035}{the} \markbox{17036}{proof} \markbox{17037}{now} \markbox{17038}{involves} \markbox{17039}{iteratively} \markbox{17040}{applying} \markbox{17041}{step} (1), \markbox{17042}{and} \markbox{17043}{thus} \markbox{17044}{one} \markbox{17045}{must} \markbox{17046}{show} \markbox{17047}{that} \markbox{17048}{one} \markbox{17049}{can} \markbox{17050}{coherently} \markbox{17051}{combine} \markbox{17052}{two} \markbox{17053}{pairs} \markbox{17054}{of} \markbox{17055}{stable} \markbox{17056}{decompositions} \markbox{17057}{across} \markbox{17058}{a} \markbox{17059}{common} setup.  \markbox{17060}{Figure} \ref{fig:iterated stable decomp} \markbox{17061}{shows} \markbox{17062}{a} \markbox{17063}{schematic} \markbox{17064}{for} \markbox{17065}{the} argument, \markbox{17066}{in} \markbox{17067}{which} \markbox{17068}{one} \markbox{17069}{has} \markbox{17070}{three} \markbox{17071}{stable} \markbox{17072}{trees} \markbox{m17073}{$T_1,T_2,T_3$} \markbox{17074}{with} \markbox{17075}{associated} \markbox{17076}{stable} decompositions, \markbox{17077}{so} \markbox{17078}{that} \markbox{17079}{those} \markbox{17080}{for} \markbox{m17081}{$T_1,T_2$} \markbox{17082}{and} \markbox{m17083}{$T_2,T_3$} \markbox{17084}{are} compatible.  \markbox{17085}{The} \markbox{17086}{idea} \markbox{17087}{is} \markbox{17088}{to} \markbox{17089}{intersect} \markbox{17090}{the} \markbox{17091}{two} \markbox{17092}{decompositions} \markbox{17093}{on} \markbox{m17094}{$T_2$} \markbox{17095}{and} \markbox{17096}{pull} \markbox{17097}{them} \markbox{17098}{back} \markbox{17099}{to} \markbox{m17100}{$T_1,T_3$}.

The \markbox{17101}{associated} \markbox{17102}{stability} \markbox{17103}{constants} \markbox{17104}{increase} \markbox{17105}{a} \markbox{17106}{controlled} \markbox{17107}{amount} \markbox{17108}{with} \markbox{17109}{each} iteration, \markbox{17110}{but} \markbox{17111}{we} \markbox{17112}{are} \markbox{17113}{assuming} \markbox{17114}{that} \markbox{17115}{we} \markbox{17116}{only} \markbox{17117}{need} \markbox{17118}{to} \markbox{17119}{perform} boundedly-many \markbox{17120}{such} \markbox{17121}{iterations} \markbox{17122}{in} \markbox{17123}{Theorem} \ref{thm:stable intervals}.


\smallskip

Finally, \markbox{17124}{step} (3) \markbox{17125}{is} \markbox{17126}{an} \markbox{17127}{application} \markbox{17128}{of} \markbox{17129}{steps} (1) \markbox{17130}{and} (2).  \markbox{17131}{To} \markbox{17132}{get} \markbox{17133}{the} idea, \markbox{17134}{we} \markbox{17135}{can} \markbox{17136}{consider} \markbox{17137}{the} \markbox{17138}{following} \markbox{17139}{restricted} setup, \markbox{17140}{which} \markbox{17141}{we} \markbox{17142}{highlight} \markbox{17143}{to} \markbox{17144}{focus} \markbox{17145}{on} \markbox{17146}{what} \markbox{17147}{happens} \markbox{17148}{when} \markbox{17149}{we} \markbox{17150}{perturb} \markbox{17151}{an} endpoint.  \markbox{17152}{Let} \markbox{m17153}{$a,b,a' \in \calZ$} \markbox{17154}{and} \markbox{m17155}{$\calY \subset \calZ$} \markbox{17156}{be} \markbox{17157}{finite} \markbox{17158}{with} \markbox{m17159}{$\calY \subset \calN_{\epsilon/2}(\lambda(a,b)) \cap \calN_{\epsilon/2}(a',b)$}.  \markbox{17160}{The} \markbox{17161}{following} \markbox{17162}{collection} \markbox{17163}{of} setups, \markbox{17164}{each} \markbox{17165}{of} \markbox{17166}{which} \markbox{17167}{differs} \markbox{17168}{by} \markbox{17169}{adding} \markbox{17170}{or} \markbox{17171}{deleting} \markbox{17172}{one} \markbox{17173}{cluster} point, \markbox{17174}{or} \markbox{17175}{by} \markbox{17176}{switching} \markbox{17177}{the} \markbox{17178}{role} \markbox{17179}{that} \markbox{m17180}{$a,a'$} \markbox{17181}{or} \markbox{m17182}{$b,b'$} \markbox{17183}{play} \markbox{17184}{between} \markbox{17185}{cluster} \markbox{17186}{or} endpoint:
\vspace{-.09in}
\begin{multicols}{3}
\begin{enumerate}
\item $(a,b;\calY)$,
\item $(a,b;\calY \cup \{a\})$,
\item $(a,b;\calY \cup \{a, a'\})$,
\item $(a',b;\calY \cup \{a,a'\})$,
\item $(a',b;\calY \cup \{a'\})$,
\item $(a',b;\calY)$.
\end{enumerate}
\end{multicols}

Hence \markbox{17187}{we} \markbox{17188}{can} \markbox{17189}{use} \markbox{17190}{steps} (1),(2), (3) \markbox{17191}{plus} \markbox{17192}{iteration} \markbox{17193}{to} \markbox{17194}{change} \markbox{17195}{the} \markbox{17196}{roles} \markbox{17197}{of} \markbox{17198}{endpoints} \markbox{17199}{once} \markbox{17200}{we} \markbox{17201}{have} \markbox{17202}{added} \markbox{17203}{all} \markbox{17204}{of} \markbox{17205}{the} \markbox{17206}{necessary} \markbox{17207}{cluster} points.  \markbox{17208}{See} \markbox{17209}{Appendix} \ref{app:SI} \markbox{17210}{for} \markbox{17211}{the} \markbox{17212}{full} argument.


\begin{figure}[b]
    \centering
    \includegraphics[width=1\textwidth]{figures/split_cluster}
    \caption{Step (1) of the proof of Theorem \ref{thm:stable intervals}, split cluster case:  In the first figure, the two edge components of the two stable intervals are shown.  The point $z$ forms an individual cluster and therefore must be inserted as a vertex in the graph $\calG$, between clusters $C_1, C_2$.  Every cluster to the left of $C_1$ is unchanged, as are all of the connecting segments (in pink), and same for those to the right of $C_2$.  The second figure shows the stable decomposition of the stable intervals.  Here, we need to include the shadow of the cluster $z$ on $\lambda(C_1,C_2)$ as an unstable component.  This cuts $\lambda(C_1,C_2)$ into two segments, which are paired with $\lambda(C_1,z)$ and $\lambda(z,C_2)$, though these need to be slightly truncated so guarantee they have the same lengths; the unstable segments accomplishing this are red.  The third figure shows the stable decomposition for their $(r_1,r_2)$-thickenings, which are subsets of the edge components $T_e \subset T$ and $T'_e \subset T$, are indicated in brown.  Note that this can result in collapsing an entire edge component if its diameter is less than $r_2-2r_1$.  These brown segments refine the stable decompositions $T_s \subset T_e$ and $T'_s \subset T'_e$.}    \label{fig:split cluster}
\end{figure}

\newpage
\begin{figure}[!htb]
    \centering
    \includegraphics[width=1\textwidth]{figures/affect_cluster}
    \caption{Step (1) of the proof of Theorem \ref{thm:stable intervals}, affected cluster case.  Two phenomena are shown.  In the top figure, there are three affected clusters, $P,Q,R$, for $(a,b;\calY)$ which combine with $z$ into a new cluster $C'$ for $(a,b;\calY \cup \{z\})$.  By definition, $P,Q,R$ must be $O(\epsilon)$ apart, and actually are adjacent in $\calG$.  The clusters $C_1,C_2$ appear in both setups, and the subgraph of $\calG$ to the left of $C_1$ coincides with the same subgraph for $\calG'$, and similarly for $C_2$.  So the corresponding (pink) components form (stable) components of $T_s \subset T_e$ and $T'_s \subset T'_e$.  The components of $T_e$ connecting $P,Q,R$ are declared unstable and, in this example, the components $\lambda(C_1,P)$ and $\lambda(R,C_2)$ of $T_e$ coincide with the components $\lambda(C_1,C')$ and $\lambda(C',C_2)$ of $T'_e$, and hence are stable.  The second figure shows the stable decomposition for the $(r_1,r_2)$-thickenings, which are just the thickenings of the components of $T_s = T'_s$, and hence are also exactly the same.  In the second example, the same discussion applies to the outside parts.  For the middle of the graph, $z$ combines with the cluster $A$, which results in pairs of segments $\lambda(C_1,A)$ and $\lambda(C_1, C')$, and $\lambda(A,C_2)$ and $\lambda(C',C_2)$, which have $O(\epsilon)$-close endpoints and are thus $O(\epsilon)$-Hausdorff close, with the same length up to error $O(\epsilon)$.  Small surgeries provide the required stable components for the stable intervals $T, T'$, shown in the third figure.  The fourth figure shows the stable decomposition for the $(R,r)$-thickenings of this example.}
    \label{fig:affected cluster}
\end{figure}

\begin{figure}[t]
    \centering
    \includegraphics[width=1\textwidth]{figures/iterated_stabledecomp}
    \caption{The proof of Theorem \ref{thm:stable intervals}, iterating stable decompositions: The idea for the iteration argument is to intersect the stable decompositions $T^1_{s,2} \cap T^3_{s,2} \subset T_2$ for $T_1,T_3$, respectively, and then use the isometries which identify the stable pairs for $T_1, T_2$ to give a refined stable decomposition for $(T_1,T_2)$, which can be combined with a refinement for $(T_2,T_3)$ via simple composition.  In the schematic (which is \emph{not} happening in $\calZ$), we have lined up the stable intervals $T_1,T_2,T_3$ to indicate how to refine the pairwise stable decompositions for $(T_1,T_2)$ and $(T_2,T_3)$ for one for $(T_1,T_3)$.  The orange segments correspond to cluster components of the intervals, while the blue and green segments correspond to the unstable components for the pairs $(T_1,T_2)$ and $(T_2,T_3)$, respectively.  The complement of the orange, blue, and green segments on $T_2$ form the refined stable decomposition on $T_2$, and the purple squares indicate how these segments induce refined stable decompositions on $T_1$ and $T_3$.}
    \label{fig:iterated stable decomp}
\end{figure}


\newpage
\section{Stable cubical models} \label{sec:stable cubes}

In \markbox{17213}{this} section, \markbox{17214}{we} \markbox{17215}{explain} \markbox{17216}{how} \markbox{17217}{to} \markbox{17218}{combine} \markbox{17219}{the} \markbox{17220}{cubulation} \markbox{17221}{machinery} \markbox{17222}{described} \markbox{17223}{in} \markbox{17224}{Sections} \ref{sec:interval systems}--\ref{sec:cubulation} \markbox{17225}{with} \markbox{17226}{the} \markbox{17227}{Controlling} \markbox{17228}{Domains} \markbox{17229}{Theorem} \ref{thm:controlling domains} \markbox{17230}{established} \markbox{17231}{in} \markbox{17232}{Section} \ref{sec:controlling domains} \markbox{17233}{and} \markbox{17234}{the} \markbox{17235}{Stable} \markbox{17236}{Interval} \markbox{17237}{Theorem} \ref{thm:stable intervals} \markbox{17238}{from} \markbox{17239}{Section} \ref{sec:stable intervals}.  \markbox{17240}{Over} \markbox{17241}{the} \markbox{17242}{first} \markbox{17243}{two} subsections, \markbox{17244}{we} \markbox{17245}{prove} \markbox{17246}{that} \markbox{17247}{our} \markbox{17248}{stable} \markbox{17249}{intervals} \markbox{17250}{can} \markbox{17251}{be} \markbox{17252}{plugged} \markbox{17253}{into} \markbox{17254}{our} \markbox{17255}{interval} \markbox{17256}{system} \markbox{17257}{machinery} \markbox{17258}{to} \markbox{17259}{produce} \markbox{17260}{an} \markbox{17261}{HFI} \markbox{17262}{for} \markbox{17263}{any} \markbox{17264}{pair} \markbox{17265}{of} \markbox{17266}{points} \markbox{m17267}{$a,b \in \calX$} \markbox{17268}{in} \markbox{17269}{an} HHS.

The \markbox{17270}{heart} \markbox{17271}{of} \markbox{17272}{the} \markbox{17273}{section} \markbox{17274}{is} \markbox{17275}{then} \markbox{17276}{explaining} \markbox{17277}{how} \markbox{17278}{to} \markbox{17279}{relate} \markbox{17280}{two} \markbox{17281}{such} \markbox{17282}{HFIs} \markbox{17283}{for} \markbox{17284}{a} \markbox{17285}{pair} \markbox{17286}{of} \markbox{17287}{points} \markbox{m17288}{$a,b$} \markbox{17289}{and} \markbox{17290}{a} \markbox{17291}{perturbed} \markbox{17292}{pair} \markbox{m17293}{$a',b'$}.  \markbox{17294}{We} \markbox{17295}{explain} \markbox{17296}{this} \markbox{17297}{below} \markbox{17298}{in} \markbox{17299}{detail} \markbox{17300}{in} \markbox{17301}{Subsection} \ref{subsec:perturbed to stable}.




\subsection{Stable intervals form an interval system}

Our \markbox{17302}{first} \markbox{17303}{goal} \markbox{17304}{is} \markbox{17305}{to} \markbox{17306}{explain} \markbox{17307}{how} \markbox{17308}{to} \markbox{17309}{take} \markbox{17310}{the} \markbox{17311}{family} \markbox{17312}{of} \markbox{17313}{stable} \markbox{17314}{intervals} \markbox{17315}{associated} \markbox{17316}{to} \markbox{17317}{a} \markbox{17318}{pair} \markbox{17319}{of} \markbox{17320}{points} \markbox{m17321}{$a, b\in \calX$} \markbox{17322}{and} \markbox{17323}{produce} \markbox{17324}{a} \markbox{17325}{hierarchical} \markbox{17326}{family} \markbox{17327}{of} intervals.


First, \markbox{17328}{we} \markbox{17329}{need} \markbox{17330}{to} \markbox{17331}{induce} \markbox{17332}{a} \markbox{17333}{collection} \markbox{17334}{of} \markbox{17335}{relative} \markbox{17336}{projections} \markbox{17337}{on} \markbox{17338}{the} \markbox{17339}{stable} \markbox{17340}{intervals} \markbox{17341}{which} \markbox{17342}{turn} \markbox{17343}{them} \markbox{17344}{into} \markbox{17345}{an} \markbox{m17346}{$R$}-interval \markbox{17347}{system} (Definition \ref{defn:interval axioms}) \markbox{17348}{for} \markbox{17349}{a} \markbox{17350}{uniform} \markbox{m17351}{$R = R(\mathfrak S)>0$}.

Let \markbox{m17352}{$U \in \calU$}.  \markbox{17353}{Recall} \markbox{17354}{that} \markbox{17355}{the} \markbox{17356}{BGIA} \ref{ax:BGIA} \markbox{17357}{says} \markbox{17358}{that} \markbox{17359}{if} \markbox{m17360}{$d_V(a,b)$} \markbox{17361}{is} \markbox{17362}{sufficiently} \markbox{17363}{large} \markbox{17364}{for} \markbox{m17365}{$V \in \mathfrak S$}, \markbox{17366}{then} \markbox{m17367}{$\rho^V_U \subset \calN_{\ES}(\lambda(a,b))$} \markbox{17368}{when} \markbox{m17369}{$V \nest U$} and, \markbox{17370}{even} better, \markbox{m17371}{$\rho^V_U \subset \calN_{\ES}(a \cup b)$} \markbox{17372}{when} \markbox{m17373}{$V \pitchfork U$}.  \markbox{17374}{If} \markbox{17375}{we} \markbox{17376}{set} \markbox{m17377}{$\calY_U= \{\rho^V_U|V \nest U \in \calU\}$}, \markbox{17378}{then} \markbox{m17379}{$(\pi_U(a), \pi_U(b); \calY_U)$} \markbox{17380}{is} \markbox{17381}{an} \markbox{m17382}{$\epsilon$}-setup \markbox{17383}{in} \markbox{m17384}{$\calC(U)$} \markbox{17385}{for} \markbox{m17386}{$\epsilon = 2\ES$} \markbox{17387}{in} \markbox{17388}{the} \markbox{17389}{sense} \markbox{17390}{of} \markbox{17391}{Subsection} \ref{subsec:stable setup}.  \markbox{17392}{In} particular, \markbox{17393}{our} \markbox{17394}{stable} \markbox{17395}{interval} \markbox{17396}{construction} (Proposition \ref{prop:stable interval structure}) applies.

For \markbox{17397}{each} \markbox{m17398}{$U \in \calU$}, \markbox{17399}{let} \markbox{m17400}{$T_U = T_{U,e} \cup T_{U,c}$} \markbox{17401}{denote} \markbox{17402}{the} \markbox{17403}{stable} \markbox{17404}{interval} \markbox{17405}{for} \markbox{17406}{the} \markbox{17407}{setup} \markbox{m17408}{$(a,b;\calY_U)$} \markbox{17409}{in} \markbox{m17410}{$\calC(U)$}.  \markbox{17411}{Recall} \markbox{17412}{that} \markbox{17413}{each} \markbox{17414}{component} \markbox{17415}{of} \markbox{m17416}{$T_{U,c}$} \markbox{17417}{coincides} \markbox{17418}{with} \markbox{m17419}{$\mu(C)$} \markbox{17420}{for} \markbox{17421}{some} \markbox{17422}{cluster} \markbox{m17423}{$C$} \markbox{17424}{of} \markbox{17425}{points} \markbox{17426}{in} \markbox{m17427}{$\calY_U \cup \{a,b\}$} (Subsection \ref{subsec:clusters}).  Importantly, \markbox{17428}{item} (2) \markbox{17429}{of} \markbox{17430}{Proposition} \ref{prop:stable interval structure} \markbox{17431}{says} \markbox{17432}{that} \markbox{m17433}{$\phi_U(\mu(C))$} \markbox{17434}{is} \markbox{m17435}{$O(\epsilon)$} (and \markbox{17436}{hence} \markbox{m17437}{$O(\mathfrak S)$}) \markbox{17438}{Hausdorff} \markbox{17439}{close} \markbox{17440}{to} \markbox{m17441}{$C$} itself.  \markbox{17442}{This} \markbox{17443}{property} \markbox{17444}{is} \markbox{17445}{what} \markbox{17446}{makes} \markbox{17447}{the} \markbox{17448}{following} \markbox{17449}{definition} work:

\begin{definition}[Stable \markbox{17450}{interval} projections]\label{defn:stable interval projections}
For \markbox{17451}{each} \markbox{m17452}{$U \in \calU$}, \markbox{17453}{we} \markbox{17454}{define} \markbox{17455}{the} \markbox{17456}{following} \emph{stable interval projections}:
\begin{itemize}
\item For \markbox{17457}{each} \markbox{m17458}{$V \in \calU$} \markbox{17459}{with} \markbox{m17460}{$V \nest U$}, \markbox{17461}{let} \markbox{m17462}{$C$} \markbox{17463}{be} \markbox{17464}{the} \markbox{17465}{cluster} \markbox{17466}{containing} \markbox{m17467}{$\rho^V_U$}.  \markbox{17468}{Define} 
$$\delta^V_U = \phi_U^{-1}(\hull_{\mu(C)}(p_{\phi_U(\mu(C))}(\rho^V_U))) \subset \mu(C),$$where \markbox{m17469}{$p_U:\calC(U) \to \phi_U(\mu(C))$} \markbox{17470}{is} \markbox{17471}{the} \markbox{17472}{closest} \markbox{17473}{point} \markbox{17474}{projection} \markbox{17475}{to} \markbox{17476}{the} \markbox{17477}{geodesic} \markbox{17478}{segment} \markbox{m17479}{$\phi_U(\mu(C)) = \mu(C)$}.
\item For \markbox{17480}{each} \markbox{m17481}{$V \in \calU$} \markbox{17482}{with} \markbox{m17483}{$V \pitchfork U$}, \markbox{17484}{let} \markbox{m17485}{$f \in \{a,b\}$} \markbox{17486}{denote} \markbox{17487}{the} \markbox{17488}{point} (provided \markbox{17489}{by} \markbox{17490}{Definition} \ref{defn:consistency}) \markbox{17491}{for} \markbox{17492}{which} \markbox{m17493}{$d_U(\pi_U(f), \rho^V_U)<\epsilon$}, \markbox{17494}{and} \markbox{17495}{let} \markbox{m17496}{$C$} \markbox{17497}{denote} \markbox{17498}{the} \markbox{17499}{cluster} \markbox{17500}{containing} \markbox{m17501}{$f$}.  \markbox{17502}{Again} \markbox{17503}{we} \markbox{17504}{define} \markbox{m17505}{$\delta^V_U = \phi_U^{-1}(\hull_{\mu(C)}(p_{\phi_U(\mu(C)}(\rho^V_U))) \subset \mu(C)$}.
\item If \markbox{m17506}{$U \nest V$}, \markbox{17507}{then} \markbox{17508}{we} \markbox{17509}{define} \markbox{17510}{the} \emph{interval projection map} \markbox{m17511}{$\delta^V_U:T_V \to T_U$} \markbox{17512}{by} \markbox{m17513}{$\delta^V_U = \phi^{-1}_U \circ p_{T_U} \circ \rho^V_U \circ \phi_V.$}
\end{itemize}
\end{definition}

The \markbox{17514}{next} \markbox{17515}{lemma} \markbox{17516}{says} \markbox{17517}{that} \markbox{17518}{these} \markbox{17519}{projections} \markbox{17520}{turn} \markbox{17521}{the} \markbox{17522}{family} \markbox{17523}{of} \markbox{17524}{stable} \markbox{17525}{intervals} \markbox{17526}{into} \markbox{17527}{an} \markbox{17528}{interval} system.  \markbox{17529}{The} proof, \markbox{17530}{which} \markbox{17531}{we} \markbox{17532}{leave} \markbox{17533}{to} \markbox{17534}{the} reader, \markbox{17535}{involves} \markbox{17536}{verifying} \markbox{17537}{the} \markbox{17538}{conditions} \markbox{17539}{of} \markbox{17540}{Definition} \ref{defn:interval axioms} (and \markbox{17541}{hence} \markbox{17542}{Lemma} \ref{lem:interval control}, \markbox{17543}{and} \markbox{17544}{one} \markbox{17545}{does} \markbox{17546}{this} \markbox{17547}{via} \markbox{17548}{Lemma} \ref{lem:rho control} \markbox{17549}{and} \markbox{17550}{Proposition} \ref{prop:stable interval structure}.

\begin{lemma}\label{lem:stable interval system}
There \markbox{17551}{exists} \markbox{m17552}{$R_s = R_s(\mathfrak S)>0$} \markbox{17553}{so} \markbox{17554}{that} \markbox{17555}{the} \markbox{17556}{stable} \markbox{17557}{intervals} \markbox{m17558}{$\{T_U\}_{U \in \calU}$} \markbox{17559}{endowed} \markbox{17560}{with} \markbox{17561}{the} \markbox{17562}{stable} \markbox{17563}{interval} \markbox{17564}{projections} \markbox{17565}{forms} \markbox{17566}{an} \markbox{m17567}{$R_s$}-interval \markbox{17568}{system} \markbox{17569}{for} \markbox{m17570}{$a,b$}.
\end{lemma}



\subsection{Thickenings of stable intervals, their collapses, and HFIs}\label{subsec:collapsed stable intervals}

In \markbox{17571}{this} subsection, \markbox{17572}{we} \markbox{17573}{explain} \markbox{17574}{why} \markbox{17575}{collapsed} \markbox{17576}{thickened} \markbox{17577}{interval} \markbox{17578}{systems} \markbox{17579}{of} \markbox{17580}{stable} \markbox{17581}{intevals} \markbox{17582}{form} HFIs.

To begin, \markbox{17583}{in} \markbox{17584}{Subsection} \ref{subsec:thickenings}, \markbox{17585}{we} \markbox{17586}{took} \markbox{17587}{an} \markbox{17588}{interval} \markbox{17589}{system} \markbox{m17590}{$\{T_U\}_{U \in \calU}$} \markbox{17591}{along} \markbox{17592}{with} \markbox{17593}{its} \markbox{17594}{relative} \markbox{17595}{projection} \markbox{17596}{data} \markbox{m17597}{$\delta^V_U$}, \markbox{17598}{and} \markbox{17599}{then} \markbox{17600}{thickened} \markbox{17601}{the} \markbox{17602}{intervals} \markbox{17603}{along} \markbox{17604}{the} \markbox{17605}{components} \markbox{m17606}{$B$} \markbox{17607}{of} \markbox{17608}{a} \markbox{17609}{decomposition} \markbox{m17610}{$T_U = A \cup B$}, \markbox{17611}{where} \markbox{m17612}{$B$} \markbox{17613}{consists} \markbox{17614}{of} \markbox{17615}{these} \markbox{m17616}{$\delta^V_U$} \markbox{17617}{along} \markbox{17618}{with} \markbox{17619}{the} \markbox{17620}{marked} \markbox{17621}{points} \markbox{m17622}{$a_U,b_U$}.  \markbox{17623}{Then} \markbox{17624}{in} \markbox{17625}{Subsection} \ref{subsec:collapsing}, \markbox{17626}{we} \markbox{17627}{collapsed} \markbox{17628}{along} \markbox{17629}{this} \markbox{17630}{thickening} \markbox{17631}{which} \markbox{17632}{induced} \markbox{17633}{collapsed} \markbox{17634}{relative} \markbox{17635}{projections} \markbox{17636}{on} \markbox{17637}{the} \markbox{17638}{collapsed} intervals.  \markbox{17639}{On} \markbox{17640}{the} \markbox{17641}{other} hand, \markbox{17642}{the} \markbox{17643}{thickenings} \markbox{17644}{of} \markbox{17645}{stable} \markbox{17646}{intervals} \markbox{17647}{we} \markbox{17648}{considered} \markbox{17649}{in} \markbox{17650}{the} \markbox{17651}{Stable} \markbox{17652}{Intervals} \markbox{17653}{Theorem} \ref{thm:stable intervals} \markbox{17654}{were} \markbox{17655}{thickenings} \markbox{17656}{along} \markbox{17657}{the} \markbox{17658}{cluster} components.

The \markbox{17659}{following} lemma, \markbox{17660}{whose} \markbox{17661}{proof} \markbox{17662}{we} \markbox{17663}{leave} \markbox{17664}{to} \markbox{17665}{the} reader, \markbox{17666}{says} \markbox{17667}{that} \markbox{17668}{these} \markbox{17669}{thickenings} coincide, \markbox{17670}{and} \markbox{17671}{hence} \markbox{17672}{that} \markbox{17673}{the} \markbox{17674}{corresponding} \markbox{17675}{collapsed} \markbox{17676}{trees} \markbox{17677}{are} identical:

\begin{lemma}\label{lem:same thickenings}
For \markbox{17678}{any} \markbox{m17679}{$U \in \calU$}, \markbox{17680}{let} \markbox{m17681}{$T_U = A \cup B$} \markbox{17682}{be} \markbox{17683}{the} \markbox{17684}{decomposition} \markbox{17685}{where} \markbox{m17686}{$B$} \markbox{17687}{is} \markbox{17688}{the} \markbox{17689}{union} \markbox{17690}{of} \markbox{17691}{all} \markbox{m17692}{$\delta^V_U$} \markbox{17693}{for} \markbox{m17694}{$V \nest U$} \markbox{17695}{along} \markbox{17696}{with} \markbox{m17697}{$a_U,b_U$}.  \markbox{17698}{Let} \markbox{m17699}{$T_U = T_{U,e} \cup T_{U,c}$} \markbox{17700}{denote} \markbox{17701}{the} \markbox{17702}{decomposition} \markbox{17703}{provided} \markbox{17704}{by} \markbox{17705}{Proposition} \ref{prop:stable interval structure}.  \markbox{17706}{There} \markbox{17707}{exists} \markbox{m17708}{$R_3 = R_3(\mathfrak S)>0$} \markbox{17709}{so} \markbox{17710}{that} \markbox{17711}{for} \markbox{17712}{any} \markbox{m17713}{$r_1>R_3$} \markbox{17714}{and} \markbox{m17715}{$r_2>0$}, \markbox{17716}{the} \markbox{m17717}{$(r_1,r_2)$}-thickenings \markbox{17718}{of} \markbox{m17719}{$T_U$} \markbox{17720}{along} \markbox{m17721}{$B$} \markbox{17722}{and} \markbox{17723}{along} \markbox{m17724}{$T_{U,c}$} \markbox{17725}{are} identical.
\end{lemma}




The \markbox{17726}{upshot} \markbox{17727}{of} \markbox{17728}{Lemmas} \ref{lem:stable interval system} \markbox{17729}{and} \ref{lem:same thickenings} \markbox{17730}{is} \markbox{17731}{that} \markbox{17732}{we} \markbox{17733}{can} \markbox{17734}{plug} \markbox{17735}{our} \markbox{17736}{stable} \markbox{17737}{intervals} \markbox{17738}{directly} \markbox{17739}{into} \markbox{17740}{our} \markbox{17741}{interval} \markbox{17742}{system} machinery.  \markbox{17743}{The} \markbox{17744}{next} \markbox{17745}{step} \markbox{17746}{is} \markbox{17747}{to} \markbox{17748}{explain} \markbox{17749}{how} \markbox{17750}{to} \markbox{17751}{produce} \markbox{17752}{an} \markbox{17753}{HFI} (Definition \ref{defn:HFI}) \markbox{17754}{from} \markbox{17755}{this} \markbox{17756}{system} \markbox{17757}{using} \markbox{17758}{the} \markbox{17759}{thickenings} \markbox{17760}{and} \markbox{17761}{collapsing} \markbox{17762}{procedures} \markbox{17763}{discussed} \markbox{17764}{in} \markbox{17765}{Subsections} \ref{subsec:thickenings} \markbox{17766}{and} \ref{subsec:collapsing}.

Continuing \markbox{17767}{with} \markbox{17768}{our} notation, \markbox{17769}{Lemma} \ref{lem:stable interval system} \markbox{17770}{says} \markbox{17771}{that} \markbox{17772}{the} \markbox{17773}{stable} \markbox{17774}{intervals} \markbox{m17775}{$\{T_U\}_{U \in \calU}$} \markbox{17776}{endowed} \markbox{17777}{with} \markbox{17778}{the} \markbox{17779}{interval} \markbox{17780}{projections} \markbox{17781}{via} \markbox{17782}{Definition} \ref{defn:stable interval projections} \markbox{17783}{form} \markbox{17784}{an} \markbox{m17785}{$R_s$}-interval \markbox{17786}{system} \markbox{17787}{for} \markbox{m17788}{$a,b\in \calX$}, \markbox{17789}{where} \markbox{m17790}{$R_s = R_s(\mathfrak S)>0$}.  \markbox{17791}{Since} \markbox{m17792}{$R_s= R_s(\mathfrak S)>0$}, \markbox{17793}{Proposition} \ref{prop:hPsi defined} \markbox{17794}{and} \markbox{17795}{Lemma} \ref{lem:collapsed interval control} \markbox{17796}{provide} \markbox{17797}{constants} \markbox{m17798}{$R_1 = R_1(\mathfrak S)>0$} \markbox{17799}{and} \markbox{m17800}{$R_2(\mathfrak S)>0$} \markbox{17801}{so} \markbox{17802}{that} \markbox{17803}{for} \markbox{17804}{any} \markbox{m17805}{$r_1\geq R_1$} \markbox{17806}{and} \markbox{m17807}{$r_2 \geq R_2$}, \markbox{17808}{the} \markbox{17809}{conclusions} \markbox{17810}{of} \markbox{17811}{Lemma} \ref{lem:collapsed interval control} \markbox{17812}{hold} \markbox{17813}{for} \markbox{17814}{the} \markbox{17815}{family} \markbox{17816}{of} \markbox{17817}{collapsed} \markbox{17818}{intervals} \markbox{m17819}{$\{\hT_U\}_{U \in \calU}$} \markbox{17820}{obtained} \markbox{17821}{from} \markbox{17822}{the} \markbox{m17823}{$(r_1,r_2)$}-thickening \markbox{17824}{of} \markbox{17825}{the} \markbox{17826}{system} \markbox{m17827}{$\{T_U\}_{U \in \calU}$}.  \markbox{17828}{We} \markbox{17829}{also} \markbox{17830}{want} \markbox{17831}{to} \markbox{17832}{assume} \markbox{17833}{that} \markbox{m17834}{$r_1>R_3 = R_3(\mathfrak S)>0$} \markbox{17835}{so} \markbox{17836}{that} \markbox{17837}{Lemma} \ref{lem:same thickenings} holds.

The \markbox{17838}{next} \markbox{17839}{proposition} \markbox{17840}{states} \markbox{17841}{that} \markbox{17842}{as} \markbox{17843}{long} \markbox{17844}{as} \markbox{m17845}{$r_1$} \markbox{17846}{is} \markbox{17847}{a} \markbox{17848}{positive} integer, \markbox{17849}{the} \markbox{17850}{collapsed} \markbox{17851}{intervals} \markbox{m17852}{$\hT_U$} \markbox{17853}{are} \markbox{17854}{all} \markbox{17855}{simplicial} intervals, \markbox{17856}{where} \markbox{17857}{the} \markbox{17858}{collapsed} \markbox{17859}{points} \markbox{17860}{lie} \markbox{17861}{at} vertices.  \markbox{17862}{The} \markbox{17863}{proof} \markbox{17864}{is} \markbox{17865}{a} \markbox{17866}{straightforward} \markbox{17867}{application} \markbox{17868}{of} \markbox{17869}{the} \markbox{17870}{ideas} \markbox{17871}{in} \markbox{17872}{the} \markbox{17873}{preceding} sections, \markbox{17874}{so} \markbox{17875}{we} \markbox{17876}{leave} \markbox{17877}{it} \markbox{17878}{to} \markbox{17879}{the} reader.

\begin{proposition}\label{prop:stable HFI}
As \markbox{17880}{long} \markbox{17881}{as} \markbox{m17882}{$r_1\geq \max\{R_1,R_3\}$} \markbox{17883}{is} \markbox{17884}{a} \markbox{17885}{positive} \markbox{17886}{integer} \markbox{17887}{and} \markbox{m17888}{$r_2\geq R_2$}, \markbox{17889}{the} \markbox{17890}{family} \markbox{17891}{of} \markbox{17892}{collapsed} \markbox{17893}{stable} \markbox{17894}{intervals} \markbox{m17895}{$\{\hT_U\}_{U \in \calU}$} \markbox{17896}{associated} \markbox{17897}{to} \markbox{17898}{an} \markbox{m17899}{$(r_1,r_2)$}-thickening \markbox{17900}{of} \markbox{m17901}{$\{T_U\}_{U \in \calU}$} \markbox{17902}{along} \markbox{m17903}{$T_{U,c}$} \markbox{17904}{and} \markbox{17905}{endowed} \markbox{17906}{with} \markbox{17907}{their} \markbox{17908}{collapsed} \markbox{17909}{projections} \markbox{17910}{forms} \markbox{17911}{a} \markbox{17912}{hierarchical} \markbox{17913}{family} \markbox{17914}{of} intervals.
\end{proposition} 



We \markbox{17915}{note} \markbox{17916}{the} \markbox{17917}{following} \markbox{17918}{immediate} \markbox{17919}{corollary} \markbox{17920}{of} \markbox{17921}{Proposition} \ref{prop:stable HFI} \markbox{17922}{and} \markbox{17923}{Theorem} \ref{thm:Q CCC}:

\begin{corollary}\label{cor:stable HFI cube}
Let \markbox{m17924}{$a,b \in \calX$}, \markbox{m17925}{$K > K_0$} \markbox{17926}{for} \markbox{m17927}{$K_0$} \markbox{17928}{as} \markbox{17929}{in} \markbox{17930}{Theorem} \ref{thm:DF} \markbox{17931}{and} \markbox{m17932}{$\calU = \Rel_K(a,b)$}.  \markbox{17933}{Let} \markbox{m17934}{$\{\hT_U\}_{U \in \calU}$} \markbox{17935}{be} \markbox{17936}{the} \markbox{17937}{associated} \markbox{17938}{family} \markbox{17939}{of} \markbox{17940}{stable} intervals.  \markbox{17941}{Then} \markbox{17942}{the} \markbox{17943}{hierarchical} \markbox{17944}{hull} \markbox{m17945}{$H = \hull_{\calX}(a,b)$} \markbox{17946}{is} quasi-isometric \markbox{17947}{to} \markbox{17948}{the} \markbox{17949}{dual} \markbox{17950}{cube} \markbox{17951}{complex} \markbox{17952}{of} \markbox{17953}{the} \markbox{17954}{associated} HFI, \markbox{17955}{with} \markbox{17956}{constants} \markbox{17957}{depending} \markbox{17958}{only} \markbox{17959}{on} \markbox{m17960}{$\mathfrak S$} \markbox{17961}{and} \markbox{m17962}{$K$}.
\end{corollary}





\subsection{From a perturbed pair to a family of stable decompositions} \label{subsec:perturbed to stable}

In \markbox{17963}{this} subsection, \markbox{17964}{we} \markbox{17965}{explain} \markbox{17966}{how} \markbox{17967}{the} \markbox{17968}{basic} \markbox{17969}{setup} \markbox{17970}{of} \markbox{17971}{this} \markbox{17972}{paper} \markbox{17973}{can} \markbox{17974}{be} \markbox{17975}{plugged} \markbox{17976}{into} \markbox{17977}{the} \markbox{17978}{machinery} \markbox{17979}{we} \markbox{17980}{have} \markbox{17981}{built} \markbox{17982}{so} far.

For \markbox{17983}{the} \markbox{17984}{rest} \markbox{17985}{of} \markbox{17986}{this} section, \markbox{17987}{assume} \markbox{17988}{that} \markbox{17989}{we} \markbox{17990}{have} \markbox{17991}{a} \markbox{17992}{colorable} \markbox{17993}{HHS} \markbox{m17994}{$(\calX, \mathfrak S)$} \markbox{17995}{endowed} \markbox{17996}{with} \markbox{17997}{the} \markbox{17998}{stable} \markbox{17999}{projections} \markbox{18000}{from} \markbox{18001}{Theorem} \ref{thm:controlling domains}.  \markbox{18002}{Let} \markbox{m18003}{$K > K_0=K_0(\mathfrak S)>0$} \markbox{18004}{be} \markbox{18005}{as} \markbox{18006}{in} \markbox{18007}{item} (2) \markbox{18008}{of} \markbox{18009}{that} theorem.  



Also \markbox{18010}{for} \markbox{18011}{the} \markbox{18012}{rest} \markbox{18013}{of} \markbox{18014}{this} section, \markbox{18015}{fix} \markbox{m18016}{$a,b,a',b' \in \calX$} \markbox{18017}{so} \markbox{18018}{that} \markbox{m18019}{$d_{\calX}(a,a'), d_{\calX}(b,b') \leq 1$}.  \markbox{18020}{We} \markbox{18021}{refer} \markbox{18022}{to} \markbox{18023}{the} \markbox{18024}{points} \markbox{m18025}{$a',b'$} \markbox{18026}{as} \markbox{18027}{a} \emph{perturbed pair} \markbox{18028}{from} \markbox{m18029}{$a,b$}.  \markbox{18030}{Let} \markbox{m18031}{$\calU = \Rel_{K}(a,b)$} \markbox{18032}{and} \markbox{m18033}{$\calU' = \Rel_{K}(a',b')$}.  \markbox{18034}{Let} \markbox{m18035}{$\{T_U\}_{U \in \calU}$} \markbox{18036}{and} \markbox{m18037}{$\{T'_U\}_{U \in \calU'}$} \markbox{18038}{denote} \markbox{18039}{the} \markbox{18040}{families} \markbox{18041}{of} \markbox{18042}{stable} \markbox{18043}{intervals} \markbox{18044}{produced} \markbox{18045}{as} above. 

The \markbox{18046}{first} \markbox{18047}{thing} \markbox{18048}{to} \markbox{18049}{observe} \markbox{18050}{is} \markbox{18051}{that} \markbox{18052}{item} (2)(a) \markbox{18053}{of} \markbox{18054}{Controlling} \markbox{18055}{Domains} \markbox{18056}{Theorem} \ref{thm:controlling domains} \markbox{18057}{provides} \markbox{18058}{that} 
\begin{enumerate}
\item \markbox{m18059}{$|\calU \triangle \calU'|<N_0 = N_0(\mathfrak S)$}, and
\item Each \markbox{18060}{domain} \markbox{m18061}{$V \in \calU \triangle \calU'$} \markbox{18062}{satisfies} \markbox{m18063}{$d_V(a,b) \leq K'$} \markbox{18064}{and} \markbox{m18065}{$d_V(a',b') \leq K'$}, \markbox{18066}{where} \markbox{m18067}{$|K-K'|$} \markbox{18068}{is} \markbox{18069}{bounded} \markbox{18070}{in} \markbox{18071}{terms} \markbox{18072}{of} \markbox{m18073}{$\mathfrak S$}.
\end{enumerate}

Item (2) \markbox{18074}{plus} \markbox{18075}{Lemma} \ref{lem:collapsed interval control} \markbox{18076}{says} \markbox{18077}{that} \markbox{18078}{each} \markbox{18079}{of} \markbox{18080}{the} \markbox{18081}{associated} \markbox{18082}{collapsed} \markbox{18083}{intervals} \markbox{m18084}{$\hT_V$} \markbox{18085}{or} \markbox{m18086}{$\hT'_V$} \markbox{18087}{for} \markbox{m18088}{$V\in \calU \triangle \calU'$} \markbox{18089}{has} \markbox{18090}{bounded} diameter.  \markbox{18091}{For} \markbox{18092}{the} \markbox{18093}{rest} \markbox{18094}{of} \markbox{18095}{the} domains, \markbox{18096}{namely} \markbox{18097}{the} \markbox{18098}{domains} \markbox{m18099}{$U \in \calU_0 = \calU \cap \calU'$}, \markbox{18100}{we} \markbox{18101}{want} \markbox{18102}{to} \markbox{18103}{obtain} \markbox{18104}{compatible} \markbox{18105}{stable} \markbox{18106}{decompositions} \markbox{18107}{between} \markbox{18108}{the} \markbox{18109}{intervals} \markbox{m18110}{$T_U$} \markbox{18111}{and} \markbox{m18112}{$T'_U$}, \markbox{18113}{which} \markbox{18114}{we} \markbox{18115}{do} \markbox{18116}{as} follows.

First, \markbox{18117}{observe} \markbox{18118}{that} \markbox{18119}{if} \markbox{m18120}{$V \nest U \in \calU_0$}, \markbox{18121}{then} \markbox{m18122}{$d_V(a,b)\geq K>\ES$} \markbox{18123}{and} \markbox{m18124}{$d_V(a',b') \geq K> \ES$}, \markbox{18125}{so} \markbox{18126}{the} \markbox{18127}{BGIA} \ref{ax:BGIA} \markbox{18128}{implies} \markbox{18129}{that} \markbox{m18130}{$\rho^V_U \subset \calN_{\ES}(\lambda_U(a,b)) \cap \calN_{\ES}(\lambda_U(a',b'))$}, \markbox{18131}{where} \markbox{m18132}{$\lambda_U$} \markbox{18133}{is} \markbox{18134}{the} \markbox{18135}{function} \markbox{18136}{which} \markbox{18137}{assigns} \markbox{18138}{a} \markbox{18139}{geodesic} \markbox{18140}{in} \markbox{m18141}{$\calC(U)$} \markbox{18142}{to} \markbox{18143}{any} \markbox{18144}{pair} \markbox{18145}{of} \markbox{18146}{points} \markbox{18147}{from} \markbox{18148}{Subsection} \ref{subsec:stable setup}.  \markbox{18149}{Hence} \markbox{18150}{taking} \markbox{m18151}{$\epsilon = 2\ES$} \markbox{18152}{in} \markbox{18153}{our} \markbox{18154}{stable} \markbox{18155}{tree} \markbox{18156}{setup} \markbox{18157}{suffices} \markbox{18158}{to} \markbox{18159}{make} \markbox{m18160}{$(\pi_U(a),\pi_U(b);\calY_U)$} \markbox{18161}{and} \markbox{m18162}{$(\pi_U(a'),\pi_U(b');\calY'_U)$} \markbox{18163}{into} \markbox{m18164}{$\epsilon$}-setups \markbox{18165}{in} \markbox{m18166}{$\calC(U)$} (item (1) \markbox{18167}{of} \markbox{18168}{Definition} \ref{defn:stable decomp}).

Moreover, \markbox{18169}{for} \markbox{18170}{each} \markbox{m18171}{$U \in \calU_0$}, \markbox{18172}{Theorem} \ref{thm:controlling domains} \markbox{18173}{provides} \markbox{18174}{that} 
\begin{itemize}
\item[(a)] \markbox{18175}{The} \markbox{m18176}{$\rho$}-sets \markbox{18177}{for} \markbox{18178}{the} \markbox{18179}{domains} \markbox{18180}{in} \markbox{m18181}{$\calU$} \markbox{18182}{and} \markbox{m18183}{$\calU'$} \markbox{18184}{which} \markbox{18185}{nest} \markbox{18186}{into} \markbox{m18187}{$U$}---namely \markbox{m18188}{$\calY_U$} \markbox{18189}{and} \markbox{m18190}{$\calY'_U$} respectively---satisfy \markbox{m18191}{$|\calY_U \triangle \calY'_U| < N_0 = N_0(\mathfrak S)$}, and
\item[(b)] \markbox{18192}{If} \markbox{m18193}{$\calU^*_0 \subset \calU_0$} \markbox{18194}{is} \markbox{18195}{the} \markbox{18196}{set} \markbox{18197}{of} \markbox{18198}{domains} \markbox{m18199}{$U \in \calU_0$} \markbox{18200}{for} \markbox{18201}{which} \markbox{m18202}{$\calY_U \neq \calY'_U$} \markbox{18203}{or} \markbox{m18204}{$\pi_U(a) \neq \pi_U(a')$} \markbox{18205}{or} \markbox{m18206}{$\pi_U(b) \neq \pi_U(b')$}, \markbox{18207}{then} \markbox{m18208}{$\#\calU^*_0 < N_0$}.
\end{itemize}

Hence, \markbox{18209}{by} \markbox{18210}{item} (a), \markbox{18211}{these} \markbox{m18212}{$\epsilon$}-setups \markbox{18213}{are} \markbox{m18214}{$(N_0, \epsilon)$}-admissible \markbox{18215}{in} \markbox{18216}{the} \markbox{18217}{sense} \markbox{18218}{of} \markbox{18219}{item} (2) \markbox{18220}{of} \markbox{18221}{Definition} \ref{defn:stable decomp} \markbox{18222}{for} \markbox{18223}{all} \markbox{18224}{domains} \markbox{18225}{in} \markbox{m18226}{$\calU_0$}, \markbox{18227}{while} \markbox{18228}{item} (b) \markbox{18229}{says} \markbox{18230}{that} \markbox{18231}{for} \markbox{18232}{domains} \markbox{18233}{in} \markbox{m18234}{$\calU_0 - \calU^*_0$}, \markbox{18235}{these} \markbox{m18236}{$\epsilon$}-setups \markbox{18237}{exactly} coincide.  \markbox{18238}{Thus} \markbox{18239}{item} (2) \markbox{18240}{of} \markbox{18241}{the} \markbox{18242}{Stable} \markbox{18243}{Intervals} \markbox{18244}{Theorem} \ref{thm:stable intervals} \markbox{18245}{implies} \markbox{18246}{that} \markbox{18247}{the} \markbox{m18248}{$(r_1,r_2)$}-thickenings \markbox{18249}{of} \markbox{18250}{their} \markbox{18251}{stable} \markbox{18252}{intervals} \markbox{m18253}{$T_U, T'_U$} \markbox{18254}{admit} \markbox{m18255}{$L_s$}-compatible \markbox{18256}{stable} decompositions, \markbox{18257}{where} \markbox{m18258}{$L_s=L_s(\mathfrak S)>0$} \markbox{18259}{by} \markbox{18260}{choosing} \markbox{m18261}{$r_1 = \max\{R_1,R_3\}$} \markbox{18262}{and} \markbox{m18263}{$r_2 = R_2$}, \markbox{18264}{since} \markbox{18265}{the} \markbox{18266}{constants} \markbox{m18267}{$R_i = R_i(\mathfrak S)>0$} \markbox{18268}{depend} \markbox{18269}{only} \markbox{18270}{on} \markbox{m18271}{$\mathfrak S$}.  \markbox{18272}{In} particular, \markbox{18273}{we} have:

\begin{proposition}\label{prop:stable interval decomp}
For \markbox{18274}{each} \markbox{m18275}{$U \in \calU_0$}, \markbox{18276}{the} \markbox{m18277}{$(r_1,r_2)$}-thickenings \markbox{18278}{of} \markbox{18279}{the} \markbox{18280}{stable} \markbox{18281}{intervals} \markbox{m18282}{$T_U = T_{U,e} \cup T_{U,c}$} \markbox{18283}{and} \markbox{m18284}{$T'_U = T'_{U,e} \cup T'_{U,c}$} \markbox{18285}{along} \markbox{m18286}{$T_{U,c}, T'_{U,c}$} \markbox{18287}{respectively} \markbox{18288}{admit} \markbox{m18289}{$L_s$}-compatible \markbox{18290}{stable} decompositions, \markbox{18291}{where} \markbox{m18292}{$L_s = L_s(\mathfrak S)>0$}.
\begin{itemize}
\item Moreover, \markbox{18293}{if} \markbox{m18294}{$U \in \calU_0 - \calU^*_0$}, \markbox{18295}{then} \markbox{m18296}{$T_U = T'_U$} \markbox{18297}{and} \markbox{18298}{these} \markbox{18299}{thickenings} \markbox{18300}{coincide} exactly.
\end{itemize}
\end{proposition}

For \markbox{18301}{each} \markbox{m18302}{$U \in \calU_0$}, \markbox{18303}{let} \markbox{m18304}{$\Delta_U:\hT_U \to \hT_{U,0}$} \markbox{18305}{and} \markbox{m18306}{$\Delta'_U:\hT'_U \to \hT'_{U,0}$} \markbox{18307}{denote} \markbox{18308}{the} \markbox{18309}{maps} \markbox{18310}{which} \markbox{18311}{collapse} \markbox{18312}{the} \markbox{18313}{unstable} \markbox{18314}{components} \markbox{18315}{these} \markbox{18316}{decompositions} \markbox{18317}{to} points; \markbox{18318}{we} \markbox{18319}{note} \markbox{18320}{that} \markbox{18321}{these} \markbox{18322}{maps} \markbox{18323}{are} \markbox{18324}{the} \markbox{18325}{identity} \markbox{18326}{when} \markbox{m18327}{$U \in \calU_0- \calU^*_0$}.  \markbox{18328}{By} \markbox{18329}{Definition} \ref{defn:stable decomp} \markbox{18330}{of} \markbox{18331}{a} \markbox{18332}{stable} decomposition, \markbox{18333}{the} \markbox{18334}{subintervals} \markbox{18335}{of} \markbox{18336}{the} \markbox{m18337}{$\hT_U$} \markbox{18338}{and} \markbox{m18339}{$\hT'_U$} \markbox{18340}{being} \markbox{18341}{collapsed} \markbox{18342}{for} \markbox{m18343}{$U \in \calU_0$} \markbox{18344}{along} \markbox{18345}{with} \markbox{18346}{the} \markbox{18347}{whole} \markbox{18348}{intervals} \markbox{m18349}{$\hT_V, \hT'_V$} (whichever \markbox{18350}{is} defined) \markbox{18351}{for} \markbox{m18352}{$V \in \calU \triangle \calU'$} \markbox{18353}{collectively} \markbox{18354}{form} \markbox{m18355}{$(L_s^2+2K'N_0)$}-admissible \markbox{18356}{simplicial} \markbox{18357}{trimming} \markbox{18358}{setups} \markbox{18359}{for} \markbox{m18360}{$\{\hT_U\}_{U \in \calU}$} \markbox{18361}{and} \markbox{m18362}{$\{\hT'_U\}_{U \in \calU'}$}, \markbox{18363}{in} \markbox{18364}{the} \markbox{18365}{sense} \markbox{18366}{of} \markbox{18367}{Definition} \ref{defn:simplicial trimming setup}.  \markbox{18368}{This} \markbox{18369}{is} \markbox{18370}{because} \markbox{18371}{the} \markbox{18372}{set} \markbox{m18373}{$(\calU \cup \calU') - \calU_0$} \markbox{18374}{has} \markbox{18375}{at} \markbox{18376}{most} \markbox{m18377}{$N_0$}-many \markbox{18378}{domains} \markbox{18379}{by} (1) above, \markbox{18380}{each} \markbox{18381}{of} \markbox{18382}{which} \markbox{18383}{has} \markbox{18384}{diameter} \markbox{18385}{bounded} \markbox{18386}{by} \markbox{m18387}{$K'$}, \markbox{18388}{while} \markbox{18389}{the} \markbox{18390}{unstable} \markbox{18391}{pieces} \markbox{18392}{for} \markbox{18393}{the} \markbox{18394}{domains} \markbox{18395}{in} \markbox{m18396}{$\calU_0$} \markbox{18397}{consist} \markbox{18398}{of} \markbox{18399}{at} \markbox{18400}{most} \markbox{m18401}{$L_2$}-many \markbox{18402}{pieces} \markbox{18403}{of} \markbox{18404}{diameter} \markbox{18405}{at} \markbox{18406}{most} \markbox{m18407}{$L_2$}.

Set \markbox{m18408}{$L_2^2 + 2K'N_0 = S_0$}, \markbox{18409}{which} \markbox{18410}{we} \markbox{18411}{note} \markbox{18412}{depends} \markbox{18413}{only} \markbox{18414}{on} \markbox{m18415}{$\mathfrak S$} \markbox{18416}{and} \markbox{18417}{our} \markbox{18418}{choice} \markbox{18419}{of} \markbox{m18420}{$K$}.  \markbox{18421}{We} \markbox{18422}{now} \markbox{18423}{obtain} \markbox{18424}{the} \markbox{18425}{following} \markbox{18426}{from} \markbox{18427}{Theorem} \ref{thm:simplicial tree trimming} \markbox{18428}{and} \markbox{18429}{Proposition} \ref{prop:stable interval decomp}:

\begin{proposition} \label{prop:stable collapse}
The \markbox{18430}{following} hold:
\begin{enumerate}
\item The \markbox{18431}{collections} \markbox{m18432}{$\{\hT_{U,0}\}_{U \in \calU_0}$} \markbox{18433}{and} \markbox{m18434}{$\{\hT'_{U,0}\}_{U \in \calU_0}$} \markbox{18435}{are} HFIs.  \markbox{18436}{Let} \markbox{m18437}{$\calQ_0, \calQ'_0$} \markbox{18438}{denote} \markbox{18439}{their} \markbox{18440}{corresponding} \markbox{m18441}{$0$}-consistent subsets.
\item The \markbox{18442}{combined} \markbox{18443}{maps} \markbox{m18444}{$\Delta:\calQ \to \calQ_0$} \markbox{18445}{and} \markbox{m18446}{$\Delta':\calQ' \to \calQ'_0$} \markbox{18447}{satisfy} \markbox{m18448}{$\Delta(\calQ) = \calQ_0$} \markbox{18449}{and} \markbox{m18450}{$\Delta'(\calQ') = \calQ'_0$} \markbox{18451}{and} \markbox{18452}{are} \markbox{18453}{both} \markbox{m18454}{$(1, S_0^2)$}-quasi-isometries.
\item There \markbox{18455}{exists} \markbox{18456}{maps} \markbox{m18457}{$\Xi:\calQ_0 \to \calQ$} \markbox{18458}{and} \markbox{m18459}{$\Xi':\calQ'_0 \to \calQ'$} \markbox{18460}{with} \markbox{m18461}{$\Delta \circ \Xi = id_{\calQ_0}$} \markbox{18462}{and} \markbox{m18463}{$\Delta' \circ \Xi' = id_{\calQ'_0}$}.
\item At \markbox{18464}{the} \markbox{18465}{level} \markbox{18466}{of} \markbox{18467}{cube} complexes, \markbox{18468}{the} \markbox{18469}{maps} \markbox{m18470}{$\Delta\calQ \to \calQ_0$} \markbox{18471}{and} \markbox{m18472}{$\Delta':\calQ' \to \calQ'_0$} \markbox{18473}{delete} \markbox{18474}{at} \markbox{18475}{most} \markbox{m18476}{$S_0^2$}-many hyperplanes.
\end{enumerate}
\end{proposition}

Using \markbox{18477}{this} proposition, \markbox{18478}{we} \markbox{18479}{can} \markbox{18480}{define} \markbox{18481}{maps} \markbox{m18482}{$\hO_0:\calQ_0 \to \calX$} \markbox{18483}{and} \markbox{m18484}{$\hO'_0:\calQ'_0 \to \calX$} \markbox{18485}{by} \markbox{m18486}{$\hO_0 = \hO \circ \Xi$} \markbox{18487}{and} \markbox{m18488}{$\hO'_0 = \hO' \circ \Xi'$}, \markbox{18489}{where} \markbox{m18490}{$\hO:\calQ \to \calX$} \markbox{18491}{and} \markbox{m18492}{$\hO':\calQ \to \calX$} \markbox{18493}{are} \markbox{18494}{the} quasi-isometric \markbox{18495}{embeddings} \markbox{18496}{defined} \markbox{18497}{Subsection} \ref{subsec:upgrade to HHS}.

For \markbox{18498}{the} \markbox{18499}{final} \markbox{18500}{piece} \markbox{18501}{of} setup, \markbox{18502}{we} \markbox{18503}{want} \markbox{18504}{to} \markbox{18505}{observe} \markbox{18506}{that} \markbox{18507}{these} \markbox{18508}{HFIs} \markbox{m18509}{$\{\hT_{U,0}\}_{U \in \calU_0}$} \markbox{18510}{and} \markbox{m18511}{$\{\hT'_{U,0}\}_{U \in \calU_0}$} \markbox{18512}{admit} \markbox{18513}{an} \markbox{18514}{isomorphism} \markbox{18515}{in} \markbox{18516}{the} \markbox{18517}{sense} \markbox{18518}{of} \markbox{18519}{Proposition} \ref{prop:HFI isomorphism}.  \markbox{18520}{For} this, \markbox{18521}{we} \markbox{18522}{require} \markbox{18523}{the} \markbox{18524}{following} lemma, \markbox{18525}{whose} \markbox{18526}{proof} \markbox{18527}{is} \markbox{18528}{a} \markbox{18529}{straightforward} \markbox{18530}{application} \markbox{18531}{of} \markbox{18532}{the} \markbox{18533}{definitions} \markbox{18534}{and} \markbox{18535}{Corollary} \ref{cor:interval isometry}.  

\begin{lemma}\label{lem:interval isometries}
For \markbox{18536}{each} \markbox{m18537}{$U \in \calU^*_0$}, \markbox{18538}{the} \markbox{18539}{isometry} \markbox{m18540}{$i_U:\hT_{U,0} \to \hT'_{U,0}$} \markbox{18541}{provided} \markbox{18542}{by} \markbox{18543}{Corollary} \ref{cor:interval isometry} \markbox{18544}{satisfies} \markbox{18545}{the} \markbox{18546}{conditions} \markbox{18547}{of} \markbox{18548}{Proposition} \ref{prop:HFI isomorphism}.
\begin{itemize}
\item Thus \markbox{18549}{these} component-wise \markbox{18550}{isometries} \markbox{18551}{combine} \markbox{18552}{to} \markbox{18553}{give} \markbox{18554}{an} \markbox{18555}{isometry} \markbox{m18556}{$I_0:\calQ_0 \to \calQ'_0$}. 
\end{itemize}


\end{lemma}




\subsection{Statement of the stable cubulations theorem}

We \markbox{18557}{are} \markbox{18558}{now} \markbox{18559}{ready} \markbox{18560}{to} \markbox{18561}{state} \markbox{18562}{the} \markbox{18563}{stable} \markbox{18564}{cubical} \markbox{18565}{intervals} theorem:

\begin{theorem}[Stable \markbox{18566}{cubical} intervals]\label{thm:stable cubes}
Continuing \markbox{18567}{with} \markbox{18568}{our} \markbox{18569}{standing} notation, \markbox{18570}{there} \markbox{18571}{exists} \markbox{m18572}{$\Sigma = \Sigma(\mathfrak S, K)>0$} \markbox{18573}{so} \markbox{18574}{that} \markbox{18575}{the} \markbox{18576}{following} \markbox{18577}{diagram} \markbox{18578}{commutes} \markbox{18579}{up} \markbox{18580}{to} \markbox{18581}{error} \markbox{m18582}{$\Sigma$}:
\begin{equation}\label{Phi diagram}
  \begin{tikzcd}
   \calQ \arrow[ddrr,"\hO", bend left=40] \arrow[dr,"\Delta_0 \hspace{.075in}" left] &  \\
    &\calQ_{0} \arrow[dr,"\hO_0 \hspace{.2in}" below]\arrow[dd, "I_0"] \\
    & & \calX\\
    & \calQ'_{0} \arrow[ur,"\hO'_0"] \\
    \calQ'\arrow[uurr,"\hspace{.2in} \vspace{.1in} \hO'" below, bend right=40] \arrow[ur,"\Delta'_0"] & \\
  \end{tikzcd}
  \end{equation}

\begin{itemize}
\item In \markbox{18583}{the} above, \markbox{m18584}{$I_0:\calQ_0 \to \calQ'_0$} \markbox{18585}{is} \markbox{18586}{the} \markbox{18587}{isomorphism} \markbox{18588}{from} \markbox{18589}{Lemma} \ref{lem:interval isometries}.
\item In particular, \markbox{18590}{any} \markbox{18591}{colorable} \markbox{18592}{hierarchically} \markbox{18593}{hyperbolic} \markbox{18594}{space} \markbox{18595}{is} \markbox{m18596}{$\Sigma$}-stably \markbox{18597}{weakly} \markbox{18598}{locally} quasi-cubical (Definition \ref{defn:stable cubes}). 
\end{itemize}
\end{theorem}

\begin{proof}

It \markbox{18599}{remains} \markbox{18600}{to} \markbox{18601}{prove} \markbox{18602}{that} \markbox{18603}{the} upper, lower, \markbox{18604}{and} \markbox{18605}{middle} \markbox{18606}{triangles} \markbox{18607}{coarsely} commute.  \markbox{18608}{The} \markbox{18609}{proof} \markbox{18610}{for} \markbox{18611}{the} \markbox{18612}{upper} (and \markbox{18613}{hence} \markbox{18614}{the} lower) \markbox{18615}{is} \markbox{18616}{essentially} \markbox{18617}{automatic} \markbox{18618}{by} construction.  \markbox{18619}{In} particular, \markbox{18620}{by} \markbox{18621}{item} (2) \markbox{18622}{of} \markbox{18623}{Proposition} \ref{prop:stable collapse}, \markbox{18624}{the} \markbox{18625}{map} \markbox{m18626}{$\Delta_0:\calQ \to \calQ_0$} \markbox{18627}{is} \markbox{18628}{a} \markbox{m18629}{$(1,S^2_0)$}-quasi-isometry \markbox{18630}{for} \markbox{m18631}{$S_0 = S_0(\mathfrak S, K)>0$}.  \markbox{18632}{On} \markbox{18633}{the} \markbox{18634}{other} hand, \markbox{18635}{item} (3) \markbox{18636}{of} \markbox{18637}{that} \markbox{18638}{proposition} \markbox{18639}{implies} \markbox{18640}{that} \markbox{m18641}{$\Delta_0 \circ \Xi = id_{\calQ_0}$} \markbox{18642}{while} \markbox{m18643}{$\hO_0:\calQ_0 \to \calX$} \markbox{18644}{is} \markbox{18645}{defined} \markbox{18646}{by} \markbox{m18647}{$\hO_0 = \hO \circ \Xi$}.  \markbox{18648}{Hence} \markbox{18649}{the} \markbox{18650}{top} \markbox{18651}{triangle} \markbox{18652}{commutes} \markbox{18653}{up} \markbox{18654}{to} \markbox{18655}{error} \markbox{m18656}{$S_0$}, \markbox{18657}{and} \markbox{18658}{the} \markbox{18659}{same} \markbox{18660}{holds} \markbox{18661}{for} \markbox{18662}{the} \markbox{18663}{bottom} triangle.

For \markbox{18664}{the} \markbox{18665}{middle} triangle, \markbox{18666}{we} \markbox{18667}{want} \markbox{18668}{to} \markbox{18669}{show} \markbox{18670}{that} \markbox{m18671}{$d_{\calX}(\hO_0(\hx), \hO'_0 \circ I_0(\hx))$} \markbox{18672}{is} \markbox{18673}{bounded} \markbox{18674}{in} \markbox{18675}{terms} \markbox{18676}{of} \markbox{m18677}{$\mathfrak S, K$} \markbox{18678}{for} \markbox{18679}{any} \markbox{m18680}{$\hx \in \calQ_0$}.  However, \markbox{18681}{we} \markbox{18682}{note} \markbox{18683}{that} \markbox{18684}{the} \markbox{18685}{maps} \markbox{m18686}{$\hO_0:\calQ_0 \to H$} \markbox{18687}{and} \markbox{m18688}{$\Delta_0 \circ \hPsi:H \to \calQ_0$} \markbox{18689}{are} quasi-inverses (with \markbox{18690}{errors} \markbox{18691}{depending} \markbox{18692}{on} \markbox{m18693}{$\mathfrak S, K$}), \markbox{18694}{and} \markbox{18695}{similarly} \markbox{18696}{for} \markbox{m18697}{$\hO'_0:\calQ'_0 \to H'$} \markbox{18698}{and} \markbox{m18699}{$\Delta_0 \circ \hPsi:H' \to \calQ'_0$}.  Here, \markbox{m18700}{$H = \hull_{\calX}(a,b)$} \markbox{18701}{and} \markbox{m18702}{$H' = \hull_{\calX}(a',b')$}.  \markbox{18703}{But} \markbox{18704}{since} \markbox{m18705}{$d_{\calX}(a,a')\leq 1$} \markbox{18706}{and} \markbox{m18707}{$d_{\calX}(b,b')\leq 1$}, \markbox{18708}{it} \markbox{18709}{follows} \markbox{18710}{from} \markbox{18711}{the} \markbox{18712}{Distance} \markbox{18713}{Formula} \ref{thm:DF} \markbox{18714}{and} \markbox{18715}{Definition} \ref{defn:hier hull} \markbox{18716}{that} \markbox{m18717}{$d^{Haus}_{\calX}(H,H')$} \markbox{18718}{is} \markbox{18719}{bounded} \markbox{18720}{in} \markbox{18721}{terms} \markbox{18722}{of} \markbox{m18723}{$\mathfrak S$}.

Hence \markbox{18724}{it} \markbox{18725}{suffices} \markbox{18726}{to} \markbox{18727}{show} \markbox{18728}{that} \markbox{18729}{for} \markbox{m18730}{$x \in H \cap H'$} (so \markbox{18731}{that} \markbox{m18732}{$\hPsi(x)$} \markbox{18733}{and} \markbox{m18734}{$\hPsi'(x)$} \markbox{18735}{are} \markbox{18736}{both} defined), \markbox{18737}{we} have
$$d_{\calQ'_0}(\Delta'_0 \circ \hPsi'(x), I_0 \circ \Delta_0 \circ \hPsi(x))< \Sigma,$$
for \markbox{m18738}{$\Sigma = \Sigma(\mathfrak S, K)$}.  \markbox{18739}{Set} \markbox{m18740}{$\Delta'_0 \circ \hPsi'(x) = \hx'_0 = (\hx'_{U,0})$} \markbox{18741}{and} \markbox{m18742}{$I_0 \circ \Delta_0 \circ \hPsi(x) = \hy'_0= (\hy'_{U,0})$}, \markbox{18743}{where} \markbox{18744}{we} \markbox{18745}{note} \markbox{18746}{that} \markbox{18747}{both} \markbox{m18748}{$\hx'_0,\hy'_0 \in \calQ'_0$}.  

We \markbox{18749}{argue} component-wise \markbox{18750}{that} \markbox{m18751}{$d_{\calQ'_0}(\hx'_0,\hy'_0)$} \markbox{18752}{is} bounded.  \markbox{18753}{Recall} \markbox{18754}{that} \markbox{18755}{the} \markbox{18756}{map} \markbox{m18757}{$\hPsi:H \to \calQ$} \markbox{18758}{is} \markbox{18759}{defined} component-wise (over \markbox{18760}{the} \markbox{18761}{set} \markbox{m18762}{$\calU$}) \markbox{18763}{by} \markbox{m18764}{$\hpsi_U = q_U \circ \phi_U^{-1} \circ p_U \circ \pi_U$}, \markbox{18765}{where} \markbox{m18766}{$\pi_U:\calX \to \calC(U)$} \markbox{18767}{is} \markbox{18768}{the} \markbox{18769}{HHS} projection, \markbox{m18770}{$p_U:\calC(U) \to \phi_U(T_U)$} \markbox{18771}{is} \markbox{18772}{closest} \markbox{18773}{point} projection, \markbox{m18774}{$\phi_U:T_U \to \calC(U)$} \markbox{18775}{is} \markbox{18776}{the} \markbox{m18777}{$(L_0,L_0)$}-quasi-isometric \markbox{18778}{embedding} \markbox{18779}{provided} \markbox{18780}{by} \markbox{18781}{Proposition} \ref{prop:stable interval structure} (here \markbox{m18782}{$L_0=L_0(\mathfrak S)$}), \markbox{18783}{and} \markbox{m18784}{$q_U:T_U \to \hT_U$} \markbox{18785}{is} \markbox{18786}{the} \markbox{18787}{map} \markbox{18788}{which} \markbox{18789}{collapses} \markbox{18790}{a} \markbox{18791}{uniform} \markbox{18792}{thickening} \markbox{18793}{of} \markbox{m18794}{$T_U$} \markbox{18795}{along} \markbox{18796}{the} \markbox{18797}{cluster} components, \markbox{18798}{with} \markbox{18799}{constants} \markbox{18800}{depending} \markbox{18801}{only} \markbox{18802}{on} \markbox{m18803}{$\mathfrak S$}.  \markbox{18804}{The} \markbox{18805}{map} \markbox{m18806}{$\hPsi':H' \to \calQ'$} \markbox{18807}{is} \markbox{18808}{defined} similarly.

First, \markbox{18809}{we} \markbox{18810}{can} \markbox{18811}{reduce} \markbox{18812}{to} \markbox{18813}{involved} \markbox{18814}{domains} \markbox{18815}{in} \markbox{m18816}{$\calU_0 = \calU \cap \calU'$}.  \markbox{18817}{If} \markbox{m18818}{$U \in \calU \triangle \calU'$}, \markbox{18819}{then} \markbox{m18820}{$a,b$} \markbox{18821}{and} \markbox{m18822}{$a',b'$} \markbox{18823}{have} \markbox{18824}{bounded} \markbox{18825}{diameter} \markbox{18826}{projections} \markbox{18827}{to} \markbox{m18828}{$U$} \markbox{18829}{in} \markbox{18830}{terms} \markbox{18831}{of} \markbox{m18832}{$K$} \markbox{18833}{and} \markbox{m18834}{$\mathfrak S$}, \markbox{18835}{while} \markbox{18836}{also} \markbox{18837}{each} \markbox{18838}{such} \markbox{18839}{domain} \markbox{18840}{is} \markbox{18841}{involved} \markbox{18842}{in} \markbox{18843}{the} \markbox{18844}{sense} \markbox{18845}{of} \markbox{18846}{Definition} \ref{defn:involved} \markbox{18847}{and} \markbox{18848}{hence} \markbox{18849}{there} \markbox{18850}{are} \markbox{18851}{only} boundedly-many \markbox{18852}{by} \markbox{18853}{Theorem} \ref{thm:controlling domains}. \markbox{18854}{Next} \markbox{18855}{observe} \markbox{18856}{that} \markbox{18857}{if} \markbox{m18858}{$U \in \calU_0$} \markbox{18859}{is} \markbox{18860}{not} involved, \markbox{18861}{then} \markbox{18862}{the} \markbox{18863}{stable} \markbox{18864}{trees} \markbox{m18865}{$T_U, T'_U$} \markbox{18866}{for} \markbox{18867}{the} \markbox{18868}{two} \markbox{18869}{setups} \markbox{18870}{are} \markbox{18871}{exactly} \markbox{18872}{the} same, \markbox{18873}{and} \markbox{18874}{hence} \markbox{18875}{have} \markbox{18876}{identical} thickenings, \markbox{18877}{and} \markbox{18878}{thus} \markbox{18879}{the} \markbox{18880}{stable} \markbox{18881}{decompositions} \markbox{18882}{the} \markbox{18883}{pair} \markbox{18884}{are} \markbox{18885}{the} (identical) \markbox{18886}{collection} \markbox{18887}{of} \markbox{18888}{edge} \markbox{18889}{components} \markbox{18890}{for} each, \markbox{18891}{and} \markbox{18892}{their} \markbox{18893}{corresponding} \markbox{18894}{collapsed} \markbox{18895}{trees} \markbox{m18896}{$\hT_U$} \markbox{18897}{and} \markbox{m18898}{$\hT'_U$} \markbox{18899}{are} identical.  Hence, \markbox{18900}{for} \markbox{18901}{uninvolved} \markbox{m18902}{$U \in \calU_0$}, \markbox{18903}{we} \markbox{18904}{have} \markbox{m18905}{$\hx'_{U,0} = \hy'_{U,0}$}.

Let \markbox{m18906}{$U \in \calU_0$} \markbox{18907}{be} involved.  \markbox{18908}{Since} \markbox{18909}{there} \markbox{18910}{are} boundedly-many (in \markbox{m18911}{$\mathfrak S$}) \markbox{18912}{such} \markbox{18913}{domains} \markbox{18914}{by} \markbox{18915}{Theorem} \ref{thm:controlling domains}, \markbox{18916}{it} \markbox{18917}{suffices} \markbox{18918}{to} \markbox{18919}{bound} \markbox{18920}{the} \markbox{18921}{diameter} \markbox{m18922}{$d_{\hT'_{U,0}}(\hx'_{U,0}, \hy'_{U,0})$} \markbox{18923}{in} \markbox{18924}{terms} \markbox{18925}{of} \markbox{m18926}{$\mathfrak S$}.

  \markbox{18927}{The} \markbox{18928}{distance} \markbox{m18929}{$d_{\hT'_{U,0}}(\hx'_{U,0}, \hy'_{U,0})$} \markbox{18930}{is} \markbox{18931}{measured} \markbox{18932}{in} \markbox{18933}{the} \markbox{18934}{edge} \markbox{18935}{components} \markbox{18936}{of} \markbox{m18937}{$\hT'_{U,0}$} \markbox{18938}{which} \markbox{18939}{separate} them, \markbox{18940}{and} \markbox{18941}{these} \markbox{18942}{edge} \markbox{18943}{components} \markbox{18944}{are} \markbox{18945}{stable} \markbox{18946}{components} \markbox{18947}{of} \markbox{m18948}{$T'_U$}.  \markbox{18949}{This} \markbox{18950}{means} \markbox{18951}{that} \markbox{18952}{if} \markbox{18953}{the} \markbox{18954}{distance} \markbox{m18955}{$d_{\hT'_{U,0}}(\hx'_{U,0}, \hy'_{U,0})$} \markbox{18956}{is} \markbox{18957}{very} large, \markbox{18958}{then} \markbox{18959}{there} \markbox{18960}{must} \markbox{18961}{be} \markbox{18962}{either} 
\begin{enumerate}
\item some \markbox{18963}{long} \markbox{18964}{stable} \markbox{18965}{component} \markbox{m18966}{$E' \subset T'_{U,s}$} \markbox{18967}{so} \markbox{18968}{that} \markbox{18969}{some} \markbox{18970}{long} \markbox{18971}{segment} \markbox{18972}{of} \markbox{m18973}{$\Delta'_U(q'_U(E'))$} \markbox{18974}{separates} \markbox{m18975}{$\hx'_{U,0}$} \markbox{18976}{from} \markbox{m18977}{$\hy'_{U,0}$}, or
\item if \markbox{18978}{no} \markbox{18979}{such} \markbox{18980}{long} \markbox{18981}{component} exists, \markbox{18982}{there} \markbox{18983}{must} \markbox{18984}{be} \markbox{18985}{some} \markbox{18986}{large} \markbox{18987}{number} \markbox{18988}{of} \markbox{18989}{such} \markbox{18990}{stable} \markbox{18991}{components} \markbox{18992}{separating} them.
\end{enumerate}

In \markbox{18993}{case} (1), \markbox{18994}{let} \markbox{m18995}{$E \subset T_{U,s}$} \markbox{18996}{be} \markbox{18997}{the} \markbox{18998}{stable} \markbox{18999}{component} \markbox{19000}{paired} \markbox{19001}{with} \markbox{m19002}{$E' \subset T'_{U,s}$}.  \markbox{19003}{Note} \markbox{19004}{that} \markbox{m19005}{$\phi_U(E) \cup \phi'_U(E')$} \markbox{19006}{is} \markbox{19007}{uniformly} quasi-convex (in \markbox{m19008}{$\mathfrak S$}), \markbox{19009}{and} \markbox{19010}{hence} \markbox{m19011}{$\pi_U(x)$} \markbox{19012}{has} \markbox{19013}{a} \markbox{19014}{uniformly} \markbox{19015}{bounded} \markbox{19016}{projection} \markbox{19017}{to} it.  \markbox{19018}{However} \markbox{19019}{the} \markbox{19020}{fact} \markbox{19021}{that} \markbox{19022}{a} \markbox{19023}{long} \markbox{19024}{segment} \markbox{19025}{of} \markbox{m19026}{$\Delta'_U(q_U(E')) \subset \hT'_{U,0}$} \markbox{19027}{separates} \markbox{m19028}{$\hx'_{U,0}$} \markbox{19029}{from} \markbox{m19030}{$\hy'_{U,0}$} \markbox{19031}{means} \markbox{19032}{that} \markbox{19033}{some} \markbox{19034}{large} \markbox{19035}{diameter} \markbox{19036}{portion} \markbox{19037}{of} \markbox{m19038}{$\phi_U(E) \cup \phi'_U(E')$} \markbox{19039}{coarsely} (in \markbox{m19040}{$\mathfrak S$}) \markbox{19041}{separates} \markbox{m19042}{$p_U(\pi_U(x))$} \markbox{19043}{from} \markbox{m19044}{$p'_U(\pi_U(x))$}, \markbox{19045}{which} \markbox{19046}{is} impossible.

In \markbox{19047}{case} (2), \markbox{19048}{we} \markbox{19049}{can} \markbox{19050}{assume} \markbox{19051}{that} \markbox{19052}{no} \markbox{19053}{such} \markbox{19054}{long} \markbox{19055}{stable} \markbox{19056}{component} exists, \markbox{19057}{so} \markbox{19058}{that} \markbox{19059}{the} \markbox{19060}{distance} \markbox{m19061}{$d_{\hT'_{U,0}}(\hx'_{U,0}, \hy'_{U,0})$} \markbox{19062}{corresponds} \markbox{19063}{to} \markbox{19064}{some} \markbox{19065}{sequence} \markbox{m19066}{$E'_1, \dots, E'_n \subset T'_{U,s}$} \markbox{19067}{of} \markbox{19068}{short} \markbox{19069}{stable} \markbox{19070}{components} \markbox{19071}{of} \markbox{19072}{length} \markbox{19073}{bounded} \markbox{19074}{in} \markbox{19075}{terms} \markbox{19076}{of} \markbox{m19077}{$\mathfrak S$}.  \markbox{19078}{Let} \markbox{m19079}{$E_i \subset T_{U,s}$} \markbox{19080}{denote} \markbox{19081}{the} \markbox{19082}{stable} \markbox{19083}{component} \markbox{19084}{paired} \markbox{19085}{with} \markbox{m19086}{$E'_i$}.  \markbox{19087}{By} \markbox{19088}{Proposition} \ref{prop:stable interval structure} \markbox{19089}{and} \markbox{19090}{the} \markbox{19091}{fact} \markbox{19092}{that} \markbox{m19093}{$d_{\calX}(a,a') \leq 1$} \markbox{19094}{and} \markbox{m19095}{$d_{\calX}(b,b')\leq 1$}, \markbox{19096}{we} \markbox{19097}{have} \markbox{19098}{that} \markbox{m19099}{$\phi_U(T_U)$} \markbox{19100}{and} \markbox{m19101}{$\phi'_U(T'_U)$} \markbox{19102}{are} \markbox{19103}{within} \markbox{19104}{bounded} (in \markbox{m19105}{$\mathfrak S$}) \markbox{19106}{Hausdorff} \markbox{19107}{distance} \markbox{19108}{in} \markbox{m19109}{$\calC(U)$}.  \markbox{19110}{Since} \markbox{19111}{each} \markbox{19112}{of} \markbox{19113}{the} \markbox{m19114}{$E'_i$} \markbox{19115}{are} \markbox{19116}{uniformly} \markbox{19117}{close} (in \markbox{m19118}{$\mathfrak S$}) \markbox{19119}{to} \markbox{m19120}{$E_i$} \markbox{19121}{and} \markbox{19122}{the} \markbox{19123}{bijection} \markbox{m19124}{$\alpha:\pi_0(T_{U,s}) \to \pi_0(T'_{U,s})$} \markbox{19125}{is} order-preserving, \markbox{19126}{it} \markbox{19127}{follows} \markbox{19128}{that} \markbox{19129}{the} \markbox{19130}{hulls} \markbox{m19131}{$\hull_{\phi_U(T_U)}(E_1, E_n)$} \markbox{19132}{and} \markbox{m19133}{$\hull_{\phi'_U(T'_U)}(E'_1,E'_n)$} \markbox{19134}{are} \markbox{19135}{within} \markbox{19136}{uniform} (in \markbox{m19137}{$\mathfrak S$}) \markbox{19138}{Hausdorff} \markbox{19139}{distance} \markbox{19140}{of} \markbox{19141}{each} other, \markbox{19142}{and} \markbox{19143}{hence} \markbox{19144}{their} \markbox{19145}{union} \markbox{19146}{is} \markbox{19147}{uniformly} quasi-convex (in \markbox{m19148}{$\mathfrak S$}).  Thus, \markbox{19149}{if} \markbox{m19150}{$\Delta'_U(q'_U(E'_1)), \dots, \Delta'_U(q'_U(E'_n))$} \markbox{19151}{separate} \markbox{m19152}{$\hx'_{U,0}$} \markbox{19153}{from} \markbox{m19154}{$\hy'_{U,0}$} \markbox{19155}{in} \markbox{m19156}{$\hT'_{U,0}$}, \markbox{19157}{then} \markbox{19158}{the} \markbox{19159}{union} \markbox{19160}{of} \markbox{19161}{these} \markbox{19162}{hulls} \markbox{19163}{coarsely} (in \markbox{m19164}{$\mathfrak S$}) \markbox{19165}{separates} \markbox{m19166}{$p_U(\pi_U(x))$} \markbox{19167}{from} \markbox{m19168}{$p'_U(\pi_U(x))$}.

Since \markbox{19169}{each} \markbox{19170}{of} \markbox{19171}{the} \markbox{19172}{segments} \markbox{m19173}{$E'_i$} \markbox{19174}{is} \markbox{19175}{bounded} length, \markbox{19176}{the} \markbox{19177}{union} \markbox{19178}{of} \markbox{19179}{these} \markbox{19180}{hulls} \markbox{19181}{is} \markbox{19182}{long} \markbox{19183}{if} \markbox{19184}{the} \markbox{19185}{number} \markbox{19186}{of} \markbox{19187}{segments} \markbox{m19188}{$n$} \markbox{19189}{is} \markbox{19190}{very} large.  Moreover, \markbox{19191}{each} \markbox{19192}{pair} \markbox{19193}{of} \markbox{19194}{segments} \markbox{m19195}{$E'_i, E'_{i+1}$} \markbox{19196}{is} \markbox{19197}{separated} \markbox{19198}{by} \markbox{19199}{some} \markbox{19200}{complementary} \markbox{19201}{component} \markbox{m19202}{$C_i \subset T'_U - T'_{U,s}$}.  \markbox{19203}{By} construction, \markbox{19204}{all} \markbox{19205}{but} boundedly-many (in \markbox{m19206}{$\mathfrak S$}) \markbox{19207}{of} \markbox{19208}{these} \markbox{19209}{components} \markbox{19210}{corresponds} \markbox{19211}{to} \markbox{19212}{some} \markbox{19213}{cluster} \markbox{19214}{component} \markbox{19215}{of} \markbox{m19216}{$T'_U$}.  \markbox{19217}{Since} \markbox{19218}{there} \markbox{19219}{are} \markbox{19220}{only} boundedly-many (in \markbox{m19221}{$\mathfrak S$}) \markbox{19222}{involved} domains, \markbox{19223}{by} \markbox{19224}{choosing} \markbox{m19225}{$n$} \markbox{19226}{to} \markbox{19227}{be} \markbox{19228}{sufficiently} large, \markbox{19229}{there} \markbox{19230}{exists} \markbox{19231}{some} \markbox{m19232}{$C_j$} \markbox{19233}{which} \markbox{19234}{contains} \markbox{19235}{a} \markbox{m19236}{$\nest_{\calU_0}$}-minimal \markbox{19237}{domain} \markbox{m19238}{$V \nest U$} \markbox{19239}{which} \markbox{19240}{is} \markbox{19241}{both} \markbox{m19242}{$\nest_{\calU}$}-minimal \markbox{19243}{and} \markbox{m19244}{$\nest_{\calU'}$}-minimal.  \markbox{19245}{But} \markbox{19246}{this} \markbox{19247}{is} impossible, \markbox{19248}{for} \markbox{19249}{the} \markbox{19250}{BGIA} \ref{ax:BGIA} \markbox{19251}{would} \markbox{19252}{imply} \markbox{19253}{that} \markbox{m19254}{$d_V(\rho^U_V(p_U(\pi_U(x)), \rho^U_V(p'_U(\pi_U(x)))) \succ K$}, \markbox{19255}{and} \markbox{19256}{this} \markbox{19257}{cannot} \markbox{19258}{happen} \markbox{19259}{as} \markbox{19260}{we} \markbox{19261}{can} \markbox{19262}{also} \markbox{19263}{arrange} \markbox{m19264}{$\pi_U(x)$} \markbox{19265}{to} \markbox{19266}{be} \markbox{19267}{as} \markbox{19268}{far} \markbox{19269}{from} \markbox{m19270}{$\rho^V_U$} \markbox{19271}{as} necessary.  \markbox{19272}{Hence} \markbox{19273}{no} \markbox{19274}{such} \markbox{19275}{long} \markbox{19276}{sequence} \markbox{m19277}{$E'_1, \dots E'_n$} \markbox{19278}{can} exist, \markbox{19279}{completing} \markbox{19280}{the} proof.



\end{proof}



\appendix
\section{Proof of the Tree Trimming Theorem \ref{thm:tree trimming}}\label{app:TT}

Below \markbox{19281}{is} \markbox{19282}{a} re-statement \markbox{19283}{of} \markbox{19284}{Theorem} \ref{thm:tree trimming}.  \markbox{19285}{See} \markbox{19286}{Subsection} \ref{subsec:tree trimming} \markbox{19287}{for} \markbox{19288}{the} \markbox{19289}{contextual} \markbox{19290}{definitions} \markbox{19291}{and} notation.

\begin{theorem}[Tree Trimming]
There \markbox{19292}{exists} \markbox{m19293}{$B_{tt} = B_{tt}(\mathfrak S, K)>0$} \markbox{19294}{so} \markbox{19295}{that} \markbox{19296}{for} \markbox{19297}{any} \markbox{m19298}{$B < B_{tt}$}, \markbox{19299}{there} \markbox{19300}{exists} \markbox{m19301}{$L =L(\mathfrak S, B)>0$} \markbox{19302}{so} \markbox{19303}{that} \markbox{19304}{the} \markbox{19305}{following} hold:

\begin{enumerate}
\item We \markbox{19306}{have} \markbox{m19307}{$\Delta(\calQ) \subset \calQ'$}.
\item There \markbox{19308}{is} \markbox{19309}{a} \markbox{19310}{map} \markbox{m19311}{$\Xi:\calQ' \to \calQ$} \markbox{19312}{so} \markbox{19313}{that} \markbox{m19314}{$\Delta \circ \Xi = id_{\calQ'}$}.  \markbox{19315}{In} particular, \markbox{m19316}{$\Delta(\calQ) = \calQ'$}.
\item The \markbox{19317}{map} \markbox{m19318}{$\Delta:\calQ \to \calQ'$} \markbox{19319}{is} \markbox{19320}{an} \markbox{m19321}{$(L,L)$}-quasi-isometry.
\end{enumerate}
\end{theorem}

\begin{proof}
The \markbox{19322}{fact} \markbox{19323}{that} \markbox{m19324}{$\Delta(\calQ) \subset \calQ'$}, \markbox{19325}{namely} \markbox{19326}{that} \markbox{m19327}{$\Delta$} \markbox{19328}{preserves} \markbox{m19329}{$0$}-consistency, \markbox{19330}{is} \markbox{19331}{immediate} \markbox{19332}{from} \markbox{19333}{the} \markbox{19334}{fact} \markbox{19335}{that} \markbox{19336}{the} \markbox{m19337}{$\Delta_U$} \markbox{19338}{just} \markbox{19339}{collapse} subintervals, \markbox{19340}{so} \markbox{19341}{coordinates} \markbox{19342}{which} \markbox{19343}{were} \markbox{19344}{collapsed} \markbox{19345}{projections} \markbox{19346}{remain} \markbox{19347}{collapsed} projections, \markbox{19348}{showing} \markbox{19349}{item} (1).  \markbox{19350}{Items} (2) \markbox{19351}{and} (3) \markbox{19352}{require} \markbox{19353}{more} \markbox{19354}{work} \markbox{19355}{and} \markbox{19356}{we} \markbox{19357}{provide} \markbox{19358}{a} \markbox{19359}{detailed} \markbox{19360}{sketch} \markbox{19361}{of} both.
\medskip

\textbf{\underline{Item (2): Surjectivity of $\Delta:\calQ \to \calQ'$}}: \markbox{19362}{Let} \markbox{m19363}{$\hy \in \calQ'$}.  \markbox{19364}{We} \markbox{19365}{will} \markbox{19366}{construct} \markbox{19367}{a} \markbox{19368}{point} \markbox{m19369}{$\hx \in \calQ$} \markbox{19370}{with} \markbox{m19371}{$\Delta(\hx) = \hy$} \markbox{19372}{by} \markbox{19373}{a} coordinate-wise argument, \markbox{19374}{thereby} \markbox{19375}{defining} \markbox{19376}{a} \markbox{19377}{map} \markbox{m19378}{$\Xi:\calQ' \to \calQ$} \markbox{19379}{with} \markbox{m19380}{$\Delta \circ \Xi = id_{\calQ'}$}.

For \markbox{19381}{each} \markbox{m19382}{$U \in \calU$}, \markbox{19383}{let} \markbox{m19384}{$C_U = \Delta^{-1}_U(\hy_U)$}.  \markbox{19385}{Our} \markbox{19386}{goal} \markbox{19387}{is} \markbox{19388}{to} pick, \markbox{19389}{for} \markbox{19390}{each} \markbox{m19391}{$U \in \calU$}, \markbox{19392}{a} \markbox{19393}{point} \markbox{m19394}{$\hx_U \in C_U$} \markbox{19395}{and} \markbox{19396}{then} \markbox{19397}{prove} \markbox{m19398}{$0$}-consistency \markbox{19399}{of} \markbox{19400}{the} \markbox{19401}{tuple} \markbox{m19402}{$\hx = (\hx_U)$}.  \markbox{19403}{Note} \markbox{19404}{that} \markbox{m19405}{$\Delta(\hx) =\hy$} \markbox{19406}{for} \markbox{19407}{such} \markbox{19408}{a} tuple, \markbox{19409}{by} construction.  \markbox{19410}{The} \markbox{19411}{proof} \markbox{19412}{is} \markbox{19413}{by} \markbox{19414}{induction} \markbox{19415}{on} \markbox{19416}{the} \markbox{19417}{nesting} \markbox{19418}{level} \markbox{19419}{in} \markbox{m19420}{$\calU$}, \markbox{19421}{and} \markbox{19422}{is} \markbox{19423}{similar} \markbox{19424}{to} \markbox{19425}{the} \markbox{19426}{construction} \markbox{19427}{of} \markbox{19428}{the} \markbox{19429}{map} \markbox{m19430}{$\hO:\calQ \to H$} \markbox{19431}{as} \markbox{19432}{in} \markbox{19433}{Proposition} \ref{prop:coarse surjectivity}.  \markbox{19434}{The} \markbox{19435}{main} \markbox{19436}{difference} \markbox{19437}{is} \markbox{19438}{that} \markbox{19439}{the} \markbox{19440}{collapsing} \markbox{19441}{subintervals} \markbox{19442}{are} \markbox{19443}{not} \markbox{19444}{automatically} \markbox{19445}{associated} \markbox{19446}{to} \markbox{19447}{a} \markbox{19448}{collection} \markbox{19449}{of} domains, \markbox{19450}{and} \markbox{19451}{this} \markbox{19452}{is} \markbox{19453}{where} \markbox{19454}{the} \markbox{19455}{work} lies.  \markbox{19456}{The} \markbox{19457}{proof} \markbox{19458}{is} \markbox{19459}{basically} \markbox{19460}{the} \markbox{19461}{proof} \markbox{19462}{of} \markbox{19463}{the} \markbox{19464}{analogous} \markbox{19465}{fact} \markbox{19466}{in} \cite[Theorem 10.2]{Dur_infcube}, \markbox{19467}{except} \markbox{19468}{that} \markbox{19469}{our} \markbox{19470}{setup} \markbox{19471}{is} \markbox{19472}{much} simpler.  \markbox{19473}{What} \markbox{19474}{follows} \markbox{19475}{is} \markbox{19476}{a} \markbox{19477}{very} \markbox{19478}{detailed} sketch, \markbox{19479}{which} \markbox{19480}{leaves} \markbox{19481}{some} \markbox{19482}{small} \markbox{19483}{bits} \markbox{19484}{to} \markbox{19485}{the} reader.

For \markbox{19486}{the} \markbox{19487}{base} case, \markbox{19488}{let} \markbox{m19489}{$U \in \calU$} \markbox{19490}{be} \markbox{m19491}{$\nest_{\calU}$}-minimal.   \markbox{19492}{If} \markbox{m19493}{$\hy_U \in \hT_{U,0}$} \markbox{19494}{is} \markbox{19495}{not} \markbox{19496}{contained} \markbox{19497}{in} \markbox{m19498}{$\Delta_U(B)$} \markbox{19499}{for} \markbox{19500}{some} \markbox{m19501}{$B \in \calB$}, \markbox{19502}{then} \markbox{m19503}{$C_U\subset \hT_U$} \markbox{19504}{is} \markbox{19505}{a} \markbox{19506}{point} \markbox{19507}{and} \markbox{19508}{we} \markbox{19509}{set} \markbox{m19510}{$\hx_U = C_U$}.  \markbox{19511}{If} \markbox{m19512}{$\hy_U \in \Delta_U(B)$} \markbox{19513}{for} \markbox{19514}{some} \markbox{m19515}{$B \in \calB$} \markbox{19516}{and} \markbox{m19517}{$B \subset \hT_U$} \markbox{19518}{does} \markbox{19519}{not} \markbox{19520}{contain} \markbox{19521}{an} endpoint, \markbox{19522}{then} \markbox{19523}{let} \markbox{m19524}{$\hx_U \in C_U$} \markbox{19525}{be} \markbox{19526}{any} point.  \markbox{19527}{If} \markbox{19528}{instead} \markbox{m19529}{$C_U$} \markbox{19530}{does} \markbox{19531}{contain} \markbox{19532}{an} endpoint, \markbox{19533}{then} \markbox{19534}{it} \markbox{19535}{is} \markbox{19536}{possible} \markbox{19537}{that} \markbox{19538}{it} \markbox{19539}{contains} \markbox{19540}{both} endpoints, \markbox{19541}{and} \markbox{19542}{we} \markbox{19543}{need} \markbox{19544}{to} \markbox{19545}{choose} one.

The \markbox{19546}{following} claim, \markbox{19547}{which} \markbox{19548}{is} \markbox{19549}{exactly} \cite[Claim 10.3]{Dur_infcube}, \markbox{19550}{does} \markbox{19551}{not} \markbox{19552}{require} \markbox{m19553}{$U$} \markbox{19554}{to} \markbox{19555}{be} \markbox{m19556}{$\nest_{\calU}$}-minimal:

\begin{claim} \label{claim:choose one}
If \markbox{m19557}{$W, Z \in \{V \in \calU| V\pitchfork U, \hspace{.1in} \text{and} \hspace{.1in} \hy_V \neq (\hd^U_V)_0\}$}, \markbox{19558}{then} \markbox{m19559}{$\hd^W_U = \hd^Z_U$}.
\end{claim}

With \markbox{19560}{Claim} \ref{claim:choose one} \markbox{19561}{in} hand, \markbox{19562}{we} \markbox{19563}{can} \markbox{19564}{define} \markbox{m19565}{$\hx_U$} \markbox{19566}{for} \markbox{m19567}{$\nest_{\calU}$}-minimal \markbox{m19568}{$U$} \markbox{19569}{as} follows:

\begin{itemize}
\item If \markbox{m19570}{$\calW_U^{\pitchfork} = \{V \in \calU| V \pitchfork U \hspace{.1in} \mathrm{ and } \hspace{.1in} \hy_W \neq (\hd^V_U)_0\} \neq \emptyset$}, \markbox{19571}{then} \markbox{19572}{we} \markbox{19573}{set} \markbox{m19574}{$\hx_U = \hd^W_U$} \markbox{19575}{for} \markbox{19576}{any} (and \markbox{19577}{hence} all, \markbox{19578}{by} \markbox{19579}{the} claim) \markbox{m19580}{$W \in \calW_U^{\pitchfork}$}.
\item If \markbox{m19581}{$\calW_U^{\pitchfork} = \emptyset$}, \markbox{19582}{then} \markbox{19583}{we} \markbox{19584}{let} \markbox{m19585}{$\hx_U$} \markbox{19586}{be} \markbox{19587}{any} \markbox{19588}{marked} \markbox{19589}{point} \markbox{19590}{in} \markbox{m19591}{$C_U$}.
\end{itemize}

At \markbox{19592}{this} point, \markbox{19593}{we} \markbox{19594}{also} \markbox{19595}{want} \markbox{19596}{to} \markbox{19597}{set} \markbox{m19598}{$l_U$} \markbox{19599}{to} \markbox{19600}{be} \markbox{19601}{equal} \markbox{19602}{to} \markbox{19603}{the} \markbox{19604}{endpoint} \markbox{m19605}{$\hx_U$} \markbox{19606}{when} \markbox{m19607}{$U$} \markbox{19608}{is} \markbox{m19609}{$\nest_{\calU}$}-minimal, \markbox{19610}{where} \markbox{m19611}{$l_U = \emptyset$} \markbox{19612}{when} \markbox{m19613}{$C_U$} \markbox{19614}{does} \markbox{19615}{not} \markbox{19616}{contain} \markbox{19617}{an} \markbox{19618}{endpoint} \markbox{19619}{of} \markbox{m19620}{$\hT_U$}.  \markbox{19621}{These} \markbox{19622}{labels} \markbox{19623}{will} \markbox{19624}{play} \markbox{19625}{a} \markbox{19626}{similar} \markbox{19627}{role} \markbox{19628}{as} \markbox{19629}{in} \markbox{19630}{the} \markbox{19631}{cluster} \markbox{19632}{honing} \markbox{19633}{process} \markbox{19634}{in} \markbox{19635}{Subsection} \ref{subsec:hO defined}.

For \markbox{19636}{the} \markbox{19637}{inductive} step, \markbox{19638}{suppose} \markbox{19639}{that} \markbox{m19640}{$U$} \markbox{19641}{is} \markbox{19642}{not} \markbox{m19643}{$\nest_{\calU}$}-minimal \markbox{19644}{and} \markbox{19645}{that} \markbox{19646}{we} \markbox{19647}{have} \markbox{19648}{defined} \markbox{m19649}{$\hx_V$} \markbox{19650}{for} \markbox{19651}{all} \markbox{m19652}{$V \nest U$} and, \markbox{19653}{in} particular, \markbox{19654}{for} \markbox{19655}{all} \markbox{m19656}{$\nest_{\calU}$}-minimal \markbox{m19657}{$V \in \calU$}.  \markbox{19658}{As} before, \markbox{19659}{if} \markbox{m19660}{$C_U$} \markbox{19661}{does} \markbox{19662}{not} \markbox{19663}{contain} \markbox{19664}{a} \markbox{19665}{marked} \markbox{19666}{or} \markbox{19667}{a} \markbox{19668}{projection} \markbox{m19669}{$\hd^V_U$} \markbox{19670}{for} \markbox{19671}{some} \markbox{m19672}{$V \nest U$}, \markbox{19673}{then} \markbox{19674}{we} \markbox{19675}{let} \markbox{m19676}{$\hx_U \in C_U$} \markbox{19677}{be} \markbox{19678}{any} point.  \markbox{19679}{If} \markbox{m19680}{$C_U$} \markbox{19681}{happens} \markbox{19682}{to} \markbox{19683}{contain} \markbox{19684}{one} \markbox{19685}{of} \markbox{19686}{the} \markbox{19687}{endpoints} \markbox{19688}{but} \markbox{19689}{no} \markbox{m19690}{$\hd^V_U$} \markbox{19691}{for} \markbox{m19692}{$V \nest U$}, \markbox{19693}{then} \markbox{m19694}{$C_U$} \markbox{19695}{contains} \markbox{19696}{only} \markbox{19697}{that} \markbox{19698}{one} \markbox{19699}{endpoint} (since \markbox{m19700}{$U$} \markbox{19701}{is} \markbox{19702}{not} \markbox{m19703}{$\nest_{\calU}$}-minimal), \markbox{19704}{and} \markbox{19705}{we} \markbox{19706}{let} \markbox{m19707}{$\hx_U \in C_U$} \markbox{19708}{be} \markbox{19709}{any} point

Otherwise, \markbox{19710}{we} \markbox{19711}{set} \markbox{m19712}{$C=C_U$} \markbox{19713}{and} \markbox{19714}{let} \markbox{m19715}{$\calV_U$} \markbox{19716}{denote} \markbox{19717}{the} \markbox{19718}{set} \markbox{19719}{of} \markbox{m19720}{$\nest_{\calU}$}-minimal \markbox{19721}{domains} \markbox{m19722}{$V \nest U$} \markbox{19723}{so} \markbox{19724}{that} \markbox{m19725}{$\hd^V_U \in C$} (or equivalently, \markbox{m19726}{$(\hd^V_U)_0 = \hy_U$}).  \markbox{19727}{For} \markbox{19728}{each} \markbox{m19729}{$V \in \calV_U$}, \markbox{19730}{set} \markbox{m19731}{$C^V_U = \hull_C(\hd^V_U \cup \pi_C(\hx_V))$}, \markbox{19732}{namely} \markbox{19733}{the} \markbox{19734}{convex} \markbox{19735}{hull} \markbox{19736}{in} \markbox{m19737}{$C$} \markbox{19738}{of} \markbox{m19739}{$\hd^V_U$} \markbox{19740}{and} \markbox{19741}{the} \markbox{19742}{projections} \markbox{19743}{of} \markbox{19744}{the} \markbox{19745}{marked} \markbox{19746}{point} \markbox{19747}{labeled} \markbox{19748}{by} \markbox{m19749}{$l_V$} \markbox{19750}{down} \markbox{19751}{to} \markbox{19752}{the} \markbox{19753}{convex} \markbox{19754}{subset} \markbox{m19755}{$C$}.  \markbox{19756}{The} \markbox{19757}{following} claim, \markbox{19758}{which} \markbox{19759}{is} \markbox{19760}{exactly} \cite[Claim 10.4]{Dur_infcube}, \markbox{19761}{helps} \markbox{19762}{us} \markbox{19763}{choose} \markbox{19764}{a} \markbox{19765}{point} \markbox{19766}{in} \markbox{19767}{such} \markbox{19768}{a} \markbox{m19769}{$C_U$}:

\begin{claim}\label{claim:cluster overlap}
For \markbox{19770}{every} \markbox{m19771}{$V, W \in \calV_U$}, \markbox{19772}{we} \markbox{19773}{have} \markbox{m19774}{$C^V_U \cap C^W_U \neq \emptyset$}.  Moreover, \markbox{19775}{at} \markbox{19776}{least} \markbox{19777}{one} \markbox{19778}{of} \markbox{m19779}{$\hd^V_U \in C^W_U$} \markbox{19780}{or} \markbox{m19781}{$\hd^W_U \in C^V_U$} holds.


\end{claim}

\begin{proof}
We \markbox{19782}{may} \markbox{19783}{assume} \markbox{19784}{that} \markbox{m19785}{$\hd^V_U \neq \hd^W_U$}, \markbox{19786}{and} \markbox{19787}{hence} \markbox{19788}{that} \markbox{m19789}{$V \pitchfork W$}.  \markbox{19790}{If} \markbox{m19791}{$C^V_U \cap C^W_U = \emptyset$}, \markbox{19792}{then} \markbox{m19793}{$\hd^V_U \notin C^W_U$} \markbox{19794}{and} \markbox{m19795}{$\hd^W_U \notin C^V_U$}, \markbox{19796}{and} \markbox{19797}{it} \markbox{19798}{follows} \markbox{19799}{that} \markbox{m19800}{$l_V \neq l_W$}.  \markbox{19801}{The} \markbox{19802}{BGI} \markbox{19803}{property} \markbox{19804}{in} (7) \markbox{19805}{of} \markbox{19806}{Lemma} \ref{lem:collapsed interval control} \markbox{19807}{plus} \markbox{19808}{item} (4) \markbox{19809}{of} \markbox{19810}{Lemma} \ref{lem:interval control} \markbox{19811}{imply} \markbox{19812}{that}  \markbox{m19813}{$\hd^W_V \notin \Delta^{-1}_V(\hy_V)$} \markbox{19814}{and} \markbox{m19815}{$\hd^V_W \notin \Delta^{-1}_W(\hy_W)$}, \markbox{19816}{and} \markbox{19817}{hence} \markbox{m19818}{$\hy_V \neq (\hd^W_V)_0$} \markbox{19819}{and} \markbox{m19820}{$\hy_W \neq (\hd^V_W)_0$}, \markbox{19821}{which} \markbox{19822}{is} \markbox{19823}{a} \markbox{19824}{contradiction} \markbox{19825}{of} \markbox{m19826}{$0$}-consistency \markbox{19827}{of} \markbox{m19828}{$\hy$}.  \markbox{19829}{This} \markbox{19830}{proves} \markbox{19831}{the} claim.
\end{proof}

Hence \markbox{19832}{the} \markbox{19833}{Helly} \markbox{19834}{property} \markbox{19835}{for} \markbox{19836}{trees} \markbox{19837}{implies} \markbox{19838}{that} \markbox{m19839}{$\bigcap_{V \in \calV_U} C^V_U \subset \hT_U$} \markbox{19840}{is} nonempty.  \markbox{19841}{This} intersection, nonetheless, \markbox{19842}{may} \markbox{19843}{contain} \markbox{19844}{many} \markbox{m19845}{$\hd^V_U$} \markbox{19846}{for} \markbox{m19847}{$V \in \calV_U$}.  \markbox{19848}{The} \markbox{19849}{following} claim, \markbox{19850}{which} \markbox{19851}{is} \markbox{19852}{exactly} \cite[Claim 10.6]{Dur_infcube} \markbox{19853}{helps} \markbox{19854}{us} \markbox{19855}{make} \markbox{19856}{a} \markbox{19857}{consistent} choice:

\begin{claim}\label{claim:choose two}
Suppose \markbox{m19858}{$V, W \in \calW_U^{\nest}$}, \markbox{19859}{then} \markbox{m19860}{$\hd^V_U = \hd^W_U$}.
\end{claim}

\begin{proof}[Proof \markbox{19861}{of} \markbox{19862}{Claim} \ref{claim:choose two}]
For \markbox{19863}{a} contradiction, \markbox{19864}{suppose} \markbox{19865}{that} \markbox{m19866}{$\hd^W_U \neq \hd^V_U$}, \markbox{19867}{so} \markbox{19868}{that} \markbox{m19869}{$V \pitchfork W$}.  \markbox{19870}{Then} \markbox{19871}{again} \markbox{19872}{the} \markbox{19873}{BGI} \markbox{19874}{property} \markbox{19875}{in} \markbox{19876}{item} (7) \markbox{19877}{of} \markbox{19878}{Lemma} \ref{lem:collapsed interval control} \markbox{19879}{implies} \markbox{19880}{that} \markbox{m19881}{$\hd^V_W = \hd^U_W(\hd^V_U)$} \markbox{19882}{and} \markbox{m19883}{$\hd^W_V = \hd^U_V(\hd^W_U)$}.  \markbox{19884}{But} \markbox{19885}{then} \markbox{m19886}{$\hy_W \neq (\hd^V_W)_0 = (\hd^U_W)_0((\hd^V_U)_0)$} \markbox{19887}{and} \markbox{m19888}{$\hy_V \neq (\hd^W_V)_0 = (\hd^U_V)_0((\hd^W_U)_0)$}, \markbox{19889}{which} \markbox{19890}{contradicts} \markbox{m19891}{$0$}-consistency \markbox{19892}{of} \markbox{m19893}{$\hy$}, \markbox{19894}{completing} \markbox{19895}{the} proof.
\end{proof}

Finally, \markbox{19896}{this} \markbox{19897}{last} \markbox{19898}{claim} \markbox{19899}{helps} \markbox{19900}{us} \markbox{19901}{make} \markbox{19902}{a} \markbox{19903}{consistent} \markbox{19904}{choice} \markbox{19905}{between} \markbox{m19906}{$\hd^V_U$} \markbox{19907}{sets} \markbox{19908}{and} \markbox{19909}{marked} \markbox{19910}{points} \markbox{19911}{when} \markbox{m19912}{$C_U$} \markbox{19913}{contains} both:

\begin{claim}\label{claim:good choice}
The \markbox{19914}{following} holds:
\begin{enumerate}
\item If \markbox{19915}{there} \markbox{19916}{exists} \markbox{m19917}{$V \pitchfork U$} \markbox{19918}{so} \markbox{19919}{that} \markbox{m19920}{$\hy_V \neq (\hd^U_V)'$}, \markbox{19921}{then} \markbox{19922}{for} \markbox{19923}{all} \markbox{m19924}{$W \in \calV_U$} \markbox{19925}{with} \markbox{m19926}{$\hd^W_U \neq \hd^V_U$}, \markbox{19927}{we} \markbox{19928}{have} \markbox{m19929}{$\hx_W = \hd^V_W$}.
\item If \markbox{19930}{there} \markbox{19931}{exists} \markbox{m19932}{$W \in \calV_U$} \markbox{19933}{with} \markbox{m19934}{$\hy_W \neq (\hd^U_W)'(\hy_U)$}, \markbox{19935}{then} \markbox{19936}{for} \markbox{19937}{all} \markbox{m19938}{$V \pitchfork U$} \markbox{19939}{with} \markbox{m19940}{$\hd^W_U \neq \hd^V_U$}, \markbox{19941}{we} \markbox{19942}{have} \markbox{m19943}{$\hy_V = (\hd^U_V)'$}.
\end{enumerate}
\begin{itemize}
\item In particular, \markbox{19944}{if} \markbox{m19945}{$V \in \calW_U^{\pitchfork}$} \markbox{19946}{and} \markbox{m19947}{$W \in \calW_U^{\nest}$}, \markbox{19948}{then} \markbox{m19949}{$\hd^V_U = \hd^W_U$}.
\end{itemize}
\end{claim}

\begin{proof}[Proof \markbox{19950}{of} \markbox{19951}{Claim} \ref{claim:good choice}]
Suppose \markbox{m19952}{$V \pitchfork U$} \markbox{19953}{as} \markbox{19954}{in} \markbox{19955}{item} (1) \markbox{19956}{of} \markbox{19957}{the} claim, \markbox{19958}{and} \markbox{19959}{let} \markbox{m19960}{$W \in \calV_U$} \markbox{19961}{with} \markbox{m19962}{$\hd^W_U \neq \hd^V_U$}.  \markbox{19963}{Then} \markbox{m19964}{$W \pitchfork V$}, \markbox{19965}{and} \markbox{19966}{since} \markbox{m19967}{$W \nest U$}, \markbox{19968}{we} \markbox{19969}{have} \markbox{m19970}{$(\hd^W_V)_0 = (\hd^U_V)_0 \neq \hy_V$}, \markbox{19971}{and} \markbox{19972}{hence} \markbox{m19973}{$\hx_W = \hd^V_W$}, \markbox{19974}{by} \markbox{19975}{definition} \markbox{19976}{of} \markbox{m19977}{$\hx_W$}.

Now \markbox{19978}{suppose} \markbox{m19979}{$W \in \calV_U$}, \markbox{19980}{as} \markbox{19981}{in} \markbox{19982}{item} (2), \markbox{19983}{and} \markbox{19984}{that} \markbox{m19985}{$V \pitchfork U$} \markbox{19986}{with} \markbox{m19987}{$\hd^W_U \neq \hd^V_U$}. \markbox{19988}{Then} \markbox{m19989}{$W \pitchfork V$}.  \markbox{19990}{By} \markbox{m19991}{$0$}-consistency \markbox{19992}{of} \markbox{m19993}{$\hy$}, \markbox{19994}{we} \markbox{19995}{have} \markbox{19996}{that} \markbox{m19997}{$\hy_U = (\hd^W_U)_0$}.  \markbox{19998}{But} \markbox{19999}{since} \markbox{m20000}{$\hd^V_U \neq \hd^W_U$}, \markbox{20001}{we} \markbox{20002}{have} \markbox{m20003}{$(\hd^V_U)_0 \neq (\hd^W_U)_0$}, \markbox{20004}{and} \markbox{20005}{so} \markbox{m20006}{$\hy_V = (\hd^U_V)_0 = (\hd^W_V)_0$} \markbox{20007}{since} \markbox{m20008}{$W \nest U$}.  \markbox{20009}{This} \markbox{20010}{completes} \markbox{20011}{the} proof.
\end{proof}

We \markbox{20012}{are} \markbox{20013}{finally} \markbox{20014}{ready} \markbox{20015}{to} \markbox{20016}{define} \markbox{20017}{our} \markbox{20018}{tuple} \markbox{m20019}{$\hx$}, \markbox{20020}{which} \markbox{20021}{we} \markbox{20022}{do} domain-wise \markbox{20023}{for} \markbox{20024}{each} \markbox{m20025}{$U \in \calU$}:

\begin{enumerate}
\item If \markbox{m20026}{$\hy_U$} \markbox{20027}{is} \markbox{20028}{not} \markbox{20029}{a} \markbox{20030}{marked} \markbox{20031}{or} \markbox{20032}{cluster} \markbox{20033}{point} \markbox{20034}{of} \markbox{m20035}{$\hT_{U,0}$}, \markbox{20036}{then} \markbox{20037}{we} \markbox{20038}{let} \markbox{m20039}{$\hx_U \in C_U$} \markbox{20040}{be} \markbox{20041}{any} \markbox{20042}{point} \markbox{20043}{in} \markbox{m20044}{$\Delta^{-1}_U(\hy_U)$}.
\item For \markbox{20045}{any} \markbox{m20046}{$U$} \markbox{20047}{of} \markbox{20048}{type} (1): \markbox{20049}{If} \markbox{m20050}{$V \pitchfork U$} \markbox{20051}{or} \markbox{m20052}{$U \nest V$}, \markbox{20053}{we} \markbox{20054}{set} \markbox{m20055}{$\hx_V = \hd^U_V$}, \markbox{20056}{and} \markbox{20057}{if} \markbox{m20058}{$U \nest V$}, \markbox{20059}{we} \markbox{20060}{set} \markbox{m20061}{$\hx_V = \hd^U_V(\hx_U)$}.
\item If \markbox{m20062}{$U$} \markbox{20063}{is} \markbox{m20064}{$\nest_{\calU}$}-minimal \markbox{20065}{and} \markbox{m20066}{$\hy_U$} \markbox{20067}{is} \markbox{20068}{a} \markbox{20069}{marked} \markbox{20070}{point} \markbox{20071}{of} \markbox{m20072}{$\hT_{U,0}$}, \markbox{20073}{then} \markbox{20074}{there} \markbox{20075}{are} \markbox{20076}{three} subcases: \label{item:minimal choice}
\begin{enumerate}
\item The \markbox{20077}{set} \markbox{m20078}{$\calW_U^{\pitchfork} = \{W \in \calU| W \pitchfork U \hspace{.1in}  \textrm{and } \hspace{.1in} (\hd^U_W)' \neq \hy_W\}$} \markbox{20079}{is} nonempty, \markbox{20080}{and} \markbox{20081}{we} \markbox{20082}{set} \markbox{m20083}{$\hx_U = \hd^W_U$} \markbox{20084}{for} \markbox{20085}{any} (and \markbox{20086}{hence} \markbox{20087}{all} \markbox{20088}{by} \markbox{20089}{Claim} \ref{claim:choose one}) \markbox{m20090}{$W \in \calW_U^{\pitchfork}$};
\item \markbox{m20091}{$\calW_U^{\nest} = \{V \nest U| (\hd^U_V)'(\hy_U) \neq \hy_V \hspace{.1in} \textrm{and} \hspace{.1in} (\hd^U_W)'(\hy_U) \neq \hy_W\}$} \markbox{20092}{is} nonempty, \markbox{20093}{and} \markbox{20094}{we} \markbox{20095}{set} \markbox{m20096}{$\hx_U = \hd^V_U$} \markbox{20097}{for} \markbox{20098}{any} (and \markbox{20099}{hence} \markbox{20100}{all} \markbox{20101}{by} \markbox{20102}{Claim} \ref{claim:choose two}) \markbox{m20103}{$V \in \calW_U^{\nest}$}; \markbox{20104}{or} 
\item \markbox{m20105}{$\calW_U^{\pitchfork}$} \markbox{20106}{and} \markbox{m20107}{$\calW_U^{\nest}$} \markbox{20108}{are} \markbox{20109}{both} empty, \markbox{20110}{and} \markbox{20111}{we} \markbox{20112}{set} \markbox{m20113}{$\hx_U$} \markbox{20114}{to} \markbox{20115}{be} \markbox{20116}{any} \markbox{20117}{point} \markbox{20118}{of} \markbox{m20119}{$\hT^e_U$} \markbox{20120}{contained} \markbox{20121}{in} \markbox{m20122}{$C_U$}, \markbox{20123}{in} \markbox{20124}{particular} \markbox{20125}{a} \markbox{20126}{point} \markbox{20127}{which} \markbox{20128}{is} \markbox{20129}{not} \markbox{20130}{a} \markbox{20131}{cluster} \markbox{20132}{or} \markbox{20133}{marked} point. 
\end{enumerate}
\item Proceeding inductively, \markbox{20134}{if} \markbox{m20135}{$U$} \markbox{20136}{is} \markbox{20137}{not} \markbox{20138}{in} \markbox{20139}{cases} (1)--(3) above, \markbox{20140}{then} \markbox{m20141}{$\bigcap_{V \in \calV_U} C^V_U \neq \emptyset$} \markbox{20142}{and} \markbox{20143}{has} \markbox{20144}{finite} diameter.  \markbox{20145}{There} \markbox{20146}{are} \markbox{20147}{three} subcases: \label{item:general choice}
\begin{enumerate}
\item \markbox{m20148}{$\hx_U = \hd^W_U$} \markbox{20149}{for} \markbox{20150}{any} \markbox{m20151}{$W \in \calW_U^{\pitchfork}$} \markbox{20152}{if} \markbox{m20153}{$ \calW_U^{\pitchfork} \neq \emptyset$}, \label{item:choose transverse}
\item \markbox{m20154}{$\hx_U = \hd^V_U$} \markbox{20155}{for} \markbox{20156}{any} \markbox{m20157}{$V \in \calW_U^{\nest}$} \markbox{20158}{when} \markbox{m20159}{$\calW_U^{\nest} \neq \emptyset$}, \markbox{20160}{or} \label{item:choose nested}
\item Otherwise, \markbox{20161}{both} \markbox{m20162}{$\calW_U^{\pitchfork}$} \markbox{20163}{and} \markbox{m20164}{$\calW_U^{\nest}$} \markbox{20165}{are} empty, \markbox{20166}{and} \markbox{20167}{we} \markbox{20168}{set} \markbox{m20169}{$\hx_U$} \markbox{20170}{to} \markbox{20171}{be} \markbox{20172}{any} \markbox{20173}{point} \markbox{20174}{in} \markbox{m20175}{$\hT^e_U \cap C_U$}.
\end{enumerate}

\end{enumerate}

Finally, \markbox{20176}{we} \markbox{20177}{prove} \markbox{20178}{that} \markbox{m20179}{$\hx = (\hx_U)$} \markbox{20180}{is} \markbox{m20181}{$0$}-consistent \markbox{20182}{by} \markbox{20183}{a} case-wise analysis, \markbox{20184}{similar} \markbox{20185}{to} \markbox{20186}{the} \markbox{20187}{proof} \markbox{20188}{of} \markbox{20189}{Proposition} \ref{prop:Q-consistent}.  \markbox{20190}{Showing} \markbox{20191}{this} \markbox{20192}{will} \markbox{20193}{complete} \markbox{20194}{the} \markbox{20195}{proof} \markbox{20196}{of} \markbox{20197}{surjectivity} \markbox{20198}{of} \markbox{m20199}{$\Delta: \calQ \to \calQ'$}.  \markbox{20200}{The} \markbox{20201}{proof} \markbox{20202}{closely} \markbox{20203}{follows} \markbox{20204}{the} \markbox{20205}{analogous} \markbox{20206}{part} \markbox{20207}{of} \markbox{20208}{the} \markbox{20209}{proof} \markbox{20210}{from} \cite[Theorem 10.2]{Dur_infcube}.

\vspace{.1in}

\underline{$U \pitchfork V$:} \markbox{20211}{We} \markbox{20212}{may} \markbox{20213}{assume} \markbox{20214}{that} \markbox{m20215}{$\hx_V \neq \hd^U_V$}, \markbox{20216}{for} \markbox{20217}{we} \markbox{20218}{are} \markbox{20219}{done} otherwise.  \markbox{20220}{Then} \markbox{m20221}{$\hy_V \neq (\hd^U_V)_0$}, \markbox{20222}{and} \markbox{20223}{so} \markbox{m20224}{$\hy_U = (\hd^V_U)_0$} \markbox{20225}{by} \markbox{m20226}{$0$}-consistency \markbox{20227}{of} \markbox{m20228}{$\hy$}.  \markbox{20229}{It} \markbox{20230}{follows} \markbox{20231}{that} \markbox{m20232}{$\hd^V_U \in C_U = \Delta^{-1}_U(\hy_U)$}, \markbox{20233}{and} \markbox{20234}{necessarily} \markbox{m20235}{$\hd^V_U  \in \{\ha_V, \hb_V\}$}, \markbox{20236}{so} \markbox{20237}{we} \markbox{20238}{may} \markbox{20239}{assume} \markbox{20240}{without} \markbox{20241}{loss} \markbox{20242}{of} \markbox{20243}{generality} \markbox{20244}{that} \markbox{m20245}{$\hd^V_U = \ha_V$}.  \markbox{20246}{If} \markbox{m20247}{$U$} \markbox{20248}{is} \markbox{m20249}{$\nest_{\calU}$}-minimal, \markbox{20250}{then} \markbox{20251}{our} \markbox{20252}{choice} \markbox{20253}{of} \markbox{m20254}{$\hx_U$} \markbox{20255}{in} \eqref{item:minimal choice} \markbox{20256}{says} \markbox{20257}{that} \markbox{m20258}{$\hx_U = \hd^V_U$}, \markbox{20259}{as} required.

Now \markbox{20260}{suppose} \markbox{20261}{that} \markbox{m20262}{$U$} \markbox{20263}{is} \markbox{20264}{not} \markbox{m20265}{$\nest_{\calU}$}-minimal.  \markbox{20266}{Set} \markbox{m20267}{$\calV_U$} \markbox{20268}{to} \markbox{20269}{be} \markbox{20270}{the} \markbox{20271}{set} \markbox{20272}{of} \markbox{m20273}{$\nest_{\calU}$}-minimal \markbox{m20274}{$W \nest U$} \markbox{20275}{with} \markbox{m20276}{$\hd^W_U \in C_U$}.  \markbox{20277}{Let} \markbox{m20278}{$W \in \calV_U$} \markbox{20279}{be} \markbox{20280}{so} \markbox{20281}{that} \markbox{m20282}{$\hd^W_U \neq \hd^V_U$}.  \markbox{20283}{Then} \markbox{m20284}{$W \pitchfork V$} \markbox{20285}{and} \markbox{m20286}{$(\hd^W_V)_0 = (\hd^U_V)_0 \neq \hy_V$}, \markbox{20287}{and} \markbox{20288}{so} \markbox{m20289}{$\hx_W = \hd^V_W = \ha_W$}, \markbox{20290}{with} \markbox{20291}{the} \markbox{20292}{first} \markbox{20293}{equality} \markbox{20294}{following} \markbox{20295}{from} \markbox{20296}{our} \markbox{20297}{choice} \markbox{20298}{in} \eqref{item:minimal choice} \markbox{20299}{and} \markbox{20300}{the} \markbox{20301}{last} \markbox{20302}{equality} \markbox{20303}{by} \markbox{m20304}{$0$}-consistency \markbox{20305}{of} \markbox{m20306}{$a$}.  \markbox{20307}{But} \markbox{20308}{this} \markbox{20309}{says} \markbox{20310}{that} \markbox{m20311}{$a = l_W$}, \markbox{20312}{and} \markbox{20313}{hence} \markbox{m20314}{$\ha_U \in C^W_U$} \markbox{20315}{for} \markbox{20316}{all} \markbox{m20317}{$W \in \calV_U$} (including \markbox{20318}{those} \markbox{20319}{for} \markbox{20320}{which} \markbox{m20321}{$\hd^W_U = \hd^V_U = \ha_U$}).

It \markbox{20322}{follows} \markbox{20323}{then} \markbox{20324}{that} \markbox{m20325}{$\ha_U \in \bigcap_{W \in \calV_U}C^W_U$} \markbox{20326}{and} \markbox{20327}{so} \markbox{m20328}{$\hx_U = \ha_U$} \markbox{20329}{by} \markbox{20330}{definition} \markbox{20331}{of} \markbox{m20332}{$\hx$} \markbox{20333}{in} \markbox{20334}{item} \eqref{item:choose transverse} above.

\vspace{.1in}

\underline{$V \nest U$:} \markbox{20335}{We} \markbox{20336}{may} \markbox{20337}{assume} \markbox{20338}{that} \markbox{m20339}{$\hx_V \neq \hd^U_V(\hx_U)$}, \markbox{20340}{for} \markbox{20341}{we} \markbox{20342}{are} \markbox{20343}{done} otherwise.  \markbox{20344}{Then} \markbox{m20345}{$\hy_V \neq (\hd^U_V)_0(\hy_U)$}, \markbox{20346}{and} \markbox{m20347}{$0$}-consistency \markbox{20348}{of} \markbox{m20349}{$\hy$} \markbox{20350}{implies} \markbox{20351}{that} \markbox{m20352}{$\hy_U = (\hd^V_U)'$}, \markbox{20353}{and} \markbox{20354}{thus} \markbox{m20355}{$\hd^V_U \in C_U = \Delta^{-1}_U(\hy_U)$}.  \markbox{20356}{We} \markbox{20357}{claim} \markbox{20358}{that} \markbox{20359}{for} \markbox{20360}{all} \markbox{m20361}{$W \in \calV_U$}, \markbox{20362}{we} \markbox{20363}{have} \markbox{m20364}{$\hd^V_U \in C^W_U$}.

To \markbox{20365}{see} this, \markbox{20366}{is} \markbox{20367}{suffices} \markbox{20368}{to} \markbox{20369}{consider} \markbox{m20370}{$W \in \calV_U$} \markbox{20371}{with} \markbox{m20372}{$\hd^W_U \neq \hd^V_U$}.  \markbox{20373}{Then} \markbox{m20374}{$W \pitchfork V$}.  \markbox{20375}{But} \markbox{m20376}{$\hx_V \neq \hd^U_V(\hx_U)$}, \markbox{20377}{so} \markbox{20378}{if} \markbox{20379}{also} \markbox{m20380}{$\hd^V_U \notin C^W_U$}, \markbox{20381}{then} \markbox{m20382}{$\hx_V \neq \hd^U_V(\hd^W_U) = \hd^W_V$}, \markbox{20383}{while} \markbox{20384}{also} \markbox{m20385}{$\hx_W \neq \hd^U_W(\hd^V_U) = \hd^V_W$}, \markbox{20386}{which} \markbox{20387}{both} \markbox{20388}{use} \markbox{20389}{the} \markbox{20390}{BGI} \markbox{20391}{property} \markbox{20392}{in} \markbox{20393}{item} (7) \markbox{20394}{of} \markbox{20395}{Lemma} \ref{lem:collapsed interval control}.  \markbox{20396}{But} \markbox{20397}{then} \markbox{m20398}{$\hy_V \neq (\hd^W_V)_0$} \markbox{20399}{and} \markbox{m20400}{$\hy_W \neq (\hd^V_W)_0$}, \markbox{20401}{which} \markbox{20402}{contradicts} \markbox{m20403}{$0$}-consistency \markbox{20404}{of} \markbox{m20405}{$\hy$}.

Hence \markbox{m20406}{$\hd^V_U \in C^W_U$} \markbox{20407}{for} \markbox{20408}{all} \markbox{m20409}{$W \in \calV_U$}.  \markbox{20410}{It} \markbox{20411}{follows} \markbox{20412}{that} \markbox{m20413}{$\hd^V_U \in \bigcap_{W \in \calV_U} C^W_U$}, \markbox{20414}{and} \markbox{20415}{then} \eqref{item:choose nested} \markbox{20416}{says} \markbox{20417}{that} \markbox{m20418}{$\hx_U = \hd^V_U$}.



\vspace{.1in}

Hence \markbox{m20419}{$(\hx)$} \markbox{20420}{is} \markbox{m20421}{$0$}-consistent.  \markbox{20422}{Since} \markbox{m20423}{$\Delta(\hx) = \hy$} \markbox{20424}{because} \markbox{m20425}{$\hx_U \in \Delta^{-1}_U(\hy_U)$} \markbox{20426}{for} \markbox{20427}{all} \markbox{m20428}{$U \in \calU$}, \markbox{20429}{we} \markbox{20430}{are} \markbox{20431}{done} \markbox{20432}{with} \markbox{20433}{the} \markbox{20434}{proof} \markbox{20435}{of} \markbox{20436}{surjectivity} \markbox{20437}{of} \markbox{m20438}{$\Delta: \calQ \to \calQ'$}, \markbox{20439}{and} \markbox{20440}{this} \markbox{20441}{also} \markbox{20442}{defines} \markbox{20443}{the} \markbox{20444}{map} \markbox{m20445}{$\Xi:\calQ' \to \calQ$} \markbox{20446}{by} \markbox{m20447}{$\Xi(\hy) = \hx$}, \markbox{20448}{as} \markbox{20449}{defined} above.  \markbox{20450}{This} \markbox{20451}{completes} \markbox{20452}{the} \markbox{20453}{proof} \markbox{20454}{of} \markbox{20455}{item} (2).

\medskip

\textbf{\underline{Item (3): $\Delta:\calQ \to \calQ'$ is a quasi-isometry:}} \markbox{20456}{The} \markbox{20457}{proof} \markbox{20458}{of} \markbox{20459}{this} \markbox{20460}{part} \markbox{20461}{proceeds} \markbox{20462}{similarly} \markbox{20463}{to} \markbox{20464}{its} \markbox{20465}{analogue} \markbox{20466}{in} \cite[Theorem 10.2]{Dur_infcube}, \markbox{20467}{though} \markbox{20468}{with} \markbox{20469}{some} \markbox{20470}{modest} \markbox{20471}{simplifications} (see \markbox{20472}{especially} \cite[Subsection 9.1]{Dur_infcube}).

Since \markbox{m20473}{$\Delta|_{\calQ}$} \markbox{20474}{is} \markbox{20475}{surjective} \markbox{20476}{and} \markbox{20477}{distance} non-increasing, \markbox{20478}{it} \markbox{20479}{suffices} \markbox{20480}{to} \markbox{20481}{prove} \markbox{20482}{that} \markbox{m20483}{$d_{\calQ} \prec d_{\calQ'}$}, \markbox{20484}{and} \markbox{20485}{for} \markbox{20486}{this} \markbox{20487}{it} \markbox{20488}{suffices} \markbox{20489}{to} \markbox{20490}{bound} \markbox{20491}{the} \markbox{20492}{distances} \markbox{20493}{in} \markbox{20494}{each} \markbox{m20495}{$U \in \calU$}.

Let \markbox{m20496}{$\hx, \hy \in \calQ$} \markbox{20497}{with} \markbox{m20498}{$\hx' = \Delta(\hx)$} \markbox{20499}{and} \markbox{m20500}{$\hy' = \Delta(\hy)$}.  \markbox{20501}{We} \markbox{20502}{may} \markbox{20503}{assume} \markbox{20504}{that} \markbox{m20505}{$\hx_U \neq \hy_U$} \markbox{20506}{for} \markbox{20507}{any} \markbox{m20508}{$U\in \calU$} \markbox{20509}{that} \markbox{20510}{we} \markbox{20511}{will} consider.  \markbox{20512}{We} \markbox{20513}{begin} \markbox{20514}{by} \markbox{20515}{making} \markbox{20516}{a} \markbox{20517}{useful} reduction.

Observe \markbox{20518}{that} \markbox{20519}{item} (9) \markbox{20520}{of} \markbox{20521}{Lemma} \ref{lem:collapsed interval control} \markbox{20522}{implies} \markbox{20523}{that} \markbox{20524}{there} \markbox{20525}{are} \markbox{20526}{at} \markbox{20527}{most} boundedly-many \markbox{20528}{domains} \markbox{m20529}{$U \in \calU$} \markbox{20530}{for} \markbox{20531}{which} \markbox{m20532}{$\hx_U,\hy_U$} \markbox{20533}{are} \markbox{20534}{in} \markbox{20535}{the} \markbox{20536}{same} \markbox{20537}{component} \markbox{20538}{of} \markbox{m20539}{$\hT^e_U$}, \markbox{20540}{where} \markbox{20541}{the} \markbox{20542}{bound} \markbox{20543}{is} \markbox{20544}{controlled} \markbox{20545}{by} \markbox{m20546}{$\mathfrak S$}.  \markbox{20547}{For} \markbox{20548}{such} \markbox{m20549}{$U$}, \markbox{20550}{we} \markbox{20551}{have} \markbox{m20552}{$d_{\hT_U}(\hx_U, \hy_U) \leq d_{\hT'_U}(\hx'_U, \hy'_U) + B^2$} \markbox{20553}{because} \markbox{20554}{at} \markbox{20555}{most} \markbox{m20556}{$B$}-many \markbox{20557}{subtrees} \markbox{20558}{of} \markbox{20559}{diameter} \markbox{m20560}{$B$} \markbox{20561}{have} \markbox{20562}{been} \markbox{20563}{deleted} \markbox{20564}{from} \markbox{20565}{that} edge.  \markbox{20566}{Hence} \markbox{20567}{we} \markbox{20568}{may} \markbox{20569}{deal} \markbox{20570}{with} \markbox{20571}{these} boundedly-many \markbox{20572}{domains} \markbox{20573}{with} \markbox{20574}{an} \markbox{20575}{additive} \markbox{20576}{constant} \markbox{20577}{in} \markbox{20578}{the} \markbox{20579}{distance} \markbox{20580}{estimate} \markbox{20581}{comparing} \markbox{m20582}{$d_{\calQ}(\hx,\hy)$} \markbox{20583}{and} \markbox{m20584}{$d_{\calQ'}(\hx',\hy')$}. Hereafter, \markbox{20585}{we} \markbox{20586}{assume} \markbox{20587}{that} \markbox{20588}{at} \markbox{20589}{least} \markbox{20590}{one} \markbox{20591}{of} \markbox{m20592}{$\hx_U, \hy_U$} \markbox{20593}{coincides} \markbox{20594}{with} \markbox{20595}{a} cluster, \markbox{20596}{or} \markbox{20597}{they} \markbox{20598}{are} \markbox{20599}{separated} \markbox{20600}{by} \markbox{20601}{at} \markbox{20602}{least} \markbox{20603}{one} cluster.



\smallskip

There \markbox{20604}{are} \markbox{20605}{two} cases, (1) \markbox{m20606}{$U$} \markbox{20607}{is} \markbox{m20608}{$\nest_{\calU}$}-minimal \markbox{20609}{and} (2) otherwise.

\smallskip

\underline{Case (1)}: \markbox{20610}{Then} \markbox{m20611}{$\hT^e_U$} \markbox{20612}{has} \markbox{20613}{one} component.  \markbox{20614}{So} \markbox{20615}{there} \markbox{20616}{are} \markbox{20617}{at} \markbox{20618}{most} \markbox{m20619}{$B$}-many \markbox{20620}{subtrees} \markbox{20621}{of} \markbox{20622}{diameter} \markbox{20623}{at} \markbox{20624}{most} \markbox{m20625}{$B$} \markbox{20626}{in} \markbox{m20627}{$\hT^e_U$} \markbox{20628}{being} collapsed.  \markbox{20629}{By} \markbox{20630}{item} (9) \markbox{20631}{of} \markbox{20632}{Lemma} \ref{lem:collapsed interval control} \markbox{20633}{there} \markbox{20634}{are} \markbox{20635}{at} \markbox{20636}{most} boundedly-many (in \markbox{m20637}{$\mathfrak S$}) \markbox{20638}{such} \markbox{m20639}{$\nest_{\calU}$}-minimal \markbox{m20640}{$U$} \markbox{20641}{for} \markbox{20642}{which} \markbox{20643}{one} \markbox{20644}{of} \markbox{m20645}{$\hx_U, \hy_U$} \markbox{20646}{is} \markbox{20647}{not} \markbox{20648}{a} \markbox{20649}{cluster} point.  \markbox{20650}{We} \markbox{20651}{may} \markbox{20652}{deal} \markbox{20653}{with} \markbox{20654}{such} \markbox{m20655}{$U$} \markbox{20656}{by} \markbox{20657}{increasing} \markbox{20658}{the} \markbox{20659}{additive} \markbox{20660}{constant} \markbox{20661}{in} \markbox{20662}{the} \markbox{20663}{distance} estimate.

The \markbox{20664}{general} \markbox{20665}{case} \markbox{20666}{is} \markbox{20667}{where} \markbox{m20668}{$\hx_U, \hy_U$} \markbox{20669}{are} \markbox{20670}{the} \markbox{20671}{distinct} \markbox{20672}{endpoint} \markbox{20673}{clusters} \markbox{20674}{of} \markbox{20675}{the} \markbox{20676}{interval} \markbox{m20677}{$\hT_U$}.  \markbox{20678}{In} \markbox{20679}{this} case, 
$$d_{\hT'_U}(\hx'_U,\hy'_U)  \geq d_{\hT_U}(\hx_U,\hy_U) - B^2 \geq K - B^2 - 2r_1,$$ \markbox{20680}{by} \markbox{20681}{item} (6) \markbox{20682}{of} \markbox{20683}{Lemma} \ref{lem:collapsed interval control}.   \markbox{20684}{Hence} \markbox{20685}{by} \markbox{20686}{choosing} \markbox{m20687}{$K = K(\mathfrak S)>0$} \markbox{20688}{sufficiently} \markbox{20689}{large} \markbox{20690}{and} \markbox{20691}{requiring} \markbox{20692}{that} \markbox{m20693}{$B^2_{tt}-2r_1<K$}, \markbox{20694}{we} \markbox{20695}{can} \markbox{20696}{guarantee} \markbox{20697}{that} \markbox{m20698}{$d_{\hT'_U}(\hx'_U,\hy'_U) >1$} \markbox{20699}{allowing} \markbox{20700}{the} estimate
$$d_{\hT_U}(\hx_U,\hy_U) \leq d_{\hT'_U}(\hx'_U,\hy'_U) + B^2 \leq (1+B^2)d_{\hT'_U}(\hx'_U,\hy'_U).$$
Thus \markbox{20701}{we} \markbox{20702}{can} \markbox{20703}{account} \markbox{20704}{for} \markbox{20705}{these} \markbox{20706}{domains} \markbox{20707}{via} \markbox{20708}{a} \markbox{20709}{bounded} \markbox{20710}{multiplicative} error.


\smallskip
\underline{Case (2)}:  \markbox{20711}{Suppose} \markbox{20712}{that} \markbox{m20713}{$U \in \calU$} \markbox{20714}{is} \markbox{20715}{not} \markbox{m20716}{$\nest_{\calU}$}-minimal.  \markbox{20717}{Since} \markbox{m20718}{$\hx_U \neq \hy_U$}, \markbox{20719}{there} \markbox{20720}{is} \markbox{20721}{some} \markbox{20722}{collection} \markbox{20723}{of} \markbox{20724}{edge} \markbox{20725}{components} \markbox{m20726}{$E_1, \dots, E_k\subset \hT^e_U$} \markbox{20727}{separating} \markbox{m20728}{$\hx_U$} \markbox{20729}{from} \markbox{m20730}{$\hy_U$}, i.e. \markbox{20731}{intersecting} \markbox{m20732}{$[\hx_U, \hy_U]_{\hT_U}$}.  \markbox{20733}{By} assumption, \markbox{20734}{each} \markbox{20735}{such} \markbox{20736}{component} \markbox{20737}{contains} \markbox{20738}{at} \markbox{20739}{most} \markbox{m20740}{$B$}-many \markbox{20741}{subintervals} \markbox{20742}{in} \markbox{m20743}{$\calB$} \markbox{20744}{of} \markbox{20745}{diameter} \markbox{20746}{at} \markbox{20747}{most} \markbox{m20748}{$B$} \markbox{20749}{which} \markbox{20750}{are} \markbox{20751}{collapsed} \markbox{20752}{by} \markbox{m20753}{$\Delta_U:\hT_U \to \hT'_U$}.  Moreover, \markbox{20754}{adjacent} \markbox{20755}{intervals} \markbox{m20756}{$E_i, E_{i+1}$} \markbox{20757}{are} \markbox{20758}{attached} \markbox{20759}{at} \markbox{20760}{some} \markbox{20761}{collapsed} \markbox{20762}{cluster} \markbox{m20763}{$C_i$}.  \markbox{20764}{For} \markbox{20765}{each} \markbox{20766}{such} \markbox{20767}{collapsed} \markbox{20768}{cluster} \markbox{m20769}{$C_i$}, \markbox{20770}{choose} \markbox{20771}{a} \markbox{m20772}{$\nest_{\calU}$}-minimal \markbox{20773}{domain} \markbox{m20774}{$V_i \nest U$} \markbox{20775}{with} \markbox{m20776}{$\hd^{V_i}_U \in C_i$}.  \markbox{20777}{Observe} that
\begin{eqnarray*}
d_{\hT_U}(C_i,C_{i+1}) &\leq& d_{\hT'_U}(\Delta_U(C_i), \Delta_U(C_{i+1})) + B^2\\
&\leq& d_{\hT'_U}(\Delta_U(C_i), \Delta_U(C_{i+1})) + B^2d_{\hT'_{V_i}}(\hx'_{V_i}, \hy'_{V_i}).
\end{eqnarray*}

Hence \markbox{20778}{we} \markbox{20779}{can} \markbox{20780}{account} \markbox{20781}{for} \markbox{20782}{the} \markbox{20783}{lost} \markbox{20784}{distance} \markbox{20785}{along} \markbox{m20786}{$[\hx_U, \hy_U]$} \markbox{20787}{between} \markbox{20788}{each} \markbox{20789}{pair} \markbox{20790}{of} \markbox{20791}{successive} \markbox{20792}{collapsed} \markbox{20793}{cluster} \markbox{20794}{points} \markbox{m20795}{$C_i, C_{i+1}$} (i.e., \markbox{20796}{the} \markbox{20797}{distance} \markbox{20798}{lost} \markbox{20799}{in} \markbox{20800}{the} \markbox{20801}{edge} \markbox{m20802}{$E_i$}) \markbox{20803}{by} \markbox{20804}{distances} \markbox{20805}{in} \markbox{20806}{the} \markbox{m20807}{$\nest_{\calU}$}-minimal \markbox{20808}{domains} \markbox{m20809}{$V_i$}.  Similarly, \markbox{20810}{we} \markbox{20811}{can} \markbox{20812}{use} \markbox{m20813}{$V_1, V_k$} \markbox{20814}{to} \markbox{20815}{account} \markbox{20816}{for} \markbox{20817}{any} \markbox{20818}{lost} \markbox{20819}{distance} \markbox{20820}{between} \markbox{m20821}{$\hx_U, C_1$} \markbox{20822}{and} \markbox{m20823}{$C_n, \hy_U$}, respectively.  \markbox{20824}{Since} \markbox{20825}{each} \markbox{20826}{domain} \markbox{20827}{in} \markbox{m20828}{$\calU$} \markbox{20829}{nests} \markbox{20830}{into} \markbox{20831}{at} \markbox{20832}{most} boundedly-many \markbox{20833}{domains} \markbox{20834}{in} \markbox{m20835}{$\calU$} \markbox{20836}{by} \markbox{20837}{the} \markbox{20838}{Covering} \markbox{20839}{Lemma} \ref{lem:covering}, \markbox{20840}{the} \markbox{20841}{proof} \markbox{20842}{of} \markbox{20843}{case} (2) \markbox{20844}{is} complete.  \markbox{20845}{This} \markbox{20846}{completes} \markbox{20847}{the} \markbox{20848}{proof} \markbox{20849}{of} \markbox{20850}{the} theorem.
\end{proof}




\section{Proof of the Stable Intervals Theorem \ref{thm:stable intervals}} \label{app:SI}

We \markbox{20851}{will} \markbox{20852}{give} \markbox{20853}{a} \markbox{20854}{fairly} \markbox{20855}{complete} \markbox{20856}{accounting} \markbox{20857}{of} \markbox{20858}{the} \markbox{20859}{two} \markbox{20860}{main} \markbox{20861}{arguments} \markbox{20862}{involved} \markbox{20863}{in} \markbox{20864}{Theorem} \ref{thm:stable intervals}.  \markbox{20865}{See} \markbox{20866}{Subsection} \ref{subsec:detailed sketch} \markbox{20867}{for} \markbox{20868}{a} \markbox{20869}{detailed} \markbox{20870}{sketch} \markbox{20871}{and} outline.  \markbox{20872}{The} \markbox{20873}{two} \markbox{20874}{key} \markbox{20875}{arguments} \markbox{20876}{involve} \markbox{20877}{showing} \markbox{20878}{that} \markbox{20879}{we} \markbox{20880}{can} \markbox{20881}{stably} \markbox{20882}{add} \markbox{20883}{one} \markbox{20884}{cluster} \markbox{20885}{point} \markbox{20886}{and} \markbox{20887}{then} \markbox{20888}{that} \markbox{20889}{we} \markbox{20890}{can} \markbox{20891}{iterate} \markbox{20892}{this} process.

\subsection{Adding a cluster point}

In \markbox{20893}{this} subsection, \markbox{20894}{we} \markbox{20895}{explain} \markbox{20896}{how} \markbox{20897}{to} \markbox{20898}{build} \markbox{20899}{a} \markbox{20900}{stable} \markbox{20901}{decomposition} \markbox{20902}{when} \markbox{20903}{adding} \markbox{20904}{a} \markbox{20905}{cluster} \markbox{20906}{point} \markbox{20907}{to} \markbox{20908}{the} setup.  \markbox{20909}{This} \markbox{20910}{is} \markbox{20911}{the} \markbox{20912}{main} \markbox{20913}{bit} \markbox{20914}{of} \markbox{20915}{work} \markbox{20916}{for} \markbox{20917}{Theorem} \ref{thm:stable intervals}.

\begin{proposition} \label{prop:add cluster}
Let \markbox{m20918}{$\calZ$} \markbox{20919}{be} \markbox{20920}{a} \markbox{20921}{geodesic} \markbox{m20922}{$\delta$}-hyperbolic space, \markbox{m20923}{$\epsilon>0$}, \markbox{20924}{and} \markbox{m20925}{$r_1,r_2>0$} \markbox{20926}{be} \markbox{20927}{positive} integers.  \markbox{20928}{Let} \markbox{m20929}{$(a,b;\calY)$} \markbox{20930}{be} \markbox{20931}{an} \markbox{m20932}{$\epsilon$}-setup \markbox{20933}{and} \markbox{20934}{further} \markbox{20935}{fix} \markbox{20936}{a} \markbox{20937}{point} \markbox{m20938}{$z \in \calN_{\epsilon/2}(\lambda(a,b))$}.  Then
\begin{enumerate}
\item \markbox{m20939}{$(a,b;\calY \cup \{z\})$} \markbox{20940}{is} \markbox{20941}{an} \markbox{m20942}{$\epsilon$}-setup;
\item The \markbox{20943}{two} \markbox{20944}{setups} \markbox{m20945}{$(a,b;\calY)$} \markbox{20946}{and} \markbox{m20947}{$(a,b;\calY \cup \{z\})$} \markbox{20948}{are} \markbox{m20949}{$(1,\epsilon)$}-admissible;
\item There \markbox{20950}{exists} \markbox{m20951}{$L_1=L_1(\delta, \epsilon)>0$} \markbox{20952}{so} \markbox{20953}{that} \markbox{20954}{the} \markbox{20955}{stable} \markbox{20956}{intervals} \markbox{m20957}{$T$} \markbox{20958}{and} \markbox{m20959}{$T'$} \markbox{20960}{for} \markbox{20961}{the} \markbox{20962}{setups} \markbox{m20963}{$(a,b;\calY)$} \markbox{20964}{and} \markbox{m20965}{$(a,b;\calY \cup \{z\})$} \markbox{20966}{admit} \markbox{m20967}{$\calY$}-stable \markbox{m20968}{$L_1$}-compatible decompositions;
\item There \markbox{20969}{exists} \markbox{m20970}{$L_2 = L_2(\delta, \epsilon, r_1,r_2)>0$} \markbox{20971}{so} \markbox{20972}{that} \markbox{20973}{the} \markbox{m20974}{$(r_1,r_2)$}-thickenings \markbox{20975}{of} \markbox{m20976}{$T,T'$} \markbox{20977}{admit} \markbox{m20978}{$\calY$}-stable \markbox{m20979}{$L_2$}-compatible decompositions.
\end{enumerate}
\end{proposition}

\begin{proof}
Since \markbox{20980}{the} \markbox{20981}{points} \markbox{m20982}{$a,b$} \markbox{20983}{have} \markbox{20984}{not} changed, \markbox{20985}{the} \markbox{20986}{first} \markbox{20987}{two} \markbox{20988}{conclusions} \markbox{20989}{are} \markbox{20990}{automatic} \markbox{20991}{from} \markbox{20992}{the} assumptions.

Choosing \markbox{m20993}{$E \gg \epsilon$}, \markbox{20994}{Proposition} \ref{prop:cluster sep graph} \markbox{20995}{implies} \markbox{20996}{that} \markbox{20997}{both} \markbox{m20998}{$\calG = \calG_E(a,b;\calY)$} \markbox{20999}{and} \markbox{m21000}{$\calG' = \calG_E(a,b;\calY \cup \{z\})$} \markbox{21001}{are} intervals.  \markbox{21002}{There} \markbox{21003}{are} \markbox{21004}{two} \markbox{21005}{main} cases: (a) \markbox{m21006}{$d(z,C)>E$} \markbox{21007}{for} \markbox{21008}{all} \markbox{21009}{clusters} \markbox{m21010}{$C$}, \markbox{21011}{or} (b) otherwise.

We \markbox{21012}{will} \markbox{21013}{deal} \markbox{21014}{with} \markbox{21015}{these} \markbox{21016}{cases} separately, \markbox{21017}{though} \markbox{21018}{the} \markbox{21019}{arguments} \markbox{21020}{are} similar.  Moreover, \markbox{21021}{for} \markbox{21022}{each} case, \markbox{21023}{we} \markbox{21024}{will} \markbox{21025}{want} \markbox{21026}{to} \markbox{21027}{deal} \markbox{21028}{both} \markbox{21029}{with} \markbox{21030}{the} \markbox{21031}{original} \markbox{21032}{decompositions} \markbox{21033}{of} \markbox{21034}{the} \markbox{21035}{stable} \markbox{21036}{tree} \markbox{m21037}{$T = T_e \cup T_c$}, \markbox{21038}{as} \markbox{21039}{well} \markbox{21040}{as} \markbox{21041}{its} \markbox{m21042}{$(r_1,r_2)$}-thickening \markbox{m21043}{$T = \bT_{e} \cup \bT_{c}$}.  \markbox{21044}{The} \markbox{21045}{compatible} \markbox{21046}{decompositions} \markbox{21047}{for} \markbox{21048}{the} \markbox{21049}{latter} \markbox{21050}{will} \markbox{21051}{be} \markbox{21052}{refined} \markbox{21053}{for} \markbox{21054}{the} \markbox{21055}{decomposition} \markbox{21056}{for} \markbox{21057}{the} former, \markbox{21058}{with} \markbox{21059}{possibly} \markbox{21060}{a} \markbox{21061}{slight} \markbox{21062}{increase} \markbox{21063}{in} \markbox{21064}{the} \markbox{21065}{error} \markbox{21066}{depending} \markbox{21067}{on} \markbox{m21068}{$r_1,r_2$}.

\medskip

\underline{\textbf{Case (a), $z$ forms a split cluster}}: \markbox{21069}{In} \markbox{21070}{this} case, \markbox{m21071}{$z$} \markbox{21072}{forms} \markbox{21073}{its} \markbox{21074}{own} \markbox{21075}{cluster} and, \markbox{21076}{in} particular, \markbox{21077}{does} \markbox{21078}{not} \markbox{21079}{affect} \markbox{21080}{membership} \markbox{21081}{of} \markbox{21082}{any} \markbox{21083}{other} cluster.  Moreover, \markbox{21084}{it} \markbox{21085}{cannot} \markbox{21086}{be} \markbox{21087}{an} \markbox{21088}{endpoint} \markbox{21089}{cluster} \markbox{21090}{of} \markbox{m21091}{$\calG'$}, \markbox{21092}{as} \markbox{21093}{those} \markbox{21094}{necessarily} \markbox{21095}{contain} \markbox{m21096}{$a$} \markbox{21097}{and} \markbox{m21098}{$b$}.  \markbox{21099}{Hence} \markbox{21100}{there} \markbox{21101}{exist} \markbox{21102}{two} \markbox{21103}{clusters} \markbox{m21104}{$C_1,C_2$} \markbox{21105}{which} \markbox{21106}{are} \markbox{21107}{adjacent} \markbox{21108}{in} \markbox{m21109}{$\calG$} \markbox{21110}{but} \markbox{21111}{are} \markbox{21112}{separated} \markbox{21113}{by} \markbox{m21114}{$z$} \markbox{21115}{in} \markbox{m21116}{$\calG'$}, \markbox{21117}{say} \markbox{21118}{with} \markbox{m21119}{$C_1$} \markbox{21120}{on} \markbox{21121}{the} \markbox{21122}{side} \markbox{21123}{of} \markbox{m21124}{$a$} \markbox{21125}{and} \markbox{m21126}{$C_2$} \markbox{21127}{on} \markbox{21128}{the} \markbox{21129}{side} \markbox{21130}{of} \markbox{m21131}{$b$}.  \markbox{21132}{In} \markbox{21133}{this} sense, \markbox{21134}{we} \markbox{21135}{think} \markbox{21136}{of} \markbox{m21137}{$z$} \markbox{21138}{as} \markbox{21139}{splitting} \markbox{21140}{the} \markbox{21141}{clusters} \markbox{m21142}{$C_1,C_2$}.

Lemma \ref{lem:cluster arrangement} \markbox{21143}{implies} \markbox{21144}{that} \markbox{m21145}{$z$} \markbox{21146}{separates} \markbox{21147}{two} \markbox{21148}{clusters} \markbox{m21149}{$C,C'$} \markbox{21150}{for} \markbox{m21151}{$(a,b;\calY)$} \markbox{21152}{if} \markbox{21153}{and} \markbox{21154}{only} \markbox{21155}{if} \markbox{m21156}{$s(z)$} \markbox{21157}{separates} \markbox{m21158}{$s(C), s(C')$} \markbox{21159}{along} \markbox{m21160}{$\lambda(a,b)$}.  \markbox{21161}{It} \markbox{21162}{follows} \markbox{21163}{then} \markbox{21164}{that} \markbox{21165}{the} \markbox{21166}{subgraph} \markbox{21167}{of} \markbox{m21168}{$\calG$} \markbox{21169}{connecting} \markbox{21170}{the} \markbox{21171}{cluster} \markbox{21172}{containing} \markbox{m21173}{$a$} \markbox{21174}{to} \markbox{m21175}{$C_1$} \markbox{21176}{is} \markbox{21177}{identical} \markbox{21178}{to} \markbox{21179}{the} \markbox{21180}{subgraph} \markbox{21181}{of} \markbox{m21182}{$\calG_E(a,b;\calY \cup \{z\})$}, \markbox{21183}{and} \markbox{21184}{similarly} \markbox{21185}{for} \markbox{21186}{the} \markbox{21187}{subgraphs} \markbox{21188}{connecting} \markbox{m21189}{$C_2$} \markbox{21190}{to} \markbox{21191}{the} \markbox{21192}{cluster} \markbox{21193}{containing} \markbox{m21194}{$b$}.  \markbox{21195}{This} \markbox{21196}{says} \markbox{21197}{that} \markbox{21198}{for} \markbox{21199}{any} \markbox{21200}{pair} \markbox{m21201}{$C,C'$} \markbox{21202}{on} \markbox{21203}{the} \markbox{m21204}{$a$}-side \markbox{21205}{of} \markbox{m21206}{$z$} \markbox{21207}{in} \markbox{m21208}{$\calG'$}, \markbox{m21209}{$\lambda_0(C,C')$} \markbox{21210}{is} \markbox{21211}{an} \markbox{21212}{edge} \markbox{21213}{component} \markbox{21214}{of} \markbox{21215}{both} \markbox{m21216}{$T$} \markbox{21217}{and} \markbox{m21218}{$T'$}, \markbox{21219}{and} \markbox{21220}{similarly} \markbox{21221}{for} \markbox{21222}{such} \markbox{21223}{pairs}  \markbox{21224}{on} \markbox{21225}{the} \markbox{m21226}{$b$}-side \markbox{21227}{of} \markbox{m21228}{$z$}.  \markbox{21229}{Thus} \markbox{21230}{we} \markbox{21231}{can} \markbox{21232}{include} \markbox{21233}{each} \markbox{21234}{such} \markbox{21235}{component} \markbox{21236}{of} \markbox{m21237}{$E \subset T_e$} \markbox{21238}{and} \markbox{m21239}{$E \subset T'_e$} \markbox{21240}{in} \markbox{21241}{the} \markbox{21242}{respective} \markbox{21243}{stable} \markbox{21244}{decomposition} \markbox{m21245}{$T_s \subset T_e$} \markbox{21246}{and} \markbox{m21247}{$T'_s \subset T'_e$}, \markbox{21248}{where} \markbox{21249}{the} \markbox{21250}{identity} \markbox{21251}{map} \markbox{21252}{is} \markbox{21253}{the} \markbox{21254}{map} \markbox{21255}{described} \markbox{21256}{in} \markbox{21257}{parts} \eqref{item:stable pairs} \markbox{21258}{and} \eqref{item:identical pairs} \markbox{21259}{of} \markbox{21260}{Definition} \ref{defn:stable decomp}.  \markbox{21261}{By} construction, \markbox{21262}{each} \markbox{21263}{of} \markbox{21264}{these} \markbox{21265}{pieces} \markbox{21266}{has} \markbox{21267}{positive} \markbox{21268}{integer} length, \markbox{21269}{thus} \markbox{21270}{verifying} \markbox{21271}{property} \eqref{item:integer length}.

To \markbox{21272}{construct} \markbox{21273}{the} \markbox{21274}{rest} \markbox{21275}{of} \markbox{21276}{the} \markbox{21277}{stable} decompositions, \markbox{21278}{namely} \markbox{21279}{stable} \markbox{21280}{pieces} \markbox{21281}{of} \markbox{21282}{type} \eqref{item:close pairs} \markbox{21283}{in} \markbox{21284}{Definition} \ref{defn:stable decomp}, \markbox{21285}{we} \markbox{21286}{need} \markbox{21287}{to} \markbox{21288}{compare} \markbox{21289}{the} \markbox{21290}{component} \markbox{m21291}{$\lambda_0(C_1, C_2) \subset T_e$} \markbox{21292}{to} \markbox{21293}{the} \markbox{21294}{two} \markbox{21295}{components} \markbox{m21296}{$\lambda_0(C_1,z) \cup \lambda_0(z, C_2) \subset T'_e$}.  First, \markbox{21297}{Lemma} \ref{lem:cluster close} \markbox{21298}{says} \markbox{21299}{that} \markbox{21300}{the} \markbox{21301}{endpoints} \markbox{21302}{of} \markbox{m21303}{$\lambda(C_1,C_2)$} \markbox{21304}{and} \markbox{m21305}{$\lambda(C_1,z)$} \markbox{21306}{on} \markbox{m21307}{$C_1$} \markbox{21308}{are} \markbox{m21309}{$14\epsilon$}-close, \markbox{21310}{and} \markbox{21311}{hence} \markbox{21312}{the} \markbox{21313}{endpoints} \markbox{21314}{of} \markbox{m21315}{$\lambda_0(C_1,C_2)$} \markbox{21316}{and} \markbox{m21317}{$\lambda_0(C_1,z)$} \markbox{21318}{are} \markbox{21319}{within} \markbox{m21320}{$14\epsilon+2$}, \markbox{21321}{and} \markbox{21322}{similarly} \markbox{21323}{for} \markbox{m21324}{$C_2$}.  \markbox{21325}{It} \markbox{21326}{follows} \markbox{21327}{from} \markbox{m21328}{$\delta$}-hyperbolicity \markbox{21329}{of} \markbox{m21330}{$\calZ$} \markbox{21331}{that} \markbox{m21332}{$\lambda_0(C_1, C_2)$} \markbox{21333}{and} \markbox{m21334}{$ \lambda_0(C_1,z) \cup \lambda_0(z, C_2)$} \markbox{21335}{are} \markbox{m21336}{$O(\epsilon)$}-Hausdorff close.  Now, \markbox{21337}{unless} \markbox{m21338}{$C_1,C_2$} \markbox{21339}{are} \markbox{m21340}{$O(\epsilon)$}-close \markbox{21341}{in} \markbox{m21342}{$\calZ$}---in \markbox{21343}{which} \markbox{21344}{case} \markbox{21345}{we} \markbox{21346}{can} \markbox{21347}{declare} \markbox{21348}{all} \markbox{21349}{three} \markbox{21350}{of} \markbox{21351}{these} \markbox{21352}{geodesics} \markbox{21353}{to} \markbox{21354}{be} unstable---then \markbox{21355}{the} \markbox{21356}{shadow} \markbox{m21357}{$s_T(z)$} \markbox{21358}{of} \markbox{m21359}{$z$} \markbox{21360}{on} \markbox{m21361}{$T$} \markbox{21362}{will} \markbox{21363}{be} \markbox{21364}{properly} \markbox{21365}{contained} \markbox{21366}{in} \markbox{m21367}{$\lambda_0(C_1,C_2)$} \markbox{21368}{and} \markbox{21369}{have} \markbox{m21370}{$O(\epsilon)$}-bounded diameter.    \markbox{21371}{Hence} \markbox{21372}{we} \markbox{21373}{can} \markbox{21374}{decompose} \markbox{21375}{these} \markbox{21376}{geodesics} \markbox{21377}{into} \markbox{m21378}{$O(\epsilon)$}-close \markbox{21379}{stable} \markbox{21380}{pieces} \markbox{21381}{and} \markbox{21382}{unstable} \markbox{21383}{pieces} \markbox{21384}{labeled} \markbox{21385}{by} \markbox{m21386}{$z$}, \markbox{21387}{as} \markbox{21388}{described} \markbox{21389}{in} \markbox{21390}{property} \eqref{item:unstable components}, \markbox{21391}{while} \markbox{21392}{satisfying} \markbox{21393}{the} \markbox{21394}{length} \markbox{21395}{requirement} \markbox{21396}{of} \eqref{item:integer length} \markbox{21397}{and} \markbox{21398}{proximity} \markbox{21399}{requirements} \markbox{21400}{of} \eqref{item:identical pairs} \markbox{21401}{and} \eqref{item:close pairs}; \markbox{21402}{see} \markbox{21403}{Figure} \ref{fig:split cluster} \markbox{21404}{for} \markbox{21405}{a} \markbox{21406}{heuristic} picture.  \markbox{21407}{For} \markbox{21408}{the} \markbox{21409}{bijection} \markbox{m21410}{$\alpha:\pi_0(T_s) \to \pi_0(T'_s)$}, \markbox{21411}{since} \markbox{m21412}{$T_s,T'_s$} \markbox{21413}{have} \markbox{21414}{the} \markbox{21415}{same} \markbox{21416}{number} \markbox{21417}{of} components, \markbox{21418}{we} \markbox{21419}{can} \markbox{21420}{take} \markbox{21421}{let} \markbox{m21422}{$\alpha$} \markbox{21423}{denote} \markbox{21424}{the} \markbox{21425}{natural} order-preserving bijection, i.e. \markbox{21426}{the} \markbox{21427}{one} \markbox{21428}{obtained} \markbox{21429}{by} \markbox{21430}{moving} \markbox{21431}{along} \markbox{21432}{the} \markbox{21433}{geodesics} \markbox{m21434}{$[a,b]_{T}$} \markbox{21435}{and} \markbox{m21436}{$[a,b]_{T'}$}.  \markbox{21437}{By} construction, \markbox{21438}{this} \markbox{21439}{bijection} \markbox{21440}{identifies} \markbox{21441}{the} \markbox{21442}{components} \markbox{21443}{we} \markbox{21444}{want} \markbox{21445}{so} \markbox{21446}{that} \markbox{21447}{the} \markbox{21448}{related} \markbox{21449}{conditions} \eqref{item:identical pairs} \markbox{21450}{and} \eqref{item:close pairs} \markbox{21451}{are} satisfied.

Finally, \markbox{21452}{we} \markbox{21453}{need} \markbox{21454}{to} \markbox{21455}{confirm} \markbox{21456}{the} \markbox{21457}{properties} \markbox{21458}{in} \eqref{item:adjacency} \markbox{21459}{for} \markbox{21460}{the} order-preserving \markbox{21461}{bijection} \markbox{m21462}{$\beta:\pi_0(T - T_s) \to \pi_0 (T'-T'_s)$} \markbox{21463}{induced} \markbox{21464}{by} \markbox{m21465}{$\alpha$}.  \markbox{21466}{Since} \markbox{m21467}{$\beta$} \markbox{21468}{is} order-preserving (with \markbox{21469}{the} \markbox{21470}{order} \markbox{21471}{being} ``from \markbox{m21472}{$a$} \markbox{21473}{to} \markbox{m21474}{$b$}'', \markbox{21475}{as} \markbox{21476}{in} \markbox{21477}{Definition} \ref{defn:order preserving}), \eqref{item:endpoint condition}, i.e. \markbox{21478}{that} \markbox{21479}{the} \markbox{21480}{components} \markbox{21481}{of} \markbox{m21482}{$T-T_s$} \markbox{21483}{and} \markbox{m21484}{$T' - T'_s$} \markbox{21485}{associated} \markbox{21486}{to} \markbox{m21487}{$a$} \markbox{21488}{and} \markbox{m21489}{$b$} \markbox{21490}{are} identified, \markbox{21491}{is} \markbox{21492}{automatically} satisfied.  \markbox{21493}{For} \eqref{item:cluster identify}, \markbox{21494}{note} \markbox{21495}{that} \markbox{m21496}{$\calY \cap (\calY \cup \{z\}) = \calY$}, and, \markbox{21497}{by} \markbox{21498}{construction} again, \markbox{21499}{if} \markbox{m21500}{$y \in \calY$}, \markbox{21501}{then} \markbox{m21502}{$\beta$} \markbox{21503}{identifies} \markbox{21504}{the} \markbox{21505}{component} \markbox{m21506}{$D_y$} \markbox{21507}{of} \markbox{m21508}{$T- T_s$} \markbox{21509}{corresponding} \markbox{21510}{to} \markbox{m21511}{$y$} \markbox{21512}{with} \markbox{m21513}{$D'_y$}, \markbox{21514}{the} \markbox{21515}{component} \markbox{21516}{of} \markbox{m21517}{$T'-T'_s$} \markbox{21518}{corresponding} \markbox{21519}{to} \markbox{m21520}{$y$}.  \markbox{21521}{In} \markbox{21522}{this} case, \markbox{21523}{this} \markbox{21524}{is} \markbox{21525}{because} \markbox{21526}{all} \markbox{21527}{such} \markbox{21528}{components} \markbox{21529}{are} \markbox{21530}{exactly} \markbox{21531}{the} same.   \markbox{21532}{This} \markbox{21533}{proves} \markbox{21534}{part} (1) \markbox{21535}{of} \markbox{21536}{the} statement.

For \markbox{21537}{part} (2) \markbox{21538}{of} \markbox{21539}{the} statement, \markbox{21540}{we} \markbox{21541}{want} \markbox{21542}{to} \markbox{21543}{consider} \markbox{21544}{how} \markbox{21545}{the} \markbox{m21546}{$(r_1,r_2)$}-thickenings \markbox{21547}{of} \markbox{m21548}{$T,T'$} \markbox{21549}{along} \markbox{m21550}{$T_c,T'_c$} \markbox{21551}{respectively} \markbox{21552}{affect} \markbox{21553}{the} \markbox{21554}{decompositions} \markbox{m21555}{$T_s \subset T_e$} \markbox{21556}{and} \markbox{m21557}{$T'_s \subset T'_e$}.  First, \markbox{21558}{observe} \markbox{21559}{that} \markbox{m21560}{$\bT_e \subset T_e$} \markbox{21561}{and} \markbox{m21562}{$\bT'_e \subset T'_e$} \markbox{21563}{by} definition.  \markbox{21564}{In} particular, \markbox{21565}{consider} \markbox{21566}{a} \markbox{21567}{component} \markbox{m21568}{$D \subset T_e$}, \markbox{21569}{where} \markbox{m21570}{$D = \lambda_0(C,C')$} \markbox{21571}{for} \markbox{21572}{adjacent} \markbox{21573}{clusters} \markbox{m21574}{$C,C'$}.  \markbox{21575}{Then} \markbox{21576}{the} \markbox{m21577}{$(r_1,r_2)$}-thickening \markbox{21578}{of} \markbox{m21579}{$D$} \markbox{21580}{either} \markbox{21581}{truncates} \markbox{m21582}{$D$} \markbox{21583}{to} \markbox{m21584}{$D_{thick} = D - (\mu_{r_1}(C) \cup \mu_{r_1}(C'))$}, \markbox{21585}{or} \markbox{21586}{possibly} \markbox{21587}{removes} \markbox{m21588}{$D$} \markbox{21589}{entirely} \markbox{21590}{from} \markbox{m21591}{$\bT_e$} \markbox{21592}{if} \markbox{m21593}{$d_T(\mu(C), \mu(C'))<r_2-2r_1$}.  \markbox{21594}{A} \markbox{21595}{similar} \markbox{21596}{statement} \markbox{21597}{holds} \markbox{21598}{for} \markbox{21599}{components} \markbox{21600}{of} \markbox{m21601}{$T'_e$}.

By \markbox{21602}{the} above, \markbox{21603}{most} \markbox{21604}{components} \markbox{21605}{of} \markbox{m21606}{$T_s$} \markbox{21607}{and} \markbox{m21608}{$T'_s$} \markbox{21609}{are} \markbox{21610}{identical} \markbox{21611}{components} \markbox{21612}{of} \markbox{m21613}{$T_e, T'_e$}, \markbox{21614}{and} \markbox{21615}{hence} \markbox{21616}{their} \markbox{21617}{thickenings} \markbox{21618}{are} \markbox{21619}{exactly} \markbox{21620}{the} \markbox{21621}{same} \markbox{21622}{by} \markbox{21623}{the} above.  \markbox{21624}{For} \markbox{21625}{the} \markbox{21626}{remaining} components, \markbox{21627}{namely} \markbox{m21628}{$\lambda_0(C_1,z), \lambda_0(z,C_2)$} \markbox{21629}{of} \markbox{m21630}{$T'_e$} \markbox{21631}{and} \markbox{m21632}{$\lambda_0(C_1,C_2)$} \markbox{21633}{of} \markbox{m21634}{$T_e$}, \markbox{21635}{each} \markbox{21636}{is} \markbox{21637}{either} \markbox{21638}{truncated} \markbox{21639}{or} \markbox{21640}{removed} \markbox{21641}{as} above.  \markbox{21642}{The} \markbox{21643}{remaining} \markbox{21644}{two} \markbox{21645}{components} \markbox{21646}{of} \markbox{21647}{the} \markbox{21648}{stable} \markbox{21649}{decomposition} \markbox{m21650}{$T_s$} \markbox{21651}{correspond} \markbox{21652}{to} \markbox{m21653}{$\lambda_0(C_1,z)$} \markbox{21654}{and} \markbox{m21655}{$\lambda_0(z,C_2)$}, \markbox{21656}{and} \markbox{21657}{so} \markbox{21658}{one} \markbox{21659}{can} \markbox{21660}{construct} \markbox{21661}{the} \markbox{21662}{corresponding} \markbox{21663}{components} \markbox{21664}{of} \markbox{m21665}{$\bT_s$} \markbox{21666}{by} \markbox{21667}{applying} \markbox{21668}{the} \markbox{21669}{same} \markbox{21670}{procedure} \markbox{21671}{to} \markbox{21672}{the} \markbox{m21673}{$(r_1,r_2)$}-thickening \markbox{21674}{of} \markbox{m21675}{$\lambda_0(C_1,z)$} \markbox{21676}{and} \markbox{m21677}{$\lambda_0(z,C_2)$}.  \markbox{21678}{Note} \markbox{21679}{that} \markbox{21680}{this} \markbox{21681}{can} \markbox{21682}{inflate} \markbox{21683}{the} \markbox{21684}{proximity} constants, \markbox{21685}{but} \markbox{21686}{only} \markbox{21687}{in} \markbox{21688}{terms} \markbox{21689}{of} \markbox{m21690}{$r_1,r_2$}.  \markbox{21691}{The} \markbox{21692}{rest} \markbox{21693}{of} \markbox{21694}{the} \markbox{21695}{proof} \markbox{21696}{goes} \markbox{21697}{through} unchanged; \markbox{21698}{see} \markbox{21699}{Figure} \ref{fig:split cluster}.




\medskip

\underline{\textbf{Case (b), $z$ affects other clusters}}: \markbox{21700}{Suppose} \markbox{21701}{now} \markbox{21702}{instead} \markbox{21703}{that} \markbox{21704}{there} \markbox{21705}{exists} \markbox{21706}{some} \markbox{21707}{cluster} \markbox{m21708}{$C$} \markbox{21709}{for} \markbox{m21710}{$(a,b;\calY)$} \markbox{21711}{so} \markbox{21712}{that} \markbox{m21713}{$d(z,C)<E$}; \markbox{21714}{we} \markbox{21715}{say} \markbox{m21716}{$C$} \markbox{21717}{is} \markbox{21718}{an}  \emph{affected cluster}.

\begin{claim}\label{claim:bounded affect}
If \markbox{m21719}{$3E - 56\epsilon > 2E$}, \markbox{21720}{then} \markbox{21721}{there} \markbox{21722}{are} \markbox{21723}{at} \markbox{21724}{most} \markbox{21725}{three} \markbox{21726}{affected} clusters, \markbox{21727}{and} \markbox{21728}{they} \markbox{21729}{are} \markbox{21730}{adjacent} \markbox{21731}{in} \markbox{m21732}{$\calG$}.
\end{claim}

\begin{proof}
Suppose \markbox{21733}{that} \markbox{m21734}{$C_1,\dots, C_4$} \markbox{21735}{are} \markbox{21736}{four} \markbox{21737}{clusters} \markbox{21738}{appearing} \markbox{21739}{in} \markbox{21740}{that} \markbox{21741}{order} \markbox{21742}{along} \markbox{m21743}{$\lambda(a,b)$}.  \markbox{21744}{By} \markbox{21745}{item} (1) \markbox{21746}{of} \markbox{21747}{Lemma} \ref{lem:cluster close}, \markbox{21748}{since} \markbox{m21749}{$d(C_i, C_{i+1})\geq E$}, \markbox{21750}{we} \markbox{21751}{have} \markbox{m21752}{$d(s(C_i), s(C_{i+1}))> E - 14\epsilon$}, \markbox{21753}{for} \markbox{m21754}{$i = 1,2,3$}.

Since \markbox{21755}{the} \markbox{21756}{shadows} \markbox{21757}{are} \markbox{21758}{disjoint} \markbox{21759}{segments} \markbox{21760}{of} \markbox{21761}{the} \markbox{21762}{geodesic} \markbox{m21763}{$\lambda(a,b)$}, \markbox{21764}{we} \markbox{21765}{have} that
$$d(s(C_1), s(C_4)) \geq d(s(C_1), s(C_2)) + d(s(C_2), s(C_3))+d(s(C_3), s(C_4)) \geq 3E -42\epsilon.$$
Hence \markbox{21766}{if} \markbox{m21767}{$3E-56\epsilon \geq 2E$}, \markbox{21768}{then} \markbox{21769}{item} (1) \markbox{21770}{of} \markbox{21771}{Lemma} \ref{lem:cluster close} \markbox{21772}{says} \markbox{21773}{that} 
$$d(C_1,C_4) \geq d(s(C_1),s(C_4)) - 14\epsilon \geq 3E-56\epsilon > 2E.$$

This \markbox{21774}{is} \markbox{21775}{impossible} \markbox{21776}{if} \markbox{m21777}{$z$} \markbox{21778}{is} \markbox{m21779}{$E$}-close \markbox{21780}{to} \markbox{21781}{both} \markbox{m21782}{$C_1,C_4$}.  \markbox{21783}{Hence} \markbox{21784}{there} \markbox{21785}{are} \markbox{21786}{at} \markbox{21787}{most} \markbox{21788}{three} \markbox{21789}{affected} \markbox{21790}{clusters} \markbox{21791}{and} \markbox{21792}{they} \markbox{21793}{are} \markbox{21794}{adjacent} \markbox{21795}{vertices} \markbox{21796}{in} \markbox{m21797}{$\calG$}.
\end{proof}



Let \markbox{m21798}{$C'$} \markbox{21799}{denote} \markbox{21800}{the} \markbox{21801}{cluster} \markbox{21802}{formed} \markbox{21803}{by} \markbox{m21804}{$z$} \markbox{21805}{and} \markbox{21806}{the} \markbox{21807}{affected} \markbox{21808}{clusters} \markbox{21809}{from} \markbox{m21810}{$(a,b;\calY)$}.  \markbox{21811}{Note} \markbox{21812}{that} \markbox{21813}{the} \markbox{21814}{membership} \markbox{21815}{of} \markbox{21816}{all} \markbox{21817}{other} \markbox{m21818}{$(a,b;\calY)$}-clusters \markbox{21819}{are} \markbox{21820}{unchanged} \markbox{21821}{by} \markbox{21822}{the} \markbox{21823}{addition} \markbox{21824}{of} \markbox{m21825}{$z$}.  \markbox{21826}{Let} \markbox{m21827}{$C_1$} \markbox{21828}{and} \markbox{m21829}{$C_2$} \markbox{21830}{be} \markbox{21831}{the} \markbox{21832}{clusters} \markbox{21833}{adjacent} \markbox{21834}{to} \markbox{21835}{the} \markbox{21836}{affected} \markbox{21837}{clusters} \markbox{21838}{in} \markbox{m21839}{$\calG$} \markbox{21840}{on} \markbox{21841}{the} \markbox{21842}{side} \markbox{21843}{of} \markbox{m21844}{$a$} \markbox{21845}{and} \markbox{m21846}{$b$}, respectively.  \markbox{21847}{As} \markbox{21848}{in} \markbox{21849}{the} \markbox{21850}{split} \markbox{21851}{cluster} \markbox{21852}{case} above, \markbox{21853}{Lemma} \ref{lem:cluster arrangement} \markbox{21854}{implies} \markbox{21855}{that} \markbox{m21856}{$C_1$} \markbox{21857}{separates} \markbox{21858}{all} \markbox{21859}{clusters} \markbox{21860}{on} \markbox{21861}{the} \markbox{m21862}{$a$}-side \markbox{21863}{of} \markbox{m21864}{$\calG$} \markbox{21865}{from} \markbox{m21866}{$C'$}, \markbox{21867}{and} \markbox{21868}{similarly} \markbox{21869}{for} \markbox{m21870}{$C_2$} \markbox{21871}{and} \markbox{21872}{clusters} \markbox{21873}{on} \markbox{21874}{the} \markbox{m21875}{$b$}-side.  \markbox{21876}{Hence} \markbox{21877}{the} \markbox{21878}{subgraph} \markbox{21879}{of} \markbox{m21880}{$\calG$} \markbox{21881}{connecting} \markbox{21882}{the} \markbox{21883}{cluster} \markbox{21884}{containing} \markbox{m21885}{$a$} \markbox{21886}{to} \markbox{m21887}{$C_1$} \markbox{21888}{is} \markbox{21889}{the} \markbox{21890}{subgraph} \markbox{21891}{of} \markbox{m21892}{$\calG'$} \markbox{21893}{connecting} \markbox{21894}{the} (same) \markbox{21895}{cluster} \markbox{21896}{containing} \markbox{m21897}{$a$} \markbox{21898}{to} \markbox{m21899}{$C_1$}, \markbox{21900}{and} \markbox{21901}{similarly} \markbox{21902}{for} \markbox{21903}{the} \markbox{m21904}{$b$}-side \markbox{21905}{of} \markbox{m21906}{$\calG$} \markbox{21907}{and} \markbox{m21908}{$\calG'$}.  \markbox{21909}{As} such, \markbox{21910}{all} \markbox{21911}{of} \markbox{21912}{the} \markbox{21913}{corresponding} \markbox{21914}{components} \markbox{21915}{of} \markbox{m21916}{$T_e$} \markbox{21917}{and} \markbox{m21918}{$T'_e$} \markbox{21919}{are} \markbox{21920}{exactly} \markbox{21921}{the} same, \markbox{21922}{and} \markbox{21923}{have} \markbox{21924}{positive} \markbox{21925}{integer} \markbox{21926}{length} \markbox{21927}{by} construction, \markbox{21928}{verifying} \markbox{21929}{properties} \eqref{item:integer length}, \eqref{item:stable pairs}, \markbox{21930}{and} \eqref{item:identical pairs} \markbox{21931}{of} \markbox{21932}{Definition} \ref{defn:stable decomp} \markbox{21933}{for} \markbox{21934}{these} components.

The \markbox{21935}{forests} \markbox{m21936}{$T_e$} \markbox{21937}{and} \markbox{m21938}{$T'_e$} \markbox{21939}{have} \markbox{21940}{some} \markbox{21941}{remaining} \markbox{21942}{components} \markbox{21943}{which} \markbox{21944}{we} \markbox{21945}{need} \markbox{21946}{to} decompose.  \markbox{21947}{In} \markbox{m21948}{$T_e$}, \markbox{21949}{there} \markbox{21950}{are} \markbox{21951}{the} at-most \markbox{m21952}{$2$} \markbox{21953}{components} \markbox{21954}{of} \markbox{m21955}{$T_e$} \markbox{21956}{which} \markbox{21957}{connect} \markbox{21958}{the} \markbox{21959}{affected} clusters.  \markbox{21960}{By} assumption, \markbox{21961}{these} \markbox{21962}{segments} \markbox{21963}{are} \markbox{21964}{at} \markbox{21965}{most} \markbox{m21966}{$O(\epsilon)$} long, \markbox{21967}{so} \markbox{21968}{we} \markbox{21969}{can} \markbox{21970}{declare} \markbox{21971}{them} \markbox{21972}{to} \markbox{21973}{be} \markbox{21974}{unstable} components.

We \markbox{21975}{now} \markbox{21976}{explain} \markbox{21977}{how} \markbox{21978}{to} \markbox{21979}{handle} \markbox{21980}{the} \markbox{21981}{two} \markbox{21982}{remaining} components.  \markbox{21983}{Let} \markbox{m21984}{$A$} \markbox{21985}{be} \markbox{21986}{the} \markbox{21987}{affected} \markbox{21988}{cluster} \markbox{21989}{adjacent} \markbox{21990}{to} \markbox{m21991}{$C_1$} \markbox{21992}{in} \markbox{m21993}{$\calG$}.  \markbox{21994}{It} \markbox{21995}{is} \markbox{21996}{enough} \markbox{21997}{to} \markbox{21998}{show} \markbox{21999}{that} \markbox{22000}{the} \markbox{22001}{geodesic} \markbox{22002}{segments} \markbox{m22003}{$\lambda(C_1,A)$} \markbox{22004}{and} \markbox{m22005}{$\lambda(C_1,C')$} \markbox{22006}{are} \markbox{m22007}{$O(\epsilon)$}-Hausdorff close, \markbox{22008}{since} \markbox{22009}{then} \markbox{22010}{the} \markbox{22011}{lengths} \markbox{22012}{of} \markbox{m22013}{$\lambda_0(C_1,A)$} \markbox{22014}{and} \markbox{m22015}{$\lambda_0(C_1,C')$} \markbox{22016}{are} \markbox{22017}{the} \markbox{22018}{same} \markbox{22019}{up} \markbox{22020}{to} \markbox{22021}{error} \markbox{m22022}{$O(\epsilon)$}, \markbox{22023}{and} \markbox{22024}{we} \markbox{22025}{can} \markbox{22026}{declare} \markbox{22027}{a} \markbox{22028}{small} \markbox{22029}{end} \markbox{22030}{segment} \markbox{22031}{of} \markbox{22032}{each} unstable, \markbox{22033}{so} \markbox{22034}{that} \markbox{22035}{their} (stable) \markbox{22036}{complements} \markbox{22037}{have} \markbox{22038}{the} \markbox{22039}{same} (positive integer) \markbox{22040}{length} \markbox{22041}{and} \markbox{22042}{are} \markbox{m22043}{$O(\epsilon)$}-close.  \markbox{22044}{But} \markbox{22045}{this} \markbox{22046}{endpoint} \markbox{22047}{proximity} \markbox{22048}{statement} \markbox{22049}{is} \markbox{22050}{again} \markbox{22051}{a} \markbox{22052}{consequence} \markbox{22053}{of} \markbox{22054}{Lemma} \ref{lem:cluster close}, \markbox{22055}{since} \markbox{22056}{the} \markbox{22057}{endpoints} \markbox{22058}{of} \markbox{m22059}{$\lambda(C_1,A)$} \markbox{22060}{and} \markbox{m22061}{$\lambda(C_1,C')$} \markbox{22062}{are} \markbox{22063}{within} \markbox{m22064}{$7\epsilon$} \markbox{22065}{of} \markbox{22066}{the} \markbox{22067}{endpoint} \markbox{22068}{of} \markbox{m22069}{$s(C_1)$} \markbox{22070}{on} \markbox{m22071}{$\lambda(a,b)$}, \markbox{22072}{while} \markbox{m22073}{$s(C')$} \markbox{22074}{contains} \markbox{m22075}{$s(A)$} \markbox{22076}{and} \markbox{22077}{its} \markbox{22078}{endpoint} \markbox{22079}{is} \markbox{22080}{at} \markbox{22081}{most} \markbox{m22082}{$(E+\epsilon)$}-away.  Finally, \markbox{22083}{the} \markbox{22084}{bijection} \markbox{m22085}{$\beta:\pi_0(T-T_s) \to \pi_0(T'-T'_s)$} \markbox{22086}{required} \markbox{22087}{for} \eqref{item:adjacency} \markbox{22088}{is} \markbox{22089}{defined} \markbox{22090}{similar} \markbox{22091}{to} \markbox{22092}{the} \markbox{22093}{split} \markbox{22094}{cluster} \markbox{22095}{case} (a), \markbox{22096}{with} \markbox{22097}{the} \markbox{22098}{proof} \markbox{22099}{of} \markbox{22100}{condition} \eqref{item:endpoint condition} \markbox{22101}{being} \markbox{22102}{basically} \markbox{22103}{the} same.  \markbox{22104}{For} \markbox{22105}{condition} \eqref{item:cluster identify}, \markbox{22106}{observe} \markbox{22107}{again} \markbox{22108}{the} \markbox{m22109}{$\calY \cap (\calY \cup \{z\}) = \calY$}.  \markbox{22110}{Assuming} \markbox{22111}{that} \markbox{m22112}{$y \in \calY$} \markbox{22113}{is} \markbox{22114}{contained} \markbox{22115}{in} \markbox{22116}{an} \markbox{22117}{affected} \markbox{22118}{cluster} \markbox{22119}{in} \markbox{22120}{the} \markbox{m22121}{$(\calY; \{a,b\})$} setup---since otherwise, \markbox{22122}{it} \markbox{22123}{is} \markbox{22124}{contained} \markbox{22125}{in} \markbox{22126}{an} \markbox{22127}{identical} \markbox{22128}{cluster} \markbox{22129}{in} \markbox{22130}{the} \markbox{m22131}{$(\calY \cup \{z\};\{a,b\})$} setup---then \markbox{22132}{it} \markbox{22133}{corresponds} \markbox{22134}{to} \markbox{22135}{the} \markbox{22136}{single} \markbox{22137}{component} \markbox{22138}{which} \markbox{22139}{gets} \markbox{22140}{identified} \markbox{22141}{with} \markbox{22142}{the} \markbox{22143}{component} \markbox{22144}{of} \markbox{m22145}{$T'- T'_s$} \markbox{22146}{corresponding} \markbox{22147}{to} \markbox{22148}{the} \markbox{22149}{single} \markbox{22150}{cluster} \markbox{22151}{containing} \markbox{22152}{both} \markbox{m22153}{$y$} \markbox{22154}{and} \markbox{m22155}{$z$}.  \markbox{22156}{This} \markbox{22157}{completes} \markbox{22158}{the} \markbox{22159}{proof} \markbox{22160}{of} (1) \markbox{22161}{in} \markbox{22162}{the} \markbox{22163}{affected} \markbox{22164}{cluster} case.  \markbox{22165}{See} \markbox{22166}{Figure} \ref{fig:affected cluster} \markbox{22167}{for} \markbox{22168}{a} \markbox{22169}{heuristic} picture.

The \markbox{22170}{argument} \markbox{22171}{for} (2) \markbox{22172}{in} \markbox{22173}{the} \markbox{22174}{affected} \markbox{22175}{cluster} \markbox{22176}{case} \markbox{22177}{is} \markbox{22178}{essentially} \markbox{22179}{identical} \markbox{22180}{to} \markbox{22181}{the} \markbox{22182}{split} \markbox{22183}{cluster} version: \markbox{22184}{All} \markbox{22185}{but} \markbox{22186}{a} \markbox{22187}{few} \markbox{22188}{components} \markbox{22189}{of} \markbox{m22190}{$T_s \subset T_e$} \markbox{22191}{and} \markbox{m22192}{$T'_s \subset T'_e$} \markbox{22193}{are} \markbox{22194}{identical} \markbox{22195}{and} \markbox{22196}{thus} \markbox{22197}{have} \markbox{22198}{identical} \markbox{m22199}{$(r_1,r_2)$}-thickenings.  \markbox{22200}{And} \markbox{22201}{the} \markbox{22202}{remaining} \markbox{22203}{components} \markbox{22204}{of} \markbox{m22205}{$T_s, T'_s$} \markbox{22206}{are} \markbox{22207}{constructed} \markbox{22208}{by} \markbox{22209}{pairing} \markbox{22210}{the} \markbox{22211}{corresponding} \markbox{22212}{components} \markbox{22213}{of} \markbox{m22214}{$T_e, T'_e$} \markbox{22215}{adjacent} \markbox{22216}{to} \markbox{22217}{or} \markbox{22218}{connecting} \markbox{22219}{the} \markbox{22220}{affected} clusters, \markbox{22221}{and} \markbox{22222}{then} \markbox{22223}{either} \markbox{22224}{declaring} \markbox{22225}{them} \markbox{22226}{unstable} \markbox{22227}{or} \markbox{22228}{modifying} \markbox{22229}{them} \markbox{22230}{pairwise} \markbox{22231}{to} \markbox{22232}{achieve} \markbox{22233}{the} \markbox{22234}{length} bound.  \markbox{22235}{As} above, \markbox{22236}{this} \markbox{22237}{can} \markbox{22238}{be} \markbox{22239}{accomplished} post-thickening; \markbox{22240}{see} \markbox{22241}{Figure} \ref{fig:affected cluster}.  \markbox{22242}{This} \markbox{22243}{completes} \markbox{22244}{the} \markbox{22245}{proof} \markbox{22246}{of} \markbox{22247}{the} theorem.

\end{proof}

\subsection{Iterating stable decompositions}


Next \markbox{22248}{we} \markbox{22249}{move} \markbox{22250}{to} \markbox{22251}{proving} \markbox{22252}{our} \markbox{22253}{iteration} \markbox{22254}{statement} (Proposition \ref{prop:stable iteration}).  \markbox{22255}{The} \markbox{22256}{main} \markbox{22257}{work} \markbox{22258}{is} \markbox{22259}{the} \markbox{22260}{base} \markbox{22261}{case} \markbox{22262}{of} \markbox{22263}{combining} \markbox{22264}{two} \markbox{22265}{pairs} \markbox{22266}{of} \markbox{22267}{stable} \markbox{22268}{decompositions} \markbox{22269}{across} \markbox{22270}{a} \markbox{22271}{common} setup.

For this, \markbox{22272}{suppose} \markbox{22273}{we} \markbox{22274}{have} \markbox{22275}{three} \markbox{22276}{setups} \markbox{m22277}{$(a_i,b_i;\calY_i)$} \markbox{22278}{for} \markbox{m22279}{$i=1,2,3$}, \markbox{22280}{satisfying} \markbox{22281}{that} \markbox{m22282}{$\calY_i \subset \calN_{\epsilon/2}(\lambda(a_j,b_k))$} \markbox{22283}{for} \markbox{22284}{all} \markbox{m22285}{$i,j,k$}, \markbox{22286}{and} \markbox{22287}{that} \markbox{m22288}{$\calY_0 \subset \calY_i$} \markbox{22289}{for} \markbox{22290}{each} \markbox{m22291}{$i$}.  \markbox{22292}{Suppose} \markbox{22293}{that} \markbox{22294}{the} \markbox{22295}{stable} \markbox{22296}{intervals} \markbox{22297}{associated} \markbox{22298}{to} \markbox{m22299}{$(a_1,b_1;\calY_1)$} \markbox{22300}{and} \markbox{m22301}{$(a_2,b_2;\calY_2)$} \markbox{22302}{admits} \markbox{m22303}{$\calY_0$}-stable \markbox{m22304}{$L$}-compatible decompositions, \markbox{22305}{and} \markbox{22306}{the} \markbox{22307}{same} \markbox{22308}{for} \markbox{m22309}{$(a_2,b_2;\calY_2)$} \markbox{22310}{and} \markbox{m22311}{$(a_3,b_3;\calY_3)$}.  \markbox{22312}{Our} \markbox{22313}{goal} \markbox{22314}{is} \markbox{22315}{to} \markbox{22316}{induce} \markbox{22317}{new} \markbox{22318}{stable} \markbox{22319}{decompositions} \markbox{22320}{on} \markbox{m22321}{$T_1,T_2$} \markbox{22322}{and} \markbox{m22323}{$T_2,T_3$} \markbox{22324}{which} \markbox{22325}{encode} \markbox{22326}{the} \markbox{22327}{stable} \markbox{22328}{decompositions} \markbox{22329}{from} \markbox{m22330}{$T_2,T_3$} \markbox{22331}{and} \markbox{m22332}{$T_1,T_2$}, respectively.  \markbox{22333}{The} \markbox{22334}{following} \markbox{22335}{describes} \markbox{22336}{the} \markbox{22337}{properties} \markbox{22338}{we} \markbox{22339}{want} \markbox{22340}{for} \markbox{22341}{these} \markbox{22342}{induced} decompositions:

\begin{definition}[Refined \markbox{22343}{stable} decompositions]\label{defn:refined decomp}
Let \markbox{m22344}{$(a,b;\calY)$} \markbox{22345}{and} \markbox{m22346}{$(a',b';\calY')$} \markbox{22347}{denote} \markbox{22348}{two} \markbox{22349}{admissible} \markbox{m22350}{$\epsilon$}-setups \markbox{22351}{and} \markbox{22352}{let} \markbox{m22353}{$\calY_0 = \calY \cap \calY'$}.  \markbox{22354}{Suppose} \markbox{22355}{we} \markbox{22356}{have} \markbox{22357}{two} \markbox{22358}{compatible} \markbox{m22359}{$\calY_0$}-stable \markbox{22360}{decompositions} \markbox{m22361}{$T_s \subset T$} \markbox{22362}{and} \markbox{m22363}{$T'_s \subset T'$}.  \markbox{22364}{We} \markbox{22365}{say} \markbox{22366}{another} \markbox{22367}{pair} \markbox{22368}{of} \markbox{22369}{stable} \markbox{22370}{decompositions} \markbox{m22371}{$T_{s,0} \subset T$} \markbox{22372}{and} \markbox{m22373}{$T'_{s,0} \subset T'$} \emph{refine} \markbox{m22374}{$T_s \subset T$} \markbox{22375}{and} \markbox{m22376}{$T'_s \subset T'$} \markbox{22377}{if} \markbox{22378}{the} \markbox{22379}{following} hold:
\begin{enumerate}
\item We \markbox{22380}{have} \markbox{m22381}{$T_{s,0} \subset T_s$} \markbox{22382}{and} \markbox{m22383}{$T'_{s,0} \subset T'_s$}, and
\item Let \markbox{m22384}{$\beta:\pi_0(T - T_s) \to \pi_0(T'-T'_s)$} \markbox{22385}{and} \markbox{m22386}{$\beta_0:\pi_0(T-T_{s,0}) \to \pi_0(T' - T'_{s,0})$} \markbox{22387}{denote} \markbox{22388}{the} \markbox{22389}{associated} order-preserving bijections.  \markbox{22390}{Suppose} \markbox{m22391}{$C_1 \in \pi_0(T - T_s)$}  \markbox{22392}{and} \markbox{22393}{let} \markbox{m22394}{$C_{1,0} \in \pi_0(T-T_{s,0})$} \markbox{22395}{denote} \markbox{22396}{the} \markbox{22397}{component} \markbox{22398}{containing} \markbox{m22399}{$C_1$} (which \markbox{22400}{exists} \markbox{22401}{because} \markbox{m22402}{$T_{s,0} \subset T_s$}).  \markbox{22403}{Then} \markbox{m22404}{$\beta(C_1) \subset \beta_0(C_{1,0})$}.
\end{enumerate}
\end{definition}

\begin{remark}\label{rem:purpose of refined}
Condition (2) \markbox{22405}{in} \markbox{22406}{particular} \markbox{22407}{is} \markbox{22408}{used} \markbox{22409}{to} \markbox{22410}{verify} \markbox{22411}{the} \markbox{22412}{properties} \markbox{22413}{in} \eqref{item:adjacency} \markbox{22414}{of} \markbox{22415}{Definition} \ref{defn:stable decomp} \markbox{22416}{during} \markbox{22417}{our} \markbox{22418}{iteration} procedure.  \markbox{22419}{For} \markbox{22420}{item} \eqref{item:endpoint condition}, \markbox{22421}{since} \markbox{m22422}{$\beta$} \markbox{22423}{identifies} \markbox{22424}{the} \markbox{22425}{component} \markbox{22426}{of} \markbox{m22427}{$T-T_s$} \markbox{22428}{containing} \markbox{22429}{the} \markbox{22430}{cluster} \markbox{22431}{component} \markbox{22432}{associated} \markbox{22433}{to} \markbox{m22434}{$a$} \markbox{22435}{to} \markbox{22436}{the} \markbox{22437}{component} \markbox{22438}{of} \markbox{m22439}{$T' - T'_s$} \markbox{22440}{containing} \markbox{22441}{the} \markbox{22442}{cluster} \markbox{22443}{component} \markbox{22444}{associated} \markbox{22445}{to} \markbox{m22446}{$a'$}, \markbox{22447}{the} \markbox{22448}{refinement} \markbox{22449}{condition} (2) \markbox{22450}{forces} \markbox{22451}{the} \markbox{22452}{same} \markbox{22453}{to} \markbox{22454}{hold} \markbox{22455}{for} \markbox{m22456}{$\beta_0$}.  \markbox{22457}{A} \markbox{22458}{similar} \markbox{22459}{observation} \markbox{22460}{works} \markbox{22461}{to} \markbox{22462}{verify} \markbox{22463}{item} \eqref{item:cluster identify}.
\end{remark}

Following \markbox{22464}{our} \markbox{22465}{notation} \markbox{22466}{from} \markbox{22467}{before} \markbox{22468}{the} \markbox{22469}{above} definition, \markbox{22470}{let} \markbox{m22471}{$\phi_i:T_i \to \calZ$} \markbox{22472}{denote} \markbox{22473}{the} \markbox{22474}{maps} \markbox{22475}{into} \markbox{m22476}{$\calZ$}.  Moreover, \markbox{22477}{assume} \markbox{22478}{that} \markbox{22479}{we} have
\begin{itemize}
\item a \markbox{m22480}{$\calY_0$}-stable \markbox{22481}{decomposition} \markbox{m22482}{$T^1_{s,2} \subset T_{e,2}$} \markbox{22483}{which} \markbox{22484}{is} \markbox{m22485}{$L$}-compatible \markbox{22486}{with} \markbox{m22487}{$T^2_{s,1} \subset T_{e,1} $} \markbox{22488}{for} \markbox{22489}{the} \markbox{22490}{setups} \markbox{m22491}{$(a_1,b_1;\calY_1)$} \markbox{22492}{and} \markbox{m22493}{$(a_2,b_2;\calY_2)$}, and
\item a \markbox{m22494}{$\calY_0$}-stable \markbox{22495}{decomposition} \markbox{m22496}{$T^3_{s,2} \subset T_{e,2}$} \markbox{22497}{which} \markbox{22498}{is} \markbox{m22499}{$L$}-compatible \markbox{22500}{with} \markbox{m22501}{$T^2_{s,3} \subset T_{e,3}$} \markbox{22502}{for} \markbox{22503}{the} \markbox{22504}{setups} \markbox{m22505}{$(a_2,b_2;\calY_2)$} \markbox{22506}{and} \markbox{m22507}{$(a_3,b_3;\calY_3)$}.
\end{itemize}

\begin{proposition}\label{prop:stable iteration, pair}
There \markbox{22508}{exists} \markbox{m22509}{$\calY_0$}-stable \markbox{m22510}{$4L^2$}-compatible \markbox{22511}{decompositions} \markbox{m22512}{$T^{2,3}_{s,1} \subset T_{e,1}$} \markbox{22513}{and} \markbox{m22514}{$T^{2,1}_{s,3} \subset T_{e,3}$} \markbox{22515}{which} \markbox{22516}{refine} \markbox{m22517}{$T^2_{s,1}$} \markbox{22518}{and} \markbox{m22519}{$T^2_{s,3}$}. 
\end{proposition}

\begin{proof}
Note \markbox{22520}{that} \markbox{22521}{the} \markbox{22522}{stable} \markbox{22523}{decompositions} \markbox{m22524}{$T^1_{s,2}$} \markbox{22525}{and} \markbox{m22526}{$T^3_{s,2}$} \markbox{22527}{both} \markbox{22528}{live} \markbox{22529}{on} \markbox{m22530}{$T_2$}.  \markbox{22531}{Set} \markbox{m22532}{$T^{1,3}_{s,2} = T^1_{s,2} \cap T^3_{s,2}$}.  \markbox{22533}{Observe} \markbox{22534}{that} \markbox{m22535}{$T_{e,2} - T^{1,3}_{s,2} = (T_{e,2} - T^1_{s,2}) \cup (T_{e,2} - T^3_{s,2})$} \markbox{22536}{has} \markbox{22537}{at} \markbox{22538}{most} \markbox{m22539}{$2L$}-many \markbox{22540}{components} \markbox{22541}{each} \markbox{22542}{of} \markbox{22543}{diameter} \markbox{22544}{at} \markbox{22545}{most} \markbox{m22546}{$4L^2$}; \markbox{22547}{note} \markbox{22548}{that} \markbox{22549}{the} \markbox{22550}{larger} \markbox{22551}{diameter} \markbox{22552}{bound} \markbox{22553}{accounts} \markbox{22554}{for} \markbox{22555}{unstable} \markbox{22556}{components} \markbox{22557}{to} combine, \markbox{22558}{but} \markbox{22559}{there} \markbox{22560}{are} \markbox{22561}{at} \markbox{22562}{most} \markbox{m22563}{$2L$}-many \markbox{22564}{of} them.  Moreover, \markbox{22565}{by} \markbox{22566}{item} \eqref{item:simplicial} \markbox{22567}{of} \markbox{22568}{Definition} \ref{defn:stable decomp}, \markbox{22569}{the} \markbox{22570}{endpoints} \markbox{22571}{of} \markbox{22572}{each} \markbox{22573}{component} \markbox{22574}{of} \markbox{m22575}{$T^1_{s,2}$} \markbox{22576}{and} \markbox{m22577}{$T^3_{s,2}$} \markbox{22578}{are} \markbox{22579}{at} \markbox{22580}{vertices} \markbox{22581}{of} \markbox{22582}{the} \markbox{22583}{components} \markbox{22584}{of} \markbox{m22585}{$T_{e,2}$} \markbox{22586}{which} \markbox{22587}{contain} them, \markbox{22588}{and} \markbox{22589}{hence} \markbox{22590}{this} \markbox{22591}{property} \markbox{22592}{holds} \markbox{22593}{for} \markbox{22594}{each} \markbox{22595}{component} \markbox{22596}{of} \markbox{m22597}{$T^{1,3}_{s,2}$}

We \markbox{22598}{first} \markbox{22599}{produce} \markbox{22600}{refined} \markbox{22601}{decompositions} \markbox{22602}{of} \markbox{m22603}{$T^{2,3}_{s,1} \subset T^2_{s,1}$} \markbox{22604}{and} \markbox{m22605}{$T^{1,3}_{s,2} \subset T^1_{s,2}$}, \markbox{22606}{and} \markbox{22607}{the} \markbox{22608}{same} \markbox{22609}{argument} \markbox{22610}{produces} \markbox{22611}{the} \markbox{22612}{refined} \markbox{22613}{decompositions} \markbox{m22614}{$T^{1,3}_{s,2}  \subset T^3_{s,2}$} \markbox{22615}{and} \markbox{m22616}{$T^{2,1}_{s,3} \subset T^2_{s,3}$}.  \markbox{22617}{We} \markbox{22618}{will} \markbox{22619}{then} \markbox{22620}{see} \markbox{22621}{the} \markbox{22622}{properties} \markbox{22623}{of} \markbox{22624}{Definition} \ref{defn:refined decomp} \markbox{22625}{allow} \markbox{22626}{us} \markbox{22627}{to} \markbox{22628}{combine} these, \markbox{22629}{using} \markbox{m22630}{$T^{1,3}_{s,2}$} \markbox{22631}{as} \markbox{22632}{a} \markbox{22633}{bridge} \markbox{22634}{to} \markbox{22635}{connect} them.

We \markbox{22636}{can} \markbox{22637}{induce} \markbox{22638}{a} \markbox{22639}{decomposition} \markbox{m22640}{$T^{2,3}_{s,1}$} \markbox{22641}{on} \markbox{m22642}{$T_1$} \markbox{22643}{by} \markbox{22644}{taking} \markbox{22645}{the} \markbox{22646}{collection} \markbox{22647}{of} \markbox{22648}{all} \markbox{m22649}{$i^{-1}_{E,E'}(E' \cap T^{1,3}_{s,2})$} \markbox{22650}{over} \markbox{22651}{all} \markbox{22652}{stable} \markbox{22653}{pairs} \markbox{m22654}{$(E,E')$} \markbox{22655}{of} \markbox{m22656}{$T_1,T_2$} \markbox{22657}{as} \markbox{22658}{identified} \markbox{22659}{by} \markbox{22660}{the} \markbox{22661}{bijection} \markbox{m22662}{$\alpha_{1,2}:\pi_0(T_{s,1}) \to \pi_0(T_{s,2})$}.  \markbox{22663}{Observe} \markbox{22664}{that} \markbox{22665}{any} \markbox{22666}{component} \markbox{m22667}{$V \subset T^{2,3}_{s,1}$} \markbox{22668}{is} \markbox{22669}{contained} \markbox{22670}{in} \markbox{22671}{some} \markbox{22672}{component} \markbox{m22673}{$V \subset E \subset T_{s,1} \subset T_{e,1}$}, \markbox{22674}{and} \markbox{22675}{the} \markbox{22676}{map} \markbox{m22677}{$i_{E,E'}|_V:V \to i_{E,E'}(V)$} \markbox{22678}{is} \markbox{22679}{an} isometry, \markbox{22680}{where} \markbox{m22681}{$E' = \alpha_{1,2}(E)$}, \markbox{22682}{and} \markbox{22683}{vice} versa.  \markbox{22684}{Thus} \markbox{22685}{the} \markbox{22686}{components} \markbox{22687}{of} \markbox{m22688}{$T^{2,3}_{s,1}$} \markbox{22689}{are} \markbox{22690}{in} \markbox{22691}{bijective} \markbox{22692}{correspondence} \markbox{22693}{with} \markbox{22694}{the} \markbox{22695}{components} \markbox{22696}{of} \markbox{m22697}{$T^{1,3}_{s,2}$}, \markbox{22698}{with} \markbox{22699}{identified} \markbox{22700}{components} \markbox{22701}{being} isometric.  Moreover,  \markbox{22702}{the} \markbox{22703}{natural} order-preserving \markbox{22704}{bijection} \markbox{m22705}{$\alpha^3_{1,2}:\pi_0(T^{2,3}_{s,1}) \to \pi_0(T^{1,3}_{s,2})$} (as \markbox{22706}{in} \markbox{22707}{Definition} \ref{defn:order preserving}) \markbox{22708}{coincides} \markbox{22709}{with} \markbox{22710}{the} \markbox{22711}{bijective} \markbox{22712}{correspondence} \markbox{22713}{induced} \markbox{22714}{from} \markbox{m22715}{$\alpha_{1,2}$} \markbox{22716}{and} \markbox{22717}{the} \markbox{22718}{various} order-preserving \markbox{22719}{isometries} \markbox{m22720}{$i_{E,E'}$}.  \markbox{22721}{We} \markbox{22722}{also} \markbox{22723}{note} \markbox{22724}{that} \markbox{22725}{the} \markbox{22726}{various} \markbox{22727}{restrictions} \markbox{m22728}{$i_{E,E'}|V$} \markbox{22729}{are} order-preserving \markbox{22730}{since} \markbox{m22731}{$i_{E,E'}$} is.  \markbox{22732}{Next} \markbox{22733}{observe} \markbox{22734}{that} \markbox{22735}{the} \markbox{22736}{images} \markbox{m22737}{$\phi_1(V)$} \markbox{22738}{and} \markbox{m22739}{$\phi_2(i_{E,E'}(V))$} \markbox{22740}{are} \markbox{22741}{either} \markbox{22742}{exactly} \markbox{22743}{the} \markbox{22744}{same} \markbox{22745}{or} \markbox{22746}{are} \markbox{m22747}{$L$}-Hausdorff \markbox{22748}{close} \markbox{22749}{in} \markbox{m22750}{$\calZ$} \markbox{22751}{as} \markbox{22752}{items} \eqref{item:identical pairs} \markbox{22753}{and} \eqref{item:close pairs} \markbox{22754}{of} \markbox{22755}{Definition} \ref{defn:stable decomp}.  \markbox{22756}{Thus} \markbox{22757}{the} \markbox{22758}{decompositions} \markbox{m22759}{$T^{2,3}_{s,1} \subset T_1$} \markbox{22760}{and} \markbox{m22761}{$T^{1,3}_{s,2} \subset T_2$} \markbox{22762}{satisfy} \markbox{22763}{all} \markbox{22764}{the} \markbox{22765}{properties} \markbox{22766}{of} \markbox{22767}{Definition} \ref{defn:stable decomp} \markbox{22768}{except} \markbox{22769}{possibly} \eqref{item:adjacency}.  \markbox{22770}{We} \markbox{22771}{also} \markbox{22772}{want} \markbox{22773}{to} \markbox{22774}{show} \markbox{22775}{that} \markbox{22776}{they} \markbox{22777}{give} \markbox{22778}{a} \markbox{22779}{refinement} \markbox{22780}{as} \markbox{22781}{in} \markbox{22782}{Definition} \ref{defn:refined decomp}.

To \markbox{22783}{prove} \eqref{item:adjacency}, \markbox{22784}{it} \markbox{22785}{will} \markbox{22786}{suffice} \markbox{22787}{to} \markbox{22788}{show} \markbox{22789}{the} \markbox{22790}{refinement} \markbox{22791}{property} (Definition \ref{defn:refined decomp}), \markbox{22792}{as} \markbox{22793}{explained} \markbox{22794}{in} \markbox{22795}{Remark} \ref{rem:purpose of refined}.  \markbox{22796}{Property} (1), \markbox{22797}{namely} \markbox{22798}{that} \markbox{m22799}{$T^{2,3}_{s,1} \subset T^2_{s,1}$} \markbox{22800}{and} \markbox{m22801}{$T^{1,3}_{s,2} \subset T^1_{s,2}$}, \markbox{22802}{of} \markbox{22803}{Definition} \ref{defn:refined decomp} \markbox{22804}{holds} \markbox{22805}{by} construction.  \markbox{22806}{For} \markbox{22807}{property} (2), \markbox{22808}{we} \markbox{22809}{argument} \markbox{22810}{one} \markbox{22811}{component} \markbox{22812}{at} \markbox{22813}{a} time.  \markbox{22814}{In} particular, \markbox{22815}{let} \markbox{m22816}{$\beta^3_{1,2}:\pi_0(T_1 - T^{2,3}_{s,1}) \to \pi_0(T_2 - T^{1,3}_{s,2})$} \markbox{22817}{be} \markbox{22818}{the} \markbox{22819}{natural} order-preserving \markbox{22820}{bijections} (which \markbox{22821}{exists} \markbox{22822}{via} \markbox{22823}{Remark} \ref{rem:order preserving} \markbox{22824}{because} \markbox{m22825}{$\alpha^3_{1,2}$} does).

First, \markbox{22826}{since} \markbox{22827}{the} (unstable) \markbox{22828}{components} \markbox{22829}{of} \markbox{m22830}{$T_1 - T^2_{s,1}$} \markbox{22831}{only} \markbox{22832}{get} \markbox{22833}{expanded} \markbox{22834}{when} \markbox{22835}{passing} \markbox{22836}{to} \markbox{m22837}{$T_1 - T^{2,3}_{s,1}$}, \markbox{22838}{it} \markbox{22839}{follows} \markbox{22840}{that} \markbox{22841}{the} \markbox{22842}{first} \markbox{22843}{component} \markbox{m22844}{$C_0 \subset T_1 - T^2_{s,1}$} \markbox{22845}{one} \markbox{22846}{encounters} \markbox{22847}{when} \markbox{22848}{moving} \markbox{22849}{from} \markbox{m22850}{$a_1$} \markbox{22851}{to} \markbox{m22852}{$b_1$} \markbox{22853}{along} \markbox{22854}{the} \markbox{22855}{geodesic} \markbox{m22856}{$[a_1,b_1]_{T_1}$} \markbox{22857}{is} \markbox{22858}{contained} \markbox{22859}{in} \markbox{22860}{the} \markbox{22861}{first} \markbox{22862}{such} \markbox{22863}{component} \markbox{22864}{of} \markbox{m22865}{$C_{0,3} \subset T_1 - T^{2,3}_{s,1}$}, \markbox{22866}{and} \markbox{22867}{similarly} \markbox{22868}{for} \markbox{22869}{the} \markbox{22870}{setup} \markbox{22871}{on} \markbox{m22872}{$T_2$}.  \markbox{22873}{Hence} \markbox{22874}{these} \markbox{22875}{expanded} \markbox{22876}{clusters} \markbox{22877}{are} \markbox{22878}{identified} \markbox{22879}{by} \markbox{m22880}{$\beta^3_{1,2}$}, \markbox{22881}{which} \markbox{22882}{we} \markbox{22883}{note} \markbox{22884}{also} \markbox{22885}{confirms} \markbox{22886}{item} \eqref{item:endpoint condition} \markbox{22887}{of} \markbox{22888}{Definition} \ref{defn:stable decomp}.

We \markbox{22889}{now} \markbox{22890}{proceed} \markbox{22891}{inductively} \markbox{22892}{along} \markbox{m22893}{$T_1$} \markbox{22894}{and} \markbox{m22895}{$T_2$}.  \markbox{22896}{Let} \markbox{m22897}{$C_1, C'_1$} \markbox{22898}{denote} \markbox{22899}{the} \markbox{22900}{second} \markbox{22901}{pairs} \markbox{22902}{of} \markbox{22903}{components} \markbox{22904}{of} \markbox{m22905}{$T_1 - T^2_{s,1}$} \markbox{22906}{and} \markbox{m22907}{$T_2 - T^1_{s,2}$} \markbox{22908}{encountered} \markbox{22909}{after} \markbox{m22910}{$C_0, C'_0$}.  \markbox{22911}{Let} \markbox{m22912}{$E, E'$} \markbox{22913}{denote} \markbox{22914}{the} \markbox{22915}{respective} \markbox{22916}{components} \markbox{22917}{of} \markbox{m22918}{$T^2_{s,1}$} \markbox{22919}{and} \markbox{m22920}{$T^1_{s,2}$} \markbox{22921}{connecting} \markbox{m22922}{$C_0,C'_0$} \markbox{22923}{to} \markbox{m22924}{$C_1,C'_1$}.  \markbox{22925}{The} \markbox{22926}{components} \markbox{22927}{of} \markbox{m22928}{$(T_1 - T^{2,3}_{s,1}) \cap E$} \markbox{22929}{and} \markbox{m22930}{$(T_2 - T^{1,3}_{s,2}) \cap E'$} \markbox{22931}{are} \markbox{22932}{identified} \markbox{22933}{by} \markbox{22934}{the} order-preserving \markbox{22935}{isometry} \markbox{m22936}{$i_{E,E'}$} \markbox{22937}{in} \markbox{22938}{an} order-preserving way.  \markbox{22939}{In} particular, \markbox{22940}{the} \markbox{22941}{two} \markbox{22942}{sets} \markbox{22943}{of} \markbox{22944}{components} \markbox{22945}{are} \markbox{22946}{in} \markbox{22947}{bijective} correspondence.  \markbox{22948}{As} \markbox{22949}{a} consequence, \markbox{22950}{if} \markbox{m22951}{$C^3_1 \subset T_1 - T^{2,3}_{s,1}$} \markbox{22952}{is}  \markbox{22953}{the} \markbox{22954}{component} \markbox{22955}{containing} \markbox{m22956}{$C_1$}, \markbox{22957}{then} \markbox{m22958}{$C'_1 \subset \beta^{3}_{1,2}(C^3_1)$}, \markbox{22959}{as} required.  \markbox{22960}{One} \markbox{22961}{can} \markbox{22962}{repeat} \markbox{22963}{this} \markbox{22964}{procedure} \markbox{22965}{on} \markbox{22966}{subsequent} \markbox{22967}{components} \markbox{22968}{of} \markbox{m22969}{$T_1 - T^2_{s,1}$} \markbox{22970}{and} \markbox{22971}{their} \markbox{22972}{paired} \markbox{22973}{components} \markbox{22974}{of} \markbox{m22975}{$T_2 - T^1_{s,2}$} \markbox{22976}{to} \markbox{22977}{see} \markbox{22978}{that} \markbox{m22979}{$T^{2,3}_{s,1}$} \markbox{22980}{and} \markbox{m22981}{$T^{1,3}_{s,2}$} \markbox{22982}{refine} \markbox{m22983}{$T^{2}_{s,1}$} \markbox{22984}{and} \markbox{m22985}{$T^1_{s,2}$}, respectively.

\medskip

\textbf{\underline{Combining the decompositions}}: \markbox{22986}{We} \markbox{22987}{now} \markbox{22988}{want} \markbox{22989}{to} \markbox{22990}{see} \markbox{22991}{that} \markbox{m22992}{$T^{2,3}_{s,1}$} \markbox{22993}{and} \markbox{m22994}{$T^{2,1}_{s,3}$} \markbox{22995}{are} \markbox{m22996}{$\calY_0$}-stable \markbox{m22997}{$4L^2$}-compatible \markbox{22998}{decompositions} \markbox{22999}{for} \markbox{m23000}{$(a_1,b_1;\calY_1)$} \markbox{23001}{and} \markbox{m23002}{$(a_3,b_3;\calY_3)$}.  \markbox{23003}{For} this, \markbox{23004}{define} \markbox{m23005}{$\alpha_{1,3}:\pi_0(T^{2,3}_{s,1}) \to \pi_0(T^{2,1}_{s,3})$} \markbox{23006}{to} \markbox{23007}{be} \markbox{m23008}{$\alpha_{1,3} = \alpha^{1}_{2,3} \circ \alpha^3_{1,2}$}, \markbox{23009}{and} \markbox{23010}{similarly} \markbox{23011}{set} \markbox{m23012}{$\beta_{1,3} = \beta^1_{2,3} \circ \beta^3_{1,2}$}.  \markbox{23013}{These} \markbox{23014}{compositions} \markbox{23015}{are} order-preserving \markbox{23016}{bijections} \markbox{23017}{because} \markbox{23018}{their} \markbox{23019}{constituent} \markbox{23020}{maps} are, \markbox{23021}{and} \markbox{23022}{moreover} \markbox{23023}{we} \markbox{23024}{can} \markbox{23025}{similarly} \markbox{23026}{induce} order-preserving \markbox{23027}{isometries} \markbox{23028}{on} \markbox{23029}{the} \markbox{23030}{components} \markbox{23031}{of} \markbox{m23032}{$T^{2,3}_{s,1}$} \markbox{23033}{and} \markbox{m23034}{$T^{2,1}_{s,3}$} \markbox{23035}{identified} \markbox{23036}{by} \markbox{m23037}{$\alpha_{1,3}$}, \markbox{23038}{which} \markbox{23039}{satisfy} \markbox{23040}{the} \markbox{23041}{proximity} \markbox{23042}{conditions} \markbox{23043}{of} \eqref{item:identical pairs} \markbox{23044}{and} \eqref{item:close pairs} \markbox{23045}{of} \markbox{23046}{Definition} \ref{defn:stable decomp} \markbox{23047}{with} \markbox{23048}{a} \markbox{23049}{constant} \markbox{23050}{of} \markbox{m23051}{$2L$}.  \markbox{23052}{In} particular, \markbox{23053}{it} \markbox{23054}{remains} \markbox{23055}{to} \markbox{23056}{show} \markbox{23057}{the} \markbox{23058}{properties} \markbox{23059}{in} \eqref{item:adjacency}.

For this, \markbox{23060}{we} \markbox{23061}{use} \markbox{23062}{the} \markbox{23063}{refinement} \markbox{23064}{property} (2) \markbox{23065}{of} \markbox{23066}{Definition} \ref{defn:refined decomp}.  \markbox{23067}{This} \markbox{23068}{is} \markbox{23069}{basically} automatic.  \markbox{23070}{For} (1), \markbox{23071}{the} \markbox{23072}{refinement} \markbox{23073}{property} \markbox{23074}{implies} \markbox{23075}{that} \markbox{m23076}{$\beta^3_{1,2}$} \markbox{23077}{identifies} \markbox{23078}{the} \markbox{23079}{component} \markbox{23080}{of} \markbox{m23081}{$T_1 - T^{2,3}_{s,1}$} \markbox{23082}{associated} \markbox{23083}{to} \markbox{m23084}{$a_1$} \markbox{23085}{to} \markbox{23086}{the} \markbox{23087}{component} \markbox{23088}{of} \markbox{m23089}{$T_2 - T^{1,3}_{s,2}$} \markbox{23090}{associated} \markbox{23091}{to} \markbox{m23092}{$a_2$}, \markbox{23093}{and} \markbox{23094}{similarly} \markbox{23095}{for} \markbox{m23096}{$\beta^1_{2,3}$}.  \markbox{23097}{Hence} \markbox{m23098}{$\beta_{1,3}$} \markbox{23099}{identifies} \markbox{23100}{the} \markbox{23101}{components} \markbox{23102}{associated} \markbox{23103}{to} \markbox{m23104}{$a_1, a_3$} \markbox{23105}{and} \markbox{m23106}{$b_1,b_3$}.  Similarly, \markbox{23107}{if} \markbox{m23108}{$y \in \calY_0 \subset \calY_1 \cap \calY_2 \cap \calY_3$}, \markbox{23109}{then} \markbox{23110}{the} \markbox{23111}{refinement} \markbox{23112}{property} \markbox{23113}{implies} \markbox{23114}{that} \markbox{m23115}{$\beta^3_{1,2}$} \markbox{23116}{identifies} \markbox{23117}{the} \markbox{23118}{component} \markbox{23119}{of} \markbox{m23120}{$T_1 - T^{2,3}_{s,1}$} \markbox{23121}{associated} \markbox{23122}{to} \markbox{m23123}{$y$} \markbox{23124}{to} \markbox{23125}{the} \markbox{23126}{component} \markbox{23127}{of} \markbox{m23128}{$T_2 - T^{1,3}_{s,2}$} \markbox{23129}{associated} \markbox{23130}{to} \markbox{m23131}{$y$}, \markbox{23132}{and} \markbox{23133}{similarly} \markbox{23134}{for} \markbox{m23135}{$\beta^1_{2,3}$}.  \markbox{23136}{Hence} \markbox{m23137}{$\beta_{1,3}$} \markbox{23138}{associates} \markbox{23139}{components} \markbox{23140}{associated} \markbox{23141}{to} \markbox{m23142}{$y$} \markbox{23143}{in} \markbox{23144}{both} \markbox{23145}{of} \markbox{m23146}{$T_1 - T^{2,3}_{s,1}$} \markbox{23147}{and} \markbox{m23148}{$T_3 - T^{2,1}_{s,3}$}.  \markbox{23149}{This} \markbox{23150}{completes} \markbox{23151}{the} \markbox{23152}{proof} \markbox{23153}{of} \markbox{23154}{the} proposition.



\end{proof}

The \markbox{23155}{following} \markbox{23156}{proposition} \markbox{23157}{is} \markbox{23158}{now} \markbox{23159}{a} \markbox{23160}{simple} \markbox{23161}{iterative} \markbox{23162}{application} \markbox{23163}{of} \markbox{23164}{Proposition} \ref{prop:stable iteration, pair}:

\begin{proposition}\label{prop:stable iteration}
For \markbox{23165}{every} \markbox{m23166}{$n\geq 2$}, \markbox{23167}{there} \markbox{23168}{exists} \markbox{m23169}{$L_n = L_n(L,n)>0$} \markbox{23170}{so} \markbox{23171}{that} \markbox{23172}{the} \markbox{23173}{following} holds.  \markbox{23174}{Suppose} \markbox{m23175}{$(a_1,b_1;\calY_1), \dots, (a_n,b_n;\calY_n)$} \markbox{23176}{is} \markbox{23177}{a} \markbox{23178}{sequence} \markbox{23179}{of} \markbox{23180}{pairwise} \markbox{23181}{admissible} \markbox{m23182}{$\epsilon$}-setups \markbox{23183}{and} \markbox{23184}{suppose} \markbox{23185}{that} \markbox{m23186}{$\calY_0 \subset \bigcap_i \calY_i$}.  \markbox{23187}{If} \markbox{23188}{each} \markbox{23189}{pair} \markbox{23190}{of} \markbox{23191}{consecutive} \markbox{23192}{setups} \markbox{23193}{admits} \markbox{m23194}{$\calY_0$}-stable \markbox{m23195}{$L$}-compatible \markbox{23196}{stable} decompositions, \markbox{23197}{then} \markbox{m23198}{$(a_1,b_1;\calY_1)$} \markbox{23199}{and} \markbox{m23200}{$(a_n,b_n;\calY_n)$} \markbox{23201}{admit} \markbox{m23202}{$\calY_0$}-stable \markbox{m23203}{$L_n$}-compatible \markbox{23204}{stable} decompositions. 
\end{proposition}


\subsubsection{Completing the proof} \markbox{23205}{To} \markbox{23206}{prove} \markbox{23207}{Theorem} \ref{thm:stable intervals}, \markbox{23208}{we} \markbox{23209}{have} \markbox{23210}{two} \markbox{23211}{remaining} tasks:
\begin{enumerate}
\item We \markbox{23212}{need} \markbox{23213}{to} \markbox{23214}{explain} \markbox{23215}{how} \markbox{23216}{to} \markbox{23217}{build} \markbox{23218}{a} \markbox{23219}{stable} \markbox{23220}{decomposition} \markbox{23221}{when} \markbox{23222}{perturbing} \markbox{23223}{an} \markbox{23224}{endpoint} \markbox{23225}{but} \markbox{23226}{keeping} \markbox{23227}{the} \markbox{23228}{rest} \markbox{23229}{of} \markbox{23230}{the} \markbox{23231}{setup} \markbox{23232}{the} same, and
\item Show \markbox{23233}{how} \markbox{23234}{to} \markbox{23235}{stick} \markbox{23236}{this} \markbox{23237}{into} \markbox{23238}{an} \markbox{23239}{iterative} setup.
\end{enumerate}

\textbf{\underline{Perturbing an endpoint}:} \markbox{23240}{This} \markbox{23241}{is} \markbox{23242}{an} \markbox{23243}{iterated} \markbox{23244}{application} \markbox{23245}{of}  \markbox{23246}{Proposition} \ref{prop:add cluster}.

Consider \markbox{23247}{the} \markbox{23248}{following} \markbox{23249}{restricted} setup, \markbox{23250}{which} \markbox{23251}{we} \markbox{23252}{highlight} \markbox{23253}{to} \markbox{23254}{focus} \markbox{23255}{on} \markbox{23256}{what} \markbox{23257}{happens} \markbox{23258}{when} \markbox{23259}{we} \markbox{23260}{perturb} \markbox{23261}{an} endpoint.  \markbox{23262}{Let} \markbox{m23263}{$a,b,a' \in \calZ$} \markbox{23264}{and} \markbox{m23265}{$\calY \subset \calZ$} \markbox{23266}{be} \markbox{23267}{finite} \markbox{23268}{with} \markbox{m23269}{$\calY \subset \calN_{\epsilon/2}(\lambda(a,b)) \cap \calN_{\epsilon/2}(a',b)$}.  \markbox{23270}{Consider} \markbox{23271}{the} \markbox{23272}{following} \markbox{23273}{collection} \markbox{23274}{of} setups, \markbox{23275}{each} \markbox{23276}{of} \markbox{23277}{which} \markbox{23278}{differs} \markbox{23279}{by} \markbox{23280}{adding} \markbox{23281}{or} \markbox{23282}{deleting} \markbox{23283}{one} \markbox{23284}{cluster} point, \markbox{23285}{or} \markbox{23286}{by} \markbox{23287}{switching} \markbox{23288}{the} \markbox{23289}{role} \markbox{23290}{that} \markbox{m23291}{$a,a'$} \markbox{23292}{or} \markbox{m23293}{$b,b'$} \markbox{23294}{play} \markbox{23295}{between} \markbox{23296}{cluster} \markbox{23297}{or} endpoint:
\vspace{-.09in}
\begin{multicols}{3}
\begin{enumerate}
\item $(a,b;\calY)$,
\item $(a,b;\calY \cup \{a\})$,
\item $(a,b;\calY \cup \{a, a'\})$,
\item $(a',b;\calY \cup \{a,a'\})$,
\item $(a',b;\calY \cup \{a'\})$,
\item $(a',b;\calY)$.
\end{enumerate}
\end{multicols}

First \markbox{23298}{observe} \markbox{23299}{that} \markbox{m23300}{$\calY$} \markbox{23301}{is} \markbox{23302}{contained} \markbox{23303}{in} \markbox{23304}{each} \markbox{23305}{of} \markbox{23306}{the} \markbox{23307}{above} \markbox{23308}{sets} \markbox{23309}{of} \markbox{23310}{cluster} points, \markbox{23311}{so} \markbox{23312}{we} \markbox{23313}{want} \markbox{23314}{to} \markbox{23315}{see} \markbox{23316}{how} \markbox{23317}{to} \markbox{23318}{build} \markbox{m23319}{$\calY$}-stable \markbox{23320}{decompositions} \markbox{23321}{for} each, \markbox{23322}{which} \markbox{23323}{implies} \markbox{23324}{the} \markbox{23325}{existence} \markbox{23326}{of} \markbox{m23327}{$\calY_0$}-stable \markbox{23328}{decompositions} \markbox{23329}{for} \markbox{23330}{any} \markbox{m23331}{$\calY_0 \subset \calY$}.  Next, \markbox{23332}{observe} \markbox{23333}{that} \markbox{23334}{in} \markbox{23335}{the} \markbox{23336}{construction} \markbox{23337}{of} \markbox{23338}{the} \markbox{23339}{stable} \markbox{23340}{interval} \markbox{m23341}{$T(a,b;\calY)$}, \markbox{23342}{the} \markbox{23343}{roles} \markbox{23344}{of} \markbox{23345}{points} \markbox{23346}{of} \markbox{23347}{the} \markbox{23348}{endpoints} \markbox{m23349}{$a,b$} \markbox{23350}{and} \markbox{23351}{the} \markbox{23352}{cluster} \markbox{23353}{points} \markbox{m23354}{$\calY$} \markbox{23355}{are} \markbox{23356}{equivalent} \markbox{23357}{in} \markbox{23358}{cluster} \markbox{23359}{formation} process.  \markbox{23360}{The} \markbox{23361}{only} \markbox{23362}{special} \markbox{23363}{role} \markbox{23364}{that} \markbox{23365}{endpoints} \markbox{23366}{play} \markbox{23367}{in} \markbox{23368}{the} \markbox{23369}{Definition} \ref{defn:stable interval} \markbox{23370}{of} \markbox{m23371}{$T(a,b;\calY)$} \markbox{23372}{is} \markbox{23373}{in} \markbox{23374}{the} \markbox{23375}{segments} \markbox{23376}{defined} \emph{within} clusters, \markbox{23377}{namely} \markbox{23378}{the} \markbox{m23379}{$\mu(C)$} components.  \markbox{23380}{In} particular, \markbox{23381}{the} \markbox{23382}{edge} \markbox{23383}{components} (i.e., \markbox{23384}{the} \markbox{23385}{components} \markbox{23386}{of} \markbox{m23387}{$T_e$}) \markbox{23388}{treat} \markbox{23389}{endpoints} \markbox{23390}{and} \markbox{23391}{cluster} \markbox{23392}{points} equivalently.  \markbox{23393}{As} \markbox{23394}{the} \markbox{23395}{desired} \markbox{23396}{stable} \markbox{23397}{decompositions} \markbox{23398}{from} \markbox{23399}{Theorem} \ref{thm:stable intervals} \markbox{23400}{are} \markbox{23401}{subsets} \markbox{23402}{of} \markbox{23403}{the} \markbox{23404}{edge} components, \markbox{23405}{we} \markbox{23406}{are} \markbox{23407}{free} \markbox{23408}{to} \markbox{23409}{treat} \markbox{23410}{the} \markbox{23411}{points} \markbox{m23412}{$a,a',b,b'$} \markbox{23413}{as} \markbox{23414}{cluster} \markbox{23415}{points} \markbox{23416}{in} \markbox{23417}{applying} \markbox{23418}{Proposition} \ref{prop:add cluster} \markbox{23419}{to} \markbox{23420}{obtain} \markbox{23421}{stable} \markbox{23422}{decompositions} \markbox{23423}{for} \markbox{23424}{each} \markbox{23425}{of} \markbox{23426}{the} \markbox{23427}{steps} \markbox{m23428}{$(1) \to (2) \to (3)$} \markbox{23429}{and} \markbox{m23430}{$(4) \to (5) \to (6)$}.  \markbox{23431}{The} \markbox{23432}{only} \markbox{23433}{exception} \markbox{23434}{is} \markbox{23435}{the} \markbox{23436}{step} \markbox{m23437}{$(3) \to (4)$}, \markbox{23438}{where} \markbox{23439}{we} \markbox{23440}{are} \markbox{23441}{switching} \markbox{23442}{the} \markbox{23443}{roles} \markbox{23444}{of} \markbox{m23445}{$a$} \markbox{23446}{and} \markbox{m23447}{$a'$}.  \markbox{23448}{Here} \markbox{23449}{Proposition} \ref{prop:add cluster} \markbox{23450}{does} \markbox{23451}{not} \markbox{23452}{directly} apply, but, \markbox{23453}{by} \markbox{23454}{the} \markbox{23455}{above} discussion, \markbox{23456}{these} \markbox{23457}{two} \markbox{23458}{setups} \markbox{23459}{have} \markbox{23460}{the} \markbox{23461}{exact} \markbox{23462}{same} \markbox{23463}{clusters} \markbox{23464}{and} \markbox{23465}{thus} \markbox{23466}{the} \markbox{23467}{exact} \markbox{23468}{same} \markbox{23469}{edge} components.  \markbox{23470}{Hence} \markbox{23471}{we} \markbox{23472}{get} \markbox{23473}{the} \markbox{23474}{desired} \markbox{23475}{bijections} (with \markbox{23476}{their} \markbox{23477}{proximity} constraints) \markbox{23478}{by} \markbox{23479}{identifying} \markbox{23480}{the} \markbox{23481}{edge} \markbox{23482}{components} \markbox{23483}{as} \markbox{23484}{stable} components---which, again, \markbox{23485}{are} \markbox{23486}{all} \markbox{23487}{exactly} \markbox{23488}{the} same---and \markbox{23489}{taking} \markbox{23490}{the} \markbox{23491}{bijection} \markbox{23492}{between} \markbox{23493}{the} \markbox{23494}{complementary} \markbox{23495}{components} \markbox{23496}{to} \markbox{23497}{be} \markbox{23498}{the} \markbox{23499}{obvious} map.

In \markbox{23500}{other} words, \markbox{23501}{provided} \markbox{23502}{an} \markbox{23503}{explanation} \markbox{23504}{for} \markbox{23505}{how} \markbox{23506}{to} \markbox{23507}{iteratively} \markbox{23508}{combine} \markbox{23509}{a} \markbox{23510}{sequence} \markbox{23511}{of} \markbox{23512}{stable} decompositions, \markbox{23513}{we} \markbox{23514}{can} \markbox{23515}{apply} \markbox{23516}{this} \markbox{23517}{process} \markbox{23518}{to} \markbox{23519}{move} \markbox{23520}{from} \markbox{23521}{setup} (1) \markbox{23522}{above} \markbox{23523}{to} \markbox{23524}{setup} (6).

\medskip

\textbf{\underline{Putting it all together}}: \markbox{23525}{In} \markbox{23526}{the} \markbox{23527}{more} \markbox{23528}{general} \markbox{23529}{setting} \markbox{23530}{of} \markbox{23531}{the} theorem, \markbox{23532}{the} \markbox{23533}{above} \markbox{23534}{sequence} \markbox{23535}{only} \markbox{23536}{appears} \markbox{23537}{in} \markbox{23538}{the} \markbox{23539}{middle} \markbox{23540}{of} \markbox{23541}{a} \markbox{23542}{longer} \markbox{23543}{sequence} \markbox{23544}{we} \markbox{23545}{need} \markbox{23546}{to} consider.  \markbox{23547}{In} particular, \markbox{23548}{let} \markbox{m23549}{$\calY' - \calY = \{x_1, \dots, x_n\}$} \markbox{23550}{and} \markbox{m23551}{$\calY - \calY' = \{z_1, \dots, z_m\}$}, \markbox{23552}{where} \markbox{m23553}{$n,m < N$} \markbox{23554}{by} assumption.  \markbox{23555}{Set} \markbox{m23556}{$\calY_i = \calY \cup \{x_1, \dots, x_i\}$} \markbox{23557}{and} \markbox{m23558}{$\calY'_i = \calY' \cup \{z_1, \dots, z_i\}$}, \markbox{23559}{and} \markbox{23560}{let} \markbox{m23561}{$\calY_0 = \calY \cap \calY'$} \markbox{23562}{and} \markbox{m23563}{$\calY_{all} = \calY \cup \calY'$}.  Then, \markbox{23564}{by} \markbox{23565}{the} \markbox{23566}{assumptions} \markbox{23567}{in} \markbox{23568}{our} setup, \markbox{23569}{we} \markbox{23570}{have} \markbox{23571}{two} \markbox{23572}{sequences} \markbox{23573}{of} \markbox{23574}{pairwise} \markbox{23575}{admissible} \markbox{m23576}{$\epsilon$}-setups
$$(a,b;\calY) \to (a,b;\calY_1) \to \cdots \to (a,b;\calY_{all}) \to (a,b;\calY_{all} \cup \{a'\}) \to (a,b;\calY_{all} \cup \{a',b'\})$$
and
$$(a',b';\calY') \to \cdots \to (a',b'; \calY_n) \to (a',b';\calY_{all}) \to (a',b';\calY_{all} \cup \{a\}) \to (a',b';\calY_{all} \cup \{a,b\}),$$
which \markbox{23577}{we} \markbox{23578}{note} \markbox{23579}{are} \markbox{23580}{connected} \markbox{23581}{in} \markbox{23582}{the} \markbox{23583}{middle} \markbox{23584}{by} \markbox{23585}{the} \markbox{23586}{above} discussion, \markbox{23587}{where} \markbox{23588}{we} \markbox{23589}{need} \markbox{23590}{to} \markbox{23591}{switch} \markbox{23592}{the} \markbox{23593}{roles} \markbox{23594}{of} \markbox{23595}{both} \markbox{m23596}{$a,a'$} \markbox{23597}{and} \markbox{m23598}{$b,b'$}.  \markbox{23599}{In} particular, \markbox{23600}{the} \markbox{23601}{stable} \markbox{23602}{trees} \markbox{23603}{for} \markbox{23604}{the} \markbox{23605}{setups} \markbox{m23606}{$(a,b;\calY_{all} \cup \{a',b'\})$} \markbox{23607}{and} \markbox{m23608}{$(a',b';\calY_{all} \cup \{a,b\})$} \markbox{23609}{have} \markbox{23610}{identical} \markbox{23611}{edge} components.

By \markbox{23612}{Proposition} \ref{prop:stable iteration}, \markbox{23613}{we} \markbox{23614}{get} \markbox{m23615}{$\calY_0$}-stable \markbox{m23616}{$L_{n+2}$}-compatible \markbox{23617}{stable} \markbox{23618}{decompositions} \markbox{23619}{for} \markbox{m23620}{$(a,b;\calY)$} \markbox{23621}{and} \markbox{m23622}{$(a,b;\calY_{all} \cup \{a',b'\})$}, \markbox{23623}{and} \markbox{m23624}{$\calY_0$}-stable \markbox{m23625}{$L_{m+2}$}-compatible \markbox{23626}{stable} \markbox{23627}{decompositions} \markbox{23628}{for} \markbox{m23629}{$(a',b';\calY)$} \markbox{23630}{and} \markbox{m23631}{$(a',b';\calY_{all} \cup \{a,b\})$}.  \markbox{23632}{Since} \markbox{m23633}{$(a,b;\calY_{all} \cup \{a',b'\})$} \markbox{23634}{and} \markbox{m23635}{$(a',b';\calY_{all} \cup \{a,b\})$} \markbox{23636}{determine} \markbox{23637}{identical} \markbox{23638}{edge} components, \markbox{23639}{we} \markbox{23640}{can} \markbox{23641}{use} \markbox{23642}{an} \markbox{23643}{identical} \markbox{23644}{argument} \markbox{23645}{to} \markbox{23646}{the} \markbox{23647}{proof} \markbox{23648}{of} \markbox{23649}{Proposition} \ref{prop:stable iteration, pair} \markbox{23650}{to} \markbox{23651}{induce} \markbox{23652}{refined} \markbox{m23653}{$\calY_0$}-stable \markbox{m23654}{$(L_n \cdot L_m)$}-compatible \markbox{23655}{stable} \markbox{23656}{decompositions} \markbox{23657}{for} \markbox{m23658}{$(a,b;\calY)$} \markbox{23659}{and} \markbox{m23660}{$(a',b';\calY)$}.  \markbox{23661}{We} \markbox{23662}{leave} \markbox{23663}{the} \markbox{23664}{details} \markbox{23665}{to} \markbox{23666}{the} reader.  \markbox{23667}{This} \markbox{23668}{completes} \markbox{23669}{the} proof. \qed

\begin{thebibliography}{BHMS24b}

\bibitem[AB95]{AB95}
Juan~M. \markbox{23670}{Alonso} \markbox{23671}{and} Martin~R. Bridson.
\newblock Semihyperbolic groups.
\newblock {\em Proc. London Math. Soc. (3)}, 70(1):56--114, 1995.

\bibitem[ABD17]{ABD}
Carolyn Abbott, \markbox{23672}{Jason} Behrstock, \markbox{23673}{and} Matthew~Gentry Durham.
\newblock Largest \markbox{23674}{acylindrical} \markbox{23675}{actions} \markbox{23676}{and} \markbox{23677}{stability} \markbox{23678}{in} hierarchically
  \markbox{23679}{hyperbolic} groups.
\newblock {\em arXiv preprint arXiv:1705.06219}, 2017.

\bibitem[Aou13]{Aougab_hyp}
Tarik Aougab.
\newblock Uniform \markbox{23680}{hyperbolicity} \markbox{23681}{of} \markbox{23682}{the} \markbox{23683}{graphs} \markbox{23684}{of} curves.
\newblock {\em Geometry \& Topology}, 17(5):2855--2875, 2013.

\bibitem[BBF15]{BBF}
Mladen Bestvina, \markbox{23685}{Ken} Bromberg, \markbox{23686}{and} \markbox{23687}{Koji} Fujiwara.
\newblock Constructing \markbox{23688}{group} \markbox{23689}{actions} \markbox{23690}{on} quasi-trees \markbox{23691}{and} \markbox{23692}{applications} \markbox{23693}{to} mapping
  \markbox{23694}{class} groups.
\newblock {\em Publ. Math. Inst. Hautes \'{E}tudes Sci.}, 122:1--64, 2015.

\bibitem[BBFS20]{BBFS}
Mladen Bestvina, \markbox{23695}{Ken} Bromberg, \markbox{23696}{Koji} Fujiwara, \markbox{23697}{and} \markbox{23698}{Alessandro} Sisto.
\newblock Acylindrical \markbox{23699}{actions} \markbox{23700}{on} \markbox{23701}{projection} complexes.
\newblock {\em Enseign. Math.}, 65(1-2):1--32, 2020.

\bibitem[Beh06]{Beh:thesis}
Jason~A. Behrstock.
\newblock Asymptotic \markbox{23702}{geometry} \markbox{23703}{of} \markbox{23704}{the} \markbox{23705}{mapping} \markbox{23706}{class} \markbox{23707}{group} \markbox{23708}{and} {T}eichm\"{u}ller
  space.
\newblock {\em Geom. Topol.}, 10:1523--1578, 2006.

\bibitem[Ber21]{berlyne2021hierarchical}
Daniel James~Solomon Berlyne.
\newblock {\em Hierarchical hyperbolicity of graph products and graph braid
  groups}.
\newblock PhD thesis, \markbox{23709}{City} \markbox{23710}{University} \markbox{23711}{of} \markbox{23712}{New} York, 2021.

\bibitem[Bes96]{bestvina1996local}
Mladen Bestvina.
\newblock Local \markbox{23713}{homology} \markbox{23714}{properties} \markbox{23715}{of} \markbox{23716}{boundaries} \markbox{23717}{of} groups.
\newblock {\em Michigan Mathematical Journal}, 43(1):123--139, 1996.

\bibitem[BGGH25]{bongiovanni2025characterizing}
Eliot Bongiovanni, \markbox{23718}{Pritam} Ghosh, \markbox{23719}{Funda} G{\"u}ltepe, \markbox{23720}{and} \markbox{23721}{Mark} Hagen.
\newblock Characterizing \markbox{23722}{hierarchically} \markbox{23723}{hyperbolic} \markbox{23724}{free} \markbox{23725}{by} \markbox{23726}{cyclic} groups.
\newblock {\em arXiv preprint arXiv:2508.15738}, 2025.

\bibitem[BHMS24a]{behrstock2024combinatorial}
Jason Behrstock, \markbox{23727}{Mark} Hagen, \markbox{23728}{Alexandre} Martin, \markbox{23729}{and} \markbox{23730}{Alessandro} Sisto.
\newblock A \markbox{23731}{combinatorial} \markbox{23732}{take} \markbox{23733}{on} \markbox{23734}{hierarchical} \markbox{23735}{hyperbolicity} \markbox{23736}{and} applications
  \markbox{23737}{to} \markbox{23738}{quotients} \markbox{23739}{of} \markbox{23740}{mapping} \markbox{23741}{class} groups.
\newblock {\em Journal of Topology}, 17(3):e12351, 2024.

\bibitem[BHMS24b]{BHMS:kill_twists}
Jason Behrstock, \markbox{23742}{Mark} Hagen, \markbox{23743}{Alexandre} Martin, \markbox{23744}{and} \markbox{23745}{Alessandro} Sisto.
\newblock A \markbox{23746}{combinatorial} \markbox{23747}{take} \markbox{23748}{on} \markbox{23749}{hierarchical} \markbox{23750}{hyperbolicity} \markbox{23751}{and} applications
  \markbox{23752}{to} \markbox{23753}{quotients} \markbox{23754}{of} \markbox{23755}{mapping} \markbox{23756}{class} groups.
\newblock {\em J. Topol.}, 17(3):Paper No. e12351, 94, 2024.

\bibitem[BHS17a]{HHS:asdim}
Jason Behrstock, Mark~F. Hagen, \markbox{23757}{and} \markbox{23758}{Alessandro} Sisto.
\newblock Asymptotic \markbox{23759}{dimension} \markbox{23760}{and} small-cancellation \markbox{23761}{for} hierarchically
  \markbox{23762}{hyperbolic} \markbox{23763}{spaces} \markbox{23764}{and} groups.
\newblock {\em Proc. Lond. Math. Soc. (3)}, 114(5):890--926, 2017.

\bibitem[BHS17b]{HHS_I}
Jason Behrstock, Mark~F. Hagen, \markbox{23765}{and} \markbox{23766}{Alessandro} Sisto.
\newblock Hierarchically \markbox{23767}{hyperbolic} spaces, {I}: {C}urve \markbox{23768}{complexes} \markbox{23769}{for} cubical
  groups.
\newblock {\em Geom. Topol.}, 21(3):1731--1804, 2017.

\bibitem[BHS19]{HHS_II}
Jason Behrstock, \markbox{23770}{Mark} Hagen, \markbox{23771}{and} \markbox{23772}{Alessandro} Sisto.
\newblock {Hierarchically hyperbolic spaces II: Combination theorems and the
  distance formula}.
\newblock {\em Pacific Journal of Mathematics}, 299(2):257--338, 2019.

\bibitem[BHS21]{HHS_quasi}
Jason Behrstock, Mark~F Hagen, \markbox{23773}{and} \markbox{23774}{Alessandro} Sisto.
\newblock Quasiflats \markbox{23775}{in} \markbox{23776}{hierarchically} \markbox{23777}{hyperbolic} spaces.
\newblock {\em Duke Mathematical Journal}, 1(1):1--88, 2021.

\bibitem[BKMM12]{BKMM:qirigid}
J.~Behrstock, B.~Kleiner, Y.~Minsky, \markbox{23778}{and} L.~Mosher.
\newblock Geometry \markbox{23779}{and} \markbox{23780}{rigidity} \markbox{23781}{of} \markbox{23782}{mapping} \markbox{23783}{class} groups.
\newblock {\em Geometry and Topology}, 16:781--888, 2012.

\bibitem[Bon24]{bongiovanni2024extensions}
Eliot Bongiovanni.
\newblock Extensions \markbox{23784}{of} \markbox{23785}{finitely} \markbox{23786}{generated} \markbox{23787}{veech} groups.
\newblock {\em arXiv preprint arXiv:2406.11090}, 2024.

\bibitem[Bow19]{Bowditch_hulls}
Brian~H. Bowditch.
\newblock Convex \markbox{23788}{hulls} \markbox{23789}{in} \markbox{23790}{coarse} \markbox{23791}{median} spaces.
\newblock {\em preprint}, 2019.

\bibitem[Bow22]{bowditch2022median}
Brian~H Bowditch.
\newblock Median algebras.
\newblock {\em preprint}, \markbox{23792}{page} 209, 2022.

\bibitem[BR22]{BR:graph_prods}
Daniel \markbox{23793}{Berlyne} \markbox{23794}{and} \markbox{23795}{Jacob} Russell.
\newblock Hierarchical \markbox{23796}{hyperbolicity} \markbox{23797}{of} \markbox{23798}{graph} products.
\newblock {\em Groups Geom. Dyn.}, 16(2):523--580, 2022.

\bibitem[Bro02]{Brock}
Jeffrey~F. Brock.
\newblock Pants \markbox{23799}{decompositions} \markbox{23800}{and} \markbox{23801}{the} {W}eil-{P}etersson metric.
\newblock In {\em Complex manifolds and hyperbolic geometry ({G}uanajuato,
  2001)}, \markbox{23802}{volume} 311 \markbox{23803}{of} {\em Contemp. Math.}, \markbox{23804}{pages} 27--40. Amer. Math. Soc.,
  Providence, RI, 2002.

\bibitem[Che00]{Che00}
Victor Chepoi.
\newblock Graphs \markbox{23805}{of} \markbox{23806}{some} {${\rm CAT}(0)$} complexes.
\newblock {\em Adv. in Appl. Math.}, 24(2):125--179, 2000.

\bibitem[Che22]{chesser2022stable}
Marissa Chesser.
\newblock Stable \markbox{23807}{subgroups} \markbox{23808}{of} \markbox{23809}{the} \markbox{23810}{genus} 2 \markbox{23811}{handlebody} group.
\newblock {\em Algebraic \& Geometric Topology}, 22(2):919--971, 2022.

\bibitem[CLM12]{CLM12}
Matt~T. Clay, Christopher~J. Leininger, \markbox{23812}{and} \markbox{23813}{Johanna} Mangahas.
\newblock The \markbox{23814}{geometry} \markbox{23815}{of} right-angled {A}rtin \markbox{23816}{subgroups} \markbox{23817}{of} \markbox{23818}{mapping} class
  groups.
\newblock {\em Groups Geom. Dyn.}, 6(2):249--278, 2012.

\bibitem[CN05]{CN05}
Indira \markbox{23819}{Chatterji} \markbox{23820}{and} \markbox{23821}{Graham} Niblo.
\newblock From \markbox{23822}{wall} \markbox{23823}{spaces} \markbox{23824}{to} {$\rm CAT(0)$} \markbox{23825}{cube} complexes.
\newblock {\em Internat. J. Algebra Comput.}, 15(5-6):875--885, 2005.

\bibitem[CR24]{calderon2024hierarchical}
Aaron \markbox{23826}{Calderon} \markbox{23827}{and} \markbox{23828}{Jacob} Russell.
\newblock Hierarchical \markbox{23829}{hyperbolicity} \markbox{23830}{of} \markbox{23831}{admissible} \markbox{23832}{curve} \markbox{23833}{graphs} \markbox{23834}{and} the
  \markbox{23835}{boundary} \markbox{23836}{of} \markbox{23837}{marked} strata.
\newblock {\em arXiv preprint arXiv:2409.06798}, 2024.

\bibitem[CRHK21]{CRHK}
Montserrat Casals-Ruiz, \markbox{23838}{Mark} Hagen, \markbox{23839}{and} \markbox{23840}{Ilya} Kazachkov.
\newblock Real \markbox{23841}{cubings} \markbox{23842}{and} \markbox{23843}{asymptotic} \markbox{23844}{cones} \markbox{23845}{of} \markbox{23846}{hierarchically} hyperbolic
  groups.
\newblock {\em preprint}, 2021.

\bibitem[CS11]{CapraceSageev}
Pierre-Emmanuel \markbox{23847}{Caprace} \markbox{23848}{and} \markbox{23849}{Michah} Sageev.
\newblock Rank \markbox{23850}{rigidity} \markbox{23851}{for} \markbox{23852}{cat} (0) \markbox{23853}{cube} complexes.
\newblock {\em Geometric and functional analysis}, 21(4):851--891, 2011.

\bibitem[DDLS23]{DDLS1}
Spencer Dowdall, Matthew~G Durham, Christopher~J Leininger, \markbox{23854}{and} Alessandro
  Sisto.
\newblock Extensions \markbox{23855}{of} \markbox{23856}{veech} \markbox{23857}{groups} i: \markbox{23858}{A} \markbox{23859}{hyperbolic} action.
\newblock {\em Journal of Topology}, 16(2):757--805, 2023.

\bibitem[DDLS24]{DDLS2}
Spencer Dowdall, Matthew~G. Durham, Christopher~J. Leininger, \markbox{23860}{and} Alessandro
  Sisto.
\newblock Extensions \markbox{23861}{of} {V}eech \markbox{23862}{groups} {II}: {H}ierarchical \markbox{23863}{hyperbolicity} and
  quasi-isometric rigidity.
\newblock {\em Comment. Math. Helv.}, 99(1):149--228, 2024.

\bibitem[DMS20]{DMS_bary}
Matthew~G Durham, Yair~N Minsky, \markbox{23864}{and} \markbox{23865}{Alessandro} Sisto.
\newblock Stable cubulations, bicombings, \markbox{23866}{and} barycenters.
\newblock {\em arXiv preprint arXiv:2009.13647}, 2020.

\bibitem[DMS25]{DMS_FJ}
Matthew~Gentry Durham, \markbox{23867}{Yair} Minsky, \markbox{23868}{and} \markbox{23869}{Alessandro} Sisto.
\newblock Asymptotically \markbox{23870}{cat} (0) metrics, z-structures, \markbox{23871}{and} \markbox{23872}{the} farrell-jones
  conjecture.
\newblock {\em arXiv preprint arXiv:2504.17048}, 2025.

\bibitem[Dra06]{Dra:BM_formula}
A.~N. Dranishnikov.
\newblock On {B}estvina-{M}ess formula.
\newblock In {\em Topological and asymptotic aspects of group theory}, volume
  394 \markbox{23873}{of} {\em Contemp. Math.}, \markbox{23874}{pages} 77--85. Amer. Math. Soc., Providence, RI,
  2006.

\bibitem[Dur16]{Dur:augmented}
Matthew~Gentry Durham.
\newblock The \markbox{23875}{augmented} \markbox{23876}{marking} \markbox{23877}{complex} \markbox{23878}{of} \markbox{23879}{a} surface.
\newblock {\em J. Lond. Math. Soc. (2)}, 94(3):933--969, 2016.

\bibitem[Dur23]{Dur_infcube}
Matthew~Gentry Durham.
\newblock Cubulating \markbox{23880}{infinity} \markbox{23881}{in} \markbox{23882}{hierarchically} \markbox{23883}{hyperbolic} spaces.
\newblock {\em arXiv preprint arXiv:2308.13689}, 2023.

\bibitem[DZ22]{DZ22}
Matthew~Gentry \markbox{23884}{Durham} \markbox{23885}{and} \markbox{23886}{Abdul} Zalloum.
\newblock The \markbox{23887}{geometry} \markbox{23888}{of} \markbox{23889}{genericity} \markbox{23890}{in} \markbox{23891}{mapping} \markbox{23892}{class} \markbox{23893}{groups} and
  teichm\"uller \markbox{23894}{spaces} \markbox{23895}{via} \markbox{23896}{cat} (0) \markbox{23897}{cube} complexes.
\newblock {\em To appear in \emph{Transactions of the AMS}, arXiv:2207.06516},
  2022.

\bibitem[EMR17]{EMR:rank}
Alex Eskin, \markbox{23898}{Howard} Masur, \markbox{23899}{and} \markbox{23900}{Kasra} Rafi.
\newblock Large-scale \markbox{23901}{rank} \markbox{23902}{of} {T}eichm\"{u}ller space.
\newblock {\em Duke Math. J.}, 166(8):1517--1572, 2017.

\bibitem[FJ93]{farrell1993isomorphism}
F~Thomas \markbox{23903}{Farrell} \markbox{23904}{and} Lowell~E Jones.
\newblock Isomorphism \markbox{23905}{conjectures} \markbox{23906}{in} \markbox{23907}{algebraic} {K}-theory.
\newblock {\em Journal of the American Mathematical Society}, 6(2):249--297,
  1993.

\bibitem[FM11]{FM_primer}
Benson \markbox{23908}{Farb} \markbox{23909}{and} \markbox{23910}{Dan} Margalit.
\newblock {\em A primer on mapping class groups (pms-49)}, volume~41.
\newblock Princeton \markbox{23911}{university} press, 2011.

\bibitem[Hag23]{Hagen:non-col}
Mark Hagen.
\newblock Non-colorable \markbox{23912}{hierarchically} \markbox{23913}{hyperbolic} groups.
\newblock {\em Internat. J. Algebra Comput.}, 33(2):337--350, 2023.

\bibitem[Ham21]{Ham_boundary}
Ursula Hamenst{\"a}dt.
\newblock Geometry \markbox{23914}{of} \markbox{23915}{the} \markbox{23916}{mapping} \markbox{23917}{class} \markbox{23918}{groups} iia: \markbox{23919}{Cat} (0) \markbox{23920}{cube} \markbox{23921}{complexes} and
  boundaries.
\newblock {\em Preprint available at www. math. uni-bonn.
  de/people/ursula/noncube. pdf}, page~34, 2021.

\bibitem[Ham25]{hamenstadt2025z}
Ursula Hamenst\"adt.
\newblock A {Z}-structure \markbox{23922}{for} \markbox{23923}{the} \markbox{23924}{mapping} \markbox{23925}{class} group.
\newblock arXiv:2505.18808, 2025.

\bibitem[HHP23]{HHP}
Thomas Haettel, \markbox{23926}{Nima} Hoda, \markbox{23927}{and} \markbox{23928}{Harry} Petyt.
\newblock Coarse injectivity, \markbox{23929}{hierarchical} \markbox{23930}{hyperbolicity} \markbox{23931}{and} semihyperbolicity.
\newblock {\em Geom. Topol.}, 27(4):1587--1633, 2023.

\bibitem[HMS24]{MMS:Artin}
Mark Hagen, \markbox{23932}{Alexandre} Martin, \markbox{23933}{and} \markbox{23934}{Alessandro} Sisto.
\newblock Extra-large \markbox{23935}{type} {A}rtin \markbox{23936}{groups} \markbox{23937}{are} \markbox{23938}{hierarchically} hyperbolic.
\newblock {\em Math. Ann.}, 388(1):867--938, 2024.

\bibitem[HP98]{HP_wallspace}
Fr{\'e}d{\'e}ric \markbox{23939}{Haglund} \markbox{23940}{and} Fr{\'e}d{\'e}ric Paulin.
\newblock {\em Simplicit{\'e} de groupes d'automorphismes d'espaces {\`a}
  courbure n{\'e}gative}.
\newblock Universit{\'e} \markbox{23941}{de} Paris-Sud. D{\'e}partement \markbox{23942}{de} Math{\'e}matique,
  1998.

\bibitem[HP23]{HP_proj}
Mark~F \markbox{23943}{Hagen} \markbox{23944}{and} \markbox{23945}{Harry} Petyt.
\newblock Projection \markbox{23946}{complexes} \markbox{23947}{and} \markbox{23948}{quasimedian} maps.
\newblock {\em Algebraic \& Geometric Topology}, 22(7):3277--3304, 2023.

\bibitem[HRSS22]{hagen2022equivariant}
Mark Hagen, \markbox{23949}{Jacob} Russell, \markbox{23950}{Alessandro} Sisto, \markbox{23951}{and} \markbox{23952}{Davide} Spriano.
\newblock Equivariant \markbox{23953}{hierarchically} \markbox{23954}{hyperbolic} \markbox{23955}{structures} \markbox{23956}{for} 3-manifold
  \markbox{23957}{groups} \markbox{23958}{via} quasimorphisms.
\newblock {\em arXiv preprint arXiv:2206.12244}, 2022.

\bibitem[HS20]{HS:cubical}
Mark~F. \markbox{23959}{Hagen} \markbox{23960}{and} \markbox{23961}{Tim} Susse.
\newblock On \markbox{23962}{hierarchical} \markbox{23963}{hyperbolicity} \markbox{23964}{of} \markbox{23965}{cubical} groups.
\newblock {\em Israel J. Math.}, 236(1):45--89, 2020.

\bibitem[HW14]{HW_CCC}
G~Christopher \markbox{23966}{Hruska} \markbox{23967}{and} Daniel~T Wise.
\newblock Finiteness \markbox{23968}{properties} \markbox{23969}{of} \markbox{23970}{cubulated} groups.
\newblock {\em Compositio Mathematica}, 150(3):453--506, 2014.

\bibitem[Kar11]{Kar_asymp}
Aditi Kar.
\newblock Asymptotically {CAT}(0) groups.
\newblock {\em Publicacions Matem{\`a}tiques}, \markbox{23971}{pages} 67--91, 2011.

\bibitem[KK14]{kim2014geometry}
Sang-Hyun \markbox{23972}{Kim} \markbox{23973}{and} \markbox{23974}{Thomas} Koberda.
\newblock The \markbox{23975}{geometry} \markbox{23976}{of} \markbox{23977}{the} \markbox{23978}{curve} \markbox{23979}{graph} \markbox{23980}{of} \markbox{23981}{a} right-angled \markbox{23982}{artin} group.
\newblock {\em International Journal of Algebra and Computation},
  24(02):121--169, 2014.

\bibitem[Min10]{Min_ELC}
Yair Minsky.
\newblock The \markbox{23983}{classification} \markbox{23984}{of} \markbox{23985}{kleinian} \markbox{23986}{surface} groups, i: \markbox{23987}{Models} \markbox{23988}{and} bounds.
\newblock {\em Annals of Mathematics}, \markbox{23989}{pages} 1--107, 2010.

\bibitem[MM99]{MM99}
Howard~A \markbox{23990}{Masur} \markbox{23991}{and} Yair~N Minsky.
\newblock Geometry \markbox{23992}{of} \markbox{23993}{the} \markbox{23994}{complex} \markbox{23995}{of} \markbox{23996}{curves} {I}: Hyperbolicity.
\newblock {\em Inventiones mathematicae}, 138(1):103--149, 1999.

\bibitem[MM00a]{MM_II}
H.~A. \markbox{23997}{Masur} \markbox{23998}{and} Y.~N. Minsky.
\newblock Geometry \markbox{23999}{of} \markbox{24000}{the} \markbox{24001}{complex} \markbox{24002}{of} curves. {II}. {H}ierarchical structure.
\newblock {\em Geom. Funct. Anal.}, 10(4):902--974, 2000.

\bibitem[MM00b]{MM00}
Howard~A \markbox{24003}{Masur} \markbox{24004}{and} Yair~N Minsky.
\newblock Geometry \markbox{24005}{of} \markbox{24006}{the} \markbox{24007}{complex} \markbox{24008}{of} \markbox{24009}{curves} {II}: \markbox{24010}{Hierarchical} structure.
\newblock {\em Geometric and Functional Analysis}, 10(4):902--974, 2000.

\bibitem[Nic13]{Nica}
Bogdan Nica.
\newblock Proper \markbox{24011}{isometric} \markbox{24012}{actions} \markbox{24013}{of} \markbox{24014}{hyperbolic} \markbox{24015}{groups} \markbox{24016}{on} {$L^p$}-spaces.
\newblock {\em Compos. Math.}, 149(5):773--792, 2013.

\bibitem[NR98]{NibloReeves}
G.~A. \markbox{24017}{Niblo} \markbox{24018}{and} L.~D. Reeves.
\newblock The \markbox{24019}{geometry} \markbox{24020}{of} \markbox{24021}{cube} \markbox{24022}{complexes} \markbox{24023}{and} \markbox{24024}{the} \markbox{24025}{complexity} \markbox{24026}{of} their
  \markbox{24027}{fundamental} groups.
\newblock {\em Topology}, 37(3):621--633, 1998.

\bibitem[Pet21]{Petyt_quasicube}
Harry Petyt.
\newblock Mapping \markbox{24028}{class} \markbox{24029}{groups} \markbox{24030}{are} quasicubical.
\newblock {\em To appear in the \emph{American Journal of Mathematics},
  arXiv:2112.10681}, 2021.

\bibitem[PZS24]{PZ_walls}
Harry Petyt, \markbox{24031}{Abdul} Zalloum, \markbox{24032}{and} \markbox{24033}{Davide} Spriano.
\newblock Constructing \markbox{24034}{metric} \markbox{24035}{spaces} \markbox{24036}{from} \markbox{24037}{systems} \markbox{24038}{of} walls.
\newblock {\em arXiv preprint arXiv:2404.12057}, 2024.

\bibitem[Raf07]{Rafi:combo}
Kasra Rafi.
\newblock A \markbox{24039}{combinatorial} \markbox{24040}{model} \markbox{24041}{for} \markbox{24042}{the} {T}eichm\"{u}ller metric.
\newblock {\em Geom. Funct. Anal.}, 17(3):936--959, 2007.

\bibitem[Raf14]{Rafi:hypteich}
Kasra Rafi.
\newblock {Hyperbolicity in Teichm{\"u}ller space}.
\newblock {\em Geometry \& Topology}, 18(5):3025--3053, 2014.

\bibitem[Rol16]{Roller}
Martin Roller.
\newblock Poc sets, \markbox{24043}{median} \markbox{24044}{algebras} \markbox{24045}{and} \markbox{24046}{group} actions.
\newblock {\em arXiv preprint arXiv:1607.07747}, 2016.

\bibitem[RST23]{russell2023convexity}
Jacob Russell, \markbox{24047}{Davide} Spriano, \markbox{24048}{and} Hung~Cong Tran.
\newblock Convexity \markbox{24049}{in} \markbox{24050}{hierarchically} \markbox{24051}{hyperbolic} spaces.
\newblock {\em Algebraic \& Geometric Topology}, 23(3):1167--1248, 2023.

\bibitem[Rus21]{russell2021extensions}
Jacob Russell.
\newblock Extensions \markbox{24052}{of} \markbox{24053}{multicurve} \markbox{24054}{stabilizers} \markbox{24055}{are} \markbox{24056}{hierarchically} hyperbolic.
\newblock {\em To appear in \emph{Geometry \& Topology}, arXiv:2107.14116},
  2021.

\bibitem[Sag95]{Sageev:cubulation}
Michah Sageev.
\newblock Ends \markbox{24057}{of} \markbox{24058}{group} \markbox{24059}{pairs} \markbox{24060}{and} non-positively \markbox{24061}{curved} \markbox{24062}{cube} complexes.
\newblock {\em Proc. London Math. Soc. (3)}, 71(3):585--617, 1995.

\bibitem[Sag14]{Sageev:pcmi}
Michah Sageev.
\newblock {$\rm CAT(0)$} \markbox{24063}{cube} \markbox{24064}{complexes} \markbox{24065}{and} groups.
\newblock In {\em Geometric group theory}, volume~21 \markbox{24066}{of} {\em IAS/Park City
  Math. Ser.}, \markbox{24067}{pages} 7--54. Amer. Math. Soc., Providence, RI, 2014.

\bibitem[Sch]{schwer2324cat}
Petra Schwer.
\newblock {CAT}(0) \markbox{24068}{cube} complexes.
\newblock {\em Lecture Notes in Mathematics}, 2324.

\bibitem[She25]{shepherd2025cubulation}
Sam Shepherd.
\newblock A \markbox{24069}{cubulation} \markbox{24070}{with} \markbox{24071}{no} \markbox{24072}{factor} system.
\newblock {\em Algebraic \& Geometric Topology}, 25(1):255--266, 2025.

\bibitem[Sis17]{Sisto_HHS}
Alessandro Sisto.
\newblock What \markbox{24073}{is} \markbox{24074}{a} \markbox{24075}{hierarchically} \markbox{24076}{hyperbolic} space?
\newblock {\em arXiv preprint arXiv:1707.00053}, 2017.

\bibitem[Zal23]{Zalloum_expo}
Abdul Zalloum.
\newblock Injectivity, \markbox{24077}{cubical} \markbox{24078}{approximations} \markbox{24079}{and} \markbox{24080}{equivariant} \markbox{24081}{wall} structures
  \markbox{24082}{beyond} \markbox{24083}{cat} (0) \markbox{24084}{cube} complexes.
\newblock {\em arXiv preprint arXiv:2305.02951}, 2023.

\bibitem[Zal25]{zalloum2025effective}
Abdul Zalloum.
\newblock Effective flipping, \markbox{24085}{skewering} \markbox{24086}{and} \markbox{24087}{rank} \markbox{24088}{rigidity} \markbox{24089}{for} \markbox{24090}{cubulated} groups
  \markbox{24091}{with} \markbox{24092}{factor} systems.
\newblock {\em Transactions of the American Mathematical Society}, 2025.

\end{thebibliography}

%% \bibliographystyle{alpha}
%% \bibliography{references}

\end{document}